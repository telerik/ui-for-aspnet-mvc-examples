/*
* Kendo UI Complete v2013.1.319 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
("function"==typeof define&&define.amd?define:function(e,i){return i()})(["./kendo.draganddrop.min"],function(){(function(e,i){function t(e){return e!==i}function n(e,i,t){return Math.max(Math.min(e,t),i)}function o(e,i){var t=e.children(x);return t.data("kendoWindow")||t.data("kendo"+i)}function r(i){return e(y).filter(function(){var t=e(this),n=o(t,i);return n.options.modal&&t.is(O)&&n.options.visible}).sort(function(i,t){return+e(i).css("zIndex")-+e(t).css("zIndex")})}function s(e,i){return function(){var e=this,t=e.wrapper,n=t[0].style,o=e.options;if(!o.isMaximized&&!o.isMinimized)return e.restoreOptions={width:n.width,height:n.height},t.find(_).hide().end().find(U).parent().hide().eq(0).before(J.action({name:"Restore"})),i.call(e),e}}function a(e){var i=this;i.owner=e,i._draggable=new p(e.wrapper,{filter:_,group:e.wrapper.id+"-resizing",dragstart:m(i.dragstart,i),drag:m(i.drag,i),dragend:m(i.dragend,i)})}function d(e){var i=this;i.owner=e,i._draggable=new p(e.wrapper,{filter:b,group:e.wrapper.id+"-moving",dragstart:m(i.dragstart,i),drag:m(i.drag,i),dragend:m(i.dragend,i),dragcancel:m(i.dragcancel,i)})}var l=window.kendo,c=l.ui.Widget,p=l.ui.Draggable,h=e.isPlainObject,f=l._activeElement,m=e.proxy,u=e.extend,g=e.each,w=l.template,v="body",k=".kendoWindow",y=".k-window",z=".k-window-title",b=z+"bar",x=".k-window-content",_=".k-resize-handle",T=".k-overlay",W="k-content-frame",M="k-loading",H="k-state-hover",C="k-state-focused",O=":visible",P="hidden",S="cursor",D="open",I="activate",L="deactivate",R="close",A="refresh",F="resize",q="dragstart",j="dragend",E="error",N="overflow",G="zIndex",U=".k-window-actions .k-i-minimize,.k-window-actions .k-i-maximize",K=".k-window-titlebar .k-window-action",B=l.isLocalUrl,Q=c.extend({init:function(i,n){var o,r,s,p,f,u,w,v=this,_=!1;c.fn.init.call(v,i,n),n=v.options,i=v.element,f=n.content,v.appendTo=e(n.appendTo||document.body),v._animations(),f&&!h(f)&&(f=n.content={url:f}),i.find("script").filter(function(){return!this.type||this.type.toLowerCase().indexOf("script")>=0}).remove(),i.parent().is(v.appendTo)||(i.is(O)?(r=i.offset(),_=!0):(s=i.css("visibility"),p=i.css("display"),i.css({visibility:P,display:""}),r=i.offset(),i.css({visibility:s,display:p}))),t(n.visible)&&null!==n.visible||(n.visible=i.is(O)),o=v.wrapper=i.closest(y),i.is(".k-content")&&o[0]||(i.addClass("k-window-content k-content"),v._createWindow(i,n),o=v.wrapper=i.closest(y),v._dimensions()),r&&o.css({top:r.top,left:r.left}),f&&v.refresh(f),n.visible&&v.toFront(),u=o.children(x),v._tabindex(u),n.visible&&n.modal&&v._overlay(o.is(O)).css({opacity:.5}),o.on("mouseenter"+k,K,function(){e(this).addClass(H)}).on("mouseleave"+k,K,function(){e(this).removeClass(H)}).on("click"+k,K,m(v._windowActionHandler,v)),u.on("keydown"+k,m(v._keydown,v)).on("focus"+k,function(){o.addClass(C)}).on("blur"+k,function(){o.removeClass(C)}),n.resizable&&(o.on("dblclick"+k,b,function(i){return e(i.target).closest(".k-window-action").length||v.toggleMaximization(),this}),g("n e s w se sw ne nw".split(" "),function(e,i){o.append(J.resizeHandle(i))}),v.resizing=new a(v)),n.draggable&&(v.dragging=new d(v)),w=i.attr("id"),w&&(w+="_wnd_title",o.find(b).children(z).attr("id",w),u.attr({role:"dialog","aria-labelledby":w})),o.add(o.find(".k-resize-handle,.k-window-titlebar")).on("mousedown"+k,m(v.toFront,v)),v.touchScroller=l.touchScroller(i),v._resizeHandler=function(e){return v._onDocumentResize(e)},e(window).on("resize",v._resizeHandler),n.visible&&(v.trigger(D),v.trigger(I)),l.notify(v)},_dimensions:function(){var e=this,i=e.wrapper,t=e.element,o=e.options;e.title(o.title),g(["minWidth","minHeight","maxWidth","maxHeight"],function(e,i){var n=o[i];n&&1/0!=n&&t.css(i,n)}),o.width&&i.width(n(parseInt(o.width,10),o.minWidth,o.maxWidth)),o.height&&i.height(n(parseInt(o.height,10),o.minHeight,o.maxHeight)),o.visible||i.hide()},_animations:function(){var e=this.options;e.animation===!1&&(e.animation={open:{effects:{}},close:{hide:!0,effects:{}}})},setOptions:function(e){c.fn.setOptions.call(this,e),this._animations(),this._dimensions()},events:[D,I,L,R,A,F,q,j,E],options:{name:"Window",animation:{open:{effects:{zoom:{direction:"in"},fade:{direction:"in"}},duration:350},close:{effects:{zoom:{direction:"out",properties:{scale:.7}},fade:{direction:"out"}},duration:350,hide:!0}},title:"",actions:["Close"],modal:!1,resizable:!0,draggable:!0,minWidth:90,minHeight:50,maxWidth:1/0,maxHeight:1/0,visible:null,height:null,width:null},_closable:function(){return e.inArray("close",e.map(this.options.actions,function(e){return e.toLowerCase()}))>-1},_keydown:function(e){var i,t,o,r,s=this,a=s.options,d=l.keys,c=e.keyCode,p=s.wrapper,h=10,f=s.options.isMaximized;e.target==e.currentTarget&&(c==d.ESC&&s._closable()&&s._close(!0),!a.draggable||e.ctrlKey||f||(i=l.getOffset(p),c==d.UP?t=p.css("top",i.top-h):c==d.DOWN?t=p.css("top",i.top+h):c==d.LEFT?t=p.css("left",i.left-h):c==d.RIGHT&&(t=p.css("left",i.left+h))),a.resizable&&e.ctrlKey&&!f&&(c==d.UP?(t=!0,r=p.height()-h):c==d.DOWN&&(t=!0,r=p.height()+h),c==d.LEFT?(t=!0,o=p.width()-h):c==d.RIGHT&&(t=!0,o=p.width()+h),t&&(p.css({width:n(o,a.minWidth,a.maxWidth),height:n(r,a.minHeight,a.maxHeight)}),s.trigger(F))),t&&e.preventDefault())},_overlay:function(i){var t=this.appendTo.children(".k-overlay"),n=this.wrapper;return t.length||(t=e("<div class='k-overlay' />")),t.insertBefore(n[0]).toggle(i).css(G,parseInt(n.css(G),10)-1),t},_windowActionHandler:function(t){var n=e(t.target).closest(".k-window-action").find(".k-icon"),o=this;o._closing||g({"k-i-close":function(){o._close(!0)},"k-i-maximize":o.maximize,"k-i-minimize":o.minimize,"k-i-restore":o.restore,"k-i-refresh":o.refresh},function(e,r){return n.hasClass(e)?(t.preventDefault(),r.call(o),!1):i})},center:function(){var i=this.wrapper,t=e(window);return i.css({left:t.scrollLeft()+Math.max(0,(t.width()-i.width())/2),top:t.scrollTop()+Math.max(0,(t.height()-i.height())/2)}),this},title:function(e){var i=this,t=i.wrapper,n=i.options,o=t.find(b),r=o.children(z),s=o.outerHeight();return arguments.length?(e===!1?(t.addClass("k-window-titleless"),o.remove()):(o.length||t.prepend(J.titlebar(u(J,n))),t.css("padding-top",s),o.css("margin-top",-s)),r.text(e),i):r.text()},content:function(e){var i=this.wrapper.children(x),t=i.children(".km-scroll-container");return i=t[0]?t:i,e?(i.html(e),this):i.html()},open:function(){var i,t=this,n=t.wrapper,o=t.options,r=o.animation.open,s=n.children(x),a=s.css(N);return t.trigger(D)||(t._closing=!1,t.toFront(),t.element.focus(),o.visible=!0,o.modal&&(i=t._overlay(!1),r.duration?i.kendoStop().kendoAnimate({effects:"fade:in",duration:r.duration}):i.css("opacity",.5).show()),n.is(O)||(s.css(N,P),n.show().kendoStop().kendoAnimate({effects:r.effects,duration:r.duration,complete:function(){t.element.focus(),t.trigger(I),s.css(N,a)}}))),o.isMaximized&&(t._documentScrollTop=e(document).scrollTop(),e("html, body").css(N,P)),t},_close:function(t){var n,s,a,d=this,l=d.wrapper,c=d.options,p=c.animation.open,h=c.animation.close;l.is(O)&&!d.trigger(R,{userTriggered:!!t})&&(d._closing=!0,c.visible=!1,e(y).each(function(i,t){var n=e(t),o=n.find(x);t!=l&&o.find("> ."+W).length>0&&o.children(".k-overlay").remove()}),n=r(c.name),s=c.modal&&!n.length,a=c.modal?d._overlay(!0):e(i),s?h.duration?a.kendoStop().kendoAnimate({effects:"fade:out",duration:h.duration,hide:!0}):a.hide():n.length&&o(n.eq(n.length-1),c.name)._overlay(!0),l.kendoStop().kendoAnimate({effects:h.effects||p.effects,reverse:h.reverse===!0,duration:h.duration,complete:function(){l.hide(),d.trigger(L)}})),d.options.isMaximized&&(e("html, body").css(N,""),d._documentScrollTop&&d._documentScrollTop>0&&e(document).scrollTop(d._documentScrollTop))},close:function(){return this._close(!1),this},toFront:function(i){var t,n,o=this,r=o.wrapper,s=r[0],a=+r.css(G),d=a,l=f(),c=o.element,p=i&&i.target?i.target:null;return e(y).each(function(i,t){var n=e(t),o=n.css(G),r=n.find(x);isNaN(o)||(a=Math.max(+o,a)),t!=s&&r.find("> ."+W).length>0&&r.append(J.overlay)}),(10001==a||a>d)&&r.css(G,a+2),o.element.find("> .k-overlay").remove(),e(l).is(c)||e(p).is(K+","+K+" .k-icon,:input")||c.find(l).length&&c.find(p).length||(c.focus(),t=e(window).scrollTop(),n=parseInt(o.wrapper.position().top,10),n>0&&0>n-t&&(t>0?e(window).scrollTop(n):o.wrapper.css("top",t))),o},toggleMaximization:function(){return this._closing?this:this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var i=this,t=i.options,n=i.restoreOptions;if(t.isMaximized||t.isMinimized)return i.wrapper.css({position:"absolute",left:n.left,top:n.top,width:n.width,height:n.height}).find(".k-window-content,.k-resize-handle").show().end().find(".k-window-titlebar .k-i-restore").parent().remove().end().end().find(U).parent().show(),e("html, body").css(N,""),this._documentScrollTop&&this._documentScrollTop>0&&e(document).scrollTop(this._documentScrollTop),t.isMaximized=t.isMinimized=!1,i.trigger(F),i},maximize:s("maximize",function(){var i=this,t=i.wrapper,n=t.position();u(i.restoreOptions,{left:n.left,top:n.top}),t.css({left:0,top:0,position:"fixed"}),this._documentScrollTop=e(document).scrollTop(),e("html, body").css(N,P),i.options.isMaximized=!0,i._onDocumentResize()}),minimize:s("minimize",function(){var e=this;e.wrapper.css("height",""),e.element.hide(),e.options.isMinimized=!0}),_onDocumentResize:function(){var i=this,t=i.wrapper,n=e(window);i.options.isMaximized&&(t.css({width:n.width(),height:n.height()-parseInt(t.css("padding-top"),10)}),i.trigger(F))},refresh:function(i){var n,o,r,s=this,a=s.options,d=e(s.element);return h(i)||(i={url:i}),i=u({},a.content,i),o=t(a.iframe)?a.iframe:i.iframe,r=i.url,r?(t(o)||(o=!B(r)),o?(n=d.find("."+W)[0],n?n.src=r||n.src:d.html(J.contentFrame(u({},a,{content:i}))),d.find("."+W).unbind("load"+k).on("load"+k,function(){s.trigger(A)})):s._ajaxRequest(i)):(i.template&&s.content(w(i.template)({})),s.trigger(A)),s},_ajaxRequest:function(i){var t=this,n=i.template,o=t.wrapper.find(".k-window-titlebar .k-i-refresh"),r=setTimeout(function(){o.addClass(M)},100);e.ajax(u({type:"GET",dataType:"html",cache:!1,error:m(function(e,i){t.trigger(E,{status:i,xhr:e})},t),complete:function(){clearTimeout(r),o.removeClass(M)},success:m(function(e){n&&(e=w(n)(e||{})),t.content(e),t.element.prop("scrollTop",0),t.trigger(A)},t)},i))},destroy:function(){var i,t,n=this;c.fn.destroy.call(n),l.destroy(n.wrapper),n.resizing&&n.resizing.destroy(),n.dragging&&n.dragging.destroy(),n.element.children("iframe").remove(),n.wrapper.remove().add(n.wrapper.find(".k-resize-handle,.k-window-titlebar")).off(k),e(window).off("resize",n._resizeHandler),i=r(),t=n.options.modal&&!i.length,t?n._overlay(!1).remove():i.length>0&&o(i.eq(i.length-1),n.options.name)._overlay(!0)},_createWindow:function(){var i,t,n=this,o=n.element,r=n.options,s=l.support.isRtl(o);r.scrollable===!1&&o.attr("style","overflow:hidden;"),t=e(J.wrapper(r)),r.title!==!1&&t.append(J.titlebar(u(J,r))),i=o.find("iframe:not(.k-content)").map(function(){var e=this.getAttribute("src");return this.src="",e}),t.toggleClass("k-rtl",s).appendTo(n.appendTo).append(o).find("iframe:not(.k-content)").each(function(e){this.src=i[e]}),t.find(".k-window-title").css(s?"left":"right",t.find(".k-window-actions").outerWidth()+10),o.show()}}),J={wrapper:w("<div class='k-widget k-window' />"),action:w("<a role='button' href='\\#' class='k-window-action k-link'><span role='presentation' class='k-icon k-i-#= name.toLowerCase() #'>#= name #</span></a>"),titlebar:w("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #</span><div class='k-window-actions'># for (var i = 0; i < actions.length; i++) { ##= action({ name: actions[i] }) ## } #</div></div>"),overlay:"<div class='k-overlay' />",contentFrame:w("<iframe frameborder='0' title='#= title #' class='"+W+"' "+"src='#= content.url #'>"+"This page requires frames in order to show content"+"</iframe>"),resizeHandle:w("<div class='k-resize-handle k-resize-#= data #'></div>")};a.prototype={dragstart:function(i){var t=this,n=t.owner,o=n.wrapper;t.elementPadding=parseInt(n.wrapper.css("padding-top"),10),t.initialCursorPosition=l.getOffset(o,"position"),t.resizeDirection=i.currentTarget.prop("className").replace("k-resize-handle k-resize-",""),t.initialSize={width:o.width(),height:o.height()},t.containerOffset=l.getOffset(n.appendTo),o.append(J.overlay).find(_).not(i.currentTarget).hide(),e(v).css(S,i.currentTarget.css(S))},drag:function(e){var i,t,o,r,s=this,a=s.owner,d=a.wrapper,l=a.options,c=s.resizeDirection,p=s.containerOffset,h=s.initialCursorPosition,f=s.initialSize,m=e.x.location,u=e.y.location;c.indexOf("e")>=0?(i=m-h.left,d.width(n(i,l.minWidth,l.maxWidth))):c.indexOf("w")>=0&&(r=h.left+f.width,i=n(r-m,l.minWidth,l.maxWidth),d.css({left:r-i-p.left,width:i})),c.indexOf("s")>=0?(t=u-h.top-s.elementPadding,d.height(n(t,l.minHeight,l.maxHeight))):c.indexOf("n")>=0&&(o=h.top+f.height,t=n(o-u,l.minHeight,l.maxHeight),d.css({top:o-t-p.top,height:t})),a.trigger(F)},dragend:function(i){var t=this,n=t.owner,o=n.wrapper;return o.find(T).remove().end().find(_).not(i.currentTarget).show(),e(v).css(S,""),n.touchScroller&&n.touchScroller.reset(),27==i.keyCode&&o.css(t.initialCursorPosition).css(t.initialSize),!1},destroy:function(){this._draggable.destroy()}},d.prototype={dragstart:function(i){var t=this.owner,n=t.element,o=n.find(".k-window-actions"),r=l.getOffset(t.appendTo);t.trigger(q),t.initialWindowPosition=l.getOffset(t.wrapper,"position"),t.startPosition={left:i.x.client-t.initialWindowPosition.left,top:i.y.client-t.initialWindowPosition.top},t.minLeftPosition=o.length>0?o.outerWidth()+parseInt(o.css("right"),10)-n.outerWidth():20-n.outerWidth(),t.minLeftPosition-=r.left,t.minTopPosition=-r.top,t.wrapper.append(J.overlay).find(_).hide(),e(v).css(S,i.currentTarget.css(S))},drag:function(i){var t=this.owner,n={left:Math.max(i.x.client-t.startPosition.left,t.minLeftPosition),top:Math.max(i.y.client-t.startPosition.top,t.minTopPosition)};e(t.wrapper).css(n)},_finishDrag:function(){var i=this.owner;i.wrapper.find(_).toggle(!i.options.isMinimized).end().find(T).remove(),e(v).css(S,"")},dragcancel:function(e){this._finishDrag(),e.currentTarget.closest(y).css(this.owner.initialWindowPosition)},dragend:function(){return this._finishDrag(),this.owner.trigger(j),!1},destroy:function(){this._draggable.destroy()}},l.ui.plugin(Q)})(window.kendo.jQuery)});