/*
* Kendo UI Complete v2013.1.319 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
("function"==typeof define&&define.amd?define:function(e,t){return t()})(["./kendo.data.min","./kendo.editable.min","./kendo.window.min","./kendo.filtermenu.min","./kendo.columnmenu.min","./kendo.groupable.min","./kendo.pager.min","./kendo.selectable.min","./kendo.sortable.min","./kendo.reorderable.min","./kendo.resizable.min"],function(){(function(e,t){function r(e){return Array(e+1).join('<td class="k-group-cell">&nbsp;</td>')}function a(e){var t,r=" ";if(e){if(typeof e===gt)return e;for(t in e)r+=t+'="'+e[t]+'"'}return r}function o(t){var r=0;return e("> .k-grouping-header, > .k-grid-toolbar",t).each(function(){r+=this.offsetHeight}),r}function l(t,r){e("th, th .k-grid-filter, th .k-link",t).add(document.body).css("cursor",r)}function n(e){var t,r,a={},o={};if(!L(e))for(I(e)||(e=[e]),t=0,r=e.length;r>t;t++)a[e[t].aggregate]=0,o[e[t].field]=a;return o}function i(e,t,r){var a=e.eq(t),o=e.eq(r);a[t>r?"insertBefore":"insertAfter"](o)}function s(e,t,r){var a,o,l,n;for(r=I(r)?r:[r],a=0,o=r.length;o>a;a++)l=r[a],H(l)&&l.click&&(n=l.name||l.text,t.on(pt+K,"a.k-grid-"+(n||"").replace(/\s/g,""),{commandName:n},W(l.click,e)))}function d(e){return D(e,function(e){return!e.hidden})}function c(e){e=e||{};var t=e.style;return t?(t=t.replace(/((.*)?display)(.*)?:([^;]*)/i,"$1:none"),t===e.style&&(t=t.replace(/(.*)?/i,"display:none;$1"))):t="display:none",R({},e,{style:t})}function p(e){e=e||{};var t=e.style;return t&&(e.style=t.replace(/(display\s*:\s*none\s*;?)*/gi,"")),e}function u(t,r,a,o){var l,n=t.find(">colgroup"),i=v.support.browser,s=A(r,function(e){return l=e.width,l&&0!==parseInt(l,10)?v.format('<col style="width:{0}"/>',typeof l===gt?l:l+"px"):"<col />"});(a||n.find(".k-hierarchy-col").length)&&s.splice(0,0,'<col class="k-hierarchy-col" />'),n.length&&n.remove(),n=e("<colgroup/>").append(e(Array(o+1).join('<col class="k-group-col">')+s.join(""))),t.prepend(n),i.msie&&8==i.version&&(t.css("display","inline-table"),window.setTimeout(function(){t.css("display","")},1))}function f(e){var t,r,a,o={};for(r=0,a=e.length;a>r;r++)t=e[r],o[t.value]=t.text;return o}function h(e,t,r){var a=r&&r.length&&H(r[0])&&"value"in r[0],o=a?f(r)[e]:e;return o=null!=o?o:"",t?v.format(t,o):o}function g(e,t,r){for(var a,o=0,l=e[o];l;){if(a=r?!0:"none"!==l.style.display,a&&!wt.test(l.className)&&0>--t){l.style.display=r?"":"none";break}l=e[++o]}}function m(e,t){var r,a,o;if(typeof e===gt&&e===t)return e;if(H(e)&&e.name===t)return e;if(I(e))for(r=0,a=e.length;a>r;r++)if(o=e[r],typeof o===gt&&o===t||o.name===t)return o;return null}function b(t,r){var a,o,l,n=v.support.browser.msie;if(r===!0){if(t=e(t),l=n&&t.parent().is(".k-grid-content,.k-grid-header-wrap"),l&&(a=t.parent().scrollTop(),o=t.parent().scrollLeft()),n)try{t[0].setActive()}catch(i){t[0].focus()}else t[0].focus();l&&(t.parent().scrollTop(a),t.parent().scrollLeft(o))}else e(t).one("focusin",function(e){e.preventDefault()}).focus()}function k(t){var r=e(t.currentTarget),a=r.is("th"),o=r.closest("table")[0];(o===this.table[0]||o===this.thead.parent()[0])&&(this.current(r),(a||!e(t.target).is(":button,a,:input,a>.k-icon,textarea,span.k-icon,.k-input"))&&setTimeout(function(){b(o,!0)}),a&&t.preventDefault())}var v=window.kendo,_=v.ui,w=v.data.DataSource,y=_.Groupable,C=v.support.tbodyInnerHtml,x=v._activeElement,T=_.Widget,S=v.keys,H=e.isPlainObject,R=e.extend,A=e.map,D=e.grep,I=e.isArray,E=e.inArray,W=e.proxy,M=e.isFunction,L=e.isEmptyObject,N=Math,q="progress",B="error",z=":not(.k-group-cell):not(.k-hierarchy-cell):visible",F="tbody>tr:not(.k-grouping-row):not(.k-detail-row):not(.k-group-footer) > td:not(.k-group-cell):not(.k-hierarchy-cell)",P="tr:not(.k-footer-template):visible",O=":not(.k-group-cell):not(.k-hierarchy-cell):visible",G=P+":first>"+O+":first",j="th.k-header:not(.k-group-cell,.k-hierarchy-cell)",U=j+":visible["+v.attr("field")+"]",$=j+"["+v.attr("field")+"]",K=".kendoGrid",J="edit",V="save",X="remove",Q="detailInit",Y="filterMenuInit",Z="columnMenuInit",et="change",tt="columnHide",rt="columnShow",at="saveChanges",ot="dataBound",lt="detailExpand",nt="detailCollapse",it="k-state-focused",st="k-state-selected",dt="columnResize",ct="columnReorder",pt="click",ut="height",ft="tabIndex",ht="function",gt="string",mt="Are you sure you want to delete this record?",bt=/(\}|\#)/gi,kt=3,vt=/#/gi,_t="[\\x20\\t\\r\\n\\f]",wt=RegExp("(^|"+_t+")"+"(k-group-cell|k-hierarchy-cell)"+"("+_t+"|$)"),yt='<a class="k-button k-button-icontext #=className#" #=attr# href="\\#"><span class="#=iconClass# #=imageClass#"></span>#=text#</a>',Ct=!1,xt=T.extend({init:function(e,t){var r=this;T.fn.init.call(r,e,t),r._refreshHandler=W(r.refresh,r),r.setDataSource(t.dataSource),r.wrap()},setDataSource:function(e){var t=this;t.dataSource&&t.dataSource.unbind(et,t._refreshHandler),t.dataSource=e,t.dataSource.bind(et,t._refreshHandler)},options:{name:"VirtualScrollable",itemHeight:e.noop},destroy:function(){var e=this;T.fn.destroy.call(e),e.dataSource.unbind(et,e._refreshHandler),e.wrapper.add(e.verticalScrollbar).off(K),e.drag&&e.drag.destroy()},wrap:function(){var t,r=this,a=v.support.scrollbar()+1,o=r.element;o.css({width:"auto",overflow:"hidden"}).css(Ct?"padding-left":"padding-right",a),r.content=o.children().first(),t=r.wrapper=r.content.wrap('<div class="k-virtual-scrollable-wrap"/>').parent().bind("DOMMouseScroll"+K+" mousewheel"+K,W(r._wheelScroll,r)),v.support.kineticScrollNeeded&&(r.drag=new v.UserEvents(r.wrapper,{global:!0,move:function(e){r.verticalScrollbar.scrollTop(r.verticalScrollbar.scrollTop()-e.y.delta),t.scrollLeft(t.scrollLeft()-e.x.delta),e.preventDefault()}})),r.verticalScrollbar=e('<div class="k-scrollbar k-scrollbar-vertical" />').css({width:a}).appendTo(o).bind("scroll"+K,W(r._scroll,r))},_wheelScroll:function(e){var r,a=this,o=a.verticalScrollbar.scrollTop(),l=e.originalEvent,n=l.wheelDeltaY;l.wheelDelta?(n===t||n)&&(r=l.wheelDelta):l.detail&&l.axis===l.VERTICAL_AXIS&&(r=10*-l.detail),r&&(e.preventDefault(),a.verticalScrollbar.scrollTop(o+-r))},_scroll:function(e){var t=this,r=e.currentTarget.scrollTop,a=t.dataSource,o=t.itemHeight,l=a.skip()||0,n=t._rangeStart||l,i=t.element.innerHeight(),s=!!(t._scrollbarTop&&t._scrollbarTop>r),d=N.max(N.floor(r/o),0),c=N.max(d+N.floor(i/o),0);t._scrollTop=r-n*o,t._scrollbarTop=r,t._fetch(d,c,s)||(t.wrapper[0].scrollTop=t._scrollTop)},_fetch:function(e,t,r){var a=this,o=a.dataSource,l=a.itemHeight,n=o.take(),i=a._rangeStart||o.skip()||0,s=N.floor(e/n)*n,d=!1,c=.33;return i>e?(d=!0,i=N.max(0,t-n),a._scrollTop=(e-i)*l,a._page(i,n)):t>=i+n&&!r?(d=!0,i=e,a._scrollTop=l,a._page(i,n)):a._fetching||(s+n-n*c>e&&e>n&&o.prefetch(s-n,n),t>s+n*c&&o.prefetch(s+n,n)),d},_page:function(e,t){var r=this,a=r.dataSource;clearTimeout(r._timeout),r._fetching=!0,r._rangeStart=e,a.inRange(e,t)?a.range(e,t):(v.ui.progress(r.wrapper.parent(),!0),r._timeout=setTimeout(function(){a.range(e,t)},100))},refresh:function(){var e,t,r,a,o=this,l="",n=25e4,i=o.dataSource,s=o._rangeStart,d=v.support.kineticScrollNeeded?0:v.support.scrollbar(),c=o.wrapper[0];for(v.ui.progress(o.wrapper.parent(),!1),clearTimeout(o._timeout),r=o.itemHeight=o.options.itemHeight()||0,a=c.scrollWidth>c.offsetWidth?d:0,e=i.total()*r+a,t=0;N.floor(e/n)>t;t++)l+='<div style="width:1px;height:'+n+'px"></div>';e%n&&(l+='<div style="width:1px;height:'+e%n+'px"></div>'),o.verticalScrollbar.html(l),c.scrollTop=o._scrollTop,o.drag&&o.drag.cancel(),s&&!o._fetching&&(o._rangeStart=i.skip()),o._fetching=!1}}),Tt={create:{text:"Add new record",imageClass:"k-add",className:"k-grid-add",iconClass:"k-icon"},cancel:{text:"Cancel changes",imageClass:"k-cancel",className:"k-grid-cancel-changes",iconClass:"k-icon"},save:{text:"Save changes",imageClass:"k-update",className:"k-grid-save-changes",iconClass:"k-icon"},destroy:{text:"Delete",imageClass:"k-delete",className:"k-grid-delete",iconClass:"k-icon"},edit:{text:"Edit",imageClass:"k-edit",className:"k-grid-edit",iconClass:"k-icon"},update:{text:"Update",imageClass:"k-update",className:"k-grid-update",iconClass:"k-icon"},canceledit:{text:"Cancel",imageClass:"k-cancel",className:"k-grid-cancel",iconClass:"k-icon"}},St=T.extend({init:function(e,t){var r=this;t=I(t)?{dataSource:t}:t,T.fn.init.call(r,e,t),Ct=v.support.isRtl(e),r._element(),r._aria(),r._columns(r.options.columns),r._dataSource(),r._tbody(),r._pageable(),r._thead(),r._groupable(),r._toolbar(),r._setContentHeight(),r._templates(),r._navigatable(),r._selectable(),r._details(),r._editable(),r._attachCustomCommandsEvent(),r.options.autoBind?r.dataSource.fetch():r._footer(),v.notify(r)},events:[et,"dataBinding","cancel",ot,lt,nt,Q,Y,Z,J,V,X,at,dt,ct,rt,tt],setDataSource:function(e){var t=this;t.options.dataSource=e,t._dataSource(),t._pageable(),t.options.groupable&&t._groupable(),t._thead(),t.virtualScrollable&&t.virtualScrollable.setDataSource(t.options.dataSource),t.options.autoBind&&e.fetch()},options:{name:"Grid",columns:[],toolbar:null,autoBind:!0,filterable:!1,scrollable:!0,sortable:!1,selectable:!1,navigatable:!1,pageable:!1,editable:!1,groupable:!1,rowTemplate:"",altRowTemplate:"",dataSource:{},height:null,resizable:!1,reorderable:!1,columnMenu:!1,detailTemplate:null},destroy:function(){var e,t=this;T.fn.destroy.call(t),t.pager&&t.pager.destroy(),t.groupable&&t.groupable.destroy(),t.virtualScrollable&&t.virtualScrollable.destroy(),t._destroyColumnAttachments(),t._destroyEditable(),t.dataSource.unbind(et,t._refreshHandler).unbind(q,t._progressHandler).unbind(B,t._errorHandler),e=t.element.add(t.wrapper).add(t.table).add(t.thead).add(t.wrapper.find(">.k-grid-toolbar")),t.content&&(e=e.add(t.content).add(t.content.find(">.k-virtual-scrollable-wrap"))),e.off(K),v.destroy(t.wrapper)},setOptions:function(e){var t=this;T.fn.setOptions.call(this,e),t._templates()},items:function(){return this.tbody.children(":not(.k-grouping-row,.k-detail-row,.k-group-footer)")},_destroyColumnAttachments:function(){var t=this;t.thead.find("th").each(function(){var t=e(this),r=t.data("kendoFilterMenu"),a=t.data("kendoSortable"),o=t.data("kendoColumnMenu");r&&r.destroy(),a&&a.destroy(),o&&o.destroy()})},_attachCustomCommandsEvent:function(){var e,t,r,a=this,o=a.columns||[];for(t=0,r=o.length;r>t;t++)e=o[t].command,e&&s(a,a.wrapper,e)},_aria:function(){var e=this.element.attr("id")||"aria";e&&(this._cellId=e+"_active_cell")},_element:function(){var t=this,r=t.element;r.is("table")||(r=t.options.scrollable?t.element.find("> .k-grid-content > table"):t.element.children("table"),r.length||(r=e("<table />").appendTo(t.element))),t.table=r.attr("cellspacing",0).attr("role",t._hasDetails()?"treegrid":"grid"),t._wrapper()},_positionColumnResizeHandle:function(t){var r,a=this,n=a.options.scrollable,i=a.resizeHandle;a.thead.on("mousemove"+K,"th:not(.k-group-cell,.k-hierarchy-cell)",function(s){var d,c,p,u,f=e(this),h=s.clientX,g=e(window).scrollLeft(),m=f.offset().left+(Ct?0:this.offsetWidth);h+g>m-kt&&m+kt>h+g?(i||(i=a.resizeHandle=e('<div class="k-resize-handle"/>'),t.append(i)),Ct?(d=f.closest(".k-grid-header-wrap"),c=v.support.browser.msie?d.scrollLeft():0,p=v.support.browser.webkit?d[0].scrollWidth-d[0].offsetWidth-d.scrollLeft():0,u=v.support.browser.mozilla?d[0].scrollWidth-d[0].offsetWidth-(d[0].scrollWidth-d[0].offsetWidth-d.scrollLeft()):0,r=f.position().left-p+u-c):(r=this.offsetWidth,f.prevAll(":visible").each(function(){r+=this.offsetWidth})),i.css({top:n?0:o(a.wrapper),left:r-kt,height:f.outerHeight(),width:3*kt}).data("th",f).show()):i?i.hide():l(a.wrapper,"")})},_resizable:function(){var t,r,a,o,n,i=this,s=i.options;s.resizable&&(t=s.scrollable?i.wrapper.find(".k-grid-header-wrap:first"):i.wrapper,i._positionColumnResizeHandle(t),t.kendoResizable({handle:".k-resize-handle",hint:function(t){return e('<div class="k-grid-resize-indicator" />').css({height:t.data("th").outerHeight()+i.tbody.attr("clientHeight")})},start:function(t){var d=e(t.currentTarget).data("th"),c=e.inArray(d[0],d.parent().children(":visible")),p=i.tbody.parent(),u=i.footer||e();l(i.wrapper,"col-resize"),n=s.scrollable?i.thead.parent().find("col:eq("+c+")").add(p.children("colgroup").find("col:eq("+c+")")).add(u.find("colgroup").find("col:eq("+c+")")):p.children("colgroup").find("col:eq("+c+")"),r=t.x.location,a=d.outerWidth(),o=i.tbody.outerWidth()},resize:function(t){var l=Ct?-1:1,d=a+t.x.location*l-r*l,c=i.footer||e();d>10&&(n.css("width",d),s.scrollable&&(i._footerWidth=o+t.x.location*l-r*l,i.tbody.parent().add(i.thead.parent()).add(c.find("table")).css("width",i._footerWidth)))},resizeend:function(t){var r,o=e(t.currentTarget).data("th"),n=o.outerWidth();l(i.wrapper,""),a!=n&&(r=i.columns[o.parent().find("th:not(.k-group-cell,.k-hierarchy-cell)").index(o)],r.width=n,i.trigger(dt,{column:r,oldWidth:a,newWidth:n})),i.resizeHandle.hide()}}))},_draggable:function(){var t=this;t.options.reorderable&&(t._draggableInstance&&t._draggableInstance.destroy(),t._draggableInstance=t.wrapper.kendoDraggable({group:v.guid(),filter:t.content?">.k-grid-header "+j:">table>.k-grid-header "+j,hint:function(t){return e('<div class="k-header k-drag-clue" />').css({width:t.width(),paddingLeft:t.css("paddingLeft"),paddingRight:t.css("paddingRight"),lineHeight:t.height()+"px",paddingTop:t.css("paddingTop"),paddingBottom:t.css("paddingBottom")}).html(t.attr(v.attr("title"))||t.attr(v.attr("field"))||t.text()).prepend('<span class="k-icon k-drag-status k-denied" />')}}).data("kendoDraggable"))},_reorderable:function(){var e=this;e.options.reorderable&&e.wrapper.kendoReorderable({draggable:e._draggableInstance,change:function(t){var r=E(e.columns[t.newIndex],e.columns),a=e.columns[t.oldIndex];e.trigger(ct,{newIndex:r,oldIndex:E(a,e.columns),column:a}),e.reorderColumn(r,a)}})},reorderColumn:function(e,t){var r,a,o,l=this,n=E(t,l.columns),s=E(t,d(l.columns)),c=E(l.columns[e],d(l.columns)),p=l.footer||l.wrapper.find(".k-grid-footer");if(n!==e)for(l.columns.splice(n,1),l.columns.splice(e,0,t),l._templates(),i(l.thead.prev().find("col:not(.k-group-col,.k-hierarchy-col)"),s,c),l.options.scrollable&&i(l.tbody.prev().find("col:not(.k-group-col,.k-hierarchy-col)"),s,c),i(l.thead.find(".k-header:not(.k-group-cell,.k-hierarchy-cell)"),n,e),p&&p.length&&(i(p.find(".k-grid-footer-wrap>table>colgroup>col:not(.k-group-col,.k-hierarchy-col)"),s,c),i(p.find(".k-footer-template>td:not(.k-group-cell,.k-hierarchy-cell)"),n,e)),r=l.tbody.children(":not(.k-grouping-row,.k-detail-row)"),a=0,o=r.length;o>a;a+=1)i(r.eq(a).find(">td:not(.k-group-cell,.k-hierarchy-cell)"),n,e)},cellIndex:function(t){return e(t).parent().children("td:not(.k-group-cell,.k-hierarchy-cell)").index(t)},_modelForContainer:function(t){t=e(t),t.is("tr")||"popup"===this._editMode()||(t=t.closest("tr"));var r=t.attr(v.attr("uid"));return this.dataSource.getByUid(r)},_editable:function(){var t,r=this,a=r.selectable&&r.selectable.options.multiple,o=r.options.editable,l=function(){var t=x(),a=r._editContainer;!a||e.contains(a[0],t)||a[0]===t||e(t).closest(".k-animation-container").length||r.editable.end()&&r.closeCell()};o&&(t=r._editMode(),"incell"===t?o.update!==!1&&r.wrapper.on(pt+K,"tr:not(.k-grouping-row) > td",function(t){var o=e(this);o.hasClass("k-hierarchy-cell")||o.hasClass("k-detail-cell")||o.hasClass("k-group-cell")||o.hasClass("k-edit-cell")||o.has("a.k-grid-delete").length||o.has("button.k-grid-delete").length||o.closest("tbody")[0]!==r.tbody[0]||e(t.target).is(":input")||(r.editable?r.editable.end()&&(a&&e(x()).blur(),r.closeCell(),r.editCell(o)):r.editCell(o))}).on("focusin"+K,function(){clearTimeout(r.timer),r.timer=null}).on("focusout"+K,function(){r.timer=setTimeout(l,1)}):o.update!==!1&&r.wrapper.on(pt+K,"tbody>tr:not(.k-detail-row,.k-grouping-row):visible a.k-grid-edit",function(t){t.preventDefault(),r.editRow(e(this).closest("tr"))}),o.destroy!==!1?r.wrapper.on(pt+K,"tbody>tr:not(.k-detail-row,.k-grouping-row):visible .k-grid-delete",function(t){t.preventDefault(),t.stopPropagation(),r.removeRow(e(this).closest("tr"))}):r.wrapper.on(pt+K,"tbody>tr:not(.k-detail-row,.k-grouping-row):visible button.k-grid-delete",function(e){r._confirmation()||e.preventDefault()}))},editCell:function(e){var t=this,r=t.columns[t.cellIndex(e)],a=t._modelForContainer(e);!a||a.editable&&!a.editable(r.field)||r.command||!r.field||(t._attachModelChange(a),t._editContainer=e,t.editable=e.addClass("k-edit-cell").kendoEditable({fields:{field:r.field,format:r.format,editor:r.editor,values:r.values},model:a,change:function(r){t.trigger(V,{values:r.values,container:e,model:a})&&r.preventDefault()}}).data("kendoEditable"),e.parent().addClass("k-grid-edit-row"),t.trigger(J,{container:e,model:a}))},_destroyEditable:function(){var e=this,t=function(){e.editable&&(e._detachModelChange(),e.editable.destroy(),e.editable=null,e._editContainer=null)};e.editable&&("popup"===e._editMode()?e._editContainer.data("kendoWindow").bind("deactivate",t).close():t())},_attachModelChange:function(e){var t=this;t._modelChangeHandler=function(e){t._modelChange({field:e.field,model:this})},e.bind("change",t._modelChangeHandler)},_detachModelChange:function(){var e=this,t=e._editContainer,r=e._modelForContainer(t);r&&r.unbind(et,e._modelChangeHandler)},closeCell:function(){var t,r,a,o,l=this;l._editContainer&&(t=l._editContainer.removeClass("k-edit-cell"),r=t.closest("tr").attr(v.attr("uid")),a=l.columns[l.cellIndex(t)],o=l.dataSource.getByUid(r),t.parent().removeClass("k-grid-edit-row"),l._destroyEditable(),l._displayCell(t,a,o),t.hasClass("k-dirty-cell")&&e('<span class="k-dirty"/>').prependTo(t))},_displayCell:function(e,t,r){var a=this,o={storage:{},count:0},l=R({},v.Template,a.options.templateSettings),n=v.template(a._cellTmpl(t,o),l);o.count>0&&(n=W(n,o.storage)),e.empty().html(n(r))},removeRow:function(t){var r,a,o=this;o._confirmation()&&(t=e(t).hide(),r=o._modelForContainer(t),r&&!o.trigger(X,{row:t,model:r})&&(a=o._editMode(),"incell"!==a&&o.cancelRow(),o.dataSource.remove(r),("inline"===a||"popup"===a)&&o.dataSource.sync()))},_editMode:function(){var e="incell",t=this.options.editable;return t!==!0&&(e="string"==typeof t?t:t.mode||e),e},editRow:function(r){var a,o=this,l=o._modelForContainer(r),n=o._editMode(),i=o.options.navigatable;o.cancelRow(),l&&(o._attachModelChange(l),"popup"===n?o._createPopupEditor(l):"inline"===n?o._createInlineEditor(r,l):"incell"===n&&e(r).children(z).each(function(){var r=e(this),a=o.columns[r.index()];return l=o._modelForContainer(r),l&&(!l.editable||l.editable(a.field))&&a.field?(o.editCell(r),!1):t}),a=o._editContainer,a.on(pt+K,"a.k-grid-cancel",function(t){if(t.preventDefault(),t.stopPropagation(),!o.trigger("cancel",{container:a,model:l})){var r=o.items().index(e(o.current()).parent());o.cancelRow(),i&&(o.current(o.items().eq(r).children().filter(O).first()),b(o.table,!0))}}),a.on(pt+K,"a.k-grid-update",function(e){e.preventDefault(),e.stopPropagation(),o.saveRow()}))},_createPopupEditor:function(r){var a,o,l,n,i,s,d,c,p,u,f,h=this,g="<div "+v.attr("uid")+'="'+r.uid+'"><div class="k-edit-form-container">',k=[],_=h.options.editable,w=_.template,y=H(_)?_.window:{},C=R({},v.Template,h.options.templateSettings);if(w)for(typeof w===gt&&(w=window.unescape(w)),g+=v.template(w,C)(r),l=0,n=h.columns.length;n>l;l++)a=h.columns[l],a.command&&(c=m(a.command,"edit"),c&&(o=c));else for(l=0,n=h.columns.length;n>l;l++)a=h.columns[l],a.command?a.command&&(c=m(a.command,"edit"),c&&(o=c)):(g+='<div class="k-edit-label"><label for="'+a.field+'">'+(a.title||a.field||"")+"</label></div>",r.editable&&!r.editable(a.field)||!a.field?(u={storage:{},count:0},i=v.template(h._cellTmpl(a,u),C),u.count>0&&(i=W(i,u.storage)),g+='<div class="k-edit-field">'+i(r)+"</div>"):(k.push({field:a.field,format:a.format,editor:a.editor,values:a.values}),g+="<div "+v.attr("container-for")+'="'+a.field+'" class="k-edit-field"></div>'));o&&H(o)&&(o.text&&H(o.text)&&(s=o.text.update,d=o.text.cancel),o.attr&&(p=o.attr)),g+=h._createButton({name:"update",text:s,attr:p})+h._createButton({name:"canceledit",text:d,attr:p}),g+="</div></div>",f=h._editContainer=e(g).appendTo(h.wrapper).eq(0).kendoWindow(R({modal:!0,resizable:!1,draggable:!0,title:"Edit",visible:!1,close:function(a){if(a.userTriggered){if(h.trigger("cancel",{container:f,model:r}))return a.preventDefault(),t;var o=h.items().index(e(h.current()).parent());h.cancelRow(),h.options.navigatable&&(h.current(h.items().eq(o).children().filter(O).first()),b(h.table,!0))}}},y)),h.editable=h._editContainer.kendoEditable({fields:k,model:r,clearContainer:!1}).data("kendoEditable"),f.data("kendoWindow").center().open(),h.trigger(J,{container:f,model:r})},_createInlineEditor:function(t,r){var a,o,l,n=this,i=[];t.children(":not(.k-group-cell,.k-hierarchy-cell)").each(function(){if(o=e(this),a=n.columns[n.cellIndex(o)],a.command||!a.field||r.editable&&!r.editable(a.field)){if(a.command&&(l=m(a.command,"edit"))){o.empty();var t,s,d;H(l)&&(l.text&&H(l.text)&&(t=l.text.update,s=l.text.cancel),l.attr&&(d=l.attr)),e(n._createButton({name:"update",text:t,attr:d})+n._createButton({name:"canceledit",text:s,attr:d})).appendTo(o)}}else i.push({field:a.field,format:a.format,editor:a.editor,values:a.values}),o.attr(v.attr("container-for"),a.field),o.empty()}),n._editContainer=t,n.editable=t.addClass("k-grid-edit-row").kendoEditable({fields:i,model:r,clearContainer:!1}).data("kendoEditable"),n.trigger(J,{container:t,model:r})},cancelRow:function(){var e,t=this,r=t._editContainer;r&&(e=t._modelForContainer(r),t.dataSource.cancelChanges(e),"popup"!==t._editMode()?t._displayRow(r):t._displayRow(t.items().filter("["+v.attr("uid")+"="+e.uid+"]")),t._destroyEditable())},saveRow:function(){var e=this,t=e._editContainer,r=e._modelForContainer(t),a=e.editable;t&&a&&a.end()&&!e.trigger(V,{container:t,model:r})&&e.dataSource.sync()},_displayRow:function(t){var r=this,a=r._modelForContainer(t);a&&t.replaceWith(e((t.hasClass("k-alt")?r.altRowTemplate:r.rowTemplate)(a)))},_showMessage:function(e){return window.confirm(e)},_confirmation:function(){var e=this,t=e.options.editable,r=t===!0||typeof t===gt?mt:t.confirmation;return r!==!1&&null!=r?e._showMessage(r):!0},cancelChanges:function(){this.dataSource.cancelChanges()},saveChanges:function(){var e=this;(e.editable&&e.editable.end()||!e.editable)&&!e.trigger(at)&&e.dataSource.sync()},addRow:function(){var e,t,r,a,o,l=this,n=l.dataSource,i=l._editMode(),s=l.options.editable.createAt||"",d=n.pageSize(),c=n.view()||[];(l.editable&&l.editable.end()||!l.editable)&&("incell"!=i&&l.cancelRow(),e=n.indexOf(c[0]),"bottom"==s.toLowerCase()&&(e+=c.length,d&&!n.options.serverPaging&&c.length>=d&&(e-=1)),0>e&&(e=n.page()>n.totalPages()?(n.page()-1)*d:0),t=n.insert(e,{}),r=t.uid,a=l.table.find("tr["+v.attr("uid")+"="+r+"]"),o=a.children("td:not(.k-group-cell,.k-hierarchy-cell)").eq(l._firstEditableColumnIndex(a)),"inline"!==i&&"popup"!==i||!a.length?o.length&&l.editCell(o):l.editRow(a))},_firstEditableColumnIndex:function(e){var t,r,a,o=this,l=o.columns,n=o._modelForContainer(e);for(r=0,a=l.length;a>r;r++)if(t=l[r],n&&(!n.editable||n.editable(t.field))&&!t.command&&t.field)return r;return-1},_toolbar:function(){var t,r=this,a=r.wrapper,o=r.options.toolbar,l=r.options.editable;o&&(t=r.wrapper.find(".k-grid-toolbar"),t.length||(M(o)||(o=typeof o===gt?o:r._toolbarTmpl(o).replace(vt,"\\#"),o=W(v.template(o),r)),t=e('<div class="k-toolbar k-grid-toolbar" />').html(o({})).prependTo(a)),l&&l.create!==!1&&t.on(pt+K,".k-grid-add",function(e){e.preventDefault(),r.addRow()}).on(pt+K,".k-grid-cancel-changes",function(e){e.preventDefault(),r.cancelChanges()}).on(pt+K,".k-grid-save-changes",function(e){e.preventDefault(),r.saveChanges()}))},_toolbarTmpl:function(e){var t,r,a=this,o="";if(I(e))for(t=0,r=e.length;r>t;t++)o+=a._createButton(e[t]);return o},_createButton:function(e){var t=e.template||yt,r=typeof e===gt?e:e.name||e.text,o={className:"k-grid-"+(r||"").replace(/\s/g,""),text:r,imageClass:"",attr:"",iconClass:""};if(!(r||H(e)&&e.template))throw Error("Custom commands should have name specified");return H(e)?(e.className&&(e.className+=" "+o.className),"edit"===r&&H(e.text)&&(e=R(!0,{},e),e.text=e.text.edit),e.attr&&H(e.attr)&&(e.attr=a(e.attr)),o=R(!0,o,Tt[r],e)):o=R(!0,o,Tt[r]),v.template(t)(o)},_groupable:function(){var t=this;t.table.on(pt+K,".k-grouping-row .k-i-collapse, .k-grouping-row .k-i-expand",function(r){var a=e(this),o=a.closest("tr");a.hasClass("k-i-collapse")?t.collapseGroup(o):t.expandGroup(o),r.preventDefault(),r.stopPropagation()}),t._attachGroupable()},_attachGroupable:function(){var t=this,r=t.wrapper,a=t.options.groupable;a&&(r.has("div.k-grouping-header")[0]||e("<div>&nbsp;</div>").addClass("k-grouping-header").prependTo(r),t.groupable&&t.groupable.destroy(),t.groupable=new y(r,R({},a,{draggable:t._draggableInstance,groupContainer:">div.k-grouping-header",dataSource:t.dataSource,draggableElements:t.content?">.k-grid-header "+U:">table>.k-grid-header "+U,filter:t.content?">.k-grid-header "+$:">table>.k-grid-header "+$,allowDrag:t.options.reorderable})))},_selectable:function(){var e,r,a=this,o=a.options.selectable;o&&(e=typeof o===gt&&o.toLowerCase().indexOf("multiple")>-1,r=typeof o===gt&&o.toLowerCase().indexOf("cell")>-1,a.selectable=new v.ui.Selectable(a.table,{filter:">"+(r?F:"tbody>tr:not(.k-grouping-row,.k-detail-row,.k-group-footer)"),aria:!0,multiple:e,change:function(){a.trigger(et)}}),a.options.navigatable&&a.table.on("keydown"+K,function(o){var l=a.current();if(o.keyCode===S.SPACEBAR&&o.target==a.table[0]&&!l.is(".k-edit-cell,.k-header")&&l.parent().is(":not(.k-grouping-row,.k-detail-row,.k-group-footer)")){if(o.preventDefault(),o.stopPropagation(),l=r?l:l.parent(),e)if(o.ctrlKey){if(l.hasClass(st))return l.removeClass(st),a.trigger(et),t}else a.selectable.clear();else a.selectable.clear();a.selectable.value(l)}}))},clearSelection:function(){var e=this;e.selectable.clear(),e.trigger(et)},select:function(r){var a=this,o=a.selectable;return r=e(r),r.length?(o.options.multiple||(o.clear(),r=r.first()),o.value(r),t):o.value()},current:function(r){var a=this,o=a.options.scrollable,l=a._current,n=a.table.add(a.thead.parent());return r!==t&&r.length&&(l&&l[0]===r[0]||(l&&(l.removeClass(it).removeAttr("id"),n.removeAttr("aria-activedescendant")),r.attr("id",a._cellId),a._current=r.addClass(it),n.attr("aria-activedescendant",a._cellId),r.length&&o&&(e.contains(a.content[0],r[0])&&a._scrollTo(r.parent()[0],a.content[0]),o.virtual?a._scrollTo(r[0],a.content.find(">.k-virtual-scrollable-wrap")[0]):a._scrollTo(r[0],a.content[0])))),a._current},_removeCurrent:function(){this._current&&(this._current.removeClass(it),this._current=null)},_scrollTo:function(e,t){var r=e.tagName.toLowerCase(),a="td"===r||"th"===r,o=e[a?"offsetLeft":"offsetTop"],l=e[a?"offsetWidth":"offsetHeight"],n=t[a?"scrollLeft":"scrollTop"],i=t[a?"clientWidth":"clientHeight"],s=o+l,d=0;d=n>o?o:s>n+i?i>=l?s-i:o:n,t[a?"scrollLeft":"scrollTop"]=d},_navigatable:function(){var t=this,r=W(t.current,t),a=t.table,o=t.thead.parent(),l=a,n=v.support.isRtl(t.element);t.options.navigatable&&(t.options.scrollable&&(l=a.add(o),o.attr(ft,-1)),o.on("keydown"+K,function(e){e.altKey&&e.keyCode==S.DOWN&&(r().find(".k-grid-filter, .k-header-column-menu").click(),e.stopImmediatePropagation())}).find("a.k-link").attr("tabIndex",-1),a.attr(ft,N.max(a.attr(ft)||0,0)).on("mousedown"+K+" keydown"+K,".k-detail-cell",function(e){e.target!==e.currentTarget&&e.stopImmediatePropagation()}),l.on(v.support.touch?"touchstart"+K:"mousedown"+K,P+">"+O,W(k,t)).on("focus"+K,function(){var t=r();t&&t.is(":visible")?t.addClass(it):r(e(this).find(G)),this==a[0]?(o.attr(ft,-1),a.attr(ft,0)):(a.attr(ft,-1),o.attr(ft,0))}).on("focusout"+K,function(){var e=r();e&&e.removeClass(it)}).on("keydown"+K,function(o){var l,i,s,d,c,p,u,f=o.keyCode,h=!1,g=!o.isDefaultPrevented()&&!e(o.target).is(":button,a,:input,a>.k-icon"),m=t.options.pageable,k=t.dataSource,_="incell"==t._editMode(),w=o.shiftKey,y=v.support.browser,C=r();C&&C.is("th")&&(g=!0),g&&f==S.UP?(C?(s=C.parent().prevAll(P).first(),s[0]||(c=t.thead.parent(),b(c,!0),s=c.find(P).first()),d=C.index(),C=s.children().eq(d),C[0]&&C.is(O)||(C=s.children(O).first())):C=a.find(G),h=!0,r(C)):g&&f==S.DOWN?(C?(s=C.parent().nextAll(P).first(),!s[0]&&C.is("th")&&(b(t.tbody.parent()),s=t.tbody.find(P).first()),d=C.index(),C=s.children().eq(d),C[0]&&C.is(O)||(C=s.children(O).first())):C=a.find(G),h=!0,r(C)):g&&f==(n?S.RIGHT:S.LEFT)?(r(C?C.prevAll(z+":first"):a.find(G)),h=!0):g&&f==(n?S.LEFT:S.RIGHT)?(C?C.next()[0]&&(C=C.nextAll(z+":first")):C=a.find(G),h=!0,r(C)):g&&m&&S.PAGEDOWN==f?(k.page(k.page()+1),h=!0):g&&m&&S.PAGEUP==f?(k.page(k.page()-1),h=!0):f==S.ENTER||S.F2==f?(C=C?C:a.find(G),C.is("th")?(C.find(".k-link").click(),h=!0):C.parent().is(".k-master-row,.k-grouping-row")?(C.parent().find(".k-icon:first").click(),h=!0):(p=C.find(":focusable:first"),!C.hasClass("k-edit-cell")&&p[0]&&C.hasClass("k-state-focused")?(p.focus(),h=!0):t.options.editable&&!e(o.target).is(":button,.k-button")&&(t._handleEditing(C),h=!0))):S.ESC==f?(l=x(),C&&e.contains(C[0],l)&&!C.hasClass("k-edit-cell")&&!C.parent().hasClass("k-grid-edit-row")?(b(t.table[0],!0),h=!0):!t._editContainer||C&&!t._editContainer.has(C[0])&&C[0]!==t._editContainer[0]||(_?t.closeCell():(i=t.items().index(e(C).parent()),l&&l.blur(),t.cancelRow(),i>=0&&t.current(t.items().eq(i).children().filter(O).first())),y.msie&&9>y.version&&document.body.focus(),b(a,!0),h=!0)):S.TAB==f&&(C=e(C),t.options.editable&&_&&(u=e(x()).closest(".k-edit-cell"),u[0]&&u[0]!==C[0]&&(C=u)),u=w?C.prevAll(z+":first"):C.nextAll(":visible:first"),u.length||(u=C.parent()[w?"prevAll":"nextAll"]("tr:not(.k-grouping-row):not(.k-detail-row):visible:first").children(z+(w?":last":":first"))),!C.is("th")&&u.length&&t.options.editable&&_&&(t._handleEditing(C,u),h=!0)),h&&(o.preventDefault(),o.stopPropagation())}))},_handleEditing:function(r,a){var o,l,n=this,i=e(x()),s=n._editMode(),d=n._editContainer;if(l="incell"==s?r.hasClass("k-edit-cell"):r.parent().hasClass("k-grid-edit-row"),n.editable){if(e.contains(d[0],i[0])&&(i.blur(),v.support.browser.opera&&i.change()),!n.editable)return b(n.table),t;if(!n.editable.end())return"incell"==s?n.current(d):n.current(d.children().filter(z).first()),o=d.find(":focusable:first")[0],o&&o.focus(),t;"incell"==s?n.closeCell():(n.saveRow(),l=!0)}a&&n.current(a),b(n.table,!0),(!l&&!a||a)&&("incell"==s?n.editCell(n.current()):n.editRow(n.current().parent()))},_wrapper:function(){var e=this,t=e.table,r=e.options.height,a=e.element;a.is("div")||(a=a.wrap("<div/>").parent()),e.wrapper=a.addClass("k-grid k-widget"),r&&(e.wrapper.css(ut,r),t.css(ut,"auto"))},_tbody:function(){var t,r=this,a=r.table;t=a.find(">tbody"),t.length||(t=e("<tbody/>").appendTo(a)),r.tbody=t},_scrollable:function(){var t,r,a,o,l,n=this,i=n.options,s=i.scrollable,d=s!==!0&&s.virtual&&!n.virtualScrollable,c=!v.support.kineticScrollNeeded||d?v.support.scrollbar():0;s&&(t=n.wrapper.children(".k-grid-header"),t[0]||(t=e('<div class="k-grid-header" />').insertBefore(n.table)),t.css(Ct?"padding-left":"padding-right",s.virtual?c+1:c),r=e('<table role="grid" cellspacing="0" />'),r.append(n.thead),t.empty().append(e('<div class="k-grid-header-wrap" />').append(r)),n.content=n.table.parent(),n.content.is(".k-virtual-scrollable-wrap")&&(n.content=n.content.parent()),n.content.is(".k-grid-content, .k-virtual-scrollable-wrap")||(n.content=n.table.wrap('<div class="k-grid-content" />').parent()),d&&(n.virtualScrollable=new xt(n.content,{dataSource:n.dataSource,itemHeight:W(n._averageRowHeight,n)})),n.scrollables=t.children(".k-grid-header-wrap"),a=n.wrapper.find(".k-grid-footer"),o=Ct&&v.support.browser.webkit?c:0,a.length&&(n.scrollables=n.scrollables.add(a.children(".k-grid-footer-wrap"))),s.virtual?n.content.find(">.k-virtual-scrollable-wrap").bind("scroll"+K,function(){n.scrollables.scrollLeft(this.scrollLeft+o)}):(n.content.bind("scroll"+K,function(){n.scrollables.scrollLeft(this.scrollLeft+o)}),l=v.touchScroller(n.content),l&&l.movable&&l.movable.bind("change",function(e){n.scrollables.scrollLeft(-e.sender.x)})))
},_setContentHeight:function(){var e,t=this,r=t.options,a=t.wrapper.innerHeight(),o=t.wrapper.children(".k-grid-header"),l=v.support.scrollbar();r.scrollable&&(a-=o.outerHeight(),t.pager&&(a-=t.pager.element.outerHeight()),r.groupable&&(a-=t.wrapper.children(".k-grouping-header").outerHeight()),r.toolbar&&(a-=t.wrapper.children(".k-grid-toolbar").outerHeight()),t.footerTemplate&&(a-=t.wrapper.children(".k-grid-footer").outerHeight()),e=function(e){var t,r;return e[0].style.height?!0:(t=e.height(),e.height("auto"),r=e.height(),t!=r?(e.height(""),!0):(e.height(""),!1))},e(t.wrapper)&&(a>2*l?t.content.height(a):t.content.height(2*l+1)))},_averageRowHeight:function(){var e,t=this,r=t._rowHeight;return t._rowHeight||(t._rowHeight=r=t.table.outerHeight()/t.items().length,t._sum=r,t._measures=1),e=t.table.outerHeight()/t.items().length,r!==e&&(t._measures++,t._sum+=e,t._rowHeight=t._sum/t._measures),r},_dataSource:function(){var e,r=this,a=r.options,o=a.dataSource;o=I(o)?{data:o}:o,H(o)&&(R(o,{table:r.table,fields:r.columns}),e=a.pageable,H(e)&&e.pageSize!==t&&(o.pageSize=e.pageSize)),r.dataSource&&r._refreshHandler?r.dataSource.unbind(et,r._refreshHandler).unbind(q,r._progressHandler).unbind(B,r._errorHandler):(r._refreshHandler=W(r.refresh,r),r._progressHandler=W(r._requestStart,r),r._errorHandler=W(r._error,r)),r.dataSource=w.create(o).bind(et,r._refreshHandler).bind(q,r._progressHandler).bind(B,r._errorHandler)},_error:function(){this._progress(!1)},_requestStart:function(){this._progress(!0)},_modelChange:function(t){var r,a,o,l,n=this,i=t.model,s=n.tbody.find("tr["+v.attr("uid")+"="+i.uid+"]"),d=s.hasClass("k-alt"),c=n.items().index(s);if(s.children(".k-edit-cell").length&&!n.options.rowTemplate)s.children(":not(.k-group-cell,.k-hierarchy-cell)").each(function(){r=e(this),a=n.columns[n.cellIndex(r)],a.field===t.field&&(r.hasClass("k-edit-cell")?r.addClass("k-dirty-cell"):(n._displayCell(r,a,i),e('<span class="k-dirty"/>').prependTo(r)))});else if(!s.hasClass("k-grid-edit-row")){for(o=(d?n.altRowTemplate:n.rowTemplate)(i),s.replaceWith(o),o=n.items().eq(c),c=0,l=n.columns.length;l>c;c++)a=n.columns[c],a.field===t.field&&(r=o.children(":not(.k-group-cell,.k-hierarchy-cell)").eq(c),e('<span class="k-dirty"/>').prependTo(r));n.trigger("itemChange",{item:o,data:i,ns:_})}},_pageable:function(){var t,r=this,a=r.options.pageable;a&&(t=r.wrapper.children("div.k-grid-pager"),t.length||(t=e('<div class="k-pager-wrap k-grid-pager"/>').appendTo(r.wrapper)),r.pager&&r.pager.destroy(),r.pager="object"==typeof a&&a instanceof v.ui.Pager?a:new v.ui.Pager(t,R({},a,{dataSource:r.dataSource})))},_footer:function(){var t,r,a=this,o=a.dataSource.aggregates(),l="",i=a.footerTemplate,s=a.options,d=a.footer||a.wrapper.find(".k-grid-footer");i?(o=L(o)?n(a.dataSource.aggregate()):o,l=e(a._wrapFooter(i(o))),d.length?(r=l,d.replaceWith(r),d=a.footer=r):d=a.footer=s.scrollable?s.pageable?l.insertBefore(a.wrapper.children("div.k-grid-pager")):l.appendTo(a.wrapper):l.insertBefore(a.tbody)):d&&!a.footer&&(a.footer=d),d.length&&(s.scrollable&&(t=d.attr("tabindex",-1).children(".k-grid-footer-wrap"),a.scrollables=a.scrollables.not(".k-grid-footer-wrap").add(t)),a._footerWidth&&d.find("table").css("width",a._footerWidth),t&&t.scrollLeft(a.content.scrollLeft()))},_wrapFooter:function(t){var r=this,a="",o=v.support.mobileOS?0:v.support.scrollbar();return r.options.scrollable?(a=e('<div class="k-grid-footer"><div class="k-grid-footer-wrap"><table cellspacing="0"><tbody>'+t+"</tbody></table></div></div>"),r._appendCols(a.find("table")),a.css(Ct?"padding-left":"padding-right",o),a):'<tfoot class="k-grid-footer">'+t+"</tfoot>"},_columnMenu:function(){var t,r,a,o,l,n,i=this,s=i.columns,d=i.options,c=d.columnMenu,p=function(){b(i.thead.parent(),!0)},u=function(e){i.trigger(Z,{field:e.field,container:e.container})};c&&("boolean"==typeof c&&(c={}),i.thead.find("th:not(.k-hierarchy-cell,.k-group-cell)").each(function(f){r=s[f],n=e(this),r.command||!r.field&&!n.attr("data-"+v.ns+"field")||(t=n.data("kendoColumnMenu"),t&&t.destroy(),o=r.sortable!==!1&&c.sortable!==!1?d.sortable:!1,l=d.filterable&&r.filterable!==!1&&c.filterable!==!1?R({},r.filterable,d.filterable):!1,a={dataSource:i.dataSource,values:r.values,columns:c.columns,sortable:o,filterable:l,messages:c.messages,owner:i,closeCallback:p,init:u},n.kendoColumnMenu(a))}))},_filterable:function(){var t,r,a=this,o=a.columns,l=function(){b(a.thead.parent(),!0)},n=a.options.filterable;n&&!a.options.columnMenu&&a.thead.find("th:not(.k-hierarchy-cell,.k-group-cell)").each(function(i){t=e(this),o[i].filterable===!1||o[i].command||!o[i].field&&!t.attr("data-"+v.ns+"field")||(r=t.data("kendoFilterMenu"),r&&r.destroy(),t.kendoFilterMenu(R(!0,{},n,o[i].filterable,{dataSource:a.dataSource,values:o[i].values,closeCallback:l,init:function(e){a.trigger(Y,{field:e.field,container:e.container})}})))})},_sortable:function(){var t,r,a,o=this,l=o.columns,n=o.options.sortable;n&&o.thead.find("th:not(.k-hierarchy-cell,.k-group-cell)").each(function(i){t=l[i],t.sortable!==!1&&!t.command&&t.field&&(r=e(this),a=r.data("kendoSortable"),a&&a.destroy(),r.attr("data-"+v.ns+"field",t.field).kendoSortable(R({},n,{dataSource:o.dataSource,aria:!0})))})},_columns:function(t){var r,a=this,o=a.table,l=o.find("col"),n=a.options.dataSource;t=t.length?t:A(o.find("th"),function(t,r){t=e(t);var a=t.attr(v.attr("sortable")),o=t.attr(v.attr("filterable")),n=t.attr(v.attr("type")),i=t.attr(v.attr("groupable")),s=t.attr(v.attr("field")),d=t.attr(v.attr("menu"));return s||(s=t.text().replace(/\s|[^A-z0-9]/g,"")),{field:s,type:n,sortable:"false"!==a,filterable:"false"!==o,groupable:"false"!==i,menu:d,template:t.attr(v.attr("template")),width:l.eq(r).css("width")}}),r=!(a.table.find("tbody tr").length>0&&(!n||!n.transport)),a.columns=A(t,function(e){return e=typeof e===gt?{field:e}:e,e.hidden&&(e.attributes=c(e.attributes),e.footerAttributes=c(e.footerAttributes),e.headerAttributes=c(e.headerAttributes)),R({encoded:r},e)})},_groups:function(){var e=this.dataSource.group();return e?e.length:0},_tmpl:function(e,t){var o,l,n,i,s=this,d=R({},v.Template,s.options.templateSettings),c=s.columns.length,p={storage:{},count:0},u=s._hasDetails(),f=[],h=s._groups();if(!e){for(e="<tr",t&&f.push("k-alt"),u&&f.push("k-master-row"),f.length&&(e+=' class="'+f.join(" ")+'"'),c&&(e+=" "+v.attr("uid")+'="#='+v.expr("uid",d.paramName)+'#"'),e+=" role='row'>",h>0&&(e+=r(h)),u&&(e+='<td class="k-hierarchy-cell"><a class="k-icon k-plus" href="\\#" tabindex="-1"></a></td>'),o=0;c>o;o++)n=s.columns[o],l=n.template,i=typeof l,e+="<td"+a(n.attributes)+" role='gridcell'>",e+=s._cellTmpl(n,p),e+="</td>";e+="</tr>"}return e=v.template(e,d),p.count>0?W(e,p.storage):e},_headerCellText:function(e){var t=this,r=R({},v.Template,t.options.templateSettings),a=e.headerTemplate,o=typeof a,l=e.title||e.field||"";return o===ht?l=v.template(a,r)({}):o===gt&&(l=a),l},_cellTmpl:function(e,t){var r,a,o=this,l=R({},v.Template,o.options.templateSettings),n=e.template,i=l.paramName,s=e.field,d="",c=e.format,p=typeof n,u=e.values;if(e.command){if(I(e.command)){for(r=0,a=e.command.length;a>r;r++)d+=o._createButton(e.command[r]);return d.replace(vt,"\\#")}return o._createButton(e.command).replace(vt,"\\#")}return p===ht?(t.storage["tmpl"+t.count]=n,d+="#=this.tmpl"+t.count+"("+i+")#",t.count++):p===gt?d+=n:u&&u.length&&H(u[0])&&"value"in u[0]&&s?(d+="#var v ="+v.stringify(f(u))+"#",d+="#var f = v[",l.useWithBlock||(d+=i+"."),d+=s+"]#",d+="${f != null ? f : ''}"):(d+=e.encoded?"#:":"#=",c&&(d+='kendo.format("'+c.replace(bt,"\\$1")+'",'),s?(s=v.expr(s,i),d+=s+"==null?'':"+s):d+="''",c&&(d+=")"),d+="#"),d},_templates:function(){var t=this,r=t.options,a=t.dataSource,o=a.group(),l=t.footer||t.wrapper.find(".k-grid-footer"),n=a.aggregate();t.rowTemplate=t._tmpl(r.rowTemplate),t.altRowTemplate=t._tmpl(r.altRowTemplate||r.rowTemplate,!0),t._hasDetails()&&(t.detailTemplate=t._detailTmpl(r.detailTemplate||"")),(t._group&&!L(n)||!L(n)&&!l.length||D(t.columns,function(e){return e.footerTemplate}).length)&&(t.footerTemplate=t._footerTmpl(n,"footerTemplate","k-footer-template")),o&&D(t.columns,function(e){return e.groupFooterTemplate}).length&&(n=e.map(o,function(e){return e.aggregates}),t.groupFooterTemplate=t._footerTmpl(n,"groupFooterTemplate","k-group-footer"))},_footerTmpl:function(e,t,o){var l,i,s,d,c,p=this,u=R({},v.Template,p.options.templateSettings),f=u.paramName,h="",g=p.columns,m={},b=0,k={},_=p._groups(),w=n(e);for(h+='<tr class="'+o+'">',_>0&&(h+=r(_)),p._hasDetails()&&(h+='<td class="k-hierarchy-cell">&nbsp;</td>'),l=0,i=p.columns.length;i>l;l++)c=g[l],s=c[t],d=typeof s,h+="<td"+a(c.footerAttributes)+">",s?(d!==ht&&(k=w[c.field]?R({},u,{paramName:f+"."+c.field}):{},s=v.template(s,k)),m["tmpl"+b]=s,h+="#=this.tmpl"+b+"("+f+")#",b++):h+="&nbsp;",h+="</td>";return h+="</tr>",h=v.template(h,u),b>0?W(h,m):h},_detailTmpl:function(e){var t=this,a="",o=R({},v.Template,t.options.templateSettings),l=o.paramName,n={},i=0,s=t._groups(),c=d(t.columns).length,p=typeof e;return a+='<tr class="k-detail-row">',s>0&&(a+=r(s)),a+='<td class="k-hierarchy-cell"></td><td class="k-detail-cell"'+(c?' colspan="'+c+'"':"")+">",p===ht?(n["tmpl"+i]=e,a+="#=this.tmpl"+i+"("+l+")#",i++):a+=e,a+="</td></tr>",a=v.template(a,o),i>0?W(a,n):a},_hasDetails:function(){var e=this;return null!==e.options.detailTemplate||(e._events[Q]||[]).length},_details:function(){var t=this;t.table.on(pt+K,".k-hierarchy-cell .k-plus, .k-hierarchy-cell .k-minus",function(r){var a,o,l=e(this),n=l.hasClass("k-plus"),i=l.closest("tr.k-master-row"),s=t.detailTemplate,d=t._hasDetails();return l.toggleClass("k-plus",!n).toggleClass("k-minus",n),d&&!i.next().hasClass("k-detail-row")&&(o=t.dataItem(i),e(s(o)).addClass(i.hasClass("k-alt")?"k-alt":"").insertAfter(i),t.trigger(Q,{masterRow:i,detailRow:i.next(),data:o,detailCell:i.next().find(".k-detail-cell")})),a=i.next(),t.trigger(n?lt:nt,{masterRow:i,detailRow:a}),a.toggle(n),t._current&&t._current.attr("aria-expanded",n),r.preventDefault(),!1})},dataItem:function(t){return this._data[this.tbody.find("> tr:not(.k-grouping-row,.k-detail-row,.k-group-footer)").index(e(t))]},expandRow:function(t){e(t).find("> td .k-plus, > td .k-i-expand").click()},collapseRow:function(t){e(t).find("> td .k-minus, > td .k-i-collapse").click()},_thead:function(){var r,o,l,n,i,s=this,d=s.columns,c=s._hasDetails()&&d.length,p="",u=s.table.find(">thead");if(u.length||(u=e("<thead/>").insertBefore(s.tbody)),l=s.element.find("tr:has(th):first"),l.length||(l=u.children().first(),l.length||(l=e("<tr/>"))),l.children().length)c&&!l.find(".k-hierarchy-cell")[0]&&l.prepend('<th class="k-hierarchy-cell">&nbsp;</th>');else{for(c&&(p+='<th class="k-hierarchy-cell">&nbsp;</th>'),r=0,o=d.length;o>r;r++)i=d[r],n=s._headerCellText(i),i.command?p+="<th"+a(i.headerAttributes)+">"+n+"</th>":(p+="<th role='columnheader' "+v.attr("field")+"='"+(i.field||"")+"' ",i.title&&(p+=v.attr("title")+'="'+i.title.replace(/'/g,"'")+'" '),i.groupable!==t&&(p+=v.attr("groupable")+"='"+i.groupable+"' "),i.aggregates&&(p+=v.attr("aggregates")+"='"+i.aggregates+"'"),p+=a(i.headerAttributes),p+=">"+n+"</th>");l.html(p)}l.find("th").addClass("k-header"),s.options.scrollable||u.addClass("k-grid-header"),l.find("script").remove().end().appendTo(u),s.thead&&s._destroyColumnAttachments(),s.thead=u,s._sortable(),s._filterable(),s._scrollable(),s._updateCols(),s._resizable(),s._draggable(),s._reorderable(),s.groupable&&s._attachGroupable(),s._columnMenu()},_updateCols:function(){var e=this;e._appendCols(e.thead.parent().add(e.table))},_appendCols:function(e){var t=this;u(e,d(t.columns),t._hasDetails(),t._groups())},_autoColumns:function(e){if(e&&e.toJSON){var t,r=this;e=e.toJSON();for(t in e)r.columns.push({field:t});r._thead(),r._templates()}},_rowsHtml:function(e){var t,r,a=this,o="",l=a.rowTemplate,n=a.altRowTemplate;for(t=0,r=e.length;r>t;t++)o+=t%2?n(e[t]):l(e[t]),a._data.push(e[t]);return o},_groupRowHtml:function(e,t,a){var o,l,n=this,i="",s=e.field,d=D(n.columns,function(e){return e.field==s})[0]||{},c=d.groupHeaderTemplate,p=(d.title||s)+": "+h(e.value,d.format,d.values),u=R({},{field:e.field,value:e.value},e.aggregates[e.field]),f=n._groupAggregatesDefaultObject||{},g=e.items;if(c&&(p=typeof c===ht?c(u):v.template(c)(u)),i+='<tr class="k-grouping-row">'+r(a)+'<td colspan="'+t+'" aria-expanded="true">'+'<p class="k-reset">'+'<a class="k-icon k-i-collapse" href="#" tabindex="-1"></a>'+p+"</p></td></tr>",e.hasSubgroups)for(o=0,l=g.length;l>o;o++)i+=n._groupRowHtml(g[o],t-1,a+1);else i+=n._rowsHtml(g);return n.groupFooterTemplate&&(i+=n.groupFooterTemplate(R(f,e.aggregates))),i},collapseGroup:function(r){r=e(r).find(".k-icon").addClass("k-i-expand").removeClass("k-i-collapse").end();var a,o,l=r.find(".k-group-cell").length,n=1;r.find("td:first").attr("aria-expanded",!1),r.nextAll("tr").each(function(){return o=e(this),a=o.find(".k-group-cell").length,o.hasClass("k-grouping-row")?n++:o.hasClass("k-group-footer")&&n--,l>=a||o.hasClass("k-group-footer")&&0>n?!1:(o.hide(),t)})},expandGroup:function(r){r=e(r).find(".k-icon").addClass("k-i-collapse").removeClass("k-i-expand").end();var a,o,l=this,n=r.find(".k-group-cell").length,i=1;r.find("td:first").attr("aria-expanded",!0),r.nextAll("tr").each(function(){return a=e(this),o=a.find(".k-group-cell").length,n>=o?!1:(o!=n+1||a.hasClass("k-detail-row")||(a.show(),a.hasClass("k-grouping-row")&&a.find(".k-icon").hasClass("k-i-collapse")&&l.expandGroup(a),a.hasClass("k-master-row")&&a.find(".k-icon").hasClass("k-minus")&&a.next().show()),a.hasClass("k-grouping-row")&&i++,a.hasClass("k-group-footer")&&(1==i?a.show():i--),t)})},_updateHeader:function(t){var r=this,a=r.thead.find("th.k-group-cell"),o=a.length;t>o?e(Array(t-o+1).join('<th class="k-group-cell k-header">&nbsp;</th>')).prependTo(r.thead.find("tr")):o>t&&(o-=t,e(D(a,function(e,t){return o>t})).remove())},_firstDataItem:function(e,t){return e&&t&&(e=e.hasSubgroups?this._firstDataItem(e.items[0],t):e.items[0]),e},hideColumn:function(t){var r,a,o,l,n,i,s,p,u,f=this,h=0,m=f.footer||f.wrapper.find(".k-grid-footer"),b=f.columns,k=v.support.browser;if(t="number"==typeof t?b[t]:D(b,function(e){return e.field===t})[0],t&&!t.hidden){for(u=E(t,d(b)),t.hidden=!0,t.attributes=c(t.attributes),t.footerAttributes=c(t.footerAttributes),t.headerAttributes=c(t.headerAttributes),f._templates(),f._updateCols(),f.thead.find(">tr>th:not(.k-hierarchy-cell,.k-group-cell):visible").eq(u).hide(),m&&(f._appendCols(m.find("table:first")),m.find(".k-footer-template>td:not(.k-hierarchy-cell,.k-group-cell):visible").eq(u).hide()),r=f.tbody.children(),n=0,p=r.length;p>n;n+=1)a=r.eq(n),a.is(".k-grouping-row,.k-detail-row")?(o=a.children(":not(.k-group-cell):first,.k-detail-cell").last(),o.attr("colspan",parseInt(o.attr("colspan"),10)-1)):(a.hasClass("k-grid-edit-row")&&(o=a.children(".k-edit-container")[0])&&(o=e(o),o.attr("colspan",parseInt(o.attr("colspan"),10)-1),o.find("col").eq(u).remove(),a=o.find("tr:first")),g(a[0].cells,u,!1));for(i=f.thead.prev().find("col"),n=0,p=i.length;p>n;n+=1){if(s=i[n].style.width,!s||-1!=s.indexOf("%")){h=0;break}h+=parseInt(s,10)}l=e(">.k-grid-header table:first,>.k-grid-footer table:first",f.wrapper).add(f.table),f._footerWidth=null,h&&(l.width(h),f._footerWidth=h),k.msie&&8==k.version&&(l.css("display","inline-table"),setTimeout(function(){l.css("display","table")},1)),f.trigger(tt,{column:t})}},showColumn:function(t){var r,a,o,l,n,i,s,c,f,h,m=this,b=m.columns,k=m.footer||m.wrapper.find(".k-grid-footer");if(t="number"==typeof t?b[t]:D(b,function(e){return e.field===t})[0],t&&t.hidden){for(h=E(t,b),t.hidden=!1,t.attributes=p(t.attributes),t.footerAttributes=p(t.footerAttributes),t.headerAttributes=p(t.headerAttributes),m._templates(),m._updateCols(),m.thead.find(">tr>th:not(.k-hierarchy-cell,.k-group-cell)").eq(h).show(),k&&(m._appendCols(k.find("table:first")),k.find(".k-footer-template>td:not(.k-hierarchy-cell,.k-group-cell)").eq(h).show()),r=m.tbody.children(),a=0,o=r.length;o>a;a+=1)l=r.eq(a),l.is(".k-grouping-row,.k-detail-row")?(n=l.children(":not(.k-group-cell):first,.k-detail-cell").last(),n.attr("colspan",parseInt(n.attr("colspan"),10)+1)):(l.hasClass("k-grid-edit-row")&&(n=l.children(".k-edit-container")[0])&&(n=e(n),n.attr("colspan",parseInt(n.attr("colspan"),10)+1),u(n.find(">form>table"),d(b),!1,0),l=n.find("tr:first")),g(l[0].cells,h,!0));if(i=e(">.k-grid-header table:first,>.k-grid-footer table:first",m.wrapper).add(m.table),t.width){for(s=0,f=m.thead.prev().find("col"),a=0,o=f.length;o>a;a+=1){if(c=f[a].style.width,c.indexOf("%")>-1){s=0;break}s+=parseInt(c,10)}m._footerWidth=null,s&&(i.width(s),m._footerWidth=s)}else i.width("");m.trigger(rt,{column:t})}},_progress:function(e){var t=this,r=t.element.is("table")?t.element.parent():t.content&&t.content.length?t.content:t.element;v.ui.progress(r,e)},refresh:function(t){var r,a,o,l,i,s,c=this,p="",u=c.dataSource.view(),f=c.options.navigatable,h=e(c.current()),g=!1,m=(c.dataSource.group()||[]).length,k=m+d(c.columns).length;if(!(t&&"itemchange"===t.action&&c.editable||(t=t||{},c.trigger("dataBinding",{action:t.action||"rebind",index:t.index,items:t.items})))){if(s=x(),f&&(c.table[0]===s||e.contains(c.table[0],s)||c._editContainer&&c._editContainer.data("kendoWindow"))&&(g=h.is("th"),i=0,g&&(i=c.thead.find("th:not(.k-group-cell)").index(h))),c._destroyEditable(),c._progress(!1),c._data=[],c.columns.length||(c._autoColumns(c._firstDataItem(u[0],m)),k=m+c.columns.length),c._group=m>0||c._group,c._group&&(c._templates(),c._updateCols(),c._updateHeader(m),c._group=m>0),m>0)for(c.detailTemplate&&k++,c.groupFooterTemplate&&(c._groupAggregatesDefaultObject=n(c.dataSource.aggregate())),a=0,r=u.length;r>a;a++)p+=c._groupRowHtml(u[a],k,0);else p+=c._rowsHtml(u);C?c.tbody[0].innerHTML=p:(l=document.createElement("div"),l.innerHTML="<table><tbody>"+p+"</tbody></table>",o=l.firstChild.firstChild,c.table[0].replaceChild(o,c.tbody[0]),c.tbody=e(o)),c._footer(),c._setContentHeight(),i>=0&&(c._removeCurrent(),g?c.current(c.thead.find("th:not(.k-group-cell)").eq(i)):c.current(c.items().eq(i).children().filter(z).first()),c._current&&b(c._current.closest("table")[0],!0)),c.trigger(ot)}}});_.plugin(St),_.plugin(xt)})(window.kendo.jQuery)});