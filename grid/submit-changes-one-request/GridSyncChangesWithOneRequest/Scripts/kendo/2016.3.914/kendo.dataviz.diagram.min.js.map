{"version":3,"sources":["kendo.dataviz.diagram.js"],"names":["f","define","defined","value","UNDEFINED","round","precision","power","pow","math","p","limitValue","min","max","rad","degrees","DEG_TO_RAD","deg","radians","isNumber","val","isNaN","valueOrDefault","defaultValue","sqr","objectKey","object","key","parts","push","sort","join","hashKey","str","i","hash","length","charCodeAt","hashObject","arrayLimits","arr","MAX_NUM","MIN_NUM","arrayMin","arrayMax","sparseArrayMin","sparseArrayLimits","sparseArrayMax","n","isFinite","undefined","last","array","append","first","second","apply","renderTemplate","text","kendo","template","useWithBlock","paramName","renderAttr","name","renderAllAttr","attrs","output","renderStyle","renderSize","size","renderPos","pos","result","toHyphens","split","isTransparent","color","arabicToRoman","literals","1","10","100","2","20","200","3","30","300","4","40","400","5","50","500","6","60","600","7","70","700","8","80","800","9","90","900","1000","values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","this","ucs2decode","string","extra","counter","ucs2encode","map","String","fromCharCode","mergeSort","a","cmp","merge","b","ai","bi","slice","left","right","Math","floor","window","deepExtend","PI","Number","MAX_VALUE","now","Date","getTime","util","drawing","dataviz","amd","a1","a2","a3","$","zeroSize","width","height","baseline","measureText","style","measureBox","TextMetrics","current","measure","loadFonts","fonts","callback","promises","document","font","load","e","logToConsole","Promise","all","then","doc","Class","LRUCache","extend","init","_size","_length","_map","put","lru","entry","_head","_tail","newer","older","get","defaultMeasureBox","options","_cache","_initOptions","baselineMarkerSize","box","styleKey","cacheKey","cachedResult","baselineMarker","_baselineMarker","cloneNode","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","jQuery","encodeBase64","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","encodeUTF8","KEY_STR","inArray","ObserversMixin","observers","_observers","addObserver","element","removeObserver","index","splice","trigger","methodName","event","observer","idx","_suspended","optionsChange","geometryChange","suspend","resume","_observerField","field","mixins","Range","start","stop","step","rangeIntegerScale","k","range","j","Utils","sign","Infinity","abs","findRadian","end","sngXComp","sngYComp","y","atan","Easing","Ticker","diagram","isArray","EPSILON","isNearZero","num","isDefined","obj","isUndefined","isObject","has","hasOwnProperty","call","isString","prototype","toString","isBoolean","isType","type","parseFloat","isEmpty","simpleExtend","destination","source","initArray","serializePoints","points","res","deserializePoints","s","Point","parseInt","randomInteger","lower","upper","random","DFT","el","func","item","childNodes","getMatrixAngle","atan2","getMatrixScaling","sX","sqrt","sY","number","findAngle","center","forEach","iterator","thisRef","any","predicate","remove","what","ax","indexOf","contains","fold","list","acc","context","initial","find","constraint","insert","position","clear","bisort","sortfunc","addRange","easeInOut","cos","adapters","target","tick","interval","duration","lastTime","handlers","_this","transition","timerDelegate","onTimerEvent","addAdapter","onComplete","handler","removeHandler","grep","h","caller","onStep","seekTo","to","seekFromTo","from","intervalId","setInterval","clearInterval","play","origin","initState","reverse","propagate","update","movement","timePassed","ui","intersectLine","start1","end1","start2","end2","isSegment","num1","num2","tangensdiff","normalVariable","mean","deviation","log","randomId","chars","PathDefiner","Rect","Size","Intersect","RectAlign","Polar","Matrix","MatrixVector","Geometry","HashTable","Dictionary","Queue","Set","Node","Link","Graph","Point2D","isFunction","HITTESTAREA","fn","plus","minus","offset","times","normalize","lengthSquared","middleOf","q","toPolar","useDegrees","halfpi","len","factor","isOnLine","temp","r1","r2","o1","u1","inflate","union","parse","tempStr","xy","point","dx","dy","x1","y1","x2","y2","top","bottom","topLeft","topRight","bottomLeft","bottomRight","clone","equals","rect","rotatedBounds","angle","rotatedPoints","tl","tr","br","bl","rotate","delimiter","scale","scaleX","scaleY","staicPoint","adornerCenter","delta","scaled","thisCenter","zoom","overlaps","rectBottomRight","Empty","toRect","empty","fromPoints","lines","segments","rectWithLine","rects","rect1","rect2","intersect","reverseAngle","container","align","content","alignment","alignValues","_singleAlign","_align","_left","_center","_right","stretch","_stretch","_top","middle","_middle","_bottom","alignCalc","applyRect","fromSVGMatrix","vm","fromMatrixVector","fromList","translation","unit","rotation","sin","scaling","nums","trim","substr","fromMatrix","_distanceToLineSquared","d2","pt1","pt2","vx","vy","dot","distanceToLine","distanceToPolyline","p1","p2","minimum","_buckets","add","_createGetBucket","_bucketExists","set","containsKey","hashId","_hash","bucket","hashes","_hashes","ht","_hashString","_objectHashId","ch","_hashId","Observable","dictionary","that","_hashTable","Error","forEachValue","forEachKey","keys","enqueue","next","dequeue","resource","kv","toArray","shape","links","outgoing","incoming","weight","associatedShape","bounds","data","shortForm","isVirtual","isIsolated","isLinkedTo","node","link","getComplement","getChildren","children","getParents","parents","copy","balance","owner","adjacentTo","removeLink","hasLinkTo","degree","incidentWith","getLinksWith","getNeighbors","neighbors","connection","sourceFound","targetFound","associatedConnection","getCommonNode","isBridging","v1","v2","getNodes","changeSource","changeTarget","changesNodes","w","oldSource","oldTarget","directTo","createReverseEdge","reversed","idOrDiagram","nodes","_nodeMap","_root","_hasCachedRelationships","cacheRelationships","forceRebuild","assignLevels","startNode","visited","child","level","root","found","getConnectedComponents","componentId","components","graph","componentIndex","setItemIndices","_collectConnectedNodes","addNodeAndOutgoings","setIds","nodeIndex","nextId","calcBounds","getSpanningTree","remaining","levelCount","ni","cn","newLink","treeLevels","tree","_addNode","pop","addLink","takeRandomNode","excludedNodes","incidenceLessThan","pool","isHealthy","hasNode","sourceOrLink","foundSource","foundTarget","addExistingLink","getNode","addNode","removeAllLinks","t","hasLink","linkOrId","nodeOrId","_removeNode","removeNode","areConnected","n1","n2","layoutRect","newNode","newLinks","saveMapping","save","nodeMap","linkMap","nOriginal","nCopy","linkOriginal","linkCopy","linearize","addIds","depthFirstTraversal","action","foundNode","_dftIterator","breadthFirstTraversal","queue","_stronglyConnectedComponents","excludeSingleItems","indices","lowLinks","connected","stack","component","findCycles","isAcyclic","isSubGraph","other","otherArray","thisArray","makeAcyclic","oneLink","oneNode","rev","N","intensityCatalog","flowIntensity","catalogEqualIntensity","sourceStack","targetStack","intensity","targets","li","targetLink","sources","si","sourceLink","maxdiff","ri","ril","u","vertexOrder","kk","reversedEdges","unshift","concat","Predefined","EightGraph","Mindmap","ThreeGraph","BinaryTree","levels","createBalancedTree","Linear","Tree","siblingsCount","Forest","trees","createBalancedForest","Workflow","Grid","previous","g","graphString","previousLink","part","lin","_addShape","kendoDiagram","shapeDefaults","radius","fill","undoable","addShape","_addConnection","connect","createDiagramFromGraph","doLayout","randomSize","opt","gli","sourceShape","targetShape","shi","clientWidth","clientHeight","SpringLayout","layoutGraph","limitToView","lastAdded","news","parent","treeCount","createRandomConnectedGraph","nodeCount","maxIncidence","isTree","poolNode","randomAdditions","randomDiagram","shapeCount","diffNumericOptions","fields","elementOptions","hasChanges","sizeOptionsOrDefault","normalizeDrawingOptions","drawingOptions","getColor","TRANSPARENT","Color","toHex","lineAngle","xDiff","yDiff","createSegment","Segment","toDrawingRect","Scale","Translation","Rotation","CompositeTransform","AutoSizeableMixin","Element","VisualBase","TextBlock","Rectangle","MarkerBase","CircleMarker","ArrowMarker","MarkerPathMixin","Path","Line","Polyline","Image","Group","Layout","Circle","Canvas","geometry","Markers","none","arrowStart","filledCircle","arrowEnd","FULL_CIRCLE_ANGLE","START","END","WIDTH","HEIGHT","X","Y","toMatrix","format","invert","toMatrixVector","Length","ZERO","translate","transform","render","visual","_transform","_renderTransform","rotateMatrix","scaleMatrix","translatePoint","_setScale","originWidth","_originWidth","originHeight","_originHeight","_setTranslate","_initSize","autoSize","_measure","_updateSize","_diffNumericOptions","_originSize","visible","drawingContainer","redraw","drawingElement","matrix","_hover","force","startPoint","_measured","_boundingBox","rawBBox","stroke","opacity","_fill","_stroke","show","hover","strokeOptions","dashType","fillOptions","gradient","GradientClass","RadialGradient","LinearGradient","_textColor","_font","_initText","fontSize","fontFamily","Text","fontOptions","fontStyle","fontWeight","sizeChanged","textOptions","_initPath","_setPosition","_drawPath","closed","sizeOptions","elements","anchor","createElement","_transformToPath","path","transformCopy","positionMarker","targetSegment","_linePoints","endPoint","nextSegment","prevSegment","controlOut","controlIn","_getPath","MultiPath","paths","_normalizeMarkerOptions","startCap","endCap","_removeMarker","marker","_markers","_createMarkers","_createMarker","markerType","_positionMarker","_capMap","_redrawMarker","pathChange","pathOptions","cap","pathCapType","optionsCap","created","_redrawMarkers","_createElements","_setData","multipath","_updatePath","_pointsDiffer","currentPoints","differ","_initImage","src","_rect","_childrenChange","_remove","removeAt","toFront","visuals","toBack","_reorderChildren","toIndex","group","drawingChildren","fixedPosition","boundingBox","childBoundingBox","_includeInBBox","clippedBBox","drawingRect","reflow","_initCircle","circleOptions","move","_circle","setRadius","surface","Surface","_translate","_viewBox","viewBox","setSize","draw","insertBefore","destroy","clearHtml","testKey","toUpperCase","hitToOppositeSide","hit","canDrag","editable","drag","hitTestShapeConnectors","connector","connectors","HIT_TEST_DISTANCE","noMeta","meta","ctrlKey","altKey","shiftKey","PositionAdapter","LayoutUndoUnit","CompositeUnit","ConnectionEditUnit","ConnectionEditUndoUnit","DeleteConnectionUnit","DeleteShapeUnit","TransformUnit","AddConnectionUnit","AddShapeUnit","PanUndoUnit","RotateUnit","ToFrontUnit","ToBackUnit","UndoRedoService","EmptyTool","ScrollerTool","PointerTool","SelectionTool","ConnectionTool","ConnectionEditTool","ToolService","ConnectionRouterBase","LinearConnectionRouter","PolylineRouter","CascadingRouter","AdornerBase","ConnectionEditAdorner","ConnectorsAdorner","ResizingAdorner","Selector","ConnectorVisual","Movable","browser","support","proxy","Cursors","arrow","grip","cross","select","south","east","west","north","rowresize","colresize","AUTO","TOP","RIGHT","LEFT","BOTTOM","DEFAULT_SNAP_SIZE","DEFAULT_SNAP_ANGLE","DRAG_START","DRAG","DRAG_END","ITEMROTATE","ITEMBOUNDSCHANGE","MIN_SNAP_SIZE","MIN_SNAP_ANGLE","MOUSE_ENTER","MOUSE_LEAVE","ZOOM_START","ZOOM_END","SCROLL_MIN","SCROLL_MAX","FRICTION","FRICTION_MOBILE","VELOCITY_MULTIPLIER","PAN","ROTATED","SOURCE","TARGET","HANDLE_NAMES","-1","layoutState","pusher","getShapeById","subjects","froms","tos","initialState","finalState","animate","_initialState","_finalState","title","undo","setState","redo","state","ticker","conn","units","undoUnit","redoSource","redoTarget","_redoSource","_redoTarget","_undoSource","_undoTarget","_updateConnector","updateModel","undoSource","undoTarget","targetConnector","shapes","undoStates","adorner","redoStates","layout","refreshBounds","refresh","deselect","initialPosition","finalPosition","finalPos","pan","undoRotates","redoRotates","redoAngle","_angle","_innerBounds","_initialize","items","initialIndices","_toIndex","bind","events","capacity","begin","composite","cancel","commit","execute","_restart","addCompositeItem","count","toolService","tryActivate","getCursor","canvas","scroller","virtualScroll","tool","friction","mobileOS","scrollable","kendoMobileScroller","velocityMultiplier","mousewheelScrolling","scroll","_move","movableCanvas","dimension","makeVirtual","virtualSize","dimensions","disable","pannable","enabled","hoveredItem","hoveredAdorner","_hoveredConnector","enable","args","scrollPos","scrollLeft","scrollTop","_storePan","moveTo","_pan","selectSingle","handle","_hitTest","_resizingAdorner","isDragHandle","connections","undoRedoService","_getCursor","selectable","multiple","selector","isSelected","selectArea","_createConnection","_c","connectionHandle","_connectionManipulation","_removeHover","activeConnection","sourceConnector","Shape","getConnector","_syncConnectionChanges","isActive","handleName","tools","activeTool","_updateHoveredItem","_activateTool","_updateCursor","focus","suspendTracking","updateHovered","resumeTracking","keyDown","toRemove","metaKey","_triggerRemove","_syncChanges","_destroyToolBar","_discardNewConnection","selectAll","cut","paste","wheel","z","zoomRate","zoomOptions","zoomMin","zoomMax","setTool","addToSelection","newConnection","cursor","css","msie","version","cssText","disabledShape","isNew","selectedConnections","_connectorsAdorner","_visible","_selectedItems","Connection","_hitTestItems","_hitTestElements","mainLayer","shapeIdx","connectionIdx","shapeHit","connectionHit","hitTest","rec","getBounds","allPoints","route","SAME_SIDE_DISTANCE_RATIO","routePoints","_connectorPoints","_floatingPoints","_resolvedSourceConnector","_resolvedTargetConnector","sourcePoint","targetPoint","_connectorSides","axis","boundsPoint","secondarySign","_connectorSide","sideDistance","minSide","side","shapeBounds","sides","_sameSideDistance","pointX","pointY","sourceConnectorSide","targetConnectorSide","deltaX","deltaY","sameSideDistance","shiftX","shiftY","cascadeStartHorizontal","_startHorizontal","sourceSide","horizontal","_adorners","sp","tp","_ts","spVisual","handles","epVisual","_initialSource","_initialTarget","ts","radiusX","radiusY","sourcePointDistance","distanceTo","targetPointDistance","sourceHandle","targetHandle","modelToLayer","_refreshHandler","ctr","unbind","each","_manipulating","_initSelection","_createHandles","selected","_internalChange","_rotatedHandler","_resizable","resize","_handleOptions","_bounds","handleBounds","handlesCount","_getHandleBounds","_rotationOffset","_startAngle","_rotates","_positions","initialRotates","initialStates","handleOptions","_sp","_cp","_lp","shapeStates","visibleHandles","currentAngle","dragging","newBounds","staticPoint","thr","newCenter","oldBounds","dtl","dbr","changed","_truncateAngle","_rotating","shouldSnap","_truncateDistance","_displaceBounds","minWidth","minHeight","states","_truncatePositionToGuides","ruler","truncatePositionToGuides","_truncateSizeToGuides","truncateSizeToGuides","snap","snapOptions","snapAngle","snapSize","_diffStates","_syncShapeChanges","thumb","rotationThumb","_rotationThumbBounds","_ep","_adorn","visualBounds","modelToView","relative","_visualBounds","HyperTree","LayoutBase","defaultOptions","subtype","roots","nodeDistance","iterations","horizontalSeparation","verticalSeparation","underneathVerticalTopOffset","underneathHorizontalOffset","underneathVerticalSeparation","grid","offsetX","offsetY","componentSpacingX","componentSpacingY","layerSeparation","layeredIterations","startRadialAngle","endRadialAngle","radialSeparation","radialFirstLevelSeparation","keepComponentsInOneRadialLayout","ignoreContainers","layoutContainerChildren","ignoreInvisible","animateTransitions","gridLayoutComponents","maxWidth","startX","startY","resultLinkSet","resultNodeSet","boundingRect","currentHeight","currentWidth","moveToOffset","nodeBounds","newpoints","pt","deltax","deltay","currentHorizontalOffset","transferOptions","DiagramToHyperTreeAdapter","shapeMap","edges","edgeMap","finalNodes","finalLinks","ignoredConnections","ignoredShapes","hyperMap","hyperTree","finalGraph","convert","_renormalizeShapes","_renormalizeConnections","mapConnection","mapShape","getEdge","listToRoot","containerGraph","parentContainer","firstNonIgnorableContainer","isContainer","_isIgnorableItem","isContainerConnection","isDescendantOf","scope","containers","isIgnorableItem","isCollapsed","_isVisible","_isTop","isShapeMapped","leastCommonAncestor","al","xa","xb","_isCollapsed","sink","sourceNode","sinkNode","newEdge","areConnectedAlready","adapter","finalNodeSet","LayoutState","initialTemperature","guessBounds","temperature","_expectedBounds","refineStage","_repulsion","_attraction","_shake","rho","alpha","_InverseSquareForce","wn","hn","wm","hm","_SquareForce","distance","av","squareSize","ratio","multiplier","area","ceil","TreeLayoutProcessor","treeGraph","layoutSwitch","layoutLeft","setChildrenDirection","setChildrenLayout","TreeDirection","Width","arrange","layoutRight","layoutUp","up","layoutDown","down","treeDirection","layoutRadialTree","startAngle","endAngle","previousRoot","maxDepth","calculateAngularWidth","radialLayout","Angle","tipOverTree","startFromLevel","aw","diameter","sectorAngle","sortChildren","pl","nl","col","basevalue","normalizeAngle","childNode","cp","childAngleFraction","deltaTheta","deltaThetaHalf","parentSector","fraction","sorted","setPolarLocation","BoundingRectangle","direction","includeStart","rootDirection","rootLayout","childrenLayout","givenSize","shapeWidth","shapeHeight","AngleToParent","SectorAngle","pp","childrenwidth","selfLocation","single","male","female","leftcount","tipOverTreeStartLevel","TreeLayout","layoutComponents","getTree","givenRootShape","getTreeForRoot","LayeredLayout","_initRuntimeProperties","layer","downstreamLinkCount","upstreamLinkCount","uBaryCenter","dBaryCenter","upstreamPriority","downstreamPriority","gridPosition","_prepare","targetLayer","sortedNodes","minLayer","layerMap","layerCount","o2","o1layer","o2layer","layers","linksTo","_dummify","_optimizeCrossings","_swapPairs","arrangeNodes","_moveThingsAround","_dedummify","setMinDist","minDist","layerIndex","minDistances","getMinDist","dist","i1","i2","placeLeftToRight","leftClasses","classNodes","rightSibling","D","neighbor","leftPos","placeLeft","POSITIVE_INFINITY","nodeLeftClass","upNodes","downNodes","intDiv","placeRightToLeft","rightClasses","leftSibling","rightPos","placeRight","NEGATIVE_INFINITY","nodeRightClass","_getLeftWing","leftWing","computeClasses","_getRightWing","rightWing","wingPair","ndsinl","vnode","wings","currentWing","wing","_nodesInLink","classIndex","_isVerticalLayout","_isHorizontalLayout","_isIncreasingLayout","maximumHeight","ctx","MIN_VALUE","currentNode","currDown","downNode","order","placed","sequenceStart","sequenceEnd","directions","fromLayerIndex","reachedFinalLayerIndex","layerIncrement","_gridPositionComparer","dest","virtualStartIndex","virtualStart","sequence","virtualEnd","virtualEndIndex","_firstVirtualNode","_sequencer","nextVirtualNode","adjustDirections","prevBridge","prevBridgeTarget","nextBridge","nextBridgeTarget","clayer","j1","j2","getNeighborOnLayer","dir","_sequenceSingle","combineSequences","pair","rightHeap","leftRes","rightRes","leftHeap","_positionDescendingComparer","_positionAscendingComparer","leftClass","_getComposite","rightClass","maxLayoutIterations","it","gridPos","layoutLayer","iconsidered","considered","n1Priority","n2Priority","nodeGridPos","nodeBaryCenter","calcBaryCenter","nodePriority","moveRight","moveLeft","calcDownData","calcUpData","priority","rightNode","rightNodePriority","leftNode","leftNodePriority","mapVirtualNode","nodeToLinkMap","linkToNodeMap","addLinkBetweenLayers","o","oLayer","dLayer","oPos","dPos","upLayer","downLayer","depthOfDumminess","prevLink","dedum","moves","maxIterations","iter","optimizeLayerCrossings","sum","total","presorted","inode","compareValue","n1BaryCenter","n2BaryCenter","compareByIndex","downwards","secondPass","hasSwapped","calcCrossings","memCrossings","crossBefore","node1","node2","node1GridPos","node2GridPos","crossAfter","revert","countLinksCrossingBetweenTwoLayers","ulayer","dlayer","link1","link2","n11","n12","n21","n22","l1","l2","n11gp","n12gp","n21gp","n22gp","crossings","numerator","denominator","graphOrNodes","capture","diagramOrGraphOrNodes","Array","GraphAdapter","mwDelta","origEvent","originalEvent","wheelDelta","detail","isAutoConnector","closestConnector","resCtr","minimumDistance","MAXINT","indicesOfItems","filterShapeDataItem","dataItem","filterConnectionDataItem","fromConnector","fromX","fromY","toConnector","toX","toY","connectionSelector","textField","model","dataSource","reader","idField","appendTo","kendoDropDownList","dataValueField","dataTextField","toJSON","optionLabel","valuePrimitive","InactiveItem","callbacks","InactiveItemsCollection","cloneDataItem","Model","_defaultId","splitDiagramElements","createModel","ObservableObject","clearField","copyDefaultOptions","mainOptions","translateToOrigin","bbox","preventDefault","defaultButtons","DiagramElement","Connector","Diagram","DiagramToolBar","Editor","PopupEditor","QuadRoot","QuadNode","ShapesQuadTree","geom","Widget","HierarchicalDataSource","isPlainObject","NS","CASCADING","CHANGE","CLICK","ERROR","SELECT","NONE","DEFAULT_CANVAS_WIDTH","DEFAULT_CANVAS_HEIGHT","DEFAULT_SHAPE_TYPE","DEFAULT_SHAPE_WIDTH","DEFAULT_SHAPE_HEIGHT","DEFAULT_SHAPE_MINWIDTH","DEFAULT_SHAPE_MINHEIGHT","DEFAULT_SHAPE_POSITION","DEFAULT_CONNECTION_BACKGROUND","ABSOLUTE","TRANSFORMED","MOUSEWHEEL_NS","MOBILE_ZOOM_RATE","MOBILE_PAN_DISTANCE","BUTTON_TEMPLATE","CONNECTION_CONTENT_OFFSET","DefaultConnectors","getPosition","imageClass","className","iconClass","defaults","_template","serializable","serialize","json","_content","contentOptions","contentVisual","_contentVisual","_updateContentVisual","_createContentVisual","elementTemplate","_canSelect","shapeId","updateOptionsFromModel","createShapeVisual","updateBounds","_createConnectors","_setOptionsFromModel","modelOptions","redrawVisual","_isEditable","_redrawVisual","syncChanges","_suspendModelRefresh","_resumeModelRefresh","_rotate","_alignContent","containerRect","aligner","contentBounds","contentRect","alignedBounds","connectorDefaults","_transformedBounds","_rotatedBounds","_setBounds","_triggerBoundsChange","_layouting","refreshConnections","deselected","_internalSelection","_selectionChanged","sc","deltaAngle","newPosition","con","cons","nameOrPoint","toLocaleLowerCase","fnName","_transformPoint","shapeOptions","boundsChange","shapeVisual","_visualOptions","_updateConnectors","_showConnectors","rotatedPoint","visualOptions","visualTemplate","_initRouter","_sourcePoint","_targetPoint","_setSource","_setTarget","definers","toConenctor","dataMap","_dataMap","connectionsDataSource","getByUid","uid","shapeSource","defaultConnector","_removeFromSourceConnector","_clearSourceConnector","_setFromOptions","fromPoint","sourceDefiner","_sourceDefiner","shapeTarget","_removeFromTargetConnector","_clearTargetConnector","_setToOptions","toPoint","targetDefiner","_targetDefiner","instance","connectorName","setNewTarget","inactiveItem","_inactiveShapeItems","_deferredConnectionUpdates","onActivate","endIdx","startIdx","alignToPath","midIdx","selection","_router","definition","pts","_resolveConnectors","_refreshPath","sourceConnectors","targetConnectors","_resolveAutoConnectors","minNonConflictSource","minNonConflictTarget","minSource","minTarget","sourceIdx","targetIdx","minNonConflict","_testRoutePoints","router","passRoute","_shapesQuadTree","hitTestRect","userOptions","_initTheme","_initElements","_extendLayoutOptions","_initDefaults","_interactionDefaults","_initCanvas","adornerLayer","_createHandlers","_clipboard","pauseMouseHandlers","_fetchFreshData","_createGlobalToolBar","_createOptionElements","theme","draggable","autoBind","tooltip","connectionDefaults","toolBar","click","_toolBarClick","modal","textAlign","prepend","_resize","createShape","view","editor","_createShape","edit","createConnection","_connectionsDataMap","addConnection","editModel","editorType","editors","connectionSelectorHandler","cancelEdit","shapeEditors","shapeTemplate","connectionEditors","connectionTemplate","_update","_cancel","_editArgs","_getEditDataSource","cancelChanges","_destroyEditor","saveEdit","sync","wrapper","close","attr","addClass","userShapeDefaults","mobile","canvasContainer","viewPort","viewport","on","_wheel","_keydown","_userEvents","UserEvents","multiTouch","fastTap","tap","_tap","_dragStart","_drag","_dragEnd","gesturestart","_gestureStart","gesturechange","_gestureChange","gestureend","_gestureEnd","_mouseover","_mouseout","_mouseMove","_syncHandler","_resizeHandler","onResize","_pauseMouseHandlers","_eventPositions","_meta","_createToolBar","which","ctrlPressed","focused","keyCode","touch","pageX","pageY","documentToModel","initialCenter","eventArgs","_gesture","_initialCenter","zoomedPoint","previousGesture","documentToView","scaleDelta","_zoom","updateZoom","_getValidZoom","_panTransform","_updateAdorners","_kendoNode","srcElement","themes","themeName","themeOptions","shapesLength","_createShapes","_createConnections","_findConnectionTarget","unbindResize","off","destroyScroller","_destroyGlobalToolBar","is","_activeElement","scrollContainer","offsets","documentElement","scrollHeight","setOptions","added","removed","_removeItem","_removeShapeDataItem","_removeConnectionDataItem","_getDiagramItems","_fixOrdering","bringIntoView","original","newPan","_zoomMainLayer","alignShapes","viewportVector","raw","hideTooltip","_getPan","animatedScrollTo","scrollTo","outerHeight","_copyOffset","copied","mapping","_updateCopiedConnection","sourceConnection","di","_containerOffset","containerOffset","viewToDocument","viewToModel","_transformWithMatrix","_matrixInvert","_matrix","_layerMatrix","layerToModel","_layerMatrixInvert","viewPoint","modelToDocument","setDataSource","_dataSource","fetch","setConnectionsDataSource","_connectionDataSource","_redrawConnections","getShapeByModelId","getShapeByModelUid","getConnectionByModelId","getConnectionByModelUid","_transformMainLayer","_finishPan","NaN","_storeViewMatrix","_storeLayerMatrix","canvasTransform","shapePos","conPos","removedConnections","_removeShape","_removeConnection","_removeDataItems","recursive","_removeShapeConnections","hasChildren","loaded","_addDataItem","_addDataItemByUid","_addDataItems","parentShape","_refreshSource","dataBound","_bindingRoots","_addItem","preventClosing","padding","popupWidth","popupHeight","connectionBounds","singleToolBar","_popup","outerWidth","showAt","one","_normalizePointZoom","undone","redone","_loadingShapes","_loadingConnections","dsOptions","ds","_shapesRefreshHandler","_shapesRequestStartHandler","_shapesErrorHandler","_refreshShapes","_shapesRequestStart","_error","DataSource","_treeDataSource","_connectionsRefreshHandler","_connectionsRequestStartHandler","_connectionsErrorHandler","_refreshConnections","_connectionsRequestStart","_connectionsError","_shouldRefresh","_removeShapes","_updateShapes","_syncShapes","_rebindShapesAndConnections","_addShapes","_addConnections","inactiveItems","activate","dataItems","_removeConnections","_updateConnections","_addConnectionDataItem","_validateConnector","_unbindDataSource","_errorHandler","adorners","_refresh","hide","exportDOMVisual","scrollOffset","viewRect","clipPath","fromRect","wrap","clipWrap","clip","exportVisual","when","deferredConnectionUpdates","ExportMixin","PDFMixin","_tools","createToolBar","createTools","appendTools","createPopup","kendoPopup","getKendoPopup","buttons","_toolBar","kendoToolBar","resizable","getKendoToolBar","createTool","toolName","attributes","_setAttributes","open","newGroup","editTool","spriteCssClass","showText","deleteTool","rotateAnticlockwiseTool","_appendGroup","_rotateGroup","rotateClockwiseTool","createShapeTool","_createGroup","createConnectionTool","undoTool","_historyGroup","redoTool","prop","_getAttributes","eventData","selectedElements","delete","selectedElemens","rotateClockwise","rotateAnticlockwise","_getFields","_initContainer","createEditable","Editable","clearContainer","modelFields","columns","formContent","_renderTemplate","_renderFields","_renderButtons","Window","userTriggered","sender","_cancelClick","_attachButtonEvents","unescape","form","_createButton","_cancelClickHandler","_updateClickHandler","_updateClick","_editUpdateClickHandler","deffered","Deferred","deferred","resolve","_add","_quadNode","_testRect","inBounds","nodeRect","nodeBottomRight","overlapsBounds","inserted","_initChildren","childIdx","halfWidth","halfHeight","ROOT_SIZE","boundsChangeHandler","_boundsChange","initRoots","rootMap","rootSize","sectors","getSectors","inRoot","bottomX","bottomY","xIdx","yIdx","plugin"],"mappings":"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","file":"kendo.dataviz.diagram.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend;\n        var DEG_TO_RAD = math.PI / 180, MAX_NUM = Number.MAX_VALUE, MIN_NUM = -Number.MAX_VALUE, UNDEFINED = 'undefined';\n        function defined(value) {\n            return typeof value !== UNDEFINED;\n        }\n        function round(value, precision) {\n            var power = pow(precision);\n            return math.round(value * power) / power;\n        }\n        function pow(p) {\n            if (p) {\n                return math.pow(10, p);\n            } else {\n                return 1;\n            }\n        }\n        function limitValue(value, min, max) {\n            return math.max(math.min(value, max), min);\n        }\n        function rad(degrees) {\n            return degrees * DEG_TO_RAD;\n        }\n        function deg(radians) {\n            return radians / DEG_TO_RAD;\n        }\n        function isNumber(val) {\n            return typeof val === 'number' && !isNaN(val);\n        }\n        function valueOrDefault(value, defaultValue) {\n            return defined(value) ? value : defaultValue;\n        }\n        function sqr(value) {\n            return value * value;\n        }\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function hashObject(object) {\n            return hashKey(objectKey(object));\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function arrayLimits(arr) {\n            var length = arr.length, i, min = MAX_NUM, max = MIN_NUM;\n            for (i = 0; i < length; i++) {\n                max = math.max(max, arr[i]);\n                min = math.min(min, arr[i]);\n            }\n            return {\n                min: min,\n                max: max\n            };\n        }\n        function arrayMin(arr) {\n            return arrayLimits(arr).min;\n        }\n        function arrayMax(arr) {\n            return arrayLimits(arr).max;\n        }\n        function sparseArrayMin(arr) {\n            return sparseArrayLimits(arr).min;\n        }\n        function sparseArrayMax(arr) {\n            return sparseArrayLimits(arr).max;\n        }\n        function sparseArrayLimits(arr) {\n            var min = MAX_NUM, max = MIN_NUM;\n            for (var i = 0, length = arr.length; i < length; i++) {\n                var n = arr[i];\n                if (n !== null && isFinite(n)) {\n                    min = math.min(min, n);\n                    max = math.max(max, n);\n                }\n            }\n            return {\n                min: min === MAX_NUM ? undefined : min,\n                max: max === MIN_NUM ? undefined : max\n            };\n        }\n        function last(array) {\n            if (array) {\n                return array[array.length - 1];\n            }\n        }\n        function append(first, second) {\n            first.push.apply(first, second);\n            return first;\n        }\n        function renderTemplate(text) {\n            return kendo.template(text, {\n                useWithBlock: false,\n                paramName: 'd'\n            });\n        }\n        function renderAttr(name, value) {\n            return defined(value) && value !== null ? ' ' + name + '=\\'' + value + '\\' ' : '';\n        }\n        function renderAllAttr(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                output += renderAttr(attrs[i][0], attrs[i][1]);\n            }\n            return output;\n        }\n        function renderStyle(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                var value = attrs[i][1];\n                if (defined(value)) {\n                    output += attrs[i][0] + ':' + value + ';';\n                }\n            }\n            if (output !== '') {\n                return output;\n            }\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function isTransparent(color) {\n            return color === '' || color === null || color === 'none' || color === 'transparent' || !defined(color);\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                if (id in cache) {\n                    return cache[id];\n                }\n                return f.apply(this, arguments);\n            };\n        }\n        function ucs2decode(string) {\n            var output = [], counter = 0, length = string.length, value, extra;\n            while (counter < length) {\n                value = string.charCodeAt(counter++);\n                if (value >= 55296 && value <= 56319 && counter < length) {\n                    extra = string.charCodeAt(counter++);\n                    if ((extra & 64512) == 56320) {\n                        output.push(((value & 1023) << 10) + (extra & 1023) + 65536);\n                    } else {\n                        output.push(value);\n                        counter--;\n                    }\n                } else {\n                    output.push(value);\n                }\n            }\n            return output;\n        }\n        function ucs2encode(array) {\n            return array.map(function (value) {\n                var output = '';\n                if (value > 65535) {\n                    value -= 65536;\n                    output += String.fromCharCode(value >>> 10 & 1023 | 55296);\n                    value = 56320 | value & 1023;\n                }\n                output += String.fromCharCode(value);\n                return output;\n            }).join('');\n        }\n        function mergeSort(a, cmp) {\n            if (a.length < 2) {\n                return a.slice();\n            }\n            function merge(a, b) {\n                var r = [], ai = 0, bi = 0, i = 0;\n                while (ai < a.length && bi < b.length) {\n                    if (cmp(a[ai], b[bi]) <= 0) {\n                        r[i++] = a[ai++];\n                    } else {\n                        r[i++] = b[bi++];\n                    }\n                }\n                if (ai < a.length) {\n                    r.push.apply(r, a.slice(ai));\n                }\n                if (bi < b.length) {\n                    r.push.apply(r, b.slice(bi));\n                }\n                return r;\n            }\n            return function sort(a) {\n                if (a.length <= 1) {\n                    return a;\n                }\n                var m = Math.floor(a.length / 2);\n                var left = a.slice(0, m);\n                var right = a.slice(m);\n                left = sort(left);\n                right = sort(right);\n                return merge(left, right);\n            }(a);\n        }\n        deepExtend(kendo, {\n            util: {\n                MAX_NUM: MAX_NUM,\n                MIN_NUM: MIN_NUM,\n                append: append,\n                arrayLimits: arrayLimits,\n                arrayMin: arrayMin,\n                arrayMax: arrayMax,\n                defined: defined,\n                deg: deg,\n                hashKey: hashKey,\n                hashObject: hashObject,\n                isNumber: isNumber,\n                isTransparent: isTransparent,\n                last: last,\n                limitValue: limitValue,\n                now: now,\n                objectKey: objectKey,\n                round: round,\n                rad: rad,\n                renderAttr: renderAttr,\n                renderAllAttr: renderAllAttr,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                renderStyle: renderStyle,\n                renderTemplate: renderTemplate,\n                sparseArrayLimits: sparseArrayLimits,\n                sparseArrayMin: sparseArrayMin,\n                sparseArrayMax: sparseArrayMax,\n                sqr: sqr,\n                valueOrDefault: valueOrDefault,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                ucs2encode: ucs2encode,\n                ucs2decode: ucs2decode,\n                mergeSort: mergeSort\n            }\n        });\n        kendo.drawing.util = kendo.util;\n        kendo.dataviz.util = kendo.util;\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    (function ($) {\n        var doc = document, kendo = window.kendo, Class = kendo.Class, util = kendo.util, defined = util.defined;\n        var LRUCache = Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var lru = this, map = lru._map, entry = {\n                        key: key,\n                        value: value\n                    };\n                map[key] = entry;\n                if (!lru._head) {\n                    lru._head = lru._tail = entry;\n                } else {\n                    lru._tail.newer = entry;\n                    entry.older = lru._tail;\n                    lru._tail = entry;\n                }\n                if (lru._length >= lru._size) {\n                    map[lru._head.key] = null;\n                    lru._head = lru._head.newer;\n                    lru._head.older = null;\n                } else {\n                    lru._length++;\n                }\n            },\n            get: function (key) {\n                var lru = this, entry = lru._map[key];\n                if (entry) {\n                    if (entry === lru._head && entry !== lru._tail) {\n                        lru._head = entry.newer;\n                        lru._head.older = null;\n                    }\n                    if (entry !== lru._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = lru._tail;\n                        entry.newer = null;\n                        lru._tail.newer = entry;\n                        lru._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        var defaultMeasureBox = $('<div style=\\'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: nowrap!important;\\' />')[0];\n        function zeroSize() {\n            return {\n                width: 0,\n                height: 0,\n                baseline: 0\n            };\n        }\n        var TextMetrics = Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this._initOptions(options);\n            },\n            options: { baselineMarkerSize: 1 },\n            measure: function (text, style, box) {\n                if (!text) {\n                    return zeroSize();\n                }\n                var styleKey = util.objectKey(style), cacheKey = util.hashKey(text + styleKey), cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = zeroSize();\n                var measureBox = box ? box : defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (defined(value)) {\n                        measureBox.style[key] = value;\n                    }\n                }\n                $(measureBox).text(text);\n                measureBox.appendChild(baselineMarker);\n                doc.body.appendChild(measureBox);\n                if ((text + '').length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                return $('<div class=\\'k-baseline-marker\\' ' + 'style=\\'display: inline-block; vertical-align: baseline;' + 'width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;' + 'overflow: hidden;\\' />')[0];\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        function loadFonts(fonts, callback) {\n            var promises = [];\n            if (fonts.length > 0 && document.fonts) {\n                try {\n                    promises = fonts.map(function (font) {\n                        return document.fonts.load(font);\n                    });\n                } catch (e) {\n                    kendo.logToConsole(e);\n                }\n                Promise.all(promises).then(callback, callback);\n            } else {\n                callback();\n            }\n        }\n        kendo.util.TextMetrics = TextMetrics;\n        kendo.util.LRUCache = LRUCache;\n        kendo.util.loadFonts = loadFonts;\n        kendo.util.measureText = measureText;\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/base64', ['util/main'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend, fromCharCode = String.fromCharCode;\n        var KEY_STR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        function encodeBase64(input) {\n            var output = '';\n            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n            var i = 0;\n            input = encodeUTF8(input);\n            while (i < input.length) {\n                chr1 = input.charCodeAt(i++);\n                chr2 = input.charCodeAt(i++);\n                chr3 = input.charCodeAt(i++);\n                enc1 = chr1 >> 2;\n                enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n                enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n                enc4 = chr3 & 63;\n                if (isNaN(chr2)) {\n                    enc3 = enc4 = 64;\n                } else if (isNaN(chr3)) {\n                    enc4 = 64;\n                }\n                output = output + KEY_STR.charAt(enc1) + KEY_STR.charAt(enc2) + KEY_STR.charAt(enc3) + KEY_STR.charAt(enc4);\n            }\n            return output;\n        }\n        function encodeUTF8(input) {\n            var output = '';\n            for (var i = 0; i < input.length; i++) {\n                var c = input.charCodeAt(i);\n                if (c < 128) {\n                    output += fromCharCode(c);\n                } else if (c < 2048) {\n                    output += fromCharCode(192 | c >>> 6);\n                    output += fromCharCode(128 | c & 63);\n                } else if (c < 65536) {\n                    output += fromCharCode(224 | c >>> 12);\n                    output += fromCharCode(128 | c >>> 6 & 63);\n                    output += fromCharCode(128 | c & 63);\n                }\n            }\n            return output;\n        }\n        deepExtend(kendo.util, {\n            encodeBase64: encodeBase64,\n            encodeUTF8: encodeUTF8\n        });\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('mixins/observers', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend, inArray = $.inArray;\n        var ObserversMixin = {\n            observers: function () {\n                this._observers = this._observers || [];\n                return this._observers;\n            },\n            addObserver: function (element) {\n                if (!this._observers) {\n                    this._observers = [element];\n                } else {\n                    this._observers.push(element);\n                }\n                return this;\n            },\n            removeObserver: function (element) {\n                var observers = this.observers();\n                var index = inArray(element, observers);\n                if (index != -1) {\n                    observers.splice(index, 1);\n                }\n                return this;\n            },\n            trigger: function (methodName, event) {\n                var observers = this._observers;\n                var observer;\n                var idx;\n                if (observers && !this._suspended) {\n                    for (idx = 0; idx < observers.length; idx++) {\n                        observer = observers[idx];\n                        if (observer[methodName]) {\n                            observer[methodName](event);\n                        }\n                    }\n                }\n                return this;\n            },\n            optionsChange: function (e) {\n                e = e || {};\n                e.element = this;\n                this.trigger('optionsChange', e);\n            },\n            geometryChange: function () {\n                this.trigger('geometryChange', { element: this });\n            },\n            suspend: function () {\n                this._suspended = (this._suspended || 0) + 1;\n                return this;\n            },\n            resume: function () {\n                this._suspended = math.max((this._suspended || 0) - 1, 0);\n                return this;\n            },\n            _observerField: function (field, value) {\n                if (this[field]) {\n                    this[field].removeObserver(this);\n                }\n                this[field] = value;\n                value.addObserver(this);\n            }\n        };\n        deepExtend(kendo, { mixins: { ObserversMixin: ObserversMixin } });\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('dataviz/diagram/utils', ['kendo.core'], f);\n}(function () {\n    (function ($, undefined) {\n        var kendo = window.kendo, diagram = kendo.dataviz.diagram = {}, deepExtend = kendo.deepExtend, isArray = $.isArray, EPSILON = 0.000001;\n        var Utils = {};\n        deepExtend(Utils, {\n            isNearZero: function (num) {\n                return Math.abs(num) < EPSILON;\n            },\n            isDefined: function (obj) {\n                return typeof obj !== 'undefined';\n            },\n            isUndefined: function (obj) {\n                return typeof obj === 'undefined' || obj === null;\n            },\n            isObject: function (obj) {\n                return obj === Object(obj);\n            },\n            has: function (obj, key) {\n                return Object.hasOwnProperty.call(obj, key);\n            },\n            isString: function (obj) {\n                return Object.prototype.toString.call(obj) == '[object String]';\n            },\n            isBoolean: function (obj) {\n                return Object.prototype.toString.call(obj) == '[object Boolean]';\n            },\n            isType: function (obj, type) {\n                return Object.prototype.toString.call(obj) == '[object ' + type + ']';\n            },\n            isNumber: function (obj) {\n                return !isNaN(parseFloat(obj)) && isFinite(obj);\n            },\n            isEmpty: function (obj) {\n                if (obj === null) {\n                    return true;\n                }\n                if (isArray(obj) || Utils.isString(obj)) {\n                    return obj.length === 0;\n                }\n                for (var key in obj) {\n                    if (Utils.has(obj, key)) {\n                        return false;\n                    }\n                }\n                return true;\n            },\n            simpleExtend: function (destination, source) {\n                if (!Utils.isObject(source)) {\n                    return;\n                }\n                for (var name in source) {\n                    destination[name] = source[name];\n                }\n            },\n            initArray: function createIdArray(size, value) {\n                var array = [];\n                for (var i = 0; i < size; ++i) {\n                    array[i] = value;\n                }\n                return array;\n            },\n            serializePoints: function (points) {\n                var res = [];\n                for (var i = 0; i < points.length; i++) {\n                    var p = points[i];\n                    res.push(p.x + ';' + p.y);\n                }\n                return res.join(';');\n            },\n            deserializePoints: function (s) {\n                var v = s.split(';'), points = [];\n                if (v.length % 2 !== 0) {\n                    throw 'Not an array of points.';\n                }\n                for (var i = 0; i < v.length; i += 2) {\n                    points.push(new diagram.Point(parseInt(v[i], 10), parseInt(v[i + 1], 10)));\n                }\n                return points;\n            },\n            randomInteger: function (lower, upper) {\n                return parseInt(Math.floor(Math.random() * upper) + lower, 10);\n            },\n            DFT: function (el, func) {\n                func(el);\n                if (el.childNodes) {\n                    for (var i = 0; i < el.childNodes.length; i++) {\n                        var item = el.childNodes[i];\n                        this.DFT(item, func);\n                    }\n                }\n            },\n            getMatrixAngle: function (m) {\n                if (m === null || m.d === 0) {\n                    return 0;\n                }\n                return Math.atan2(m.b, m.d) * 180 / Math.PI;\n            },\n            getMatrixScaling: function (m) {\n                var sX = Math.sqrt(m.a * m.a + m.c * m.c);\n                var sY = Math.sqrt(m.b * m.b + m.d * m.d);\n                return [\n                    sX,\n                    sY\n                ];\n            }\n        });\n        function Range(start, stop, step) {\n            if (typeof start == 'undefined' || typeof stop == 'undefined') {\n                return [];\n            }\n            if (step && Utils.sign(stop - start) != Utils.sign(step)) {\n                throw 'The sign of the increment should allow to reach the stop-value.';\n            }\n            step = step || 1;\n            start = start || 0;\n            stop = stop || start;\n            if ((stop - start) / step === Infinity) {\n                throw 'Infinite range defined.';\n            }\n            var range = [], i = -1, j;\n            function rangeIntegerScale(x) {\n                var k = 1;\n                while (x * k % 1) {\n                    k *= 10;\n                }\n                return k;\n            }\n            var k = rangeIntegerScale(Math.abs(step));\n            start *= k;\n            stop *= k;\n            step *= k;\n            if (start > stop && step > 0) {\n                step = -step;\n            }\n            if (step < 0) {\n                while ((j = start + step * ++i) >= stop) {\n                    range.push(j / k);\n                }\n            } else {\n                while ((j = start + step * ++i) <= stop) {\n                    range.push(j / k);\n                }\n            }\n            return range;\n        }\n        function findRadian(start, end) {\n            if (start == end) {\n                return 0;\n            }\n            var sngXComp = end.x - start.x, sngYComp = start.y - end.y, atan = Math.atan(sngXComp / sngYComp);\n            if (sngYComp >= 0) {\n                return sngXComp < 0 ? atan + 2 * Math.PI : atan;\n            }\n            return atan + Math.PI;\n        }\n        Utils.sign = function (number) {\n            return number ? number < 0 ? -1 : 1 : 0;\n        };\n        Utils.findAngle = function (center, end) {\n            return findRadian(center, end) * 180 / Math.PI;\n        };\n        Utils.forEach = function (arr, iterator, thisRef) {\n            for (var i = 0; i < arr.length; i++) {\n                iterator.call(thisRef, arr[i], i, arr);\n            }\n        };\n        Utils.any = function (arr, predicate) {\n            for (var i = 0; i < arr.length; ++i) {\n                if (predicate(arr[i])) {\n                    return arr[i];\n                }\n            }\n            return null;\n        };\n        Utils.remove = function (arr, what) {\n            var ax;\n            while ((ax = Utils.indexOf(arr, what)) !== -1) {\n                arr.splice(ax, 1);\n            }\n            return arr;\n        };\n        Utils.contains = function (arr, obj) {\n            return Utils.indexOf(arr, obj) !== -1;\n        };\n        Utils.indexOf = function (arr, what) {\n            return $.inArray(what, arr);\n        };\n        Utils.fold = function (list, iterator, acc, context) {\n            var initial = arguments.length > 2;\n            for (var i = 0; i < list.length; i++) {\n                var value = list[i];\n                if (!initial) {\n                    acc = value;\n                    initial = true;\n                } else {\n                    acc = iterator.call(context, acc, value, i, list);\n                }\n            }\n            if (!initial) {\n                throw 'Reduce of empty array with no initial value';\n            }\n            return acc;\n        };\n        Utils.find = function (arr, iterator, context) {\n            var result;\n            Utils.any(arr, function (value, index, list) {\n                if (iterator.call(context, value, index, list)) {\n                    result = value;\n                    return true;\n                }\n                return false;\n            });\n            return result;\n        };\n        Utils.first = function (arr, constraint, context) {\n            if (arr.length === 0) {\n                return null;\n            }\n            if (Utils.isUndefined(constraint)) {\n                return arr[0];\n            }\n            return Utils.find(arr, constraint, context);\n        };\n        Utils.insert = function (arr, element, position) {\n            arr.splice(position, 0, element);\n            return arr;\n        };\n        Utils.all = function (arr, iterator, context) {\n            var result = true;\n            var value;\n            for (var i = 0; i < arr.length; i++) {\n                value = arr[i];\n                result = result && iterator.call(context, value, i, arr);\n                if (!result) {\n                    break;\n                }\n            }\n            return result;\n        };\n        Utils.clear = function (arr) {\n            arr.splice(0, arr.length);\n        };\n        Utils.bisort = function (a, b, sortfunc) {\n            if (Utils.isUndefined(a)) {\n                throw 'First array is not specified.';\n            }\n            if (Utils.isUndefined(b)) {\n                throw 'Second array is not specified.';\n            }\n            if (a.length != b.length) {\n                throw 'The two arrays should have equal length';\n            }\n            var all = [], i;\n            for (i = 0; i < a.length; i++) {\n                all.push({\n                    'x': a[i],\n                    'y': b[i]\n                });\n            }\n            if (Utils.isUndefined(sortfunc)) {\n                all.sort(function (m, n) {\n                    return m.x - n.x;\n                });\n            } else {\n                all.sort(function (m, n) {\n                    return sortfunc(m.x, n.x);\n                });\n            }\n            Utils.clear(a);\n            Utils.clear(b);\n            for (i = 0; i < all.length; i++) {\n                a.push(all[i].x);\n                b.push(all[i].y);\n            }\n        };\n        Utils.addRange = function (arr, range) {\n            arr.push.apply(arr, range);\n        };\n        var Easing = {\n            easeInOut: function (pos) {\n                return -Math.cos(pos * Math.PI) / 2 + 0.5;\n            }\n        };\n        var Ticker = kendo.Class.extend({\n            init: function () {\n                this.adapters = [];\n                this.target = 0;\n                this.tick = 0;\n                this.interval = 20;\n                this.duration = 800;\n                this.lastTime = null;\n                this.handlers = [];\n                var _this = this;\n                this.transition = Easing.easeInOut;\n                this.timerDelegate = function () {\n                    _this.onTimerEvent();\n                };\n            },\n            addAdapter: function (a) {\n                this.adapters.push(a);\n            },\n            onComplete: function (handler) {\n                this.handlers.push(handler);\n            },\n            removeHandler: function (handler) {\n                this.handlers = $.grep(this.handlers, function (h) {\n                    return h !== handler;\n                });\n            },\n            trigger: function () {\n                var _this = this;\n                if (this.handlers) {\n                    Utils.forEach(this.handlers, function (h) {\n                        return h.call(_this.caller !== null ? _this.caller : _this);\n                    });\n                }\n            },\n            onStep: function () {\n            },\n            seekTo: function (to) {\n                this.seekFromTo(this.tick, to);\n            },\n            seekFromTo: function (from, to) {\n                this.target = Math.max(0, Math.min(1, to));\n                this.tick = Math.max(0, Math.min(1, from));\n                this.lastTime = new Date().getTime();\n                if (!this.intervalId) {\n                    this.intervalId = window.setInterval(this.timerDelegate, this.interval);\n                }\n            },\n            stop: function () {\n                if (this.intervalId) {\n                    window.clearInterval(this.intervalId);\n                    this.intervalId = null;\n                    this.trigger();\n                }\n            },\n            play: function (origin) {\n                if (this.adapters.length === 0) {\n                    return;\n                }\n                if (origin !== null) {\n                    this.caller = origin;\n                }\n                this.initState();\n                this.seekFromTo(0, 1);\n            },\n            reverse: function () {\n                this.seekFromTo(1, 0);\n            },\n            initState: function () {\n                if (this.adapters.length === 0) {\n                    return;\n                }\n                for (var i = 0; i < this.adapters.length; i++) {\n                    this.adapters[i].initState();\n                }\n            },\n            propagate: function () {\n                var value = this.transition(this.tick);\n                for (var i = 0; i < this.adapters.length; i++) {\n                    this.adapters[i].update(value);\n                }\n            },\n            onTimerEvent: function () {\n                var now = new Date().getTime();\n                var timePassed = now - this.lastTime;\n                this.lastTime = now;\n                var movement = timePassed / this.duration * (this.tick < this.target ? 1 : -1);\n                if (Math.abs(movement) >= Math.abs(this.tick - this.target)) {\n                    this.tick = this.target;\n                } else {\n                    this.tick += movement;\n                }\n                try {\n                    this.propagate();\n                } finally {\n                    this.onStep.call(this);\n                    if (this.target == this.tick) {\n                        this.stop();\n                    }\n                }\n            }\n        });\n        kendo.deepExtend(diagram, {\n            init: function (element) {\n                kendo.init(element, diagram.ui);\n            },\n            Utils: Utils,\n            Range: Range,\n            Ticker: Ticker\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('dataviz/diagram/math', [\n        'dataviz/diagram/utils',\n        'kendo.dataviz.core'\n    ], f);\n}(function () {\n    (function ($, undefined) {\n        var kendo = window.kendo, diagram = kendo.dataviz.diagram, Class = kendo.Class, deepExtend = kendo.deepExtend, dataviz = kendo.dataviz, Utils = diagram.Utils, Point = dataviz.Point2D, isFunction = kendo.isFunction, contains = Utils.contains, map = $.map;\n        var HITTESTAREA = 3, EPSILON = 0.000001;\n        deepExtend(Point.fn, {\n            plus: function (p) {\n                return new Point(this.x + p.x, this.y + p.y);\n            },\n            minus: function (p) {\n                return new Point(this.x - p.x, this.y - p.y);\n            },\n            offset: function (value) {\n                return new Point(this.x - value, this.y - value);\n            },\n            times: function (s) {\n                return new Point(this.x * s, this.y * s);\n            },\n            normalize: function () {\n                if (this.length() === 0) {\n                    return new Point();\n                }\n                return this.times(1 / this.length());\n            },\n            length: function () {\n                return Math.sqrt(this.x * this.x + this.y * this.y);\n            },\n            toString: function () {\n                return '(' + this.x + ',' + this.y + ')';\n            },\n            lengthSquared: function () {\n                return this.x * this.x + this.y * this.y;\n            },\n            middleOf: function MiddleOf(p, q) {\n                return new Point(q.x - p.x, q.y - p.y).times(0.5).plus(p);\n            },\n            toPolar: function (useDegrees) {\n                var factor = 1;\n                if (useDegrees) {\n                    factor = 180 / Math.PI;\n                }\n                var a = Math.atan2(Math.abs(this.y), Math.abs(this.x));\n                var halfpi = Math.PI / 2;\n                var len = this.length();\n                if (this.x === 0) {\n                    if (this.y === 0) {\n                        return new Polar(0, 0);\n                    }\n                    if (this.y > 0) {\n                        return new Polar(len, factor * halfpi);\n                    }\n                    if (this.y < 0) {\n                        return new Polar(len, factor * 3 * halfpi);\n                    }\n                } else if (this.x > 0) {\n                    if (this.y === 0) {\n                        return new Polar(len, 0);\n                    }\n                    if (this.y > 0) {\n                        return new Polar(len, factor * a);\n                    }\n                    if (this.y < 0) {\n                        return new Polar(len, factor * (4 * halfpi - a));\n                    }\n                } else {\n                    if (this.y === 0) {\n                        return new Polar(len, 2 * halfpi);\n                    }\n                    if (this.y > 0) {\n                        return new Polar(len, factor * (2 * halfpi - a));\n                    }\n                    if (this.y < 0) {\n                        return new Polar(len, factor * (2 * halfpi + a));\n                    }\n                }\n            },\n            isOnLine: function (from, to) {\n                if (from.x > to.x) {\n                    var temp = to;\n                    to = from;\n                    from = temp;\n                }\n                var r1 = new Rect(from.x, from.y).inflate(HITTESTAREA, HITTESTAREA), r2 = new Rect(to.x, to.y).inflate(HITTESTAREA, HITTESTAREA), o1, u1;\n                if (r1.union(r2).contains(this)) {\n                    if (from.x === to.x || from.y === to.y) {\n                        return true;\n                    } else if (from.y < to.y) {\n                        o1 = r1.x + (r2.x - r1.x) * (this.y - (r1.y + r1.height)) / (r2.y + r2.height - (r1.y + r1.height));\n                        u1 = r1.x + r1.width + (r2.x + r2.width - (r1.x + r1.width)) * (this.y - r1.y) / (r2.y - r1.y);\n                    } else {\n                        o1 = r1.x + (r2.x - r1.x) * (this.y - r1.y) / (r2.y - r1.y);\n                        u1 = r1.x + r1.width + (r2.x + r2.width - (r1.x + r1.width)) * (this.y - (r1.y + r1.height)) / (r2.y + r2.height - (r1.y + r1.height));\n                    }\n                    return this.x > o1 && this.x < u1;\n                }\n                return false;\n            }\n        });\n        deepExtend(Point, {\n            parse: function (str) {\n                var tempStr = str.slice(1, str.length - 1), xy = tempStr.split(','), x = parseInt(xy[0], 10), y = parseInt(xy[1], 10);\n                if (!isNaN(x) && !isNaN(y)) {\n                    return new Point(x, y);\n                }\n            }\n        });\n        var PathDefiner = Class.extend({\n            init: function (p, left, right) {\n                this.point = p;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var Rect = Class.extend({\n            init: function (x, y, width, height) {\n                this.x = x || 0;\n                this.y = y || 0;\n                this.width = width || 0;\n                this.height = height || 0;\n            },\n            contains: function (point) {\n                return point.x >= this.x && point.x <= this.x + this.width && point.y >= this.y && point.y <= this.y + this.height;\n            },\n            inflate: function (dx, dy) {\n                if (dy === undefined) {\n                    dy = dx;\n                }\n                this.x -= dx;\n                this.y -= dy;\n                this.width += 2 * dx + 1;\n                this.height += 2 * dy + 1;\n                return this;\n            },\n            offset: function (dx, dy) {\n                var x = dx, y = dy;\n                if (dx instanceof Point) {\n                    x = dx.x;\n                    y = dx.y;\n                }\n                this.x += x;\n                this.y += y;\n                return this;\n            },\n            union: function (r) {\n                var x1 = Math.min(this.x, r.x);\n                var y1 = Math.min(this.y, r.y);\n                var x2 = Math.max(this.x + this.width, r.x + r.width);\n                var y2 = Math.max(this.y + this.height, r.y + r.height);\n                return new Rect(x1, y1, x2 - x1, y2 - y1);\n            },\n            center: function () {\n                return new Point(this.x + this.width / 2, this.y + this.height / 2);\n            },\n            top: function () {\n                return new Point(this.x + this.width / 2, this.y);\n            },\n            right: function () {\n                return new Point(this.x + this.width, this.y + this.height / 2);\n            },\n            bottom: function () {\n                return new Point(this.x + this.width / 2, this.y + this.height);\n            },\n            left: function () {\n                return new Point(this.x, this.y + this.height / 2);\n            },\n            topLeft: function () {\n                return new Point(this.x, this.y);\n            },\n            topRight: function () {\n                return new Point(this.x + this.width, this.y);\n            },\n            bottomLeft: function () {\n                return new Point(this.x, this.y + this.height);\n            },\n            bottomRight: function () {\n                return new Point(this.x + this.width, this.y + this.height);\n            },\n            clone: function () {\n                return new Rect(this.x, this.y, this.width, this.height);\n            },\n            isEmpty: function () {\n                return !this.width && !this.height;\n            },\n            equals: function (rect) {\n                return this.x === rect.x && this.y === rect.y && this.width === rect.width && this.height === rect.height;\n            },\n            rotatedBounds: function (angle) {\n                var rect = this.clone(), points = this.rotatedPoints(angle), tl = points[0], tr = points[1], br = points[2], bl = points[3];\n                rect.x = Math.min(br.x, tl.x, tr.x, bl.x);\n                rect.y = Math.min(br.y, tl.y, tr.y, bl.y);\n                rect.width = Math.max(br.x, tl.x, tr.x, bl.x) - rect.x;\n                rect.height = Math.max(br.y, tl.y, tr.y, bl.y) - rect.y;\n                return rect;\n            },\n            rotatedPoints: function (angle) {\n                var rect = this, c = rect.center(), br = rect.bottomRight().rotate(c, 360 - angle), tl = rect.topLeft().rotate(c, 360 - angle), tr = rect.topRight().rotate(c, 360 - angle), bl = rect.bottomLeft().rotate(c, 360 - angle);\n                return [\n                    tl,\n                    tr,\n                    br,\n                    bl\n                ];\n            },\n            toString: function (delimiter) {\n                delimiter = delimiter || ' ';\n                return this.x + delimiter + this.y + delimiter + this.width + delimiter + this.height;\n            },\n            scale: function (scaleX, scaleY, staicPoint, adornerCenter, angle) {\n                var tl = this.topLeft();\n                var thisCenter = this.center();\n                tl.rotate(thisCenter, 360 - angle).rotate(adornerCenter, angle);\n                var delta = staicPoint.minus(tl);\n                var scaled = new Point(delta.x * scaleX, delta.y * scaleY);\n                var position = delta.minus(scaled);\n                tl = tl.plus(position);\n                tl.rotate(adornerCenter, 360 - angle).rotate(thisCenter, angle);\n                this.x = tl.x;\n                this.y = tl.y;\n                this.width *= scaleX;\n                this.height *= scaleY;\n            },\n            zoom: function (zoom) {\n                this.x *= zoom;\n                this.y *= zoom;\n                this.width *= zoom;\n                this.height *= zoom;\n                return this;\n            },\n            overlaps: function (rect) {\n                var bottomRight = this.bottomRight();\n                var rectBottomRight = rect.bottomRight();\n                var overlaps = !(bottomRight.x < rect.x || bottomRight.y < rect.y || rectBottomRight.x < this.x || rectBottomRight.y < this.y);\n                return overlaps;\n            }\n        });\n        var Size = Class.extend({\n            init: function (width, height) {\n                this.width = width;\n                this.height = height;\n            }\n        });\n        Size.prototype.Empty = new Size(0, 0);\n        Rect.toRect = function (rect) {\n            if (!(rect instanceof Rect)) {\n                rect = new Rect(rect.x, rect.y, rect.width, rect.height);\n            }\n            return rect;\n        };\n        Rect.empty = function () {\n            return new Rect(0, 0, 0, 0);\n        };\n        Rect.fromPoints = function (p, q) {\n            if (isNaN(p.x) || isNaN(p.y) || isNaN(q.x) || isNaN(q.y)) {\n                throw 'Some values are NaN.';\n            }\n            return new Rect(Math.min(p.x, q.x), Math.min(p.y, q.y), Math.abs(p.x - q.x), Math.abs(p.y - q.y));\n        };\n        function isNearZero(num) {\n            return Math.abs(num) < EPSILON;\n        }\n        function intersectLine(start1, end1, start2, end2, isSegment) {\n            var tangensdiff = (end1.x - start1.x) * (end2.y - start2.y) - (end1.y - start1.y) * (end2.x - start2.x);\n            if (isNearZero(tangensdiff)) {\n                return;\n            }\n            var num1 = (start1.y - start2.y) * (end2.x - start2.x) - (start1.x - start2.x) * (end2.y - start2.y);\n            var num2 = (start1.y - start2.y) * (end1.x - start1.x) - (start1.x - start2.x) * (end1.y - start1.y);\n            var r = num1 / tangensdiff;\n            var s = num2 / tangensdiff;\n            if (isSegment && (r < 0 || r > 1 || s < 0 || s > 1)) {\n                return;\n            }\n            return new Point(start1.x + r * (end1.x - start1.x), start1.y + r * (end1.y - start1.y));\n        }\n        var Intersect = {\n            lines: function (start1, end1, start2, end2) {\n                return intersectLine(start1, end1, start2, end2);\n            },\n            segments: function (start1, end1, start2, end2) {\n                return intersectLine(start1, end1, start2, end2, true);\n            },\n            rectWithLine: function (rect, start, end) {\n                return Intersect.segments(start, end, rect.topLeft(), rect.topRight()) || Intersect.segments(start, end, rect.topRight(), rect.bottomRight()) || Intersect.segments(start, end, rect.bottomLeft(), rect.bottomRight()) || Intersect.segments(start, end, rect.topLeft(), rect.bottomLeft());\n            },\n            rects: function (rect1, rect2, angle) {\n                var tl = rect2.topLeft(), tr = rect2.topRight(), bl = rect2.bottomLeft(), br = rect2.bottomRight();\n                var center = rect2.center();\n                if (angle) {\n                    tl = tl.rotate(center, angle);\n                    tr = tr.rotate(center, angle);\n                    bl = bl.rotate(center, angle);\n                    br = br.rotate(center, angle);\n                }\n                var intersect = rect1.contains(tl) || rect1.contains(tr) || rect1.contains(bl) || rect1.contains(br) || Intersect.rectWithLine(rect1, tl, tr) || Intersect.rectWithLine(rect1, tl, bl) || Intersect.rectWithLine(rect1, tr, br) || Intersect.rectWithLine(rect1, bl, br);\n                if (!intersect) {\n                    tl = rect1.topLeft();\n                    tr = rect1.topRight();\n                    bl = rect1.bottomLeft();\n                    br = rect1.bottomRight();\n                    if (angle) {\n                        var reverseAngle = 360 - angle;\n                        tl = tl.rotate(center, reverseAngle);\n                        tr = tr.rotate(center, reverseAngle);\n                        bl = bl.rotate(center, reverseAngle);\n                        br = br.rotate(center, reverseAngle);\n                    }\n                    intersect = rect2.contains(tl) || rect2.contains(tr) || rect2.contains(bl) || rect2.contains(br);\n                }\n                return intersect;\n            }\n        };\n        var RectAlign = Class.extend({\n            init: function (container) {\n                this.container = Rect.toRect(container);\n            },\n            align: function (content, alignment) {\n                var alignValues = alignment.toLowerCase().split(' ');\n                for (var i = 0; i < alignValues.length; i++) {\n                    content = this._singleAlign(content, alignValues[i]);\n                }\n                return content;\n            },\n            _singleAlign: function (content, alignment) {\n                if (isFunction(this[alignment])) {\n                    return this[alignment](content);\n                } else {\n                    return content;\n                }\n            },\n            left: function (content) {\n                return this._align(content, this._left);\n            },\n            center: function (content) {\n                return this._align(content, this._center);\n            },\n            right: function (content) {\n                return this._align(content, this._right);\n            },\n            stretch: function (content) {\n                return this._align(content, this._stretch);\n            },\n            top: function (content) {\n                return this._align(content, this._top);\n            },\n            middle: function (content) {\n                return this._align(content, this._middle);\n            },\n            bottom: function (content) {\n                return this._align(content, this._bottom);\n            },\n            _left: function (container, content) {\n                content.x = container.x;\n            },\n            _center: function (container, content) {\n                content.x = (container.width - content.width) / 2 || 0;\n            },\n            _right: function (container, content) {\n                content.x = container.width - content.width;\n            },\n            _top: function (container, content) {\n                content.y = container.y;\n            },\n            _middle: function (container, content) {\n                content.y = (container.height - content.height) / 2 || 0;\n            },\n            _bottom: function (container, content) {\n                content.y = container.height - content.height;\n            },\n            _stretch: function (container, content) {\n                content.x = 0;\n                content.y = 0;\n                content.height = container.height;\n                content.width = container.width;\n            },\n            _align: function (content, alignCalc) {\n                content = Rect.toRect(content);\n                alignCalc(this.container, content);\n                return content;\n            }\n        });\n        var Polar = Class.extend({\n            init: function (r, a) {\n                this.r = r;\n                this.angle = a;\n            }\n        });\n        var Matrix = Class.extend({\n            init: function (a, b, c, d, e, f) {\n                this.a = a || 0;\n                this.b = b || 0;\n                this.c = c || 0;\n                this.d = d || 0;\n                this.e = e || 0;\n                this.f = f || 0;\n            },\n            plus: function (m) {\n                this.a += m.a;\n                this.b += m.b;\n                this.c += m.c;\n                this.d += m.d;\n                this.e += m.e;\n                this.f += m.f;\n            },\n            minus: function (m) {\n                this.a -= m.a;\n                this.b -= m.b;\n                this.c -= m.c;\n                this.d -= m.d;\n                this.e -= m.e;\n                this.f -= m.f;\n            },\n            times: function (m) {\n                return new Matrix(this.a * m.a + this.c * m.b, this.b * m.a + this.d * m.b, this.a * m.c + this.c * m.d, this.b * m.c + this.d * m.d, this.a * m.e + this.c * m.f + this.e, this.b * m.e + this.d * m.f + this.f);\n            },\n            apply: function (p) {\n                return new Point(this.a * p.x + this.c * p.y + this.e, this.b * p.x + this.d * p.y + this.f);\n            },\n            applyRect: function (r) {\n                return Rect.fromPoints(this.apply(r.topLeft()), this.apply(r.bottomRight()));\n            },\n            toString: function () {\n                return 'matrix(' + this.a + ' ' + this.b + ' ' + this.c + ' ' + this.d + ' ' + this.e + ' ' + this.f + ')';\n            }\n        });\n        deepExtend(Matrix, {\n            fromSVGMatrix: function (vm) {\n                var m = new Matrix();\n                m.a = vm.a;\n                m.b = vm.b;\n                m.c = vm.c;\n                m.d = vm.d;\n                m.e = vm.e;\n                m.f = vm.f;\n                return m;\n            },\n            fromMatrixVector: function (v) {\n                var m = new Matrix();\n                m.a = v.a;\n                m.b = v.b;\n                m.c = v.c;\n                m.d = v.d;\n                m.e = v.e;\n                m.f = v.f;\n                return m;\n            },\n            fromList: function (v) {\n                if (v.length !== 6) {\n                    throw 'The given list should consist of six elements.';\n                }\n                var m = new Matrix();\n                m.a = v[0];\n                m.b = v[1];\n                m.c = v[2];\n                m.d = v[3];\n                m.e = v[4];\n                m.f = v[5];\n                return m;\n            },\n            translation: function (x, y) {\n                var m = new Matrix();\n                m.a = 1;\n                m.b = 0;\n                m.c = 0;\n                m.d = 1;\n                m.e = x;\n                m.f = y;\n                return m;\n            },\n            unit: function () {\n                return new Matrix(1, 0, 0, 1, 0, 0);\n            },\n            rotation: function (angle, x, y) {\n                var m = new Matrix();\n                m.a = Math.cos(angle * Math.PI / 180);\n                m.b = Math.sin(angle * Math.PI / 180);\n                m.c = -m.b;\n                m.d = m.a;\n                m.e = x - x * m.a + y * m.b || 0;\n                m.f = y - y * m.a - x * m.b || 0;\n                return m;\n            },\n            scaling: function (scaleX, scaleY) {\n                var m = new Matrix();\n                m.a = scaleX;\n                m.b = 0;\n                m.c = 0;\n                m.d = scaleY;\n                m.e = 0;\n                m.f = 0;\n                return m;\n            },\n            parse: function (v) {\n                var parts, nums;\n                if (v) {\n                    v = v.trim();\n                    if (v.slice(0, 6).toLowerCase() === 'matrix') {\n                        nums = v.slice(7, v.length - 1).trim();\n                        parts = nums.split(',');\n                        if (parts.length === 6) {\n                            return Matrix.fromList(map(parts, function (p) {\n                                return parseFloat(p);\n                            }));\n                        }\n                        parts = nums.split(' ');\n                        if (parts.length === 6) {\n                            return Matrix.fromList(map(parts, function (p) {\n                                return parseFloat(p);\n                            }));\n                        }\n                    }\n                    if (v.slice(0, 1) === '(' && v.slice(v.length - 1) === ')') {\n                        v = v.substr(1, v.length - 1);\n                    }\n                    if (v.indexOf(',') > 0) {\n                        parts = v.split(',');\n                        if (parts.length === 6) {\n                            return Matrix.fromList(map(parts, function (p) {\n                                return parseFloat(p);\n                            }));\n                        }\n                    }\n                    if (v.indexOf(' ') > 0) {\n                        parts = v.split(' ');\n                        if (parts.length === 6) {\n                            return Matrix.fromList(map(parts, function (p) {\n                                return parseFloat(p);\n                            }));\n                        }\n                    }\n                }\n                return parts;\n            }\n        });\n        var MatrixVector = Class.extend({\n            init: function (a, b, c, d, e, f) {\n                this.a = a || 0;\n                this.b = b || 0;\n                this.c = c || 0;\n                this.d = d || 0;\n                this.e = e || 0;\n                this.f = f || 0;\n            },\n            fromMatrix: function FromMatrix(m) {\n                var v = new MatrixVector();\n                v.a = m.a;\n                v.b = m.b;\n                v.c = m.c;\n                v.d = m.d;\n                v.e = m.e;\n                v.f = m.f;\n                return v;\n            }\n        });\n        function normalVariable(mean, deviation) {\n            var x, y, r;\n            do {\n                x = Math.random() * 2 - 1;\n                y = Math.random() * 2 - 1;\n                r = x * x + y * y;\n            } while (!r || r > 1);\n            return mean + deviation * x * Math.sqrt(-2 * Math.log(r) / r);\n        }\n        function randomId(length) {\n            if (Utils.isUndefined(length)) {\n                length = 10;\n            }\n            var result = '';\n            var chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n            for (var i = length; i > 0; --i) {\n                result += chars.charAt(Math.round(Math.random() * (chars.length - 1)));\n            }\n            return result;\n        }\n        var Geometry = {\n            _distanceToLineSquared: function (p, a, b) {\n                function d2(pt1, pt2) {\n                    return (pt1.x - pt2.x) * (pt1.x - pt2.x) + (pt1.y - pt2.y) * (pt1.y - pt2.y);\n                }\n                if (a === b) {\n                    return d2(p, a);\n                }\n                var vx = b.x - a.x, vy = b.y - a.y, dot = (p.x - a.x) * vx + (p.y - a.y) * vy;\n                if (dot < 0) {\n                    return d2(a, p);\n                }\n                dot = (b.x - p.x) * vx + (b.y - p.y) * vy;\n                if (dot < 0) {\n                    return d2(b, p);\n                }\n                dot = (b.x - p.x) * vy - (b.y - p.y) * vx;\n                return dot * dot / (vx * vx + vy * vy);\n            },\n            distanceToLine: function (p, a, b) {\n                return Math.sqrt(this._distanceToLineSquared(p, a, b));\n            },\n            distanceToPolyline: function (p, points) {\n                var minimum = Number.MAX_VALUE;\n                if (Utils.isUndefined(points) || points.length === 0) {\n                    return Number.MAX_VALUE;\n                }\n                for (var s = 0; s < points.length - 1; s++) {\n                    var p1 = points[s];\n                    var p2 = points[s + 1];\n                    var d = this._distanceToLineSquared(p, p1, p2);\n                    if (d < minimum) {\n                        minimum = d;\n                    }\n                }\n                return Math.sqrt(minimum);\n            }\n        };\n        var HashTable = kendo.Class.extend({\n            init: function () {\n                this._buckets = [];\n                this.length = 0;\n            },\n            add: function (key, value) {\n                var obj = this._createGetBucket(key);\n                if (Utils.isDefined(value)) {\n                    obj.value = value;\n                }\n                return obj;\n            },\n            get: function (key) {\n                if (this._bucketExists(key)) {\n                    return this._createGetBucket(key);\n                }\n                return null;\n            },\n            set: function (key, value) {\n                this.add(key, value);\n            },\n            containsKey: function (key) {\n                return this._bucketExists(key);\n            },\n            remove: function (key) {\n                if (this._bucketExists(key)) {\n                    var hashId = this._hash(key);\n                    delete this._buckets[hashId];\n                    this.length--;\n                    return key;\n                }\n            },\n            forEach: function (func) {\n                var hashes = this._hashes();\n                for (var i = 0, len = hashes.length; i < len; i++) {\n                    var hash = hashes[i];\n                    var bucket = this._buckets[hash];\n                    if (Utils.isUndefined(bucket)) {\n                        continue;\n                    }\n                    func(bucket);\n                }\n            },\n            clone: function () {\n                var ht = new HashTable();\n                var hashes = this._hashes();\n                for (var i = 0, len = hashes.length; i < len; i++) {\n                    var hash = hashes[i];\n                    var bucket = this._buckets[hash];\n                    if (Utils.isUndefined(bucket)) {\n                        continue;\n                    }\n                    ht.add(bucket.key, bucket.value);\n                }\n                return ht;\n            },\n            _hashes: function () {\n                var hashes = [];\n                for (var hash in this._buckets) {\n                    if (this._buckets.hasOwnProperty(hash)) {\n                        hashes.push(hash);\n                    }\n                }\n                return hashes;\n            },\n            _bucketExists: function (key) {\n                var hashId = this._hash(key);\n                return Utils.isDefined(this._buckets[hashId]);\n            },\n            _createGetBucket: function (key) {\n                var hashId = this._hash(key);\n                var bucket = this._buckets[hashId];\n                if (Utils.isUndefined(bucket)) {\n                    bucket = { key: key };\n                    this._buckets[hashId] = bucket;\n                    this.length++;\n                }\n                return bucket;\n            },\n            _hash: function (key) {\n                if (Utils.isNumber(key)) {\n                    return key;\n                }\n                if (Utils.isString(key)) {\n                    return this._hashString(key);\n                }\n                if (Utils.isObject(key)) {\n                    return this._objectHashId(key);\n                }\n                throw 'Unsupported key type.';\n            },\n            _hashString: function (s) {\n                var result = 0;\n                if (s.length === 0) {\n                    return result;\n                }\n                for (var i = 0; i < s.length; i++) {\n                    var ch = s.charCodeAt(i);\n                    result = result * 32 - result + ch;\n                }\n                return result;\n            },\n            _objectHashId: function (key) {\n                var id = key._hashId;\n                if (Utils.isUndefined(id)) {\n                    id = randomId();\n                    key._hashId = id;\n                }\n                return id;\n            }\n        });\n        var Dictionary = kendo.Observable.extend({\n            init: function (dictionary) {\n                var that = this;\n                kendo.Observable.fn.init.call(that);\n                this._hashTable = new HashTable();\n                this.length = 0;\n                if (Utils.isDefined(dictionary)) {\n                    if ($.isArray(dictionary)) {\n                        for (var i = 0; i < dictionary.length; i++) {\n                            this.add(dictionary[i]);\n                        }\n                    } else {\n                        dictionary.forEach(function (k, v) {\n                            this.add(k, v);\n                        }, this);\n                    }\n                }\n            },\n            add: function (key, value) {\n                var entry = this._hashTable.get(key);\n                if (!entry) {\n                    entry = this._hashTable.add(key);\n                    this.length++;\n                    this.trigger('changed');\n                }\n                entry.value = value;\n            },\n            set: function (key, value) {\n                this.add(key, value);\n            },\n            get: function (key) {\n                var entry = this._hashTable.get(key);\n                if (entry) {\n                    return entry.value;\n                }\n                throw new Error('Cannot find key ' + key);\n            },\n            containsKey: function (key) {\n                return this._hashTable.containsKey(key);\n            },\n            remove: function (key) {\n                if (this.containsKey(key)) {\n                    this.trigger('changed');\n                    this.length--;\n                    return this._hashTable.remove(key);\n                }\n            },\n            forEach: function (func, thisRef) {\n                this._hashTable.forEach(function (entry) {\n                    func.call(thisRef, entry.key, entry.value);\n                });\n            },\n            forEachValue: function (func, thisRef) {\n                this._hashTable.forEach(function (entry) {\n                    func.call(thisRef, entry.value);\n                });\n            },\n            forEachKey: function (func, thisRef) {\n                this._hashTable.forEach(function (entry) {\n                    func.call(thisRef, entry.key);\n                });\n            },\n            keys: function () {\n                var keys = [];\n                this.forEachKey(function (key) {\n                    keys.push(key);\n                });\n                return keys;\n            }\n        });\n        var Queue = kendo.Class.extend({\n            init: function () {\n                this._tail = null;\n                this._head = null;\n                this.length = 0;\n            },\n            enqueue: function (value) {\n                var entry = {\n                    value: value,\n                    next: null\n                };\n                if (!this._head) {\n                    this._head = entry;\n                    this._tail = this._head;\n                } else {\n                    this._tail.next = entry;\n                    this._tail = this._tail.next;\n                }\n                this.length++;\n            },\n            dequeue: function () {\n                if (this.length < 1) {\n                    throw new Error('The queue is empty.');\n                }\n                var value = this._head.value;\n                this._head = this._head.next;\n                this.length--;\n                return value;\n            },\n            contains: function (item) {\n                var current = this._head;\n                while (current) {\n                    if (current.value === item) {\n                        return true;\n                    }\n                    current = current.next;\n                }\n                return false;\n            }\n        });\n        var Set = kendo.Observable.extend({\n            init: function (resource) {\n                var that = this;\n                kendo.Observable.fn.init.call(that);\n                this._hashTable = new HashTable();\n                this.length = 0;\n                if (Utils.isDefined(resource)) {\n                    if (resource instanceof HashTable) {\n                        resource.forEach(function (d) {\n                            this.add(d);\n                        });\n                    } else if (resource instanceof Dictionary) {\n                        resource.forEach(function (k, v) {\n                            this.add({\n                                key: k,\n                                value: v\n                            });\n                        }, this);\n                    }\n                }\n            },\n            contains: function (item) {\n                return this._hashTable.containsKey(item);\n            },\n            add: function (item) {\n                var entry = this._hashTable.get(item);\n                if (!entry) {\n                    this._hashTable.add(item, item);\n                    this.length++;\n                    this.trigger('changed');\n                }\n            },\n            get: function (item) {\n                if (this.contains(item)) {\n                    return this._hashTable.get(item).value;\n                } else {\n                    return null;\n                }\n            },\n            hash: function (item) {\n                return this._hashTable._hash(item);\n            },\n            remove: function (item) {\n                if (this.contains(item)) {\n                    this._hashTable.remove(item);\n                    this.length--;\n                    this.trigger('changed');\n                }\n            },\n            forEach: function (func, context) {\n                this._hashTable.forEach(function (kv) {\n                    func(kv.value);\n                }, context);\n            },\n            toArray: function () {\n                var r = [];\n                this.forEach(function (d) {\n                    r.push(d);\n                });\n                return r;\n            }\n        });\n        var Node = kendo.Class.extend({\n            init: function (id, shape) {\n                this.links = [];\n                this.outgoing = [];\n                this.incoming = [];\n                this.weight = 1;\n                if (Utils.isDefined(id)) {\n                    this.id = id;\n                } else {\n                    this.id = randomId();\n                }\n                if (Utils.isDefined(shape)) {\n                    this.associatedShape = shape;\n                    var b = shape.bounds();\n                    this.width = b.width;\n                    this.height = b.height;\n                    this.x = b.x;\n                    this.y = b.y;\n                } else {\n                    this.associatedShape = null;\n                }\n                this.data = null;\n                this.type = 'Node';\n                this.shortForm = 'Node \\'' + this.id + '\\'';\n                this.isVirtual = false;\n            },\n            isIsolated: function () {\n                return Utils.isEmpty(this.links);\n            },\n            bounds: function (r) {\n                if (!Utils.isDefined(r)) {\n                    return new diagram.Rect(this.x, this.y, this.width, this.height);\n                }\n                this.x = r.x;\n                this.y = r.y;\n                this.width = r.width;\n                this.height = r.height;\n            },\n            isLinkedTo: function (node) {\n                var that = this;\n                return Utils.any(that.links, function (link) {\n                    return link.getComplement(that) === node;\n                });\n            },\n            getChildren: function () {\n                if (this.outgoing.length === 0) {\n                    return [];\n                }\n                var children = [];\n                for (var i = 0, len = this.outgoing.length; i < len; i++) {\n                    var link = this.outgoing[i];\n                    children.push(link.getComplement(this));\n                }\n                return children;\n            },\n            getParents: function () {\n                if (this.incoming.length === 0) {\n                    return [];\n                }\n                var parents = [];\n                for (var i = 0, len = this.incoming.length; i < len; i++) {\n                    var link = this.incoming[i];\n                    parents.push(link.getComplement(this));\n                }\n                return parents;\n            },\n            clone: function () {\n                var copy = new Node();\n                if (Utils.isDefined(this.weight)) {\n                    copy.weight = this.weight;\n                }\n                if (Utils.isDefined(this.balance)) {\n                    copy.balance = this.balance;\n                }\n                if (Utils.isDefined(this.owner)) {\n                    copy.owner = this.owner;\n                }\n                copy.associatedShape = this.associatedShape;\n                copy.x = this.x;\n                copy.y = this.y;\n                copy.width = this.width;\n                copy.height = this.height;\n                return copy;\n            },\n            adjacentTo: function (node) {\n                return this.isLinkedTo(node) !== null;\n            },\n            removeLink: function (link) {\n                if (link.source === this) {\n                    Utils.remove(this.links, link);\n                    Utils.remove(this.outgoing, link);\n                    link.source = null;\n                }\n                if (link.target === this) {\n                    Utils.remove(this.links, link);\n                    Utils.remove(this.incoming, link);\n                    link.target = null;\n                }\n            },\n            hasLinkTo: function (node) {\n                return Utils.any(this.outgoing, function (link) {\n                    return link.target === node;\n                });\n            },\n            degree: function () {\n                return this.links.length;\n            },\n            incidentWith: function (link) {\n                return contains(this.links, link);\n            },\n            getLinksWith: function (node) {\n                return Utils.all(this.links, function (link) {\n                    return link.getComplement(this) === node;\n                }, this);\n            },\n            getNeighbors: function () {\n                var neighbors = [];\n                Utils.forEach(this.incoming, function (e) {\n                    neighbors.push(e.getComplement(this));\n                }, this);\n                Utils.forEach(this.outgoing, function (e) {\n                    neighbors.push(e.getComplement(this));\n                }, this);\n                return neighbors;\n            }\n        });\n        var Link = kendo.Class.extend({\n            init: function (source, target, id, connection) {\n                if (Utils.isUndefined(source)) {\n                    throw 'The source of the new link is not set.';\n                }\n                if (Utils.isUndefined(target)) {\n                    throw 'The target of the new link is not set.';\n                }\n                var sourceFound, targetFound;\n                if (Utils.isString(source)) {\n                    sourceFound = new Node(source);\n                } else {\n                    sourceFound = source;\n                }\n                if (Utils.isString(target)) {\n                    targetFound = new Node(target);\n                } else {\n                    targetFound = target;\n                }\n                this.source = sourceFound;\n                this.target = targetFound;\n                this.source.links.push(this);\n                this.target.links.push(this);\n                this.source.outgoing.push(this);\n                this.target.incoming.push(this);\n                if (Utils.isDefined(id)) {\n                    this.id = id;\n                } else {\n                    this.id = randomId();\n                }\n                if (Utils.isDefined(connection)) {\n                    this.associatedConnection = connection;\n                } else {\n                    this.associatedConnection = null;\n                }\n                this.type = 'Link';\n                this.shortForm = 'Link \\'' + this.source.id + '->' + this.target.id + '\\'';\n            },\n            getComplement: function (node) {\n                if (this.source !== node && this.target !== node) {\n                    throw 'The given node is not incident with this link.';\n                }\n                return this.source === node ? this.target : this.source;\n            },\n            getCommonNode: function (link) {\n                if (this.source === link.source || this.source === link.target) {\n                    return this.source;\n                }\n                if (this.target === link.source || this.target === link.target) {\n                    return this.target;\n                }\n                return null;\n            },\n            isBridging: function (v1, v2) {\n                return this.source === v1 && this.target === v2 || this.source === v2 && this.target === v1;\n            },\n            getNodes: function () {\n                return [\n                    this.source,\n                    this.target\n                ];\n            },\n            incidentWith: function (node) {\n                return this.source === node || this.target === node;\n            },\n            adjacentTo: function (link) {\n                return contains(this.source.links, link) || contains(this.target.links, link);\n            },\n            changeSource: function (node) {\n                Utils.remove(this.source.links, this);\n                Utils.remove(this.source.outgoing, this);\n                node.links.push(this);\n                node.outgoing.push(this);\n                this.source = node;\n            },\n            changeTarget: function (node) {\n                Utils.remove(this.target.links, this);\n                Utils.remove(this.target.incoming, this);\n                node.links.push(this);\n                node.incoming.push(this);\n                this.target = node;\n            },\n            changesNodes: function (v, w) {\n                if (this.source === v) {\n                    this.changeSource(w);\n                } else if (this.target === v) {\n                    this.changeTarget(w);\n                }\n            },\n            reverse: function () {\n                var oldSource = this.source;\n                var oldTarget = this.target;\n                this.source = oldTarget;\n                Utils.remove(oldSource.outgoing, this);\n                this.source.outgoing.push(this);\n                this.target = oldSource;\n                Utils.remove(oldTarget.incoming, this);\n                this.target.incoming.push(this);\n                return this;\n            },\n            directTo: function (target) {\n                if (this.source !== target && this.target !== target) {\n                    throw 'The given node is not incident with this link.';\n                }\n                if (this.target !== target) {\n                    this.reverse();\n                }\n            },\n            createReverseEdge: function () {\n                var r = this.clone();\n                r.reverse();\n                r.reversed = true;\n                return r;\n            },\n            clone: function () {\n                var clone = new Link(this.source, this.target);\n                return clone;\n            }\n        });\n        var Graph = kendo.Class.extend({\n            init: function (idOrDiagram) {\n                this.links = [];\n                this.nodes = [];\n                this._nodeMap = new Dictionary();\n                this.diagram = null;\n                this._root = null;\n                if (Utils.isDefined(idOrDiagram)) {\n                    if (Utils.isString(idOrDiagram)) {\n                        this.id = idOrDiagram;\n                    } else {\n                        this.diagram = idOrDiagram;\n                        this.id = idOrDiagram.id;\n                    }\n                } else {\n                    this.id = randomId();\n                }\n                this.bounds = new Rect();\n                this._hasCachedRelationships = false;\n                this.type = 'Graph';\n            },\n            cacheRelationships: function (forceRebuild) {\n                if (Utils.isUndefined(forceRebuild)) {\n                    forceRebuild = false;\n                }\n                if (this._hasCachedRelationships && !forceRebuild) {\n                    return;\n                }\n                for (var i = 0, len = this.nodes.length; i < len; i++) {\n                    var node = this.nodes[i];\n                    node.children = this.getChildren(node);\n                    node.parents = this.getParents(node);\n                }\n                this._hasCachedRelationships = true;\n            },\n            assignLevels: function (startNode, offset, visited) {\n                if (!startNode) {\n                    throw 'Start node not specified.';\n                }\n                if (Utils.isUndefined(offset)) {\n                    offset = 0;\n                }\n                this.cacheRelationships();\n                if (Utils.isUndefined(visited)) {\n                    visited = new Dictionary();\n                    Utils.forEach(this.nodes, function (n) {\n                        visited.add(n, false);\n                    });\n                }\n                visited.set(startNode, true);\n                startNode.level = offset;\n                var children = startNode.children;\n                for (var i = 0, len = children.length; i < len; i++) {\n                    var child = children[i];\n                    if (!child || visited.get(child)) {\n                        continue;\n                    }\n                    this.assignLevels(child, offset + 1, visited);\n                }\n            },\n            root: function (value) {\n                if (Utils.isUndefined(value)) {\n                    if (!this._root) {\n                        var found = Utils.first(this.nodes, function (n) {\n                            return n.incoming.length === 0;\n                        });\n                        if (found) {\n                            return found;\n                        }\n                        return Utils.first(this.nodes);\n                    } else {\n                        return this._root;\n                    }\n                } else {\n                    this._root = value;\n                }\n            },\n            getConnectedComponents: function () {\n                this.componentIndex = 0;\n                this.setItemIndices();\n                var componentId = Utils.initArray(this.nodes.length, -1);\n                for (var v = 0; v < this.nodes.length; v++) {\n                    if (componentId[v] === -1) {\n                        this._collectConnectedNodes(componentId, v);\n                        this.componentIndex++;\n                    }\n                }\n                var components = [], i;\n                for (i = 0; i < this.componentIndex; ++i) {\n                    components[i] = new Graph();\n                }\n                for (i = 0; i < componentId.length; ++i) {\n                    var graph = components[componentId[i]];\n                    graph.addNodeAndOutgoings(this.nodes[i]);\n                }\n                components.sort(function (a, b) {\n                    return b.nodes.length - a.nodes.length;\n                });\n                return components;\n            },\n            _collectConnectedNodes: function (setIds, nodeIndex) {\n                setIds[nodeIndex] = this.componentIndex;\n                var node = this.nodes[nodeIndex];\n                Utils.forEach(node.links, function (link) {\n                    var next = link.getComplement(node);\n                    var nextId = next.index;\n                    if (setIds[nextId] === -1) {\n                        this._collectConnectedNodes(setIds, nextId);\n                    }\n                }, this);\n            },\n            calcBounds: function () {\n                if (this.isEmpty()) {\n                    this.bounds = new Rect();\n                    return this.bounds;\n                }\n                var b = null;\n                for (var i = 0, len = this.nodes.length; i < len; i++) {\n                    var node = this.nodes[i];\n                    if (!b) {\n                        b = node.bounds();\n                    } else {\n                        b = b.union(node.bounds());\n                    }\n                }\n                this.bounds = b;\n                return this.bounds;\n            },\n            getSpanningTree: function (root) {\n                var tree = new Graph();\n                var map = new Dictionary(), source, target;\n                tree.root = root.clone();\n                tree.root.level = 0;\n                tree.root.id = root.id;\n                map.add(root, tree.root);\n                root.level = 0;\n                var visited = [];\n                var remaining = [];\n                tree._addNode(tree.root);\n                visited.push(root);\n                remaining.push(root);\n                var levelCount = 1;\n                while (remaining.length > 0) {\n                    var next = remaining.pop();\n                    for (var ni = 0; ni < next.links.length; ni++) {\n                        var link = next.links[ni];\n                        var cn = link.getComplement(next);\n                        if (contains(visited, cn)) {\n                            continue;\n                        }\n                        cn.level = next.level + 1;\n                        if (levelCount < cn.level + 1) {\n                            levelCount = cn.level + 1;\n                        }\n                        if (!contains(remaining, cn)) {\n                            remaining.push(cn);\n                        }\n                        if (!contains(visited, cn)) {\n                            visited.push(cn);\n                        }\n                        if (map.containsKey(next)) {\n                            source = map.get(next);\n                        } else {\n                            source = next.clone();\n                            source.level = next.level;\n                            source.id = next.id;\n                            map.add(next, source);\n                        }\n                        if (map.containsKey(cn)) {\n                            target = map.get(cn);\n                        } else {\n                            target = cn.clone();\n                            target.level = cn.level;\n                            target.id = cn.id;\n                            map.add(cn, target);\n                        }\n                        var newLink = new Link(source, target);\n                        tree.addLink(newLink);\n                    }\n                }\n                var treeLevels = [];\n                for (var i = 0; i < levelCount; i++) {\n                    treeLevels.push([]);\n                }\n                Utils.forEach(tree.nodes, function (node) {\n                    treeLevels[node.level].push(node);\n                });\n                tree.treeLevels = treeLevels;\n                tree.cacheRelationships();\n                return tree;\n            },\n            takeRandomNode: function (excludedNodes, incidenceLessThan) {\n                if (Utils.isUndefined(excludedNodes)) {\n                    excludedNodes = [];\n                }\n                if (Utils.isUndefined(incidenceLessThan)) {\n                    incidenceLessThan = 4;\n                }\n                if (this.nodes.length === 0) {\n                    return null;\n                }\n                if (this.nodes.length === 1) {\n                    return contains(excludedNodes, this.nodes[0]) ? null : this.nodes[0];\n                }\n                var pool = $.grep(this.nodes, function (node) {\n                    return !contains(excludedNodes, node) && node.degree() <= incidenceLessThan;\n                });\n                if (Utils.isEmpty(pool)) {\n                    return null;\n                }\n                return pool[Utils.randomInteger(0, pool.length)];\n            },\n            isEmpty: function () {\n                return Utils.isEmpty(this.nodes);\n            },\n            isHealthy: function () {\n                return Utils.all(this.links, function (link) {\n                    return contains(this.nodes, link.source) && contains(this.nodes, link.target);\n                }, this);\n            },\n            getParents: function (n) {\n                if (!this.hasNode(n)) {\n                    throw 'The given node is not part of this graph.';\n                }\n                return n.getParents();\n            },\n            getChildren: function (n) {\n                if (!this.hasNode(n)) {\n                    throw 'The given node is not part of this graph.';\n                }\n                return n.getChildren();\n            },\n            addLink: function (sourceOrLink, target, owner) {\n                if (Utils.isUndefined(sourceOrLink)) {\n                    throw 'The source of the link is not defined.';\n                }\n                if (Utils.isUndefined(target)) {\n                    if (Utils.isDefined(sourceOrLink.type) && sourceOrLink.type === 'Link') {\n                        this.addExistingLink(sourceOrLink);\n                        return;\n                    } else {\n                        throw 'The target of the link is not defined.';\n                    }\n                }\n                var foundSource = this.getNode(sourceOrLink);\n                if (Utils.isUndefined(foundSource)) {\n                    foundSource = this.addNode(sourceOrLink);\n                }\n                var foundTarget = this.getNode(target);\n                if (Utils.isUndefined(foundTarget)) {\n                    foundTarget = this.addNode(target);\n                }\n                var newLink = new Link(foundSource, foundTarget);\n                if (Utils.isDefined(owner)) {\n                    newLink.owner = owner;\n                }\n                this.links.push(newLink);\n                return newLink;\n            },\n            removeAllLinks: function () {\n                while (this.links.length > 0) {\n                    var link = this.links[0];\n                    this.removeLink(link);\n                }\n            },\n            addExistingLink: function (link) {\n                if (this.hasLink(link)) {\n                    return;\n                }\n                this.links.push(link);\n                if (this.hasNode(link.source.id)) {\n                    var s = this.getNode(link.source.id);\n                    link.changeSource(s);\n                } else {\n                    this.addNode(link.source);\n                }\n                if (this.hasNode(link.target.id)) {\n                    var t = this.getNode(link.target.id);\n                    link.changeTarget(t);\n                } else {\n                    this.addNode(link.target);\n                }\n            },\n            hasLink: function (linkOrId) {\n                if (Utils.isString(linkOrId)) {\n                    return Utils.any(this.links, function (link) {\n                        return link.id === linkOrId;\n                    });\n                }\n                if (linkOrId.type === 'Link') {\n                    return contains(this.links, linkOrId);\n                }\n                throw 'The given object is neither an identifier nor a Link.';\n            },\n            getNode: function (nodeOrId) {\n                var id = nodeOrId.id || nodeOrId;\n                if (this._nodeMap.containsKey(id)) {\n                    return this._nodeMap.get(id);\n                }\n            },\n            hasNode: function (nodeOrId) {\n                var id = nodeOrId.id || nodeOrId;\n                return this._nodeMap.containsKey(id);\n            },\n            _addNode: function (node) {\n                this.nodes.push(node);\n                this._nodeMap.add(node.id, node);\n            },\n            _removeNode: function (node) {\n                Utils.remove(this.nodes, node);\n                this._nodeMap.remove(node.id);\n            },\n            removeNode: function (nodeOrId) {\n                var n = nodeOrId;\n                if (Utils.isString(nodeOrId)) {\n                    n = this.getNode(nodeOrId);\n                }\n                if (Utils.isDefined(n)) {\n                    var links = n.links;\n                    n.links = [];\n                    for (var i = 0, len = links.length; i < len; i++) {\n                        var link = links[i];\n                        this.removeLink(link);\n                    }\n                    this._removeNode(n);\n                } else {\n                    throw 'The identifier should be a Node or the Id (string) of a node.';\n                }\n            },\n            areConnected: function (n1, n2) {\n                return Utils.any(this.links, function (link) {\n                    return link.source == n1 && link.target == n2 || link.source == n2 && link.target == n1;\n                });\n            },\n            removeLink: function (link) {\n                Utils.remove(this.links, link);\n                Utils.remove(link.source.outgoing, link);\n                Utils.remove(link.source.links, link);\n                Utils.remove(link.target.incoming, link);\n                Utils.remove(link.target.links, link);\n            },\n            addNode: function (nodeOrId, layoutRect, owner) {\n                var newNode = null;\n                if (!Utils.isDefined(nodeOrId)) {\n                    throw 'No Node or identifier for a new Node is given.';\n                }\n                if (Utils.isString(nodeOrId)) {\n                    if (this.hasNode(nodeOrId)) {\n                        return this.getNode(nodeOrId);\n                    }\n                    newNode = new Node(nodeOrId);\n                } else {\n                    if (this.hasNode(nodeOrId)) {\n                        return this.getNode(nodeOrId);\n                    }\n                    newNode = nodeOrId;\n                }\n                if (Utils.isDefined(layoutRect)) {\n                    newNode.bounds(layoutRect);\n                }\n                if (Utils.isDefined(owner)) {\n                    newNode.owner = owner;\n                }\n                this._addNode(newNode);\n                return newNode;\n            },\n            addNodeAndOutgoings: function (node) {\n                if (!this.hasNode(node)) {\n                    this._addNode(node);\n                }\n                var newLinks = node.outgoing;\n                node.outgoing = [];\n                Utils.forEach(newLinks, function (link) {\n                    this.addExistingLink(link);\n                }, this);\n            },\n            setItemIndices: function () {\n                var i;\n                for (i = 0; i < this.nodes.length; ++i) {\n                    this.nodes[i].index = i;\n                }\n                for (i = 0; i < this.links.length; ++i) {\n                    this.links[i].index = i;\n                }\n            },\n            clone: function (saveMapping) {\n                var copy = new Graph();\n                var save = Utils.isDefined(saveMapping) && saveMapping === true;\n                if (save) {\n                    copy.nodeMap = new Dictionary();\n                    copy.linkMap = new Dictionary();\n                }\n                var map = new Dictionary();\n                Utils.forEach(this.nodes, function (nOriginal) {\n                    var nCopy = nOriginal.clone();\n                    map.set(nOriginal, nCopy);\n                    copy._addNode(nCopy);\n                    if (save) {\n                        copy.nodeMap.set(nCopy, nOriginal);\n                    }\n                });\n                Utils.forEach(this.links, function (linkOriginal) {\n                    if (map.containsKey(linkOriginal.source) && map.containsKey(linkOriginal.target)) {\n                        var linkCopy = copy.addLink(map.get(linkOriginal.source), map.get(linkOriginal.target));\n                        if (save) {\n                            copy.linkMap.set(linkCopy, linkOriginal);\n                        }\n                    }\n                });\n                return copy;\n            },\n            linearize: function (addIds) {\n                return Graph.Utils.linearize(this, addIds);\n            },\n            depthFirstTraversal: function (startNode, action) {\n                if (Utils.isUndefined(startNode)) {\n                    throw 'You need to supply a starting node.';\n                }\n                if (Utils.isUndefined(action)) {\n                    throw 'You need to supply an action.';\n                }\n                if (!this.hasNode(startNode)) {\n                    throw 'The given start-node is not part of this graph';\n                }\n                var foundNode = this.getNode(startNode);\n                var visited = [];\n                this._dftIterator(foundNode, action, visited);\n            },\n            _dftIterator: function (node, action, visited) {\n                action(node);\n                visited.push(node);\n                var children = node.getChildren();\n                for (var i = 0, len = children.length; i < len; i++) {\n                    var child = children[i];\n                    if (contains(visited, child)) {\n                        continue;\n                    }\n                    this._dftIterator(child, action, visited);\n                }\n            },\n            breadthFirstTraversal: function (startNode, action) {\n                if (Utils.isUndefined(startNode)) {\n                    throw 'You need to supply a starting node.';\n                }\n                if (Utils.isUndefined(action)) {\n                    throw 'You need to supply an action.';\n                }\n                if (!this.hasNode(startNode)) {\n                    throw 'The given start-node is not part of this graph';\n                }\n                var foundNode = this.getNode(startNode);\n                var queue = new Queue();\n                var visited = [];\n                queue.enqueue(foundNode);\n                while (queue.length > 0) {\n                    var node = queue.dequeue();\n                    action(node);\n                    visited.push(node);\n                    var children = node.getChildren();\n                    for (var i = 0, len = children.length; i < len; i++) {\n                        var child = children[i];\n                        if (contains(visited, child) || contains(queue, child)) {\n                            continue;\n                        }\n                        queue.enqueue(child);\n                    }\n                }\n            },\n            _stronglyConnectedComponents: function (excludeSingleItems, node, indices, lowLinks, connected, stack, index) {\n                indices.add(node, index);\n                lowLinks.add(node, index);\n                index++;\n                stack.push(node);\n                var children = node.getChildren(), next;\n                for (var i = 0, len = children.length; i < len; i++) {\n                    next = children[i];\n                    if (!indices.containsKey(next)) {\n                        this._stronglyConnectedComponents(excludeSingleItems, next, indices, lowLinks, connected, stack, index);\n                        lowLinks.add(node, Math.min(lowLinks.get(node), lowLinks.get(next)));\n                    } else if (contains(stack, next)) {\n                        lowLinks.add(node, Math.min(lowLinks.get(node), indices.get(next)));\n                    }\n                }\n                if (lowLinks.get(node) === indices.get(node)) {\n                    var component = [];\n                    do {\n                        next = stack.pop();\n                        component.push(next);\n                    } while (next !== node);\n                    if (!excludeSingleItems || component.length > 1) {\n                        connected.push(component);\n                    }\n                }\n            },\n            findCycles: function (excludeSingleItems) {\n                if (Utils.isUndefined(excludeSingleItems)) {\n                    excludeSingleItems = true;\n                }\n                var indices = new Dictionary();\n                var lowLinks = new Dictionary();\n                var connected = [];\n                var stack = [];\n                for (var i = 0, len = this.nodes.length; i < len; i++) {\n                    var node = this.nodes[i];\n                    if (indices.containsKey(node)) {\n                        continue;\n                    }\n                    this._stronglyConnectedComponents(excludeSingleItems, node, indices, lowLinks, connected, stack, 0);\n                }\n                return connected;\n            },\n            isAcyclic: function () {\n                return Utils.isEmpty(this.findCycles());\n            },\n            isSubGraph: function (other) {\n                var otherArray = other.linearize();\n                var thisArray = this.linearize();\n                return Utils.all(otherArray, function (s) {\n                    return contains(thisArray, s);\n                });\n            },\n            makeAcyclic: function () {\n                if (this.isEmpty() || this.nodes.length <= 1 || this.links.length <= 1) {\n                    return [];\n                }\n                if (this.nodes.length == 2) {\n                    var result = [];\n                    if (this.links.length > 1) {\n                        var oneLink = this.links[0];\n                        var oneNode = oneLink.source;\n                        for (var i = 0, len = this.links.length; i < len; i++) {\n                            var link = this.links[i];\n                            if (link.source == oneNode) {\n                                continue;\n                            }\n                            var rev = link.reverse();\n                            result.push(rev);\n                        }\n                    }\n                    return result;\n                }\n                var copy = this.clone(true);\n                var N = this.nodes.length;\n                var intensityCatalog = new Dictionary();\n                var flowIntensity = function (node) {\n                    if (node.outgoing.length === 0) {\n                        return 2 - N;\n                    } else if (node.incoming.length === 0) {\n                        return N - 2;\n                    } else {\n                        return node.outgoing.length - node.incoming.length;\n                    }\n                };\n                var catalogEqualIntensity = function (node, intensityCatalog) {\n                    var intensity = flowIntensity(node, N);\n                    if (!intensityCatalog.containsKey(intensity)) {\n                        intensityCatalog.set(intensity, []);\n                    }\n                    intensityCatalog.get(intensity).push(node);\n                };\n                Utils.forEach(copy.nodes, function (v) {\n                    catalogEqualIntensity(v, intensityCatalog);\n                });\n                var sourceStack = [];\n                var targetStack = [];\n                while (copy.nodes.length > 0) {\n                    var source, target, intensity;\n                    if (intensityCatalog.containsKey(2 - N)) {\n                        var targets = intensityCatalog.get(2 - N);\n                        while (targets.length > 0) {\n                            target = targets.pop();\n                            for (var li = 0; li < target.links.length; li++) {\n                                var targetLink = target.links[li];\n                                source = targetLink.getComplement(target);\n                                intensity = flowIntensity(source, N);\n                                Utils.remove(intensityCatalog.get(intensity), source);\n                                source.removeLink(targetLink);\n                                catalogEqualIntensity(source, intensityCatalog);\n                            }\n                            copy._removeNode(target);\n                            targetStack.unshift(target);\n                        }\n                    }\n                    if (intensityCatalog.containsKey(N - 2)) {\n                        var sources = intensityCatalog.get(N - 2);\n                        while (sources.length > 0) {\n                            source = sources.pop();\n                            for (var si = 0; si < source.links.length; si++) {\n                                var sourceLink = source.links[si];\n                                target = sourceLink.getComplement(source);\n                                intensity = flowIntensity(target, N);\n                                Utils.remove(intensityCatalog.get(intensity), target);\n                                target.removeLink(sourceLink);\n                                catalogEqualIntensity(target, intensityCatalog);\n                            }\n                            sourceStack.push(source);\n                            copy._removeNode(source);\n                        }\n                    }\n                    if (copy.nodes.length > 0) {\n                        for (var k = N - 3; k > 2 - N; k--) {\n                            if (intensityCatalog.containsKey(k) && intensityCatalog.get(k).length > 0) {\n                                var maxdiff = intensityCatalog.get(k);\n                                var v = maxdiff.pop();\n                                for (var ri = 0; ri < v.links.length; ri++) {\n                                    var ril = v.links[ri];\n                                    var u = ril.getComplement(v);\n                                    intensity = flowIntensity(u, N);\n                                    Utils.remove(intensityCatalog.get(intensity), u);\n                                    u.removeLink(ril);\n                                    catalogEqualIntensity(u, intensityCatalog);\n                                }\n                                sourceStack.push(v);\n                                copy._removeNode(v);\n                                break;\n                            }\n                        }\n                    }\n                }\n                sourceStack = sourceStack.concat(targetStack);\n                var vertexOrder = new Dictionary();\n                for (var kk = 0; kk < this.nodes.length; kk++) {\n                    vertexOrder.set(copy.nodeMap.get(sourceStack[kk]), kk);\n                }\n                var reversedEdges = [];\n                Utils.forEach(this.links, function (link) {\n                    if (vertexOrder.get(link.source) > vertexOrder.get(link.target)) {\n                        link.reverse();\n                        reversedEdges.push(link);\n                    }\n                });\n                return reversedEdges;\n            }\n        });\n        Graph.Predefined = {\n            EightGraph: function () {\n                return Graph.Utils.parse([\n                    '1->2',\n                    '2->3',\n                    '3->4',\n                    '4->1',\n                    '3->5',\n                    '5->6',\n                    '6->7',\n                    '7->3'\n                ]);\n            },\n            Mindmap: function () {\n                return Graph.Utils.parse([\n                    '0->1',\n                    '0->2',\n                    '0->3',\n                    '0->4',\n                    '0->5',\n                    '1->6',\n                    '1->7',\n                    '7->8',\n                    '2->9',\n                    '9->10',\n                    '9->11',\n                    '3->12',\n                    '12->13',\n                    '13->14',\n                    '4->15',\n                    '4->16',\n                    '15->17',\n                    '15->18',\n                    '18->19',\n                    '18->20',\n                    '14->21',\n                    '14->22',\n                    '5->23',\n                    '23->24',\n                    '23->25',\n                    '6->26'\n                ]);\n            },\n            ThreeGraph: function () {\n                return Graph.Utils.parse([\n                    '1->2',\n                    '2->3',\n                    '3->1'\n                ]);\n            },\n            BinaryTree: function (levels) {\n                if (Utils.isUndefined(levels)) {\n                    levels = 5;\n                }\n                return Graph.Utils.createBalancedTree(levels, 2);\n            },\n            Linear: function (length) {\n                if (Utils.isUndefined(length)) {\n                    length = 10;\n                }\n                return Graph.Utils.createBalancedTree(length, 1);\n            },\n            Tree: function (levels, siblingsCount) {\n                return Graph.Utils.createBalancedTree(levels, siblingsCount);\n            },\n            Forest: function (levels, siblingsCount, trees) {\n                return Graph.Utils.createBalancedForest(levels, siblingsCount, trees);\n            },\n            Workflow: function () {\n                return Graph.Utils.parse([\n                    '0->1',\n                    '1->2',\n                    '2->3',\n                    '1->4',\n                    '4->3',\n                    '3->5',\n                    '5->6',\n                    '6->3',\n                    '6->7',\n                    '5->4'\n                ]);\n            },\n            Grid: function (n, m) {\n                var g = new diagram.Graph();\n                if (n <= 0 && m <= 0) {\n                    return g;\n                }\n                for (var i = 0; i < n + 1; i++) {\n                    var previous = null;\n                    for (var j = 0; j < m + 1; j++) {\n                        var node = new Node(i.toString() + '.' + j.toString());\n                        g.addNode(node);\n                        if (previous) {\n                            g.addLink(previous, node);\n                        }\n                        if (i > 0) {\n                            var left = g.getNode((i - 1).toString() + '.' + j.toString());\n                            g.addLink(left, node);\n                        }\n                        previous = node;\n                    }\n                }\n                return g;\n            }\n        };\n        Graph.Utils = {\n            parse: function (graphString) {\n                var previousLink, graph = new diagram.Graph(), parts = graphString.slice();\n                for (var i = 0, len = parts.length; i < len; i++) {\n                    var part = parts[i];\n                    if (Utils.isString(part)) {\n                        if (part.indexOf('->') < 0) {\n                            throw 'The link should be specified as \\'a->b\\'.';\n                        }\n                        var p = part.split('->');\n                        if (p.length != 2) {\n                            throw 'The link should be specified as \\'a->b\\'.';\n                        }\n                        previousLink = new Link(p[0], p[1]);\n                        graph.addLink(previousLink);\n                    }\n                    if (Utils.isObject(part)) {\n                        if (!previousLink) {\n                            throw 'Specification found before Link definition.';\n                        }\n                        kendo.deepExtend(previousLink, part);\n                    }\n                }\n                return graph;\n            },\n            linearize: function (graph, addIds) {\n                if (Utils.isUndefined(graph)) {\n                    throw 'Expected an instance of a Graph object in slot one.';\n                }\n                if (Utils.isUndefined(addIds)) {\n                    addIds = false;\n                }\n                var lin = [];\n                for (var i = 0, len = graph.links.length; i < len; i++) {\n                    var link = graph.links[i];\n                    lin.push(link.source.id + '->' + link.target.id);\n                    if (addIds) {\n                        lin.push({ id: link.id });\n                    }\n                }\n                return lin;\n            },\n            _addShape: function (kendoDiagram, p, id, shapeDefaults) {\n                if (Utils.isUndefined(p)) {\n                    p = new diagram.Point(0, 0);\n                }\n                if (Utils.isUndefined(id)) {\n                    id = randomId();\n                }\n                shapeDefaults = kendo.deepExtend({\n                    width: 20,\n                    height: 20,\n                    id: id,\n                    radius: 10,\n                    fill: '#778899',\n                    data: 'circle',\n                    undoable: false,\n                    x: p.x,\n                    y: p.y\n                }, shapeDefaults);\n                return kendoDiagram.addShape(shapeDefaults);\n            },\n            _addConnection: function (diagram, from, to, options) {\n                return diagram.connect(from, to, options);\n            },\n            createDiagramFromGraph: function (diagram, graph, doLayout, randomSize) {\n                if (Utils.isUndefined(diagram)) {\n                    throw 'The diagram surface is undefined.';\n                }\n                if (Utils.isUndefined(graph)) {\n                    throw 'No graph specification defined.';\n                }\n                if (Utils.isUndefined(doLayout)) {\n                    doLayout = true;\n                }\n                if (Utils.isUndefined(randomSize)) {\n                    randomSize = false;\n                }\n                var width = diagram.element.clientWidth || 200;\n                var height = diagram.element.clientHeight || 200;\n                var map = [], node, shape;\n                for (var i = 0, len = graph.nodes.length; i < len; i++) {\n                    node = graph.nodes[i];\n                    var p = node.position;\n                    if (Utils.isUndefined(p)) {\n                        if (Utils.isDefined(node.x) && Utils.isDefined(node.y)) {\n                            p = new Point(node.x, node.y);\n                        } else {\n                            p = new Point(Utils.randomInteger(10, width - 20), Utils.randomInteger(10, height - 20));\n                        }\n                    }\n                    var opt = {};\n                    if (node.id === '0') {\n                    } else if (randomSize) {\n                        kendo.deepExtend(opt, {\n                            width: Math.random() * 150 + 20,\n                            height: Math.random() * 80 + 50,\n                            data: 'rectangle',\n                            fill: { color: '#778899' }\n                        });\n                    }\n                    shape = this._addShape(diagram, p, node.id, opt);\n                    var bounds = shape.bounds();\n                    if (Utils.isDefined(bounds)) {\n                        node.x = bounds.x;\n                        node.y = bounds.y;\n                        node.width = bounds.width;\n                        node.height = bounds.height;\n                    }\n                    map[node.id] = shape;\n                }\n                for (var gli = 0; gli < graph.links.length; gli++) {\n                    var link = graph.links[gli];\n                    var sourceShape = map[link.source.id];\n                    if (Utils.isUndefined(sourceShape)) {\n                        continue;\n                    }\n                    var targetShape = map[link.target.id];\n                    if (Utils.isUndefined(targetShape)) {\n                        continue;\n                    }\n                    this._addConnection(diagram, sourceShape, targetShape, { id: link.id });\n                }\n                if (doLayout) {\n                    var l = new diagram.SpringLayout(diagram);\n                    l.layoutGraph(graph, { limitToView: false });\n                    for (var shi = 0; shi < graph.nodes.length; shi++) {\n                        node = graph.nodes[shi];\n                        shape = map[node.id];\n                        shape.bounds(new Rect(node.x, node.y, node.width, node.height));\n                    }\n                }\n            },\n            createBalancedTree: function (levels, siblingsCount) {\n                if (Utils.isUndefined(levels)) {\n                    levels = 3;\n                }\n                if (Utils.isUndefined(siblingsCount)) {\n                    siblingsCount = 3;\n                }\n                var g = new diagram.Graph(), counter = -1, lastAdded = [], news;\n                if (levels <= 0 || siblingsCount <= 0) {\n                    return g;\n                }\n                var root = new Node((++counter).toString());\n                g.addNode(root);\n                g.root = root;\n                lastAdded.push(root);\n                for (var i = 0; i < levels; i++) {\n                    news = [];\n                    for (var j = 0; j < lastAdded.length; j++) {\n                        var parent = lastAdded[j];\n                        for (var k = 0; k < siblingsCount; k++) {\n                            var item = new Node((++counter).toString());\n                            g.addLink(parent, item);\n                            news.push(item);\n                        }\n                    }\n                    lastAdded = news;\n                }\n                return g;\n            },\n            createBalancedForest: function (levels, siblingsCount, treeCount) {\n                if (Utils.isUndefined(levels)) {\n                    levels = 3;\n                }\n                if (Utils.isUndefined(siblingsCount)) {\n                    siblingsCount = 3;\n                }\n                if (Utils.isUndefined(treeCount)) {\n                    treeCount = 5;\n                }\n                var g = new diagram.Graph(), counter = -1, lastAdded = [], news;\n                if (levels <= 0 || siblingsCount <= 0 || treeCount <= 0) {\n                    return g;\n                }\n                for (var t = 0; t < treeCount; t++) {\n                    var root = new Node((++counter).toString());\n                    g.addNode(root);\n                    lastAdded = [root];\n                    for (var i = 0; i < levels; i++) {\n                        news = [];\n                        for (var j = 0; j < lastAdded.length; j++) {\n                            var parent = lastAdded[j];\n                            for (var k = 0; k < siblingsCount; k++) {\n                                var item = new Node((++counter).toString());\n                                g.addLink(parent, item);\n                                news.push(item);\n                            }\n                        }\n                        lastAdded = news;\n                    }\n                }\n                return g;\n            },\n            createRandomConnectedGraph: function (nodeCount, maxIncidence, isTree) {\n                if (Utils.isUndefined(nodeCount)) {\n                    nodeCount = 40;\n                }\n                if (Utils.isUndefined(maxIncidence)) {\n                    maxIncidence = 4;\n                }\n                if (Utils.isUndefined(isTree)) {\n                    isTree = false;\n                }\n                var g = new diagram.Graph(), counter = -1;\n                if (nodeCount <= 0) {\n                    return g;\n                }\n                var root = new Node((++counter).toString());\n                g.addNode(root);\n                if (nodeCount === 1) {\n                    return g;\n                }\n                if (nodeCount > 1) {\n                    for (var i = 1; i < nodeCount; i++) {\n                        var poolNode = g.takeRandomNode([], maxIncidence);\n                        if (!poolNode) {\n                            break;\n                        }\n                        var newNode = g.addNode(i.toString());\n                        g.addLink(poolNode, newNode);\n                    }\n                    if (!isTree && nodeCount > 1) {\n                        var randomAdditions = Utils.randomInteger(1, nodeCount);\n                        for (var ri = 0; ri < randomAdditions; ri++) {\n                            var n1 = g.takeRandomNode([], maxIncidence);\n                            var n2 = g.takeRandomNode([], maxIncidence);\n                            if (n1 && n2 && !g.areConnected(n1, n2)) {\n                                g.addLink(n1, n2);\n                            }\n                        }\n                    }\n                    return g;\n                }\n            },\n            randomDiagram: function (diagram, shapeCount, maxIncidence, isTree, randomSize) {\n                var g = kendo.dataviz.diagram.Graph.Utils.createRandomConnectedGraph(shapeCount, maxIncidence, isTree);\n                Graph.Utils.createDiagramFromGraph(diagram, g, false, randomSize);\n            }\n        };\n        kendo.deepExtend(diagram, {\n            init: function (element) {\n                kendo.init(element, diagram.ui);\n            },\n            Point: Point,\n            Intersect: Intersect,\n            Geometry: Geometry,\n            Rect: Rect,\n            Size: Size,\n            RectAlign: RectAlign,\n            Matrix: Matrix,\n            MatrixVector: MatrixVector,\n            normalVariable: normalVariable,\n            randomId: randomId,\n            Dictionary: Dictionary,\n            HashTable: HashTable,\n            Queue: Queue,\n            Set: Set,\n            Node: Node,\n            Link: Link,\n            Graph: Graph,\n            PathDefiner: PathDefiner\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('dataviz/diagram/svg', [\n        'kendo.drawing',\n        'dataviz/diagram/math'\n    ], f);\n}(function () {\n    (function ($, undefined) {\n        var kendo = window.kendo, diagram = kendo.dataviz.diagram, Class = kendo.Class, deepExtend = kendo.deepExtend, Point = diagram.Point, Rect = diagram.Rect, Matrix = diagram.Matrix, Utils = diagram.Utils, isNumber = Utils.isNumber, isString = Utils.isString, MatrixVector = diagram.MatrixVector, g = kendo.geometry, d = kendo.drawing, defined = kendo.util.defined, inArray = $.inArray;\n        var TRANSPARENT = 'transparent', Markers = {\n                none: 'none',\n                arrowStart: 'ArrowStart',\n                filledCircle: 'FilledCircle',\n                arrowEnd: 'ArrowEnd'\n            }, FULL_CIRCLE_ANGLE = 360, START = 'start', END = 'end', WIDTH = 'width', HEIGHT = 'height', X = 'x', Y = 'y';\n        diagram.Markers = Markers;\n        function diffNumericOptions(options, fields) {\n            var elementOptions = this.options;\n            var hasChanges = false;\n            var value, field;\n            for (var i = 0; i < fields.length; i++) {\n                field = fields[i];\n                value = options[field];\n                if (isNumber(value) && elementOptions[field] !== value) {\n                    elementOptions[field] = value;\n                    hasChanges = true;\n                }\n            }\n            return hasChanges;\n        }\n        var Scale = Class.extend({\n            init: function (x, y) {\n                this.x = x;\n                this.y = y;\n            },\n            toMatrix: function () {\n                return Matrix.scaling(this.x, this.y);\n            },\n            toString: function () {\n                return kendo.format('scale({0},{1})', this.x, this.y);\n            },\n            invert: function () {\n                return new Scale(1 / this.x, 1 / this.y);\n            }\n        });\n        var Translation = Class.extend({\n            init: function (x, y) {\n                this.x = x;\n                this.y = y;\n            },\n            toMatrixVector: function () {\n                return new MatrixVector(0, 0, 0, 0, this.x, this.y);\n            },\n            toMatrix: function () {\n                return Matrix.translation(this.x, this.y);\n            },\n            toString: function () {\n                return kendo.format('translate({0},{1})', this.x, this.y);\n            },\n            plus: function (delta) {\n                this.x += delta.x;\n                this.y += delta.y;\n            },\n            times: function (factor) {\n                this.x *= factor;\n                this.y *= factor;\n            },\n            length: function () {\n                return Math.sqrt(this.x * this.x + this.y * this.y);\n            },\n            normalize: function () {\n                if (this.Length === 0) {\n                    return;\n                }\n                this.times(1 / this.length());\n            },\n            invert: function () {\n                return new Translation(-this.x, -this.y);\n            }\n        });\n        var Rotation = Class.extend({\n            init: function (angle, x, y) {\n                this.x = x || 0;\n                this.y = y || 0;\n                this.angle = angle;\n            },\n            toString: function () {\n                if (this.x && this.y) {\n                    return kendo.format('rotate({0},{1},{2})', this.angle, this.x, this.y);\n                } else {\n                    return kendo.format('rotate({0})', this.angle);\n                }\n            },\n            toMatrix: function () {\n                return Matrix.rotation(this.angle, this.x, this.y);\n            },\n            center: function () {\n                return new Point(this.x, this.y);\n            },\n            invert: function () {\n                return new Rotation(FULL_CIRCLE_ANGLE - this.angle, this.x, this.y);\n            }\n        });\n        Rotation.ZERO = new Rotation(0);\n        Rotation.create = function (rotation) {\n            return new Rotation(rotation.angle, rotation.x, rotation.y);\n        };\n        Rotation.parse = function (str) {\n            var values = str.slice(1, str.length - 1).split(','), angle = values[0], x = values[1], y = values[2];\n            var rotation = new Rotation(angle, x, y);\n            return rotation;\n        };\n        var CompositeTransform = Class.extend({\n            init: function (x, y, scaleX, scaleY, angle, center) {\n                this.translate = new Translation(x, y);\n                if (scaleX !== undefined && scaleY !== undefined) {\n                    this.scale = new Scale(scaleX, scaleY);\n                }\n                if (angle !== undefined) {\n                    this.rotate = center ? new Rotation(angle, center.x, center.y) : new Rotation(angle);\n                }\n            },\n            toString: function () {\n                var toString = function (transform) {\n                    return transform ? transform.toString() : '';\n                };\n                return toString(this.translate) + toString(this.rotate) + toString(this.scale);\n            },\n            render: function (visual) {\n                visual._transform = this;\n                visual._renderTransform();\n            },\n            toMatrix: function () {\n                var m = Matrix.unit();\n                if (this.translate) {\n                    m = m.times(this.translate.toMatrix());\n                }\n                if (this.rotate) {\n                    m = m.times(this.rotate.toMatrix());\n                }\n                if (this.scale) {\n                    m = m.times(this.scale.toMatrix());\n                }\n                return m;\n            },\n            invert: function () {\n                var rotate = this.rotate ? this.rotate.invert() : undefined, rotateMatrix = rotate ? rotate.toMatrix() : Matrix.unit(), scale = this.scale ? this.scale.invert() : undefined, scaleMatrix = scale ? scale.toMatrix() : Matrix.unit();\n                var translatePoint = new Point(-this.translate.x, -this.translate.y);\n                translatePoint = rotateMatrix.times(scaleMatrix).apply(translatePoint);\n                var translate = new Translation(translatePoint.x, translatePoint.y);\n                var transform = new CompositeTransform();\n                transform.translate = translate;\n                transform.rotate = rotate;\n                transform.scale = scale;\n                return transform;\n            }\n        });\n        var AutoSizeableMixin = {\n            _setScale: function () {\n                var options = this.options;\n                var originWidth = this._originWidth;\n                var originHeight = this._originHeight;\n                var scaleX = options.width / originWidth;\n                var scaleY = options.height / originHeight;\n                if (!isNumber(scaleX)) {\n                    scaleX = 1;\n                }\n                if (!isNumber(scaleY)) {\n                    scaleY = 1;\n                }\n                this._transform.scale = new Scale(scaleX, scaleY);\n            },\n            _setTranslate: function () {\n                var options = this.options;\n                var x = options.x || 0;\n                var y = options.y || 0;\n                this._transform.translate = new Translation(x, y);\n            },\n            _initSize: function () {\n                var options = this.options;\n                var transform = false;\n                if (options.autoSize !== false && (defined(options.width) || defined(options.height))) {\n                    this._measure(true);\n                    this._setScale();\n                    transform = true;\n                }\n                if (defined(options.x) || defined(options.y)) {\n                    this._setTranslate();\n                    transform = true;\n                }\n                if (transform) {\n                    this._renderTransform();\n                }\n            },\n            _updateSize: function (options) {\n                var update = false;\n                if (this.options.autoSize !== false && this._diffNumericOptions(options, [\n                        WIDTH,\n                        HEIGHT\n                    ])) {\n                    update = true;\n                    this._measure(true);\n                    this._setScale();\n                }\n                if (this._diffNumericOptions(options, [\n                        X,\n                        Y\n                    ])) {\n                    update = true;\n                    this._setTranslate();\n                }\n                if (update) {\n                    this._renderTransform();\n                }\n                return update;\n            }\n        };\n        var Element = Class.extend({\n            init: function (options) {\n                var element = this;\n                element.options = deepExtend({}, element.options, options);\n                element.id = element.options.id;\n                element._originSize = Rect.empty();\n                element._transform = new CompositeTransform();\n            },\n            visible: function (value) {\n                return this.drawingContainer().visible(value);\n            },\n            redraw: function (options) {\n                if (options && options.id) {\n                    this.id = options.id;\n                }\n            },\n            position: function (x, y) {\n                var options = this.options;\n                if (!defined(x)) {\n                    return new Point(options.x, options.y);\n                }\n                if (defined(y)) {\n                    options.x = x;\n                    options.y = y;\n                } else if (x instanceof Point) {\n                    options.x = x.x;\n                    options.y = x.y;\n                }\n                this._transform.translate = new Translation(options.x, options.y);\n                this._renderTransform();\n            },\n            rotate: function (angle, center) {\n                if (defined(angle)) {\n                    this._transform.rotate = new Rotation(angle, center.x, center.y);\n                    this._renderTransform();\n                }\n                return this._transform.rotate || Rotation.ZERO;\n            },\n            drawingContainer: function () {\n                return this.drawingElement;\n            },\n            _renderTransform: function () {\n                var matrix = this._transform.toMatrix();\n                this.drawingContainer().transform(new g.Matrix(matrix.a, matrix.b, matrix.c, matrix.d, matrix.e, matrix.f));\n            },\n            _hover: function () {\n            },\n            _diffNumericOptions: diffNumericOptions,\n            _measure: function (force) {\n                var rect;\n                if (!this._measured || force) {\n                    var box = this._boundingBox() || new g.Rect();\n                    var startPoint = box.topLeft();\n                    rect = new Rect(startPoint.x, startPoint.y, box.width(), box.height());\n                    this._originSize = rect;\n                    this._originWidth = rect.width;\n                    this._originHeight = rect.height;\n                    this._measured = true;\n                } else {\n                    rect = this._originSize;\n                }\n                return rect;\n            },\n            _boundingBox: function () {\n                return this.drawingElement.rawBBox();\n            }\n        });\n        var VisualBase = Element.extend({\n            init: function (options) {\n                Element.fn.init.call(this, options);\n                options = this.options;\n                options.fill = normalizeDrawingOptions(options.fill);\n                options.stroke = normalizeDrawingOptions(options.stroke);\n            },\n            options: {\n                stroke: {\n                    color: 'gray',\n                    width: 1\n                },\n                fill: { color: TRANSPARENT }\n            },\n            fill: function (color, opacity) {\n                this._fill({\n                    color: getColor(color),\n                    opacity: opacity\n                });\n            },\n            stroke: function (color, width, opacity) {\n                this._stroke({\n                    color: getColor(color),\n                    width: width,\n                    opacity: opacity\n                });\n            },\n            redraw: function (options) {\n                if (options) {\n                    var stroke = options.stroke;\n                    var fill = options.fill;\n                    if (stroke) {\n                        this._stroke(normalizeDrawingOptions(stroke));\n                    }\n                    if (fill) {\n                        this._fill(normalizeDrawingOptions(fill));\n                    }\n                    Element.fn.redraw.call(this, options);\n                }\n            },\n            _hover: function (show) {\n                var drawingElement = this.drawingElement;\n                var options = this.options;\n                var hover = options.hover;\n                if (hover && hover.fill) {\n                    var fill = show ? normalizeDrawingOptions(hover.fill) : options.fill;\n                    drawingElement.fill(fill.color, fill.opacity);\n                }\n            },\n            _stroke: function (strokeOptions) {\n                var options = this.options;\n                deepExtend(options, { stroke: strokeOptions });\n                strokeOptions = options.stroke;\n                var stroke = null;\n                if (strokeOptions.width > 0) {\n                    stroke = {\n                        color: strokeOptions.color,\n                        width: strokeOptions.width,\n                        opacity: strokeOptions.opacity,\n                        dashType: strokeOptions.dashType\n                    };\n                }\n                this.drawingElement.options.set('stroke', stroke);\n            },\n            _fill: function (fillOptions) {\n                var options = this.options;\n                deepExtend(options, { fill: fillOptions || {} });\n                var fill = options.fill;\n                if (fill.gradient) {\n                    var gradient = fill.gradient;\n                    var GradientClass = gradient.type === 'radial' ? d.RadialGradient : d.LinearGradient;\n                    this.drawingElement.fill(new GradientClass(gradient));\n                } else {\n                    this.drawingElement.fill(fill.color, fill.opacity);\n                }\n            }\n        });\n        var TextBlock = VisualBase.extend({\n            init: function (options) {\n                options = this._textColor(options);\n                VisualBase.fn.init.call(this, options);\n                this._font();\n                this._initText();\n                this._initSize();\n            },\n            options: {\n                fontSize: 15,\n                fontFamily: 'sans-serif',\n                stroke: { width: 0 },\n                fill: { color: 'black' },\n                autoSize: true\n            },\n            _initText: function () {\n                var options = this.options;\n                this.drawingElement = new d.Text(defined(options.text) ? options.text : '', new g.Point(), { font: options.font });\n                this._fill();\n                this._stroke();\n            },\n            _textColor: function (options) {\n                if (options && options.color) {\n                    options = deepExtend({}, options, { fill: { color: options.color } });\n                }\n                return options;\n            },\n            _font: function () {\n                var options = this.options;\n                if (options.fontFamily && defined(options.fontSize)) {\n                    var fontOptions = [];\n                    if (options.fontStyle) {\n                        fontOptions.push(options.fontStyle);\n                    }\n                    if (options.fontWeight) {\n                        fontOptions.push(options.fontWeight);\n                    }\n                    fontOptions.push(options.fontSize + (isNumber(options.fontSize) ? 'px' : ''));\n                    fontOptions.push(options.fontFamily);\n                    options.font = fontOptions.join(' ');\n                } else {\n                    delete options.font;\n                }\n            },\n            content: function (text) {\n                return this.drawingElement.content(text);\n            },\n            redraw: function (options) {\n                if (options) {\n                    var sizeChanged = false;\n                    var textOptions = this.options;\n                    options = this._textColor(options);\n                    VisualBase.fn.redraw.call(this, options);\n                    if (options.fontFamily || defined(options.fontSize) || options.fontStyle || options.fontWeight) {\n                        deepExtend(textOptions, {\n                            fontFamily: options.fontFamily,\n                            fontSize: options.fontSize,\n                            fontStyle: options.fontStyle,\n                            fontWeight: options.fontWeight\n                        });\n                        this._font();\n                        this.drawingElement.options.set('font', textOptions.font);\n                        sizeChanged = true;\n                    }\n                    if (options.text) {\n                        this.content(options.text);\n                        sizeChanged = true;\n                    }\n                    if (!this._updateSize(options) && sizeChanged) {\n                        this._initSize();\n                    }\n                }\n            }\n        });\n        deepExtend(TextBlock.fn, AutoSizeableMixin);\n        var Rectangle = VisualBase.extend({\n            init: function (options) {\n                VisualBase.fn.init.call(this, options);\n                this._initPath();\n                this._setPosition();\n            },\n            _setPosition: function () {\n                var options = this.options;\n                var x = options.x;\n                var y = options.y;\n                if (defined(x) || defined(y)) {\n                    this.position(x || 0, y || 0);\n                }\n            },\n            redraw: function (options) {\n                if (options) {\n                    VisualBase.fn.redraw.call(this, options);\n                    if (this._diffNumericOptions(options, [\n                            WIDTH,\n                            HEIGHT\n                        ])) {\n                        this._drawPath();\n                    }\n                    if (this._diffNumericOptions(options, [\n                            X,\n                            Y\n                        ])) {\n                        this._setPosition();\n                    }\n                }\n            },\n            _initPath: function () {\n                var options = this.options;\n                this.drawingElement = new d.Path({\n                    stroke: options.stroke,\n                    closed: true\n                });\n                this._fill();\n                this._drawPath();\n            },\n            _drawPath: function () {\n                var drawingElement = this.drawingElement;\n                var sizeOptions = sizeOptionsOrDefault(this.options);\n                var width = sizeOptions.width;\n                var height = sizeOptions.height;\n                drawingElement.segments.elements([\n                    createSegment(0, 0),\n                    createSegment(width, 0),\n                    createSegment(width, height),\n                    createSegment(0, height)\n                ]);\n            }\n        });\n        var MarkerBase = VisualBase.extend({\n            init: function (options) {\n                VisualBase.fn.init.call(this, options);\n                var anchor = this.options.anchor;\n                this.anchor = new g.Point(anchor.x, anchor.y);\n                this.createElement();\n            },\n            options: {\n                stroke: {\n                    color: TRANSPARENT,\n                    width: 0\n                },\n                fill: { color: 'black' }\n            },\n            _transformToPath: function (point, path) {\n                var transform = path.transform();\n                if (point && transform) {\n                    point = point.transformCopy(transform);\n                }\n                return point;\n            },\n            redraw: function (options) {\n                if (options) {\n                    if (options.position) {\n                        this.options.position = options.position;\n                    }\n                    VisualBase.fn.redraw.call(this, options);\n                }\n            }\n        });\n        var CircleMarker = MarkerBase.extend({\n            options: {\n                radius: 4,\n                anchor: {\n                    x: 0,\n                    y: 0\n                }\n            },\n            createElement: function () {\n                var options = this.options;\n                this.drawingElement = new d.Circle(new g.Circle(this.anchor, options.radius), {\n                    fill: options.fill,\n                    stroke: options.stroke\n                });\n            },\n            positionMarker: function (path) {\n                var options = this.options;\n                var position = options.position;\n                var segments = path.segments;\n                var targetSegment;\n                var point;\n                if (position == START) {\n                    targetSegment = segments[0];\n                } else {\n                    targetSegment = segments[segments.length - 1];\n                }\n                if (targetSegment) {\n                    point = this._transformToPath(targetSegment.anchor(), path);\n                    this.drawingElement.transform(g.transform().translate(point.x, point.y));\n                }\n            }\n        });\n        var ArrowMarker = MarkerBase.extend({\n            options: {\n                path: 'M 0 0 L 10 5 L 0 10 L 3 5 z',\n                anchor: {\n                    x: 10,\n                    y: 5\n                }\n            },\n            createElement: function () {\n                var options = this.options;\n                this.drawingElement = d.Path.parse(options.path, {\n                    fill: options.fill,\n                    stroke: options.stroke\n                });\n            },\n            positionMarker: function (path) {\n                var points = this._linePoints(path);\n                var start = points.start;\n                var end = points.end;\n                var transform = g.transform();\n                if (start) {\n                    transform.rotate(lineAngle(start, end), end);\n                }\n                if (end) {\n                    var anchor = this.anchor;\n                    var translate = end.clone().translate(-anchor.x, -anchor.y);\n                    transform.translate(translate.x, translate.y);\n                }\n                this.drawingElement.transform(transform);\n            },\n            _linePoints: function (path) {\n                var options = this.options;\n                var segments = path.segments;\n                var startPoint, endPoint, targetSegment;\n                if (options.position == START) {\n                    targetSegment = segments[0];\n                    if (targetSegment) {\n                        endPoint = targetSegment.anchor();\n                        startPoint = targetSegment.controlOut();\n                        var nextSegment = segments[1];\n                        if (!startPoint && nextSegment) {\n                            startPoint = nextSegment.anchor();\n                        }\n                    }\n                } else {\n                    targetSegment = segments[segments.length - 1];\n                    if (targetSegment) {\n                        endPoint = targetSegment.anchor();\n                        startPoint = targetSegment.controlIn();\n                        var prevSegment = segments[segments.length - 2];\n                        if (!startPoint && prevSegment) {\n                            startPoint = prevSegment.anchor();\n                        }\n                    }\n                }\n                if (endPoint) {\n                    return {\n                        start: this._transformToPath(startPoint, path),\n                        end: this._transformToPath(endPoint, path)\n                    };\n                }\n            }\n        });\n        var MarkerPathMixin = {\n            _getPath: function (position) {\n                var path = this.drawingElement;\n                if (path instanceof d.MultiPath) {\n                    if (position == START) {\n                        path = path.paths[0];\n                    } else {\n                        path = path.paths[path.paths.length - 1];\n                    }\n                }\n                if (path && path.segments.length) {\n                    return path;\n                }\n            },\n            _normalizeMarkerOptions: function (options) {\n                var startCap = options.startCap;\n                var endCap = options.endCap;\n                if (isString(startCap)) {\n                    options.startCap = { type: startCap };\n                }\n                if (isString(endCap)) {\n                    options.endCap = { type: endCap };\n                }\n            },\n            _removeMarker: function (position) {\n                var marker = this._markers[position];\n                if (marker) {\n                    this.drawingContainer().remove(marker.drawingElement);\n                    delete this._markers[position];\n                }\n            },\n            _createMarkers: function () {\n                var options = this.options;\n                this._normalizeMarkerOptions(options);\n                this._markers = {};\n                this._markers[START] = this._createMarker(options.startCap, START);\n                this._markers[END] = this._createMarker(options.endCap, END);\n            },\n            _createMarker: function (options, position) {\n                var type = (options || {}).type;\n                var path = this._getPath(position);\n                var markerType, marker;\n                if (!path) {\n                    this._removeMarker(position);\n                    return;\n                }\n                if (type == Markers.filledCircle) {\n                    markerType = CircleMarker;\n                } else if (type == Markers.arrowStart || type == Markers.arrowEnd) {\n                    markerType = ArrowMarker;\n                } else {\n                    this._removeMarker(position);\n                }\n                if (markerType) {\n                    marker = new markerType(deepExtend({}, options, { position: position }));\n                    marker.positionMarker(path);\n                    this.drawingContainer().append(marker.drawingElement);\n                    return marker;\n                }\n            },\n            _positionMarker: function (position) {\n                var marker = this._markers[position];\n                if (marker) {\n                    var path = this._getPath(position);\n                    if (path) {\n                        marker.positionMarker(path);\n                    } else {\n                        this._removeMarker(position);\n                    }\n                }\n            },\n            _capMap: {\n                start: 'startCap',\n                end: 'endCap'\n            },\n            _redrawMarker: function (pathChange, position, options) {\n                this._normalizeMarkerOptions(options);\n                var pathOptions = this.options;\n                var cap = this._capMap[position];\n                var pathCapType = (pathOptions[cap] || {}).type;\n                var optionsCap = options[cap];\n                var created = false;\n                if (optionsCap) {\n                    pathOptions[cap] = deepExtend({}, pathOptions[cap], optionsCap);\n                    if (optionsCap.type && pathCapType != optionsCap.type) {\n                        this._removeMarker(position);\n                        this._markers[position] = this._createMarker(pathOptions[cap], position);\n                        created = true;\n                    } else if (this._markers[position]) {\n                        this._markers[position].redraw(optionsCap);\n                    }\n                } else if (pathChange && !this._markers[position] && pathOptions[cap]) {\n                    this._markers[position] = this._createMarker(pathOptions[cap], position);\n                    created = true;\n                }\n                return created;\n            },\n            _redrawMarkers: function (pathChange, options) {\n                if (!this._redrawMarker(pathChange, START, options) && pathChange) {\n                    this._positionMarker(START);\n                }\n                if (!this._redrawMarker(pathChange, END, options) && pathChange) {\n                    this._positionMarker(END);\n                }\n            }\n        };\n        var Path = VisualBase.extend({\n            init: function (options) {\n                VisualBase.fn.init.call(this, options);\n                this.container = new d.Group();\n                this._createElements();\n                this._initSize();\n            },\n            options: { autoSize: true },\n            drawingContainer: function () {\n                return this.container;\n            },\n            data: function (value) {\n                var options = this.options;\n                if (value) {\n                    if (options.data != value) {\n                        options.data = value;\n                        this._setData(value);\n                        this._initSize();\n                        this._redrawMarkers(true, {});\n                    }\n                } else {\n                    return options.data;\n                }\n            },\n            redraw: function (options) {\n                if (options) {\n                    VisualBase.fn.redraw.call(this, options);\n                    var pathOptions = this.options;\n                    var data = options.data;\n                    if (defined(data) && pathOptions.data != data) {\n                        pathOptions.data = data;\n                        this._setData(data);\n                        if (!this._updateSize(options)) {\n                            this._initSize();\n                        }\n                        this._redrawMarkers(true, options);\n                    } else {\n                        this._updateSize(options);\n                        this._redrawMarkers(false, options);\n                    }\n                }\n            },\n            _createElements: function () {\n                var options = this.options;\n                this.drawingElement = d.Path.parse(options.data || '', { stroke: options.stroke });\n                this._fill();\n                this.container.append(this.drawingElement);\n                this._createMarkers();\n            },\n            _setData: function (data) {\n                var drawingElement = this.drawingElement;\n                var multipath = d.Path.parse(data || '');\n                var paths = multipath.paths.slice(0);\n                multipath.paths.elements([]);\n                drawingElement.paths.elements(paths);\n            }\n        });\n        deepExtend(Path.fn, AutoSizeableMixin);\n        deepExtend(Path.fn, MarkerPathMixin);\n        var Line = VisualBase.extend({\n            init: function (options) {\n                VisualBase.fn.init.call(this, options);\n                this.container = new d.Group();\n                this._initPath();\n                this._createMarkers();\n            },\n            drawingContainer: function () {\n                return this.container;\n            },\n            redraw: function (options) {\n                if (options) {\n                    options = options || {};\n                    var from = options.from;\n                    var to = options.to;\n                    if (from) {\n                        this.options.from = from;\n                    }\n                    if (to) {\n                        this.options.to = to;\n                    }\n                    if (from || to) {\n                        this._drawPath();\n                        this._redrawMarkers(true, options);\n                    } else {\n                        this._redrawMarkers(false, options);\n                    }\n                    VisualBase.fn.redraw.call(this, options);\n                }\n            },\n            _initPath: function () {\n                var options = this.options;\n                var drawingElement = this.drawingElement = new d.Path({ stroke: options.stroke });\n                this._fill();\n                this._drawPath();\n                this.container.append(drawingElement);\n            },\n            _drawPath: function () {\n                var options = this.options;\n                var drawingElement = this.drawingElement;\n                var from = options.from || new Point();\n                var to = options.to || new Point();\n                drawingElement.segments.elements([\n                    createSegment(from.x, from.y),\n                    createSegment(to.x, to.y)\n                ]);\n            }\n        });\n        deepExtend(Line.fn, MarkerPathMixin);\n        var Polyline = VisualBase.extend({\n            init: function (options) {\n                VisualBase.fn.init.call(this, options);\n                this.container = new d.Group();\n                this._initPath();\n                this._createMarkers();\n            },\n            drawingContainer: function () {\n                return this.container;\n            },\n            points: function (points) {\n                var options = this.options;\n                if (points) {\n                    options.points = points;\n                    this._updatePath();\n                } else {\n                    return options.points;\n                }\n            },\n            redraw: function (options) {\n                if (options) {\n                    var points = options.points;\n                    VisualBase.fn.redraw.call(this, options);\n                    if (points && this._pointsDiffer(points)) {\n                        this.points(points);\n                        this._redrawMarkers(true, options);\n                    } else {\n                        this._redrawMarkers(false, options);\n                    }\n                }\n            },\n            _initPath: function () {\n                var options = this.options;\n                this.drawingElement = new d.Path({ stroke: options.stroke });\n                this._fill();\n                this.container.append(this.drawingElement);\n                if (options.points) {\n                    this._updatePath();\n                }\n            },\n            _pointsDiffer: function (points) {\n                var currentPoints = this.options.points;\n                var differ = currentPoints.length !== points.length;\n                if (!differ) {\n                    for (var i = 0; i < points.length; i++) {\n                        if (currentPoints[i].x !== points[i].x || currentPoints[i].y !== points[i].y) {\n                            differ = true;\n                            break;\n                        }\n                    }\n                }\n                return differ;\n            },\n            _updatePath: function () {\n                var drawingElement = this.drawingElement;\n                var options = this.options;\n                var points = options.points;\n                var segments = [];\n                var point;\n                for (var i = 0; i < points.length; i++) {\n                    point = points[i];\n                    segments.push(createSegment(point.x, point.y));\n                }\n                drawingElement.segments.elements(segments);\n            },\n            options: { points: [] }\n        });\n        deepExtend(Polyline.fn, MarkerPathMixin);\n        var Image = Element.extend({\n            init: function (options) {\n                Element.fn.init.call(this, options);\n                this._initImage();\n            },\n            redraw: function (options) {\n                if (options) {\n                    if (options.source) {\n                        this.drawingElement.src(options.source);\n                    }\n                    if (this._diffNumericOptions(options, [\n                            WIDTH,\n                            HEIGHT,\n                            X,\n                            Y\n                        ])) {\n                        this.drawingElement.rect(this._rect());\n                    }\n                    Element.fn.redraw.call(this, options);\n                }\n            },\n            _initImage: function () {\n                var options = this.options;\n                var rect = this._rect();\n                this.drawingElement = new d.Image(options.source, rect, {});\n            },\n            _rect: function () {\n                var sizeOptions = sizeOptionsOrDefault(this.options);\n                var origin = new g.Point(sizeOptions.x, sizeOptions.y);\n                var size = new g.Size(sizeOptions.width, sizeOptions.height);\n                return new g.Rect(origin, size);\n            }\n        });\n        var Group = Element.extend({\n            init: function (options) {\n                this.children = [];\n                Element.fn.init.call(this, options);\n                this.drawingElement = new d.Group();\n                this._initSize();\n            },\n            options: { autoSize: false },\n            append: function (visual) {\n                this.drawingElement.append(visual.drawingContainer());\n                this.children.push(visual);\n                this._childrenChange = true;\n            },\n            remove: function (visual) {\n                if (this._remove(visual)) {\n                    this._childrenChange = true;\n                }\n            },\n            _remove: function (visual) {\n                var index = inArray(visual, this.children);\n                if (index >= 0) {\n                    this.drawingElement.removeAt(index);\n                    this.children.splice(index, 1);\n                    return true;\n                }\n            },\n            clear: function () {\n                this.drawingElement.clear();\n                this.children = [];\n                this._childrenChange = true;\n            },\n            toFront: function (visuals) {\n                var visual;\n                for (var i = 0; i < visuals.length; i++) {\n                    visual = visuals[i];\n                    if (this._remove(visual)) {\n                        this.append(visual);\n                    }\n                }\n            },\n            toBack: function (visuals) {\n                this._reorderChildren(visuals, 0);\n            },\n            toIndex: function (visuals, indices) {\n                this._reorderChildren(visuals, indices);\n            },\n            _reorderChildren: function (visuals, indices) {\n                var group = this.drawingElement;\n                var drawingChildren = group.children.slice(0);\n                var children = this.children;\n                var fixedPosition = isNumber(indices);\n                var i, index, toIndex, drawingElement, visual;\n                for (i = 0; i < visuals.length; i++) {\n                    visual = visuals[i];\n                    drawingElement = visual.drawingContainer();\n                    index = inArray(visual, children);\n                    if (index >= 0) {\n                        drawingChildren.splice(index, 1);\n                        children.splice(index, 1);\n                        toIndex = fixedPosition ? indices : indices[i];\n                        drawingChildren.splice(toIndex, 0, drawingElement);\n                        children.splice(toIndex, 0, visual);\n                    }\n                }\n                group.clear();\n                group.append.apply(group, drawingChildren);\n            },\n            redraw: function (options) {\n                if (options) {\n                    if (this._childrenChange) {\n                        this._childrenChange = false;\n                        if (!this._updateSize(options)) {\n                            this._initSize();\n                        }\n                    } else {\n                        this._updateSize(options);\n                    }\n                    Element.fn.redraw.call(this, options);\n                }\n            },\n            _boundingBox: function () {\n                var children = this.children;\n                var boundingBox;\n                var visual, childBoundingBox;\n                for (var i = 0; i < children.length; i++) {\n                    visual = children[i];\n                    if (visual.visible() && visual._includeInBBox !== false) {\n                        childBoundingBox = visual.drawingContainer().clippedBBox(null);\n                        if (childBoundingBox) {\n                            if (boundingBox) {\n                                boundingBox = g.Rect.union(boundingBox, childBoundingBox);\n                            } else {\n                                boundingBox = childBoundingBox;\n                            }\n                        }\n                    }\n                }\n                return boundingBox;\n            }\n        });\n        deepExtend(Group.fn, AutoSizeableMixin);\n        var Layout = Group.extend({\n            init: function (rect, options) {\n                this.children = [];\n                Element.fn.init.call(this, options);\n                this.drawingElement = new d.Layout(toDrawingRect(rect), options);\n                this._initSize();\n            },\n            rect: function (rect) {\n                if (rect) {\n                    this.drawingElement.rect(toDrawingRect(rect));\n                } else {\n                    var drawingRect = this.drawingElement.rect();\n                    if (drawingRect) {\n                        return new Rect(drawingRect.origin.x, drawingRect.origin.y, drawingRect.size.width, drawingRect.size.height);\n                    }\n                }\n            },\n            reflow: function () {\n                this.drawingElement.reflow();\n            },\n            redraw: function (options) {\n                kendo.deepExtend(this.drawingElement.options, options);\n                Group.fn.redraw.call(this, options);\n            }\n        });\n        var Circle = VisualBase.extend({\n            init: function (options) {\n                VisualBase.fn.init.call(this, options);\n                this._initCircle();\n                this._initSize();\n            },\n            redraw: function (options) {\n                if (options) {\n                    var circleOptions = this.options;\n                    if (options.center) {\n                        deepExtend(circleOptions, { center: options.center });\n                        this._center.move(circleOptions.center.x, circleOptions.center.y);\n                    }\n                    if (this._diffNumericOptions(options, ['radius'])) {\n                        this._circle.setRadius(circleOptions.radius);\n                    }\n                    this._updateSize(options);\n                    VisualBase.fn.redraw.call(this, options);\n                }\n            },\n            _initCircle: function () {\n                var options = this.options;\n                var width = options.width;\n                var height = options.height;\n                var radius = options.radius;\n                if (!defined(radius)) {\n                    if (!defined(width)) {\n                        width = height;\n                    }\n                    if (!defined(height)) {\n                        height = width;\n                    }\n                    options.radius = radius = Math.min(width, height) / 2;\n                }\n                var center = options.center || {\n                    x: radius,\n                    y: radius\n                };\n                this._center = new g.Point(center.x, center.y);\n                this._circle = new g.Circle(this._center, radius);\n                this.drawingElement = new d.Circle(this._circle, { stroke: options.stroke });\n                this._fill();\n            }\n        });\n        deepExtend(Circle.fn, AutoSizeableMixin);\n        var Canvas = Class.extend({\n            init: function (element, options) {\n                options = options || {};\n                this.element = element;\n                this.surface = d.Surface.create(element, options);\n                if (kendo.isFunction(this.surface.translate)) {\n                    this.translate = this._translate;\n                }\n                this.drawingElement = new d.Group();\n                this._viewBox = new Rect(0, 0, options.width, options.height);\n                this.size(this._viewBox);\n            },\n            bounds: function () {\n                var box = this.drawingElement.clippedBBox();\n                return new Rect(0, 0, box.width(), box.height());\n            },\n            size: function (size) {\n                var viewBox = this._viewBox;\n                if (defined(size)) {\n                    viewBox.width = size.width;\n                    viewBox.height = size.height;\n                    this.surface.setSize(size);\n                }\n                return {\n                    width: viewBox.width,\n                    height: viewBox.height\n                };\n            },\n            _translate: function (x, y) {\n                var viewBox = this._viewBox;\n                if (defined(x) && defined(y)) {\n                    viewBox.x = x;\n                    viewBox.y = y;\n                    this.surface.translate({\n                        x: x,\n                        y: y\n                    });\n                }\n                return {\n                    x: viewBox.x,\n                    y: viewBox.y\n                };\n            },\n            draw: function () {\n                this.surface.draw(this.drawingElement);\n            },\n            append: function (visual) {\n                this.drawingElement.append(visual.drawingContainer());\n                return this;\n            },\n            remove: function (visual) {\n                this.drawingElement.remove(visual.drawingContainer());\n            },\n            insertBefore: function () {\n            },\n            clear: function () {\n                this.drawingElement.clear();\n            },\n            destroy: function (clearHtml) {\n                this.surface.destroy();\n                if (clearHtml) {\n                    $(this.element).remove();\n                }\n            }\n        });\n        function sizeOptionsOrDefault(options) {\n            return {\n                x: options.x || 0,\n                y: options.y || 0,\n                width: options.width || 0,\n                height: options.height || 0\n            };\n        }\n        function normalizeDrawingOptions(options) {\n            if (options) {\n                var drawingOptions = options;\n                if (isString(drawingOptions)) {\n                    drawingOptions = { color: drawingOptions };\n                }\n                if (drawingOptions.color) {\n                    drawingOptions.color = getColor(drawingOptions.color);\n                }\n                return drawingOptions;\n            }\n        }\n        function getColor(value) {\n            var color;\n            if (value != TRANSPARENT) {\n                color = new d.Color(value).toHex();\n            } else {\n                color = value;\n            }\n            return color;\n        }\n        function lineAngle(p1, p2) {\n            var xDiff = p2.x - p1.x;\n            var yDiff = p2.y - p1.y;\n            var angle = kendo.util.deg(Math.atan2(yDiff, xDiff));\n            return angle;\n        }\n        function createSegment(x, y) {\n            return new d.Segment(new g.Point(x, y));\n        }\n        function toDrawingRect(rect) {\n            if (rect) {\n                return new g.Rect([\n                    rect.x,\n                    rect.y\n                ], [\n                    rect.width,\n                    rect.height\n                ]);\n            }\n        }\n        kendo.deepExtend(diagram, {\n            init: function (element) {\n                kendo.init(element, diagram.ui);\n            },\n            diffNumericOptions: diffNumericOptions,\n            Element: Element,\n            Scale: Scale,\n            Translation: Translation,\n            Rotation: Rotation,\n            Circle: Circle,\n            Group: Group,\n            Rectangle: Rectangle,\n            Canvas: Canvas,\n            Path: Path,\n            Layout: Layout,\n            Line: Line,\n            MarkerBase: MarkerBase,\n            ArrowMarker: ArrowMarker,\n            CircleMarker: CircleMarker,\n            Polyline: Polyline,\n            CompositeTransform: CompositeTransform,\n            TextBlock: TextBlock,\n            Image: Image,\n            VisualBase: VisualBase\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('dataviz/diagram/services', [\n        'kendo.drawing',\n        'dataviz/diagram/svg'\n    ], f);\n}(function () {\n    (function ($, undefined) {\n        var kendo = window.kendo, dataviz = kendo.dataviz, diagram = dataviz.diagram, Class = kendo.Class, Group = diagram.Group, Rect = diagram.Rect, Rectangle = diagram.Rectangle, Utils = diagram.Utils, isUndefined = Utils.isUndefined, Point = diagram.Point, Circle = diagram.Circle, Ticker = diagram.Ticker, deepExtend = kendo.deepExtend, Movable = kendo.ui.Movable, browser = kendo.support.browser, defined = kendo.util.defined, inArray = $.inArray, proxy = $.proxy;\n        var Cursors = {\n                arrow: 'default',\n                grip: 'pointer',\n                cross: 'pointer',\n                add: 'pointer',\n                move: 'move',\n                select: 'pointer',\n                south: 's-resize',\n                east: 'e-resize',\n                west: 'w-resize',\n                north: 'n-resize',\n                rowresize: 'row-resize',\n                colresize: 'col-resize'\n            }, HIT_TEST_DISTANCE = 10, AUTO = 'Auto', TOP = 'Top', RIGHT = 'Right', LEFT = 'Left', BOTTOM = 'Bottom', DEFAULT_SNAP_SIZE = 10, DEFAULT_SNAP_ANGLE = 10, DRAG_START = 'dragStart', DRAG = 'drag', DRAG_END = 'dragEnd', ITEMROTATE = 'itemRotate', ITEMBOUNDSCHANGE = 'itemBoundsChange', MIN_SNAP_SIZE = 5, MIN_SNAP_ANGLE = 5, MOUSE_ENTER = 'mouseEnter', MOUSE_LEAVE = 'mouseLeave', ZOOM_START = 'zoomStart', ZOOM_END = 'zoomEnd', SCROLL_MIN = -20000, SCROLL_MAX = 20000, FRICTION = 0.9, FRICTION_MOBILE = 0.93, VELOCITY_MULTIPLIER = 5, TRANSPARENT = 'transparent', PAN = 'pan', ROTATED = 'rotated', SOURCE = 'source', TARGET = 'target', HANDLE_NAMES = {\n                '-1': SOURCE,\n                '1': TARGET\n            };\n        diagram.Cursors = Cursors;\n        var PositionAdapter = kendo.Class.extend({\n            init: function (layoutState) {\n                this.layoutState = layoutState;\n                this.diagram = layoutState.diagram;\n            },\n            initState: function () {\n                this.froms = [];\n                this.tos = [];\n                this.subjects = [];\n                function pusher(id, bounds) {\n                    var shape = this.diagram.getShapeById(id);\n                    if (shape) {\n                        this.subjects.push(shape);\n                        this.froms.push(shape.bounds().topLeft());\n                        this.tos.push(bounds.topLeft());\n                    }\n                }\n                this.layoutState.nodeMap.forEach(pusher, this);\n            },\n            update: function (tick) {\n                if (this.subjects.length <= 0) {\n                    return;\n                }\n                for (var i = 0; i < this.subjects.length; i++) {\n                    this.subjects[i].position(new Point(this.froms[i].x + (this.tos[i].x - this.froms[i].x) * tick, this.froms[i].y + (this.tos[i].y - this.froms[i].y) * tick));\n                }\n            }\n        });\n        var LayoutUndoUnit = Class.extend({\n            init: function (initialState, finalState, animate) {\n                if (isUndefined(animate)) {\n                    this.animate = false;\n                } else {\n                    this.animate = animate;\n                }\n                this._initialState = initialState;\n                this._finalState = finalState;\n                this.title = 'Diagram layout';\n            },\n            undo: function () {\n                this.setState(this._initialState);\n            },\n            redo: function () {\n                this.setState(this._finalState);\n            },\n            setState: function (state) {\n                var diagram = state.diagram;\n                if (this.animate) {\n                    state.linkMap.forEach(function (id, points) {\n                        var conn = diagram.getShapeById(id);\n                        conn.visible(false);\n                        if (conn) {\n                            conn.points(points);\n                        }\n                    });\n                    var ticker = new Ticker();\n                    ticker.addAdapter(new PositionAdapter(state));\n                    ticker.onComplete(function () {\n                        state.linkMap.forEach(function (id) {\n                            var conn = diagram.getShapeById(id);\n                            conn.visible(true);\n                        });\n                    });\n                    ticker.play();\n                } else {\n                    state.nodeMap.forEach(function (id, bounds) {\n                        var shape = diagram.getShapeById(id);\n                        if (shape) {\n                            shape.position(bounds.topLeft());\n                        }\n                    });\n                    state.linkMap.forEach(function (id, points) {\n                        var conn = diagram.getShapeById(id);\n                        if (conn) {\n                            conn.points(points);\n                        }\n                    });\n                }\n            }\n        });\n        var CompositeUnit = Class.extend({\n            init: function (unit) {\n                this.units = [];\n                this.title = 'Composite unit';\n                if (unit !== undefined) {\n                    this.units.push(unit);\n                }\n            },\n            add: function (undoUnit) {\n                this.units.push(undoUnit);\n            },\n            undo: function () {\n                for (var i = 0; i < this.units.length; i++) {\n                    this.units[i].undo();\n                }\n            },\n            redo: function () {\n                for (var i = 0; i < this.units.length; i++) {\n                    this.units[i].redo();\n                }\n            }\n        });\n        var ConnectionEditUnit = Class.extend({\n            init: function (item, redoSource, redoTarget) {\n                this.item = item;\n                this._redoSource = redoSource;\n                this._redoTarget = redoTarget;\n                if (defined(redoSource)) {\n                    this._undoSource = item.source();\n                }\n                if (defined(redoTarget)) {\n                    this._undoTarget = item.target();\n                }\n                this.title = 'Connection Editing';\n            },\n            undo: function () {\n                if (this._undoSource !== undefined) {\n                    this.item._updateConnector(this._undoSource, 'source');\n                }\n                if (this._undoTarget !== undefined) {\n                    this.item._updateConnector(this._undoTarget, 'target');\n                }\n                this.item.updateModel();\n            },\n            redo: function () {\n                if (this._redoSource !== undefined) {\n                    this.item._updateConnector(this._redoSource, 'source');\n                }\n                if (this._redoTarget !== undefined) {\n                    this.item._updateConnector(this._redoTarget, 'target');\n                }\n                this.item.updateModel();\n            }\n        });\n        var ConnectionEditUndoUnit = Class.extend({\n            init: function (item, undoSource, undoTarget) {\n                this.item = item;\n                this._undoSource = undoSource;\n                this._undoTarget = undoTarget;\n                this._redoSource = item.source();\n                this._redoTarget = item.target();\n                this.title = 'Connection Editing';\n            },\n            undo: function () {\n                this.item._updateConnector(this._undoSource, 'source');\n                this.item._updateConnector(this._undoTarget, 'target');\n                this.item.updateModel();\n            },\n            redo: function () {\n                this.item._updateConnector(this._redoSource, 'source');\n                this.item._updateConnector(this._redoTarget, 'target');\n                this.item.updateModel();\n            }\n        });\n        var DeleteConnectionUnit = Class.extend({\n            init: function (connection) {\n                this.connection = connection;\n                this.diagram = connection.diagram;\n                this.targetConnector = connection.targetConnector;\n                this.title = 'Delete connection';\n            },\n            undo: function () {\n                this.diagram._addConnection(this.connection, false);\n            },\n            redo: function () {\n                this.diagram.remove(this.connection, false);\n            }\n        });\n        var DeleteShapeUnit = Class.extend({\n            init: function (shape) {\n                this.shape = shape;\n                this.diagram = shape.diagram;\n                this.title = 'Deletion';\n            },\n            undo: function () {\n                this.diagram._addShape(this.shape, false);\n                this.shape.select(false);\n            },\n            redo: function () {\n                this.shape.select(false);\n                this.diagram.remove(this.shape, false);\n            }\n        });\n        var TransformUnit = Class.extend({\n            init: function (shapes, undoStates, adorner) {\n                this.shapes = shapes;\n                this.undoStates = undoStates;\n                this.title = 'Transformation';\n                this.redoStates = [];\n                this.adorner = adorner;\n                for (var i = 0; i < this.shapes.length; i++) {\n                    var shape = this.shapes[i];\n                    this.redoStates.push(shape.bounds());\n                }\n            },\n            undo: function () {\n                for (var i = 0; i < this.shapes.length; i++) {\n                    var shape = this.shapes[i];\n                    shape.bounds(this.undoStates[i]);\n                    if (shape.hasOwnProperty('layout')) {\n                        shape.layout(shape, this.redoStates[i], this.undoStates[i]);\n                    }\n                    shape.updateModel();\n                }\n                if (this.adorner) {\n                    this.adorner.refreshBounds();\n                    this.adorner.refresh();\n                }\n            },\n            redo: function () {\n                for (var i = 0; i < this.shapes.length; i++) {\n                    var shape = this.shapes[i];\n                    shape.bounds(this.redoStates[i]);\n                    if (shape.hasOwnProperty('layout')) {\n                        shape.layout(shape, this.undoStates[i], this.redoStates[i]);\n                    }\n                    shape.updateModel();\n                }\n                if (this.adorner) {\n                    this.adorner.refreshBounds();\n                    this.adorner.refresh();\n                }\n            }\n        });\n        var AddConnectionUnit = Class.extend({\n            init: function (connection, diagram) {\n                this.connection = connection;\n                this.diagram = diagram;\n                this.title = 'New connection';\n            },\n            undo: function () {\n                this.diagram.remove(this.connection, false);\n            },\n            redo: function () {\n                this.diagram._addConnection(this.connection, false);\n            }\n        });\n        var AddShapeUnit = Class.extend({\n            init: function (shape, diagram) {\n                this.shape = shape;\n                this.diagram = diagram;\n                this.title = 'New shape';\n            },\n            undo: function () {\n                this.diagram.deselect();\n                this.diagram.remove(this.shape, false);\n            },\n            redo: function () {\n                this.diagram._addShape(this.shape, false);\n            }\n        });\n        var PanUndoUnit = Class.extend({\n            init: function (initialPosition, finalPosition, diagram) {\n                this.initial = initialPosition;\n                this.finalPos = finalPosition;\n                this.diagram = diagram;\n                this.title = 'Pan Unit';\n            },\n            undo: function () {\n                this.diagram.pan(this.initial);\n            },\n            redo: function () {\n                this.diagram.pan(this.finalPos);\n            }\n        });\n        var RotateUnit = Class.extend({\n            init: function (adorner, shapes, undoRotates) {\n                this.shapes = shapes;\n                this.undoRotates = undoRotates;\n                this.title = 'Rotation';\n                this.redoRotates = [];\n                this.redoAngle = adorner._angle;\n                this.adorner = adorner;\n                this.center = adorner._innerBounds.center();\n                for (var i = 0; i < this.shapes.length; i++) {\n                    var shape = this.shapes[i];\n                    this.redoRotates.push(shape.rotate().angle);\n                }\n            },\n            undo: function () {\n                var i, shape;\n                for (i = 0; i < this.shapes.length; i++) {\n                    shape = this.shapes[i];\n                    shape.rotate(this.undoRotates[i], this.center, false);\n                    if (shape.hasOwnProperty('layout')) {\n                        shape.layout(shape);\n                    }\n                    shape.updateModel();\n                }\n                if (this.adorner) {\n                    this.adorner._initialize();\n                    this.adorner.refresh();\n                }\n            },\n            redo: function () {\n                var i, shape;\n                for (i = 0; i < this.shapes.length; i++) {\n                    shape = this.shapes[i];\n                    shape.rotate(this.redoRotates[i], this.center, false);\n                    if (shape.hasOwnProperty('layout')) {\n                        shape.layout(shape);\n                    }\n                    shape.updateModel();\n                }\n                if (this.adorner) {\n                    this.adorner._initialize();\n                    this.adorner.refresh();\n                }\n            }\n        });\n        var ToFrontUnit = Class.extend({\n            init: function (diagram, items, initialIndices) {\n                this.diagram = diagram;\n                this.indices = initialIndices;\n                this.items = items;\n                this.title = 'Rotate Unit';\n            },\n            undo: function () {\n                this.diagram._toIndex(this.items, this.indices);\n            },\n            redo: function () {\n                this.diagram.toFront(this.items, false);\n            }\n        });\n        var ToBackUnit = Class.extend({\n            init: function (diagram, items, initialIndices) {\n                this.diagram = diagram;\n                this.indices = initialIndices;\n                this.items = items;\n                this.title = 'Rotate Unit';\n            },\n            undo: function () {\n                this.diagram._toIndex(this.items, this.indices);\n            },\n            redo: function () {\n                this.diagram.toBack(this.items, false);\n            }\n        });\n        var UndoRedoService = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.bind(this.events, options);\n                this.stack = [];\n                this.index = 0;\n                this.capacity = 100;\n            },\n            events: [\n                'undone',\n                'redone'\n            ],\n            begin: function () {\n                this.composite = new CompositeUnit();\n            },\n            cancel: function () {\n                this.composite = undefined;\n            },\n            commit: function (execute) {\n                if (this.composite.units.length > 0) {\n                    this._restart(this.composite, execute);\n                }\n                this.composite = undefined;\n            },\n            addCompositeItem: function (undoUnit) {\n                if (this.composite) {\n                    this.composite.add(undoUnit);\n                } else {\n                    this.add(undoUnit);\n                }\n            },\n            add: function (undoUnit, execute) {\n                this._restart(undoUnit, execute);\n            },\n            pop: function () {\n                if (this.index > 0) {\n                    this.stack.pop();\n                    this.index--;\n                }\n            },\n            count: function () {\n                return this.stack.length;\n            },\n            undo: function () {\n                if (this.index > 0) {\n                    this.index--;\n                    this.stack[this.index].undo();\n                    this.trigger('undone');\n                }\n            },\n            redo: function () {\n                if (this.stack.length > 0 && this.index < this.stack.length) {\n                    this.stack[this.index].redo();\n                    this.index++;\n                    this.trigger('redone');\n                }\n            },\n            _restart: function (composite, execute) {\n                this.stack.splice(this.index, this.stack.length - this.index);\n                this.stack.push(composite);\n                if (execute !== false) {\n                    this.redo();\n                } else {\n                    this.index++;\n                }\n                if (this.stack.length > this.capacity) {\n                    this.stack.splice(0, this.stack.length - this.capacity);\n                    this.index = this.capacity;\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.index = 0;\n            }\n        });\n        var EmptyTool = Class.extend({\n            init: function (toolService) {\n                this.toolService = toolService;\n            },\n            start: function () {\n            },\n            move: function () {\n            },\n            end: function () {\n            },\n            tryActivate: function () {\n                return false;\n            },\n            getCursor: function () {\n                return Cursors.arrow;\n            }\n        });\n        var ScrollerTool = EmptyTool.extend({\n            init: function (toolService) {\n                var tool = this;\n                var friction = kendo.support.mobileOS ? FRICTION_MOBILE : FRICTION;\n                EmptyTool.fn.init.call(tool, toolService);\n                var diagram = tool.toolService.diagram, canvas = diagram.canvas;\n                var scroller = diagram.scroller = tool.scroller = $(diagram.scrollable).kendoMobileScroller({\n                    friction: friction,\n                    velocityMultiplier: VELOCITY_MULTIPLIER,\n                    mousewheelScrolling: false,\n                    zoom: false,\n                    scroll: proxy(tool._move, tool)\n                }).data('kendoMobileScroller');\n                if (canvas.translate) {\n                    tool.movableCanvas = new Movable(canvas.element);\n                }\n                var virtualScroll = function (dimension, min, max) {\n                    dimension.makeVirtual();\n                    dimension.virtualSize(min || SCROLL_MIN, max || SCROLL_MAX);\n                };\n                virtualScroll(scroller.dimensions.x);\n                virtualScroll(scroller.dimensions.y);\n                scroller.disable();\n            },\n            tryActivate: function (p, meta) {\n                var toolService = this.toolService;\n                var options = toolService.diagram.options.pannable;\n                var enabled = meta.ctrlKey;\n                if (defined(options.key)) {\n                    if (!options.key || options.key == 'none') {\n                        enabled = noMeta(meta) && !defined(toolService.hoveredItem);\n                    } else {\n                        enabled = meta[options.key + 'Key'];\n                    }\n                }\n                return options !== false && enabled && !defined(toolService.hoveredAdorner) && !defined(toolService._hoveredConnector);\n            },\n            start: function () {\n                this.scroller.enable();\n            },\n            move: function () {\n            },\n            _move: function (args) {\n                var tool = this, diagram = tool.toolService.diagram, canvas = diagram.canvas, scrollPos = new Point(args.scrollLeft, args.scrollTop);\n                if (canvas.translate) {\n                    diagram._storePan(scrollPos.times(-1));\n                    tool.movableCanvas.moveTo(scrollPos);\n                    canvas.translate(scrollPos.x, scrollPos.y);\n                } else {\n                    scrollPos = scrollPos.plus(diagram._pan.times(-1));\n                }\n                diagram.trigger(PAN, { pan: scrollPos });\n            },\n            end: function () {\n                this.scroller.disable();\n            },\n            getCursor: function () {\n                return Cursors.move;\n            }\n        });\n        var PointerTool = Class.extend({\n            init: function (toolService) {\n                this.toolService = toolService;\n            },\n            tryActivate: function () {\n                return true;\n            },\n            start: function (p, meta) {\n                var toolService = this.toolService, diagram = toolService.diagram, hoveredItem = toolService.hoveredItem;\n                if (hoveredItem) {\n                    toolService.selectSingle(hoveredItem, meta);\n                    if (hoveredItem.adorner) {\n                        this.adorner = hoveredItem.adorner;\n                        this.handle = this.adorner._hitTest(p);\n                    }\n                }\n                if (!this.handle) {\n                    this.handle = diagram._resizingAdorner._hitTest(p);\n                    if (this.handle) {\n                        this.adorner = diagram._resizingAdorner;\n                    }\n                }\n                if (this.adorner) {\n                    if (!this.adorner.isDragHandle(this.handle) || !diagram.trigger(DRAG_START, {\n                            shapes: this.adorner.shapes,\n                            connections: []\n                        })) {\n                        this.adorner.start(p);\n                    } else {\n                        toolService.startPoint = p;\n                        toolService.end(p);\n                    }\n                }\n            },\n            move: function (p) {\n                if (this.adorner) {\n                    this.adorner.move(this.handle, p);\n                    if (this.adorner.isDragHandle(this.handle)) {\n                        this.toolService.diagram.trigger(DRAG, {\n                            shapes: this.adorner.shapes,\n                            connections: []\n                        });\n                    }\n                }\n            },\n            end: function () {\n                var diagram = this.toolService.diagram, adorner = this.adorner, unit;\n                if (adorner) {\n                    if (!adorner.isDragHandle(this.handle) || !diagram.trigger(DRAG_END, {\n                            shapes: adorner.shapes,\n                            connections: []\n                        })) {\n                        unit = adorner.stop();\n                        if (unit) {\n                            diagram.undoRedoService.add(unit, false);\n                        }\n                    } else {\n                        adorner.cancel();\n                    }\n                }\n                this.adorner = undefined;\n                this.handle = undefined;\n            },\n            getCursor: function (p) {\n                return this.toolService.hoveredItem ? this.toolService.hoveredItem._getCursor(p) : Cursors.arrow;\n            }\n        });\n        var SelectionTool = Class.extend({\n            init: function (toolService) {\n                this.toolService = toolService;\n            },\n            tryActivate: function (p, meta) {\n                var toolService = this.toolService;\n                var selectable = toolService.diagram.options.selectable;\n                var enabled = selectable && selectable.multiple !== false;\n                if (enabled) {\n                    if (selectable.key && selectable.key != 'none') {\n                        enabled = meta[selectable.key + 'Key'];\n                    } else {\n                        enabled = noMeta(meta);\n                    }\n                }\n                return enabled && !defined(toolService.hoveredItem) && !defined(toolService.hoveredAdorner);\n            },\n            start: function (p) {\n                var diagram = this.toolService.diagram;\n                diagram.deselect();\n                diagram.selector.start(p);\n            },\n            move: function (p) {\n                var diagram = this.toolService.diagram;\n                diagram.selector.move(p);\n            },\n            end: function (p, meta) {\n                var diagram = this.toolService.diagram, hoveredItem = this.toolService.hoveredItem;\n                var rect = diagram.selector.bounds();\n                if ((!hoveredItem || !hoveredItem.isSelected) && !meta.ctrlKey) {\n                    diagram.deselect();\n                }\n                if (!rect.isEmpty()) {\n                    diagram.selectArea(rect);\n                }\n                diagram.selector.end();\n            },\n            getCursor: function () {\n                return Cursors.arrow;\n            }\n        });\n        var ConnectionTool = Class.extend({\n            init: function (toolService) {\n                this.toolService = toolService;\n                this.type = 'ConnectionTool';\n            },\n            tryActivate: function () {\n                return this.toolService._hoveredConnector;\n            },\n            start: function (p, meta) {\n                var toolService = this.toolService, diagram = toolService.diagram, connector = toolService._hoveredConnector, connection = diagram._createConnection({}, connector._c, p);\n                if (canDrag(connection) && !diagram.trigger(DRAG_START, {\n                        shapes: [],\n                        connections: [connection],\n                        connectionHandle: TARGET\n                    }) && diagram._addConnection(connection)) {\n                    toolService._connectionManipulation(connection, connector._c.shape, true);\n                    toolService._removeHover();\n                    toolService.selectSingle(toolService.activeConnection, meta);\n                } else {\n                    connection.source(null);\n                    toolService.end(p);\n                }\n            },\n            move: function (p) {\n                var toolService = this.toolService;\n                var connection = toolService.activeConnection;\n                connection.target(p);\n                toolService.diagram.trigger(DRAG, {\n                    shapes: [],\n                    connections: [connection],\n                    connectionHandle: TARGET\n                });\n                return true;\n            },\n            end: function (p) {\n                var toolService = this.toolService, d = toolService.diagram, connection = toolService.activeConnection, hoveredItem = toolService.hoveredItem, connector = toolService._hoveredConnector, target;\n                if (!connection) {\n                    return;\n                }\n                if (connector && connector._c != connection.sourceConnector) {\n                    target = connector._c;\n                } else if (hoveredItem && hoveredItem instanceof diagram.Shape) {\n                    target = hoveredItem.getConnector(AUTO) || hoveredItem.getConnector(p);\n                } else {\n                    target = p;\n                }\n                connection.target(target);\n                if (!d.trigger(DRAG_END, {\n                        shapes: [],\n                        connections: [connection],\n                        connectionHandle: TARGET\n                    })) {\n                    connection.updateModel();\n                    d._syncConnectionChanges();\n                } else {\n                    d.remove(connection, false);\n                    d.undoRedoService.pop();\n                }\n                toolService._connectionManipulation();\n            },\n            getCursor: function () {\n                return Cursors.arrow;\n            }\n        });\n        var ConnectionEditTool = Class.extend({\n            init: function (toolService) {\n                this.toolService = toolService;\n                this.type = 'ConnectionTool';\n            },\n            tryActivate: function (p, meta) {\n                var toolService = this.toolService, diagram = toolService.diagram, selectable = diagram.options.selectable, item = toolService.hoveredItem, isActive = selectable !== false && item && item.path && !(item.isSelected && meta.ctrlKey);\n                if (isActive) {\n                    this._c = item;\n                }\n                return isActive;\n            },\n            start: function (p, meta) {\n                var toolService = this.toolService;\n                var connection = this._c;\n                toolService.selectSingle(connection, meta);\n                var adorner = connection.adorner;\n                var handle, name;\n                if (adorner) {\n                    handle = adorner._hitTest(p);\n                    name = HANDLE_NAMES[handle];\n                }\n                if (canDrag(connection) && adorner && !toolService.diagram.trigger(DRAG_START, {\n                        shapes: [],\n                        connections: [connection],\n                        connectionHandle: name\n                    })) {\n                    this.handle = handle;\n                    this.handleName = name;\n                    adorner.start(p);\n                } else {\n                    toolService.startPoint = p;\n                    toolService.end(p);\n                }\n            },\n            move: function (p) {\n                var adorner = this._c.adorner;\n                if (canDrag(this._c) && adorner) {\n                    adorner.move(this.handle, p);\n                    this.toolService.diagram.trigger(DRAG, {\n                        shapes: [],\n                        connections: [this._c],\n                        connectionHandle: this.handleName\n                    });\n                    return true;\n                }\n            },\n            end: function (p) {\n                var connection = this._c;\n                var adorner = connection.adorner;\n                var toolService = this.toolService;\n                var diagram = toolService.diagram;\n                if (adorner) {\n                    if (canDrag(connection)) {\n                        var unit = adorner.stop(p);\n                        if (!diagram.trigger(DRAG_END, {\n                                shapes: [],\n                                connections: [connection],\n                                connectionHandle: this.handleName\n                            })) {\n                            diagram.undoRedoService.add(unit, false);\n                            connection.updateModel();\n                            diagram._syncConnectionChanges();\n                        } else {\n                            unit.undo();\n                        }\n                    }\n                }\n            },\n            getCursor: function () {\n                return Cursors.move;\n            }\n        });\n        function testKey(key, str) {\n            return str.charCodeAt(0) == key || str.toUpperCase().charCodeAt(0) == key;\n        }\n        var ToolService = Class.extend({\n            init: function (diagram) {\n                this.diagram = diagram;\n                this.tools = [\n                    new ScrollerTool(this),\n                    new ConnectionEditTool(this),\n                    new ConnectionTool(this),\n                    new SelectionTool(this),\n                    new PointerTool(this)\n                ];\n                this.activeTool = undefined;\n            },\n            start: function (p, meta) {\n                meta = deepExtend({}, meta);\n                if (this.activeTool) {\n                    this.activeTool.end(p, meta);\n                }\n                this._updateHoveredItem(p);\n                this._activateTool(p, meta);\n                this.activeTool.start(p, meta);\n                this._updateCursor(p);\n                this.diagram.focus();\n                this.diagram.canvas.surface.suspendTracking();\n                this.startPoint = p;\n                return true;\n            },\n            move: function (p, meta) {\n                meta = deepExtend({}, meta);\n                var updateHovered = true;\n                if (this.activeTool) {\n                    updateHovered = this.activeTool.move(p, meta);\n                }\n                if (updateHovered) {\n                    this._updateHoveredItem(p);\n                }\n                this._updateCursor(p);\n                return true;\n            },\n            end: function (p, meta) {\n                meta = deepExtend({}, meta);\n                if (this.activeTool) {\n                    this.activeTool.end(p, meta);\n                }\n                this.diagram.canvas.surface.resumeTracking();\n                this.activeTool = undefined;\n                this._updateCursor(p);\n                return true;\n            },\n            keyDown: function (key, meta) {\n                var diagram = this.diagram;\n                meta = deepExtend({\n                    ctrlKey: false,\n                    metaKey: false,\n                    altKey: false\n                }, meta);\n                if ((meta.ctrlKey || meta.metaKey) && !meta.altKey) {\n                    if (testKey(key, 'a')) {\n                        diagram.selectAll();\n                        diagram._destroyToolBar();\n                        return true;\n                    } else if (testKey(key, 'z')) {\n                        diagram.undo();\n                        diagram._destroyToolBar();\n                        return true;\n                    } else if (testKey(key, 'y')) {\n                        diagram.redo();\n                        diagram._destroyToolBar();\n                        return true;\n                    } else if (testKey(key, 'c')) {\n                        diagram.copy();\n                        diagram._destroyToolBar();\n                    } else if (testKey(key, 'x')) {\n                        diagram.cut();\n                        diagram._destroyToolBar();\n                    } else if (testKey(key, 'v')) {\n                        diagram.paste();\n                        diagram._destroyToolBar();\n                    } else if (testKey(key, 'l')) {\n                        diagram.layout();\n                        diagram._destroyToolBar();\n                    } else if (testKey(key, 'd')) {\n                        diagram._destroyToolBar();\n                        diagram.copy();\n                        diagram.paste();\n                    }\n                } else if (key === 46 || key === 8) {\n                    var toRemove = this.diagram._triggerRemove(diagram.select());\n                    if (toRemove.length) {\n                        this.diagram.remove(toRemove, true);\n                        this.diagram._syncChanges();\n                        this.diagram._destroyToolBar();\n                    }\n                    return true;\n                } else if (key === 27) {\n                    this._discardNewConnection();\n                    diagram.deselect();\n                    diagram._destroyToolBar();\n                    return true;\n                }\n            },\n            wheel: function (p, meta) {\n                var diagram = this.diagram, delta = meta.delta, z = diagram.zoom(), options = diagram.options, zoomRate = options.zoomRate, zoomOptions = {\n                        point: p,\n                        meta: meta,\n                        zoom: z\n                    };\n                if (diagram.trigger(ZOOM_START, zoomOptions)) {\n                    return;\n                }\n                if (delta < 0) {\n                    z += zoomRate;\n                } else {\n                    z -= zoomRate;\n                }\n                z = kendo.dataviz.round(Math.max(options.zoomMin, Math.min(options.zoomMax, z)), 2);\n                zoomOptions.zoom = z;\n                diagram.zoom(z, zoomOptions);\n                diagram.trigger(ZOOM_END, zoomOptions);\n                return true;\n            },\n            setTool: function (tool, index) {\n                tool.toolService = this;\n                this.tools[index] = tool;\n            },\n            selectSingle: function (item, meta) {\n                var diagram = this.diagram;\n                var selectable = diagram.options.selectable;\n                if (selectable && !item.isSelected && item.options.selectable !== false) {\n                    var addToSelection = meta.ctrlKey && selectable.multiple !== false;\n                    diagram.select(item, { addToSelection: addToSelection });\n                }\n            },\n            _discardNewConnection: function () {\n                if (this.newConnection) {\n                    this.diagram.remove(this.newConnection);\n                    this.newConnection = undefined;\n                }\n            },\n            _activateTool: function (p, meta) {\n                for (var i = 0; i < this.tools.length; i++) {\n                    var tool = this.tools[i];\n                    if (tool.tryActivate(p, meta)) {\n                        this.activeTool = tool;\n                        break;\n                    }\n                }\n            },\n            _updateCursor: function (p) {\n                var element = this.diagram.element;\n                var cursor = this.activeTool ? this.activeTool.getCursor(p) : this.hoveredAdorner ? this.hoveredAdorner._getCursor(p) : this.hoveredItem ? this.hoveredItem._getCursor(p) : Cursors.arrow;\n                element.css({ cursor: cursor });\n                if (browser.msie && browser.version == 7) {\n                    element[0].style.cssText = element[0].style.cssText;\n                }\n            },\n            _connectionManipulation: function (connection, disabledShape, isNew) {\n                this.activeConnection = connection;\n                this.disabledShape = disabledShape;\n                if (isNew) {\n                    this.newConnection = this.activeConnection;\n                } else {\n                    this.newConnection = undefined;\n                }\n            },\n            _updateHoveredItem: function (p) {\n                var hit = this._hitTest(p);\n                var diagram = this.diagram;\n                if (hit != this.hoveredItem && (!this.disabledShape || hit != this.disabledShape)) {\n                    if (this.hoveredItem) {\n                        diagram.trigger(MOUSE_LEAVE, { item: this.hoveredItem });\n                        this.hoveredItem._hover(false);\n                    }\n                    if (hit && hit.options.enable) {\n                        diagram.trigger(MOUSE_ENTER, { item: hit });\n                        this.hoveredItem = hit;\n                        this.hoveredItem._hover(true);\n                    } else {\n                        this.hoveredItem = undefined;\n                    }\n                }\n            },\n            _removeHover: function () {\n                if (this.hoveredItem) {\n                    this.hoveredItem._hover(false);\n                    this.hoveredItem = undefined;\n                }\n            },\n            _hitTest: function (point) {\n                var hit, d = this.diagram, item, i;\n                if (this._hoveredConnector) {\n                    this._hoveredConnector._hover(false);\n                    this._hoveredConnector = undefined;\n                }\n                if (d._connectorsAdorner._visible) {\n                    hit = d._connectorsAdorner._hitTest(point);\n                    if (hit) {\n                        return hit;\n                    }\n                }\n                hit = this.diagram._resizingAdorner._hitTest(point);\n                if (hit) {\n                    this.hoveredAdorner = d._resizingAdorner;\n                    if (hit.x !== 0 || hit.y !== 0) {\n                        return;\n                    }\n                    hit = undefined;\n                } else {\n                    this.hoveredAdorner = undefined;\n                }\n                if (!this.activeTool || this.activeTool.type !== 'ConnectionTool') {\n                    var selectedConnections = [];\n                    for (i = 0; i < d._selectedItems.length; i++) {\n                        item = d._selectedItems[i];\n                        if (item instanceof diagram.Connection) {\n                            selectedConnections.push(item);\n                        }\n                    }\n                    hit = this._hitTestItems(selectedConnections, point);\n                }\n                return hit || this._hitTestElements(point);\n            },\n            _hitTestElements: function (point) {\n                var diagram = this.diagram;\n                var shapeHit = this._hitTestItems(diagram.shapes, point);\n                var connectionHit = this._hitTestItems(diagram.connections, point);\n                var hit;\n                if ((!this.activeTool || this.activeTool.type != 'ConnectionTool') && shapeHit && connectionHit && !hitTestShapeConnectors(shapeHit, point)) {\n                    var mainLayer = diagram.mainLayer;\n                    var shapeIdx = inArray(shapeHit.visual, mainLayer.children);\n                    var connectionIdx = inArray(connectionHit.visual, mainLayer.children);\n                    hit = shapeIdx > connectionIdx ? shapeHit : connectionHit;\n                }\n                return hit || shapeHit || connectionHit;\n            },\n            _hitTestItems: function (array, point) {\n                var i, item, hit;\n                for (i = array.length - 1; i >= 0; i--) {\n                    item = array[i];\n                    hit = item._hitTest(point);\n                    if (hit) {\n                        return hit;\n                    }\n                }\n            }\n        });\n        var ConnectionRouterBase = kendo.Class.extend({\n            init: function () {\n            }\n        });\n        var LinearConnectionRouter = ConnectionRouterBase.extend({\n            init: function (connection) {\n                var that = this;\n                ConnectionRouterBase.fn.init.call(that);\n                this.connection = connection;\n            },\n            hitTest: function (p) {\n                var rec = this.getBounds().inflate(HIT_TEST_DISTANCE);\n                if (!rec.contains(p)) {\n                    return false;\n                }\n                return diagram.Geometry.distanceToPolyline(p, this.connection.allPoints()) < HIT_TEST_DISTANCE;\n            },\n            getBounds: function () {\n                var points = this.connection.allPoints(), s = points[0], e = points[points.length - 1], right = Math.max(s.x, e.x), left = Math.min(s.x, e.x), top = Math.min(s.y, e.y), bottom = Math.max(s.y, e.y);\n                for (var i = 1; i < points.length - 1; ++i) {\n                    right = Math.max(right, points[i].x);\n                    left = Math.min(left, points[i].x);\n                    top = Math.min(top, points[i].y);\n                    bottom = Math.max(bottom, points[i].y);\n                }\n                return new Rect(left, top, right - left, bottom - top);\n            }\n        });\n        var PolylineRouter = LinearConnectionRouter.extend({\n            init: function (connection) {\n                var that = this;\n                LinearConnectionRouter.fn.init.call(that);\n                this.connection = connection;\n            },\n            route: function () {\n            }\n        });\n        var CascadingRouter = LinearConnectionRouter.extend({\n            SAME_SIDE_DISTANCE_RATIO: 5,\n            init: function (connection) {\n                var that = this;\n                LinearConnectionRouter.fn.init.call(that);\n                this.connection = connection;\n            },\n            routePoints: function (start, end, sourceConnector, targetConnector) {\n                var result;\n                if (sourceConnector && targetConnector) {\n                    result = this._connectorPoints(start, end, sourceConnector, targetConnector);\n                } else {\n                    result = this._floatingPoints(start, end, sourceConnector);\n                }\n                return result;\n            },\n            route: function () {\n                var sourceConnector = this.connection._resolvedSourceConnector;\n                var targetConnector = this.connection._resolvedTargetConnector;\n                var start = this.connection.sourcePoint();\n                var end = this.connection.targetPoint();\n                var points = this.routePoints(start, end, sourceConnector, targetConnector);\n                this.connection.points(points);\n            },\n            _connectorSides: [\n                {\n                    name: 'Top',\n                    axis: 'y',\n                    boundsPoint: 'topLeft',\n                    secondarySign: 1\n                },\n                {\n                    name: 'Left',\n                    axis: 'x',\n                    boundsPoint: 'topLeft',\n                    secondarySign: 1\n                },\n                {\n                    name: 'Bottom',\n                    axis: 'y',\n                    boundsPoint: 'bottomRight',\n                    secondarySign: -1\n                },\n                {\n                    name: 'Right',\n                    axis: 'x',\n                    boundsPoint: 'bottomRight',\n                    secondarySign: -1\n                }\n            ],\n            _connectorSide: function (connector, targetPoint) {\n                var position = connector.position();\n                var shapeBounds = connector.shape.bounds(ROTATED);\n                var bounds = {\n                    topLeft: shapeBounds.topLeft(),\n                    bottomRight: shapeBounds.bottomRight()\n                };\n                var sides = this._connectorSides;\n                var min = kendo.util.MAX_NUM;\n                var sideDistance;\n                var minSide;\n                var axis;\n                var side;\n                for (var idx = 0; idx < sides.length; idx++) {\n                    side = sides[idx];\n                    axis = side.axis;\n                    sideDistance = Math.round(Math.abs(position[axis] - bounds[side.boundsPoint][axis]));\n                    if (sideDistance < min) {\n                        min = sideDistance;\n                        minSide = side;\n                    } else if (sideDistance === min && (position[axis] - targetPoint[axis]) * side.secondarySign > (position[minSide.axis] - targetPoint[minSide.axis]) * minSide.secondarySign) {\n                        minSide = side;\n                    }\n                }\n                return minSide.name;\n            },\n            _sameSideDistance: function (connector) {\n                var bounds = connector.shape.bounds(ROTATED);\n                return Math.min(bounds.width, bounds.height) / this.SAME_SIDE_DISTANCE_RATIO;\n            },\n            _connectorPoints: function (start, end, sourceConnector, targetConnector) {\n                var sourceConnectorSide = this._connectorSide(sourceConnector, end);\n                var targetConnectorSide = this._connectorSide(targetConnector, start);\n                var deltaX = end.x - start.x;\n                var deltaY = end.y - start.y;\n                var sameSideDistance = this._sameSideDistance(sourceConnector);\n                var result = [];\n                var pointX, pointY;\n                if (sourceConnectorSide === TOP || sourceConnectorSide == BOTTOM) {\n                    if (targetConnectorSide == TOP || targetConnectorSide == BOTTOM) {\n                        if (sourceConnectorSide == targetConnectorSide) {\n                            if (sourceConnectorSide == TOP) {\n                                pointY = Math.min(start.y, end.y) - sameSideDistance;\n                            } else {\n                                pointY = Math.max(start.y, end.y) + sameSideDistance;\n                            }\n                            result = [\n                                new Point(start.x, pointY),\n                                new Point(end.x, pointY)\n                            ];\n                        } else {\n                            result = [\n                                new Point(start.x, start.y + deltaY / 2),\n                                new Point(end.x, start.y + deltaY / 2)\n                            ];\n                        }\n                    } else {\n                        result = [new Point(start.x, end.y)];\n                    }\n                } else {\n                    if (targetConnectorSide == LEFT || targetConnectorSide == RIGHT) {\n                        if (sourceConnectorSide == targetConnectorSide) {\n                            if (sourceConnectorSide == LEFT) {\n                                pointX = Math.min(start.x, end.x) - sameSideDistance;\n                            } else {\n                                pointX = Math.max(start.x, end.x) + sameSideDistance;\n                            }\n                            result = [\n                                new Point(pointX, start.y),\n                                new Point(pointX, end.y)\n                            ];\n                        } else {\n                            result = [\n                                new Point(start.x + deltaX / 2, start.y),\n                                new Point(start.x + deltaX / 2, start.y + deltaY)\n                            ];\n                        }\n                    } else {\n                        result = [new Point(end.x, start.y)];\n                    }\n                }\n                return result;\n            },\n            _floatingPoints: function (start, end, sourceConnector) {\n                var sourceConnectorSide = sourceConnector ? this._connectorSide(sourceConnector, end) : null;\n                var cascadeStartHorizontal = this._startHorizontal(start, end, sourceConnectorSide);\n                var points = [\n                    start,\n                    start,\n                    end,\n                    end\n                ];\n                var deltaX = end.x - start.x;\n                var deltaY = end.y - start.y;\n                var length = points.length;\n                var shiftX;\n                var shiftY;\n                for (var idx = 1; idx < length - 1; ++idx) {\n                    if (cascadeStartHorizontal) {\n                        if (idx % 2 !== 0) {\n                            shiftX = deltaX / (length / 2);\n                            shiftY = 0;\n                        } else {\n                            shiftX = 0;\n                            shiftY = deltaY / ((length - 1) / 2);\n                        }\n                    } else {\n                        if (idx % 2 !== 0) {\n                            shiftX = 0;\n                            shiftY = deltaY / (length / 2);\n                        } else {\n                            shiftX = deltaX / ((length - 1) / 2);\n                            shiftY = 0;\n                        }\n                    }\n                    points[idx] = new Point(points[idx - 1].x + shiftX, points[idx - 1].y + shiftY);\n                }\n                idx--;\n                if (cascadeStartHorizontal && idx % 2 !== 0 || !cascadeStartHorizontal && idx % 2 === 0) {\n                    points[length - 2] = new Point(points[length - 1].x, points[length - 2].y);\n                } else {\n                    points[length - 2] = new Point(points[length - 2].x, points[length - 1].y);\n                }\n                return [\n                    points[1],\n                    points[2]\n                ];\n            },\n            _startHorizontal: function (start, end, sourceSide) {\n                var horizontal;\n                if (sourceSide !== null && (sourceSide === RIGHT || sourceSide === LEFT)) {\n                    horizontal = true;\n                } else {\n                    horizontal = Math.abs(start.x - end.x) > Math.abs(start.y - end.y);\n                }\n                return horizontal;\n            }\n        });\n        var AdornerBase = Class.extend({\n            init: function (diagram, options) {\n                var that = this;\n                that.diagram = diagram;\n                that.options = deepExtend({}, that.options, options);\n                that.visual = new Group();\n                that.diagram._adorners.push(that);\n            },\n            refresh: function () {\n            }\n        });\n        var ConnectionEditAdorner = AdornerBase.extend({\n            init: function (connection, options) {\n                var that = this, diagram;\n                that.connection = connection;\n                diagram = that.connection.diagram;\n                that._ts = diagram.toolService;\n                AdornerBase.fn.init.call(that, diagram, options);\n                var sp = that.connection.sourcePoint();\n                var tp = that.connection.targetPoint();\n                that.spVisual = new Circle(deepExtend(that.options.handles, { center: sp }));\n                that.epVisual = new Circle(deepExtend(that.options.handles, { center: tp }));\n                that.visual.append(that.spVisual);\n                that.visual.append(that.epVisual);\n            },\n            options: { handles: {} },\n            _getCursor: function () {\n                return Cursors.move;\n            },\n            start: function (p) {\n                this.handle = this._hitTest(p);\n                this.startPoint = p;\n                this._initialSource = this.connection.source();\n                this._initialTarget = this.connection.target();\n                switch (this.handle) {\n                case -1:\n                    if (this.connection.targetConnector) {\n                        this._ts._connectionManipulation(this.connection, this.connection.targetConnector.shape);\n                    }\n                    break;\n                case 1:\n                    if (this.connection.sourceConnector) {\n                        this._ts._connectionManipulation(this.connection, this.connection.sourceConnector.shape);\n                    }\n                    break;\n                }\n            },\n            move: function (handle, p) {\n                switch (handle) {\n                case -1:\n                    this.connection.source(p);\n                    break;\n                case 1:\n                    this.connection.target(p);\n                    break;\n                default:\n                    var delta = p.minus(this.startPoint);\n                    this.startPoint = p;\n                    if (!this.connection.sourceConnector) {\n                        this.connection.source(this.connection.sourcePoint().plus(delta));\n                    }\n                    if (!this.connection.targetConnector) {\n                        this.connection.target(this.connection.targetPoint().plus(delta));\n                    }\n                    break;\n                }\n                this.refresh();\n                return true;\n            },\n            stop: function (p) {\n                var ts = this.diagram.toolService, item = ts.hoveredItem, target;\n                if (ts._hoveredConnector) {\n                    target = ts._hoveredConnector._c;\n                } else if (item && item instanceof diagram.Shape) {\n                    target = item.getConnector(AUTO) || item.getConnector(p);\n                } else {\n                    target = p;\n                }\n                if (this.handle === -1) {\n                    this.connection.source(target);\n                } else if (this.handle === 1) {\n                    this.connection.target(target);\n                }\n                this.handle = undefined;\n                this._ts._connectionManipulation();\n                return new ConnectionEditUndoUnit(this.connection, this._initialSource, this._initialTarget);\n            },\n            _hitTest: function (point) {\n                var sourcePoint = this.connection.sourcePoint();\n                var targetPoint = this.connection.targetPoint();\n                var radiusX = this.options.handles.width / 2 + HIT_TEST_DISTANCE;\n                var radiusY = this.options.handles.height / 2 + HIT_TEST_DISTANCE;\n                var sourcePointDistance = sourcePoint.distanceTo(point);\n                var targetPointDistance = targetPoint.distanceTo(point);\n                var sourceHandle = new Rect(sourcePoint.x, sourcePoint.y).inflate(radiusX, radiusY).contains(point);\n                var targetHandle = new Rect(targetPoint.x, targetPoint.y).inflate(radiusX, radiusY).contains(point);\n                var handle = 0;\n                if (sourceHandle && (!targetHandle || sourcePointDistance < targetPointDistance)) {\n                    handle = -1;\n                } else if (targetHandle && (!sourceHandle || targetPointDistance < sourcePointDistance)) {\n                    handle = 1;\n                }\n                return handle;\n            },\n            refresh: function () {\n                this.spVisual.redraw({ center: this.diagram.modelToLayer(this.connection.sourcePoint()) });\n                this.epVisual.redraw({ center: this.diagram.modelToLayer(this.connection.targetPoint()) });\n            }\n        });\n        var ConnectorsAdorner = AdornerBase.extend({\n            init: function (diagram, options) {\n                var that = this;\n                AdornerBase.fn.init.call(that, diagram, options);\n                that._refreshHandler = function (e) {\n                    if (e.item == that.shape) {\n                        that.refresh();\n                    }\n                };\n            },\n            show: function (shape) {\n                var that = this, len, i, ctr;\n                that._visible = true;\n                that.shape = shape;\n                that.diagram.bind(ITEMBOUNDSCHANGE, that._refreshHandler);\n                len = shape.connectors.length;\n                that.connectors = [];\n                that.visual.clear();\n                for (i = 0; i < len; i++) {\n                    ctr = new ConnectorVisual(shape.connectors[i]);\n                    that.connectors.push(ctr);\n                    that.visual.append(ctr.visual);\n                }\n                that.visual.visible(true);\n                that.refresh();\n            },\n            destroy: function () {\n                var that = this;\n                that.diagram.unbind(ITEMBOUNDSCHANGE, that._refreshHandler);\n                that.shape = undefined;\n                that._visible = undefined;\n                that.visual.visible(false);\n            },\n            _hitTest: function (p) {\n                var ctr, i;\n                for (i = 0; i < this.connectors.length; i++) {\n                    ctr = this.connectors[i];\n                    if (ctr._hitTest(p)) {\n                        ctr._hover(true);\n                        this.diagram.toolService._hoveredConnector = ctr;\n                        break;\n                    }\n                }\n            },\n            refresh: function () {\n                if (this.shape) {\n                    var bounds = this.shape.bounds();\n                    bounds = this.diagram.modelToLayer(bounds);\n                    this.visual.position(bounds.topLeft());\n                    $.each(this.connectors, function () {\n                        this.refresh();\n                    });\n                }\n            }\n        });\n        function hitToOppositeSide(hit, bounds) {\n            var result;\n            if (hit.x == -1 && hit.y == -1) {\n                result = bounds.bottomRight();\n            } else if (hit.x == 1 && hit.y == 1) {\n                result = bounds.topLeft();\n            } else if (hit.x == -1 && hit.y == 1) {\n                result = bounds.topRight();\n            } else if (hit.x == 1 && hit.y == -1) {\n                result = bounds.bottomLeft();\n            } else if (hit.x === 0 && hit.y == -1) {\n                result = bounds.bottom();\n            } else if (hit.x === 0 && hit.y == 1) {\n                result = bounds.top();\n            } else if (hit.x == 1 && hit.y === 0) {\n                result = bounds.left();\n            } else if (hit.x == -1 && hit.y === 0) {\n                result = bounds.right();\n            }\n            return result;\n        }\n        var ResizingAdorner = AdornerBase.extend({\n            init: function (diagram, options) {\n                var that = this;\n                AdornerBase.fn.init.call(that, diagram, options);\n                that._manipulating = false;\n                that.map = [];\n                that.shapes = [];\n                that._initSelection();\n                that._createHandles();\n                that.redraw();\n                that.diagram.bind('select', function (e) {\n                    that._initialize(e.selected);\n                });\n                that._refreshHandler = function () {\n                    if (!that._internalChange) {\n                        that.refreshBounds();\n                        that.refresh();\n                    }\n                };\n                that._rotatedHandler = function () {\n                    if (that.shapes.length == 1) {\n                        that._angle = that.shapes[0].rotate().angle;\n                    }\n                    that._refreshHandler();\n                };\n                that.diagram.bind(ITEMBOUNDSCHANGE, that._refreshHandler).bind(ITEMROTATE, that._rotatedHandler);\n                that.refreshBounds();\n                that.refresh();\n            },\n            options: {\n                handles: {\n                    fill: { color: '#fff' },\n                    stroke: { color: '#282828' },\n                    height: 7,\n                    width: 7,\n                    hover: {\n                        fill: { color: '#282828' },\n                        stroke: { color: '#282828' }\n                    }\n                },\n                selectable: {\n                    stroke: {\n                        color: '#778899',\n                        width: 1,\n                        dashType: 'dash'\n                    },\n                    fill: { color: TRANSPARENT }\n                },\n                offset: 10\n            },\n            _initSelection: function () {\n                var that = this;\n                var diagram = that.diagram;\n                var selectable = diagram.options.selectable;\n                var options = deepExtend({}, that.options.selectable, selectable);\n                that.rect = new Rectangle(options);\n                that.visual.append(that.rect);\n            },\n            _resizable: function () {\n                return this.options.editable && this.options.editable.resize !== false;\n            },\n            _handleOptions: function () {\n                return (this.options.editable.resize || {}).handles || this.options.handles;\n            },\n            _createHandles: function () {\n                var handles, item, y, x;\n                if (this._resizable()) {\n                    handles = this._handleOptions();\n                    for (x = -1; x <= 1; x++) {\n                        for (y = -1; y <= 1; y++) {\n                            if (x !== 0 || y !== 0) {\n                                item = new Rectangle(handles);\n                                item.drawingElement._hover = proxy(this._hover, this);\n                                this.map.push({\n                                    x: x,\n                                    y: y,\n                                    visual: item\n                                });\n                                this.visual.append(item);\n                            }\n                        }\n                    }\n                }\n            },\n            bounds: function (value) {\n                if (value) {\n                    this._innerBounds = value.clone();\n                    this._bounds = this.diagram.modelToLayer(value).inflate(this.options.offset, this.options.offset);\n                } else {\n                    return this._bounds;\n                }\n            },\n            _hitTest: function (p) {\n                var tp = this.diagram.modelToLayer(p), i, hit, handleBounds, handlesCount = this.map.length, handle;\n                if (this._angle) {\n                    tp = tp.clone().rotate(this._bounds.center(), this._angle);\n                }\n                if (this._resizable()) {\n                    for (i = 0; i < handlesCount; i++) {\n                        handle = this.map[i];\n                        hit = new Point(handle.x, handle.y);\n                        handleBounds = this._getHandleBounds(hit);\n                        handleBounds.offset(this._bounds.x, this._bounds.y);\n                        if (handleBounds.contains(tp)) {\n                            return hit;\n                        }\n                    }\n                }\n                if (this._bounds.contains(tp)) {\n                    return new Point(0, 0);\n                }\n            },\n            _getHandleBounds: function (p) {\n                if (this._resizable()) {\n                    var handles = this._handleOptions(), w = handles.width, h = handles.height, r = new Rect(0, 0, w, h);\n                    if (p.x < 0) {\n                        r.x = -w / 2;\n                    } else if (p.x === 0) {\n                        r.x = Math.floor(this._bounds.width / 2) - w / 2;\n                    } else if (p.x > 0) {\n                        r.x = this._bounds.width + 1 - w / 2;\n                    }\n                    if (p.y < 0) {\n                        r.y = -h / 2;\n                    } else if (p.y === 0) {\n                        r.y = Math.floor(this._bounds.height / 2) - h / 2;\n                    } else if (p.y > 0) {\n                        r.y = this._bounds.height + 1 - h / 2;\n                    }\n                    return r;\n                }\n            },\n            _getCursor: function (point) {\n                var hit = this._hitTest(point);\n                if (hit && hit.x >= -1 && hit.x <= 1 && hit.y >= -1 && hit.y <= 1 && this._resizable()) {\n                    var angle = this._angle;\n                    if (angle) {\n                        angle = 360 - angle;\n                        hit.rotate(new Point(0, 0), angle);\n                        hit = new Point(Math.round(hit.x), Math.round(hit.y));\n                    }\n                    if (hit.x == -1 && hit.y == -1) {\n                        return 'nw-resize';\n                    }\n                    if (hit.x == 1 && hit.y == 1) {\n                        return 'se-resize';\n                    }\n                    if (hit.x == -1 && hit.y == 1) {\n                        return 'sw-resize';\n                    }\n                    if (hit.x == 1 && hit.y == -1) {\n                        return 'ne-resize';\n                    }\n                    if (hit.x === 0 && hit.y == -1) {\n                        return 'n-resize';\n                    }\n                    if (hit.x === 0 && hit.y == 1) {\n                        return 's-resize';\n                    }\n                    if (hit.x == 1 && hit.y === 0) {\n                        return 'e-resize';\n                    }\n                    if (hit.x == -1 && hit.y === 0) {\n                        return 'w-resize';\n                    }\n                }\n                return this._manipulating ? Cursors.move : Cursors.select;\n            },\n            _initialize: function () {\n                var that = this, i, item, items = that.diagram.select();\n                that.shapes = [];\n                for (i = 0; i < items.length; i++) {\n                    item = items[i];\n                    if (item instanceof diagram.Shape) {\n                        that.shapes.push(item);\n                        item._rotationOffset = new Point();\n                    }\n                }\n                that._angle = that.shapes.length == 1 ? that.shapes[0].rotate().angle : 0;\n                that._startAngle = that._angle;\n                that._rotates();\n                that._positions();\n                that.refreshBounds();\n                that.refresh();\n                that.redraw();\n            },\n            _rotates: function () {\n                var that = this, i, shape;\n                that.initialRotates = [];\n                for (i = 0; i < that.shapes.length; i++) {\n                    shape = that.shapes[i];\n                    that.initialRotates.push(shape.rotate().angle);\n                }\n            },\n            _positions: function () {\n                var that = this, i, shape;\n                that.initialStates = [];\n                for (i = 0; i < that.shapes.length; i++) {\n                    shape = that.shapes[i];\n                    that.initialStates.push(shape.bounds());\n                }\n            },\n            _hover: function (value, element) {\n                if (this._resizable()) {\n                    var handleOptions = this._handleOptions(), hover = handleOptions.hover, stroke = handleOptions.stroke, fill = handleOptions.fill;\n                    if (value && Utils.isDefined(hover.stroke)) {\n                        stroke = deepExtend({}, stroke, hover.stroke);\n                    }\n                    if (value && Utils.isDefined(hover.fill)) {\n                        fill = hover.fill;\n                    }\n                    element.stroke(stroke.color, stroke.width, stroke.opacity);\n                    element.fill(fill.color, fill.opacity);\n                }\n            },\n            start: function (p) {\n                this._sp = p;\n                this._cp = p;\n                this._lp = p;\n                this._manipulating = true;\n                this._internalChange = true;\n                this.shapeStates = [];\n                for (var i = 0; i < this.shapes.length; i++) {\n                    var shape = this.shapes[i];\n                    this.shapeStates.push(shape.bounds());\n                }\n            },\n            redraw: function () {\n                var i, handle, visibleHandles = this._resizable();\n                for (i = 0; i < this.map.length; i++) {\n                    handle = this.map[i];\n                    handle.visual.visible(visibleHandles);\n                }\n            },\n            angle: function (value) {\n                if (defined(value)) {\n                    this._angle = value;\n                }\n                return this._angle;\n            },\n            rotate: function () {\n                var center = this._innerBounds.center();\n                var currentAngle = this.angle();\n                this._internalChange = true;\n                for (var i = 0; i < this.shapes.length; i++) {\n                    var shape = this.shapes[i];\n                    currentAngle = (currentAngle + this.initialRotates[i] - this._startAngle) % 360;\n                    shape.rotate(currentAngle, center);\n                }\n                this.refresh();\n            },\n            move: function (handle, p) {\n                var delta, dragging, dtl = new Point(), dbr = new Point(), bounds, center, shape, i, angle, newBounds, changed = 0, staticPoint, scaleX, scaleY;\n                if (handle.y === -2 && handle.x === -1) {\n                    center = this._innerBounds.center();\n                    this._angle = this._truncateAngle(Utils.findAngle(center, p));\n                    for (i = 0; i < this.shapes.length; i++) {\n                        shape = this.shapes[i];\n                        angle = (this._angle + this.initialRotates[i] - this._startAngle) % 360;\n                        shape.rotate(angle, center);\n                        if (shape.hasOwnProperty('layout')) {\n                            shape.layout(shape);\n                        }\n                        this._rotating = true;\n                    }\n                    this.refresh();\n                } else {\n                    if (this.shouldSnap()) {\n                        var thr = this._truncateDistance(p.minus(this._lp));\n                        if (thr.x === 0 && thr.y === 0) {\n                            this._cp = p;\n                            return;\n                        }\n                        delta = thr;\n                        this._lp = new Point(this._lp.x + thr.x, this._lp.y + thr.y);\n                    } else {\n                        delta = p.minus(this._cp);\n                    }\n                    if (this.isDragHandle(handle)) {\n                        dbr = dtl = delta;\n                        dragging = true;\n                    } else {\n                        if (this._angle) {\n                            delta.rotate(new Point(0, 0), this._angle);\n                        }\n                        if (handle.x == -1) {\n                            dtl.x = delta.x;\n                        } else if (handle.x == 1) {\n                            dbr.x = delta.x;\n                        }\n                        if (handle.y == -1) {\n                            dtl.y = delta.y;\n                        } else if (handle.y == 1) {\n                            dbr.y = delta.y;\n                        }\n                    }\n                    if (!dragging) {\n                        staticPoint = hitToOppositeSide(handle, this._innerBounds);\n                        scaleX = (this._innerBounds.width + delta.x * handle.x) / this._innerBounds.width;\n                        scaleY = (this._innerBounds.height + delta.y * handle.y) / this._innerBounds.height;\n                    }\n                    for (i = 0; i < this.shapes.length; i++) {\n                        shape = this.shapes[i];\n                        bounds = shape.bounds();\n                        if (dragging) {\n                            if (!canDrag(shape)) {\n                                continue;\n                            }\n                            newBounds = this._displaceBounds(bounds, dtl, dbr, dragging);\n                        } else {\n                            newBounds = bounds.clone();\n                            newBounds.scale(scaleX, scaleY, staticPoint, this._innerBounds.center(), shape.rotate().angle);\n                            var newCenter = newBounds.center();\n                            newCenter.rotate(bounds.center(), -this._angle);\n                            newBounds = new Rect(newCenter.x - newBounds.width / 2, newCenter.y - newBounds.height / 2, newBounds.width, newBounds.height);\n                        }\n                        if (newBounds.width >= shape.options.minWidth && newBounds.height >= shape.options.minHeight) {\n                            var oldBounds = bounds;\n                            shape.bounds(newBounds);\n                            if (shape.hasOwnProperty('layout')) {\n                                shape.layout(shape, oldBounds, newBounds);\n                            }\n                            if (oldBounds.width !== newBounds.width || oldBounds.height !== newBounds.height) {\n                                shape.rotate(shape.rotate().angle);\n                            }\n                            changed += 1;\n                        }\n                    }\n                    if (changed) {\n                        if (changed == i) {\n                            newBounds = this._displaceBounds(this._innerBounds, dtl, dbr, dragging);\n                            this.bounds(newBounds);\n                        } else {\n                            this.refreshBounds();\n                        }\n                        this.refresh();\n                    }\n                    this._positions();\n                }\n                this._cp = p;\n            },\n            isDragHandle: function (handle) {\n                return handle.x === 0 && handle.y === 0;\n            },\n            cancel: function () {\n                var shapes = this.shapes;\n                var states = this.shapeStates;\n                for (var idx = 0; idx < shapes.length; idx++) {\n                    shapes[idx].bounds(states[idx]);\n                }\n                this.refreshBounds();\n                this.refresh();\n                this._manipulating = undefined;\n                this._internalChange = undefined;\n                this._rotating = undefined;\n            },\n            _truncatePositionToGuides: function (bounds) {\n                if (this.diagram.ruler) {\n                    return this.diagram.ruler.truncatePositionToGuides(bounds);\n                }\n                return bounds;\n            },\n            _truncateSizeToGuides: function (bounds) {\n                if (this.diagram.ruler) {\n                    return this.diagram.ruler.truncateSizeToGuides(bounds);\n                }\n                return bounds;\n            },\n            _truncateAngle: function (a) {\n                var snap = this.snapOptions();\n                var snapAngle = Math.max(snap.angle || DEFAULT_SNAP_ANGLE, MIN_SNAP_ANGLE);\n                return snap ? Math.floor(a % 360 / snapAngle) * snapAngle : a % 360;\n            },\n            _truncateDistance: function (d) {\n                if (d instanceof diagram.Point) {\n                    return new diagram.Point(this._truncateDistance(d.x), this._truncateDistance(d.y));\n                } else {\n                    var snap = this.snapOptions() || {};\n                    var snapSize = Math.max(snap.size || DEFAULT_SNAP_SIZE, MIN_SNAP_SIZE);\n                    return snap ? Math.floor(d / snapSize) * snapSize : d;\n                }\n            },\n            snapOptions: function () {\n                var editable = this.diagram.options.editable;\n                var snap = ((editable || {}).drag || {}).snap || {};\n                return snap;\n            },\n            shouldSnap: function () {\n                var editable = this.diagram.options.editable;\n                var drag = (editable || {}).drag;\n                var snap = (drag || {}).snap;\n                return editable !== false && drag !== false && snap !== false;\n            },\n            _displaceBounds: function (bounds, dtl, dbr, dragging) {\n                var tl = bounds.topLeft().plus(dtl), br = bounds.bottomRight().plus(dbr), newBounds = Rect.fromPoints(tl, br), newCenter;\n                if (!dragging) {\n                    newCenter = newBounds.center();\n                    newCenter.rotate(bounds.center(), -this._angle);\n                    newBounds = new Rect(newCenter.x - newBounds.width / 2, newCenter.y - newBounds.height / 2, newBounds.width, newBounds.height);\n                }\n                return newBounds;\n            },\n            stop: function () {\n                var unit, i, shape;\n                if (this._cp != this._sp) {\n                    if (this._rotating) {\n                        unit = new RotateUnit(this, this.shapes, this.initialRotates);\n                        this._rotating = false;\n                    } else if (this._diffStates()) {\n                        if (this.diagram.ruler) {\n                            for (i = 0; i < this.shapes.length; i++) {\n                                shape = this.shapes[i];\n                                var bounds = shape.bounds();\n                                bounds = this._truncateSizeToGuides(this._truncatePositionToGuides(bounds));\n                                shape.bounds(bounds);\n                                this.refreshBounds();\n                                this.refresh();\n                            }\n                        }\n                        for (i = 0; i < this.shapes.length; i++) {\n                            shape = this.shapes[i];\n                            shape.updateModel();\n                        }\n                        unit = new TransformUnit(this.shapes, this.shapeStates, this);\n                        this.diagram._syncShapeChanges();\n                    }\n                }\n                this._manipulating = undefined;\n                this._internalChange = undefined;\n                this._rotating = undefined;\n                return unit;\n            },\n            _diffStates: function () {\n                var shapes = this.shapes;\n                var states = this.shapeStates;\n                for (var idx = 0; idx < shapes.length; idx++) {\n                    if (!shapes[idx].bounds().equals(states[idx])) {\n                        return true;\n                    }\n                }\n                return false;\n            },\n            refreshBounds: function () {\n                var bounds = this.shapes.length == 1 ? this.shapes[0].bounds().clone() : this.diagram.boundingBox(this.shapes, true);\n                this.bounds(bounds);\n            },\n            refresh: function () {\n                var that = this, b, bounds;\n                if (this.shapes.length > 0) {\n                    bounds = this.bounds();\n                    this.visual.visible(true);\n                    this.visual.position(bounds.topLeft());\n                    $.each(this.map, function () {\n                        b = that._getHandleBounds(new Point(this.x, this.y));\n                        this.visual.position(b.topLeft());\n                    });\n                    this.visual.position(bounds.topLeft());\n                    var center = new Point(bounds.width / 2, bounds.height / 2);\n                    this.visual.rotate(this._angle, center);\n                    this.rect.redraw({\n                        width: bounds.width,\n                        height: bounds.height\n                    });\n                    if (this.rotationThumb) {\n                        var thumb = this.options.editable.rotate.thumb;\n                        this._rotationThumbBounds = new Rect(bounds.center().x, bounds.y + thumb.y, 0, 0).inflate(thumb.width);\n                        this.rotationThumb.redraw({ x: bounds.width / 2 - thumb.width / 2 });\n                    }\n                } else {\n                    this.visual.visible(false);\n                }\n            }\n        });\n        var Selector = Class.extend({\n            init: function (diagram) {\n                var selectable = diagram.options.selectable;\n                this.options = deepExtend({}, this.options, selectable);\n                this.visual = new Rectangle(this.options);\n                this.diagram = diagram;\n            },\n            options: {\n                stroke: {\n                    color: '#778899',\n                    width: 1,\n                    dashType: 'dash'\n                },\n                fill: { color: TRANSPARENT }\n            },\n            start: function (p) {\n                this._sp = this._ep = p;\n                this.refresh();\n                this.diagram._adorn(this, true);\n            },\n            end: function () {\n                this._sp = this._ep = undefined;\n                this.diagram._adorn(this, false);\n            },\n            bounds: function (value) {\n                if (value) {\n                    this._bounds = value;\n                }\n                return this._bounds;\n            },\n            move: function (p) {\n                this._ep = p;\n                this.refresh();\n            },\n            refresh: function () {\n                if (this._sp) {\n                    var visualBounds = Rect.fromPoints(this.diagram.modelToLayer(this._sp), this.diagram.modelToLayer(this._ep));\n                    this.bounds(Rect.fromPoints(this._sp, this._ep));\n                    this.visual.position(visualBounds.topLeft());\n                    this.visual.redraw({\n                        height: visualBounds.height + 1,\n                        width: visualBounds.width + 1\n                    });\n                }\n            }\n        });\n        var ConnectorVisual = Class.extend({\n            init: function (connector) {\n                this.options = deepExtend({}, connector.options);\n                this._c = connector;\n                this.visual = new Circle(this.options);\n                this.refresh();\n            },\n            _hover: function (value) {\n                var options = this.options, hover = options.hover, stroke = options.stroke, fill = options.fill;\n                if (value && Utils.isDefined(hover.stroke)) {\n                    stroke = deepExtend({}, stroke, hover.stroke);\n                }\n                if (value && Utils.isDefined(hover.fill)) {\n                    fill = hover.fill;\n                }\n                this.visual.redraw({\n                    stroke: stroke,\n                    fill: fill\n                });\n            },\n            refresh: function () {\n                var p = this._c.shape.diagram.modelToView(this._c.position()), relative = p.minus(this._c.shape.bounds('transformed').topLeft()), value = new Rect(p.x, p.y, 0, 0);\n                value.inflate(this.options.width / 2, this.options.height / 2);\n                this._visualBounds = value;\n                this.visual.redraw({ center: new Point(relative.x, relative.y) });\n            },\n            _hitTest: function (p) {\n                var tp = this._c.shape.diagram.modelToView(p);\n                return this._visualBounds.contains(tp);\n            }\n        });\n        function canDrag(element) {\n            var editable = element.options.editable;\n            return editable && editable.drag !== false;\n        }\n        function hitTestShapeConnectors(shape, point) {\n            var connector, position, rect;\n            for (var idx = 0; idx < shape.connectors.length; idx++) {\n                connector = shape.connectors[idx];\n                position = connector.position();\n                rect = new Rect(position.x, position.y);\n                rect.inflate(HIT_TEST_DISTANCE, HIT_TEST_DISTANCE);\n                if (rect.contains(point)) {\n                    return connector;\n                }\n            }\n        }\n        function noMeta(meta) {\n            return meta.ctrlKey === false && meta.altKey === false && meta.shiftKey === false;\n        }\n        deepExtend(diagram, {\n            CompositeUnit: CompositeUnit,\n            TransformUnit: TransformUnit,\n            PanUndoUnit: PanUndoUnit,\n            AddShapeUnit: AddShapeUnit,\n            AddConnectionUnit: AddConnectionUnit,\n            DeleteShapeUnit: DeleteShapeUnit,\n            DeleteConnectionUnit: DeleteConnectionUnit,\n            ConnectionEditAdorner: ConnectionEditAdorner,\n            ConnectionTool: ConnectionTool,\n            ConnectorVisual: ConnectorVisual,\n            UndoRedoService: UndoRedoService,\n            ResizingAdorner: ResizingAdorner,\n            Selector: Selector,\n            ToolService: ToolService,\n            ConnectorsAdorner: ConnectorsAdorner,\n            LayoutUndoUnit: LayoutUndoUnit,\n            ConnectionEditUnit: ConnectionEditUnit,\n            ToFrontUnit: ToFrontUnit,\n            ToBackUnit: ToBackUnit,\n            ConnectionRouterBase: ConnectionRouterBase,\n            PolylineRouter: PolylineRouter,\n            CascadingRouter: CascadingRouter,\n            SelectionTool: SelectionTool,\n            ScrollerTool: ScrollerTool,\n            PointerTool: PointerTool,\n            ConnectionEditTool: ConnectionEditTool,\n            RotateUnit: RotateUnit\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('dataviz/diagram/layout', ['dataviz/diagram/math'], f);\n}(function () {\n    (function ($, undefined) {\n        var kendo = window.kendo, diagram = kendo.dataviz.diagram, Graph = diagram.Graph, Node = diagram.Node, Link = diagram.Link, deepExtend = kendo.deepExtend, Size = diagram.Size, Rect = diagram.Rect, Dictionary = diagram.Dictionary, Set = diagram.Set, HyperTree = diagram.Graph, Utils = diagram.Utils, Point = diagram.Point, EPSILON = 0.000001, DEG_TO_RAD = Math.PI / 180, contains = Utils.contains, grep = $.grep;\n        var LayoutBase = kendo.Class.extend({\n            defaultOptions: {\n                type: 'Tree',\n                subtype: 'Down',\n                roots: null,\n                animate: false,\n                limitToView: false,\n                friction: 0.9,\n                nodeDistance: 50,\n                iterations: 300,\n                horizontalSeparation: 90,\n                verticalSeparation: 50,\n                underneathVerticalTopOffset: 15,\n                underneathHorizontalOffset: 15,\n                underneathVerticalSeparation: 15,\n                grid: {\n                    width: 1500,\n                    offsetX: 50,\n                    offsetY: 50,\n                    componentSpacingX: 20,\n                    componentSpacingY: 20\n                },\n                layerSeparation: 50,\n                layeredIterations: 2,\n                startRadialAngle: 0,\n                endRadialAngle: 360,\n                radialSeparation: 150,\n                radialFirstLevelSeparation: 200,\n                keepComponentsInOneRadialLayout: false,\n                ignoreContainers: true,\n                layoutContainerChildren: false,\n                ignoreInvisible: true,\n                animateTransitions: false\n            },\n            init: function () {\n            },\n            gridLayoutComponents: function (components) {\n                if (!components) {\n                    throw 'No components supplied.';\n                }\n                Utils.forEach(components, function (c) {\n                    c.calcBounds();\n                });\n                components.sort(function (a, b) {\n                    return b.bounds.width - a.bounds.width;\n                });\n                var maxWidth = this.options.grid.width, offsetX = this.options.grid.componentSpacingX, offsetY = this.options.grid.componentSpacingY, height = 0, startX = this.options.grid.offsetX, startY = this.options.grid.offsetY, x = startX, y = startY, i, resultLinkSet = [], resultNodeSet = [];\n                while (components.length > 0) {\n                    if (x >= maxWidth) {\n                        x = startX;\n                        y += height + offsetY;\n                        height = 0;\n                    }\n                    var component = components.pop();\n                    this.moveToOffset(component, new Point(x, y));\n                    for (i = 0; i < component.nodes.length; i++) {\n                        resultNodeSet.push(component.nodes[i]);\n                    }\n                    for (i = 0; i < component.links.length; i++) {\n                        resultLinkSet.push(component.links[i]);\n                    }\n                    var boundingRect = component.bounds;\n                    var currentHeight = boundingRect.height;\n                    if (currentHeight <= 0 || isNaN(currentHeight)) {\n                        currentHeight = 0;\n                    }\n                    var currentWidth = boundingRect.width;\n                    if (currentWidth <= 0 || isNaN(currentWidth)) {\n                        currentWidth = 0;\n                    }\n                    if (currentHeight >= height) {\n                        height = currentHeight;\n                    }\n                    x += currentWidth + offsetX;\n                }\n                return {\n                    nodes: resultNodeSet,\n                    links: resultLinkSet\n                };\n            },\n            moveToOffset: function (component, p) {\n                var i, j, bounds = component.bounds, deltax = p.x - bounds.x, deltay = p.y - bounds.y;\n                for (i = 0; i < component.nodes.length; i++) {\n                    var node = component.nodes[i];\n                    var nodeBounds = node.bounds();\n                    if (nodeBounds.width === 0 && nodeBounds.height === 0 && nodeBounds.x === 0 && nodeBounds.y === 0) {\n                        nodeBounds = new Rect(0, 0, 0, 0);\n                    }\n                    nodeBounds.x += deltax;\n                    nodeBounds.y += deltay;\n                    node.bounds(nodeBounds);\n                }\n                for (i = 0; i < component.links.length; i++) {\n                    var link = component.links[i];\n                    if (link.points) {\n                        var newpoints = [];\n                        var points = link.points;\n                        for (j = 0; j < points.length; j++) {\n                            var pt = points[j];\n                            pt.x += deltax;\n                            pt.y += deltay;\n                            newpoints.push(pt);\n                        }\n                        link.points = newpoints;\n                    }\n                }\n                this.currentHorizontalOffset += bounds.width + this.options.grid.offsetX;\n                return new Point(deltax, deltay);\n            },\n            transferOptions: function (options) {\n                this.options = kendo.deepExtend({}, this.defaultOptions);\n                if (Utils.isUndefined(options)) {\n                    return;\n                }\n                this.options = kendo.deepExtend(this.options, options || {});\n            }\n        });\n        var DiagramToHyperTreeAdapter = kendo.Class.extend({\n            init: function (diagram) {\n                this.nodeMap = new Dictionary();\n                this.shapeMap = new Dictionary();\n                this.nodes = [];\n                this.edges = [];\n                this.edgeMap = new Dictionary();\n                this.finalNodes = [];\n                this.finalLinks = [];\n                this.ignoredConnections = [];\n                this.ignoredShapes = [];\n                this.hyperMap = new Dictionary();\n                this.hyperTree = new Graph();\n                this.finalGraph = null;\n                this.diagram = diagram;\n            },\n            convert: function (options) {\n                if (Utils.isUndefined(this.diagram)) {\n                    throw 'No diagram to convert.';\n                }\n                this.options = kendo.deepExtend({\n                    ignoreInvisible: true,\n                    ignoreContainers: true,\n                    layoutContainerChildren: false\n                }, options || {});\n                this.clear();\n                this._renormalizeShapes();\n                this._renormalizeConnections();\n                this.finalNodes = new Dictionary(this.nodes);\n                this.finalLinks = new Dictionary(this.edges);\n                this.finalGraph = new Graph();\n                this.finalNodes.forEach(function (n) {\n                    this.finalGraph.addNode(n);\n                }, this);\n                this.finalLinks.forEach(function (l) {\n                    this.finalGraph.addExistingLink(l);\n                }, this);\n                return this.finalGraph;\n            },\n            mapConnection: function (connection) {\n                return this.edgeMap.get(connection.id);\n            },\n            mapShape: function (shape) {\n                return this.nodeMap.get(shape.id);\n            },\n            getEdge: function (a, b) {\n                return Utils.first(a.links, function (link) {\n                    return link.getComplement(a) === b;\n                });\n            },\n            clear: function () {\n                this.finalGraph = null;\n                this.hyperTree = !this.options.ignoreContainers && this.options.layoutContainerChildren ? new HyperTree() : null;\n                this.hyperMap = !this.options.ignoreContainers && this.options.layoutContainerChildren ? new Dictionary() : null;\n                this.nodeMap = new Dictionary();\n                this.shapeMap = new Dictionary();\n                this.nodes = [];\n                this.edges = [];\n                this.edgeMap = new Dictionary();\n                this.ignoredConnections = [];\n                this.ignoredShapes = [];\n                this.finalNodes = [];\n                this.finalLinks = [];\n            },\n            listToRoot: function (containerGraph) {\n                var list = [];\n                var s = containerGraph.container;\n                if (!s) {\n                    return list;\n                }\n                list.push(s);\n                while (s.parentContainer) {\n                    s = s.parentContainer;\n                    list.push(s);\n                }\n                list.reverse();\n                return list;\n            },\n            firstNonIgnorableContainer: function (shape) {\n                if (shape.isContainer && !this._isIgnorableItem(shape)) {\n                    return shape;\n                }\n                return !shape.parentContainer ? null : this.firstNonIgnorableContainer(shape.parentContainer);\n            },\n            isContainerConnection: function (a, b) {\n                if (a.isContainer && this.isDescendantOf(a, b)) {\n                    return true;\n                }\n                return b.isContainer && this.isDescendantOf(b, a);\n            },\n            isDescendantOf: function (scope, a) {\n                if (!scope.isContainer) {\n                    throw 'Expecting a container.';\n                }\n                if (scope === a) {\n                    return false;\n                }\n                if (contains(scope.children, a)) {\n                    return true;\n                }\n                var containers = [];\n                for (var i = 0, len = scope.children.length; i < len; i++) {\n                    var c = scope.children[i];\n                    if (c.isContainer && this.isDescendantOf(c, a)) {\n                        containers.push(c);\n                    }\n                }\n                return containers.length > 0;\n            },\n            isIgnorableItem: function (shape) {\n                if (this.options.ignoreInvisible) {\n                    if (shape.isCollapsed && this._isVisible(shape)) {\n                        return false;\n                    }\n                    if (!shape.isCollapsed && this._isVisible(shape)) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return shape.isCollapsed && !this._isTop(shape);\n                }\n            },\n            isShapeMapped: function (shape) {\n                return shape.isCollapsed && !this._isVisible(shape) && !this._isTop(shape);\n            },\n            leastCommonAncestor: function (a, b) {\n                if (!a) {\n                    throw 'Parameter should not be null.';\n                }\n                if (!b) {\n                    throw 'Parameter should not be null.';\n                }\n                if (!this.hyperTree) {\n                    throw 'No hypertree available.';\n                }\n                var al = this.listToRoot(a);\n                var bl = this.listToRoot(b);\n                var found = null;\n                if (Utils.isEmpty(al) || Utils.isEmpty(bl)) {\n                    return this.hyperTree.root.data;\n                }\n                var xa = al[0];\n                var xb = bl[0];\n                var i = 0;\n                while (xa === xb) {\n                    found = al[i];\n                    i++;\n                    if (i >= al.length || i >= bl.length) {\n                        break;\n                    }\n                    xa = al[i];\n                    xb = bl[i];\n                }\n                if (!found) {\n                    return this.hyperTree.root.data;\n                } else {\n                    return grep(this.hyperTree.nodes, function (n) {\n                        return n.data.container === found;\n                    });\n                }\n            },\n            _isTop: function (item) {\n                return !item.parentContainer;\n            },\n            _isVisible: function (shape) {\n                if (!shape.visible()) {\n                    return false;\n                }\n                return !shape.parentContainer ? shape.visible() : this._isVisible(shape.parentContainer);\n            },\n            _isCollapsed: function (shape) {\n                if (shape.isContainer && shape.isCollapsed) {\n                    return true;\n                }\n                return shape.parentContainer && this._isCollapsed(shape.parentContainer);\n            },\n            _renormalizeShapes: function () {\n                if (this.options.ignoreContainers) {\n                    for (var i = 0, len = this.diagram.shapes.length; i < len; i++) {\n                        var shape = this.diagram.shapes[i];\n                        if (this.options.ignoreInvisible && !this._isVisible(shape) || shape.isContainer) {\n                            this.ignoredShapes.push(shape);\n                            continue;\n                        }\n                        var node = new Node(shape.id, shape);\n                        node.isVirtual = false;\n                        this.nodeMap.add(shape.id, node);\n                        this.nodes.push(node);\n                    }\n                } else {\n                    throw 'Containers are not supported yet, but stay tuned.';\n                }\n            },\n            _renormalizeConnections: function () {\n                if (this.diagram.connections.length === 0) {\n                    return;\n                }\n                for (var i = 0, len = this.diagram.connections.length; i < len; i++) {\n                    var conn = this.diagram.connections[i];\n                    if (this.isIgnorableItem(conn)) {\n                        this.ignoredConnections.push(conn);\n                        continue;\n                    }\n                    var source = !conn.sourceConnector ? null : conn.sourceConnector.shape;\n                    var sink = !conn.targetConnector ? null : conn.targetConnector.shape;\n                    if (!source || !sink) {\n                        this.ignoredConnections.push(conn);\n                        continue;\n                    }\n                    if (contains(this.ignoredShapes, source) && !this.shapeMap.containsKey(source)) {\n                        this.ignoredConnections.push(conn);\n                        continue;\n                    }\n                    if (contains(this.ignoredShapes, sink) && !this.shapeMap.containsKey(sink)) {\n                        this.ignoredConnections.push(conn);\n                        continue;\n                    }\n                    if (this.shapeMap.containsKey(source)) {\n                        source = this.shapeMap[source];\n                    }\n                    if (this.shapeMap.containsKey(sink)) {\n                        sink = this.shapeMap[sink];\n                    }\n                    var sourceNode = this.mapShape(source);\n                    var sinkNode = this.mapShape(sink);\n                    if (sourceNode === sinkNode || this.areConnectedAlready(sourceNode, sinkNode)) {\n                        this.ignoredConnections.push(conn);\n                        continue;\n                    }\n                    if (sourceNode === null || sinkNode === null) {\n                        throw 'A shape was not mapped to a node.';\n                    }\n                    if (this.options.ignoreContainers) {\n                        if (sourceNode.isVirtual || sinkNode.isVirtual) {\n                            this.ignoredConnections.push(conn);\n                            continue;\n                        }\n                        var newEdge = new Link(sourceNode, sinkNode, conn.id, conn);\n                        this.edgeMap.add(conn.id, newEdge);\n                        this.edges.push(newEdge);\n                    } else {\n                        throw 'Containers are not supported yet, but stay tuned.';\n                    }\n                }\n            },\n            areConnectedAlready: function (n, m) {\n                return Utils.any(this.edges, function (l) {\n                    return l.source === n && l.target === m || l.source === m && l.target === n;\n                });\n            }\n        });\n        var SpringLayout = LayoutBase.extend({\n            init: function (diagram) {\n                var that = this;\n                LayoutBase.fn.init.call(that);\n                if (Utils.isUndefined(diagram)) {\n                    throw 'Diagram is not specified.';\n                }\n                this.diagram = diagram;\n            },\n            layout: function (options) {\n                this.transferOptions(options);\n                var adapter = new DiagramToHyperTreeAdapter(this.diagram);\n                var graph = adapter.convert(options);\n                if (graph.isEmpty()) {\n                    return;\n                }\n                var components = graph.getConnectedComponents();\n                if (Utils.isEmpty(components)) {\n                    return;\n                }\n                for (var i = 0; i < components.length; i++) {\n                    var component = components[i];\n                    this.layoutGraph(component, options);\n                }\n                var finalNodeSet = this.gridLayoutComponents(components);\n                return new diagram.LayoutState(this.diagram, finalNodeSet);\n            },\n            layoutGraph: function (graph, options) {\n                if (Utils.isDefined(options)) {\n                    this.transferOptions(options);\n                }\n                this.graph = graph;\n                var initialTemperature = this.options.nodeDistance * 9;\n                this.temperature = initialTemperature;\n                var guessBounds = this._expectedBounds();\n                this.width = guessBounds.width;\n                this.height = guessBounds.height;\n                for (var step = 0; step < this.options.iterations; step++) {\n                    this.refineStage = step >= this.options.iterations * 5 / 6;\n                    this.tick();\n                    this.temperature = this.refineStage ? initialTemperature / 30 : initialTemperature * (1 - step / (2 * this.options.iterations));\n                }\n            },\n            tick: function () {\n                var i;\n                for (i = 0; i < this.graph.nodes.length; i++) {\n                    this._repulsion(this.graph.nodes[i]);\n                }\n                for (i = 0; i < this.graph.links.length; i++) {\n                    this._attraction(this.graph.links[i]);\n                }\n                for (i = 0; i < this.graph.nodes.length; i++) {\n                    var node = this.graph.nodes[i];\n                    var offset = Math.sqrt(node.dx * node.dx + node.dy * node.dy);\n                    if (offset === 0) {\n                        return;\n                    }\n                    node.x += Math.min(offset, this.temperature) * node.dx / offset;\n                    node.y += Math.min(offset, this.temperature) * node.dy / offset;\n                    if (this.options.limitToView) {\n                        node.x = Math.min(this.width, Math.max(node.width / 2, node.x));\n                        node.y = Math.min(this.height, Math.max(node.height / 2, node.y));\n                    }\n                }\n            },\n            _shake: function (node) {\n                var rho = Math.random() * this.options.nodeDistance / 4;\n                var alpha = Math.random() * 2 * Math.PI;\n                node.x += rho * Math.cos(alpha);\n                node.y -= rho * Math.sin(alpha);\n            },\n            _InverseSquareForce: function (d, n, m) {\n                var force;\n                if (!this.refineStage) {\n                    force = Math.pow(d, 2) / Math.pow(this.options.nodeDistance, 2);\n                } else {\n                    var deltax = n.x - m.x;\n                    var deltay = n.y - m.y;\n                    var wn = n.width / 2;\n                    var hn = n.height / 2;\n                    var wm = m.width / 2;\n                    var hm = m.height / 2;\n                    force = Math.pow(deltax, 2) / Math.pow(wn + wm + this.options.nodeDistance, 2) + Math.pow(deltay, 2) / Math.pow(hn + hm + this.options.nodeDistance, 2);\n                }\n                return force * 4 / 3;\n            },\n            _SquareForce: function (d, n, m) {\n                return 1 / this._InverseSquareForce(d, n, m);\n            },\n            _repulsion: function (n) {\n                n.dx = 0;\n                n.dy = 0;\n                Utils.forEach(this.graph.nodes, function (m) {\n                    if (m === n) {\n                        return;\n                    }\n                    while (n.x === m.x && n.y === m.y) {\n                        this._shake(m);\n                    }\n                    var vx = n.x - m.x;\n                    var vy = n.y - m.y;\n                    var distance = Math.sqrt(vx * vx + vy * vy);\n                    var r = this._SquareForce(distance, n, m) * 2;\n                    n.dx += vx / distance * r;\n                    n.dy += vy / distance * r;\n                }, this);\n            },\n            _attraction: function (link) {\n                var t = link.target;\n                var s = link.source;\n                if (s === t) {\n                    return;\n                }\n                while (s.x === t.x && s.y === t.y) {\n                    this._shake(t);\n                }\n                var vx = s.x - t.x;\n                var vy = s.y - t.y;\n                var distance = Math.sqrt(vx * vx + vy * vy);\n                var a = this._InverseSquareForce(distance, s, t) * 5;\n                var dx = vx / distance * a;\n                var dy = vy / distance * a;\n                t.dx += dx;\n                t.dy += dy;\n                s.dx -= dx;\n                s.dy -= dy;\n            },\n            _expectedBounds: function () {\n                var size, N = this.graph.nodes.length, ratio = 1.5, multiplier = 4;\n                if (N === 0) {\n                    return size;\n                }\n                size = Utils.fold(this.graph.nodes, function (s, node) {\n                    var area = node.width * node.height;\n                    if (area > 0) {\n                        s += Math.sqrt(area);\n                        return s;\n                    }\n                    return 0;\n                }, 0, this);\n                var av = size / N;\n                var squareSize = av * Math.ceil(Math.sqrt(N));\n                var width = squareSize * Math.sqrt(ratio);\n                var height = squareSize / Math.sqrt(ratio);\n                return {\n                    width: width * multiplier,\n                    height: height * multiplier\n                };\n            }\n        });\n        var TreeLayoutProcessor = kendo.Class.extend({\n            init: function (options) {\n                this.center = null;\n                this.options = options;\n            },\n            layout: function (treeGraph, root) {\n                this.graph = treeGraph;\n                if (!this.graph.nodes || this.graph.nodes.length === 0) {\n                    return;\n                }\n                if (!contains(this.graph.nodes, root)) {\n                    throw 'The given root is not in the graph.';\n                }\n                this.center = root;\n                this.graph.cacheRelationships();\n                this.layoutSwitch();\n            },\n            layoutLeft: function (left) {\n                this.setChildrenDirection(this.center, 'Left', false);\n                this.setChildrenLayout(this.center, 'Default', false);\n                var h = 0, w = 0, y, i, node;\n                for (i = 0; i < left.length; i++) {\n                    node = left[i];\n                    node.TreeDirection = 'Left';\n                    var s = this.measure(node, Size.Empty);\n                    w = Math.max(w, s.Width);\n                    h += s.height + this.options.verticalSeparation;\n                }\n                h -= this.options.verticalSeparation;\n                var x = this.center.x - this.options.horizontalSeparation;\n                y = this.center.y + (this.center.height - h) / 2;\n                for (i = 0; i < left.length; i++) {\n                    node = left[i];\n                    var p = new Point(x - node.Size.width, y);\n                    this.arrange(node, p);\n                    y += node.Size.height + this.options.verticalSeparation;\n                }\n            },\n            layoutRight: function (right) {\n                this.setChildrenDirection(this.center, 'Right', false);\n                this.setChildrenLayout(this.center, 'Default', false);\n                var h = 0, w = 0, y, i, node;\n                for (i = 0; i < right.length; i++) {\n                    node = right[i];\n                    node.TreeDirection = 'Right';\n                    var s = this.measure(node, Size.Empty);\n                    w = Math.max(w, s.Width);\n                    h += s.height + this.options.verticalSeparation;\n                }\n                h -= this.options.verticalSeparation;\n                var x = this.center.x + this.options.horizontalSeparation + this.center.width;\n                y = this.center.y + (this.center.height - h) / 2;\n                for (i = 0; i < right.length; i++) {\n                    node = right[i];\n                    var p = new Point(x, y);\n                    this.arrange(node, p);\n                    y += node.Size.height + this.options.verticalSeparation;\n                }\n            },\n            layoutUp: function (up) {\n                this.setChildrenDirection(this.center, 'Up', false);\n                this.setChildrenLayout(this.center, 'Default', false);\n                var w = 0, y, node, i;\n                for (i = 0; i < up.length; i++) {\n                    node = up[i];\n                    node.TreeDirection = 'Up';\n                    var s = this.measure(node, Size.Empty);\n                    w += s.width + this.options.horizontalSeparation;\n                }\n                w -= this.options.horizontalSeparation;\n                var x = this.center.x + this.center.width / 2 - w / 2;\n                for (i = 0; i < up.length; i++) {\n                    node = up[i];\n                    y = this.center.y - this.options.verticalSeparation - node.Size.height;\n                    var p = new Point(x, y);\n                    this.arrange(node, p);\n                    x += node.Size.width + this.options.horizontalSeparation;\n                }\n            },\n            layoutDown: function (down) {\n                var node, i;\n                this.setChildrenDirection(this.center, 'Down', false);\n                this.setChildrenLayout(this.center, 'Default', false);\n                var w = 0, y;\n                for (i = 0; i < down.length; i++) {\n                    node = down[i];\n                    node.treeDirection = 'Down';\n                    var s = this.measure(node, Size.Empty);\n                    w += s.width + this.options.horizontalSeparation;\n                }\n                w -= this.options.horizontalSeparation;\n                var x = this.center.x + this.center.width / 2 - w / 2;\n                y = this.center.y + this.options.verticalSeparation + this.center.height;\n                for (i = 0; i < down.length; i++) {\n                    node = down[i];\n                    var p = new Point(x, y);\n                    this.arrange(node, p);\n                    x += node.Size.width + this.options.horizontalSeparation;\n                }\n            },\n            layoutRadialTree: function () {\n                this.setChildrenDirection(this.center, 'Radial', false);\n                this.setChildrenLayout(this.center, 'Default', false);\n                this.previousRoot = null;\n                var startAngle = this.options.startRadialAngle * DEG_TO_RAD;\n                var endAngle = this.options.endRadialAngle * DEG_TO_RAD;\n                if (endAngle <= startAngle) {\n                    throw 'Final angle should not be less than the start angle.';\n                }\n                this.maxDepth = 0;\n                this.origin = new Point(this.center.x, this.center.y);\n                this.calculateAngularWidth(this.center, 0);\n                if (this.maxDepth > 0) {\n                    this.radialLayout(this.center, this.options.radialFirstLevelSeparation, startAngle, endAngle);\n                }\n                this.center.Angle = endAngle - startAngle;\n            },\n            tipOverTree: function (down, startFromLevel) {\n                if (Utils.isUndefined(startFromLevel)) {\n                    startFromLevel = 0;\n                }\n                this.setChildrenDirection(this.center, 'Down', false);\n                this.setChildrenLayout(this.center, 'Default', false);\n                this.setChildrenLayout(this.center, 'Underneath', false, startFromLevel);\n                var w = 0, y, node, i;\n                for (i = 0; i < down.length; i++) {\n                    node = down[i];\n                    node.TreeDirection = 'Down';\n                    var s = this.measure(node, Size.Empty);\n                    w += s.width + this.options.horizontalSeparation;\n                }\n                w -= this.options.horizontalSeparation;\n                w -= down[down.length - 1].width;\n                w += down[down.length - 1].associatedShape.bounds().width;\n                var x = this.center.x + this.center.width / 2 - w / 2;\n                y = this.center.y + this.options.verticalSeparation + this.center.height;\n                for (i = 0; i < down.length; i++) {\n                    node = down[i];\n                    var p = new Point(x, y);\n                    this.arrange(node, p);\n                    x += node.Size.width + this.options.horizontalSeparation;\n                }\n            },\n            calculateAngularWidth: function (n, d) {\n                if (d > this.maxDepth) {\n                    this.maxDepth = d;\n                }\n                var aw = 0, w = 1000, h = 1000, diameter = d === 0 ? 0 : Math.sqrt(w * w + h * h) / d;\n                if (n.children.length > 0) {\n                    for (var i = 0, len = n.children.length; i < len; i++) {\n                        var child = n.children[i];\n                        aw += this.calculateAngularWidth(child, d + 1);\n                    }\n                    aw = Math.max(diameter, aw);\n                } else {\n                    aw = diameter;\n                }\n                n.sectorAngle = aw;\n                return aw;\n            },\n            sortChildren: function (n) {\n                var basevalue = 0, i;\n                if (n.parents.length > 1) {\n                    throw 'Node is not part of a tree.';\n                }\n                var p = n.parents[0];\n                if (p) {\n                    var pl = new Point(p.x, p.y);\n                    var nl = new Point(n.x, n.y);\n                    basevalue = this.normalizeAngle(Math.atan2(pl.y - nl.y, pl.x - nl.x));\n                }\n                var count = n.children.length;\n                if (count === 0) {\n                    return null;\n                }\n                var angle = [];\n                var idx = [];\n                for (i = 0; i < count; ++i) {\n                    var c = n.children[i];\n                    var l = new Point(c.x, c.y);\n                    idx[i] = i;\n                    angle[i] = this.normalizeAngle(-basevalue + Math.atan2(l.y - l.y, l.x - l.x));\n                }\n                Utils.bisort(angle, idx);\n                var col = [];\n                var children = n.children;\n                for (i = 0; i < count; ++i) {\n                    col.push(children[idx[i]]);\n                }\n                return col;\n            },\n            normalizeAngle: function (angle) {\n                while (angle > Math.PI * 2) {\n                    angle -= 2 * Math.PI;\n                }\n                while (angle < 0) {\n                    angle += Math.PI * 2;\n                }\n                return angle;\n            },\n            radialLayout: function (node, radius, startAngle, endAngle) {\n                var deltaTheta = endAngle - startAngle;\n                var deltaThetaHalf = deltaTheta / 2;\n                var parentSector = node.sectorAngle;\n                var fraction = 0;\n                var sorted = this.sortChildren(node);\n                for (var i = 0, len = sorted.length; i < len; i++) {\n                    var childNode = sorted[i];\n                    var cp = childNode;\n                    var childAngleFraction = cp.sectorAngle / parentSector;\n                    if (childNode.children.length > 0) {\n                        this.radialLayout(childNode, radius + this.options.radialSeparation, startAngle + fraction * deltaTheta, startAngle + (fraction + childAngleFraction) * deltaTheta);\n                    }\n                    this.setPolarLocation(childNode, radius, startAngle + fraction * deltaTheta + childAngleFraction * deltaThetaHalf);\n                    cp.angle = childAngleFraction * deltaTheta;\n                    fraction += childAngleFraction;\n                }\n            },\n            setPolarLocation: function (node, radius, angle) {\n                node.x = this.origin.x + radius * Math.cos(angle);\n                node.y = this.origin.y + radius * Math.sin(angle);\n                node.BoundingRectangle = new Rect(node.x, node.y, node.width, node.height);\n            },\n            setChildrenDirection: function (node, direction, includeStart) {\n                var rootDirection = node.treeDirection;\n                this.graph.depthFirstTraversal(node, function (n) {\n                    n.treeDirection = direction;\n                });\n                if (!includeStart) {\n                    node.treeDirection = rootDirection;\n                }\n            },\n            setChildrenLayout: function (node, layout, includeStart, startFromLevel) {\n                if (Utils.isUndefined(startFromLevel)) {\n                    startFromLevel = 0;\n                }\n                var rootLayout = node.childrenLayout;\n                if (startFromLevel > 0) {\n                    this.graph.assignLevels(node);\n                    this.graph.depthFirstTraversal(node, function (s) {\n                        if (s.level >= startFromLevel + 1) {\n                            s.childrenLayout = layout;\n                        }\n                    });\n                } else {\n                    this.graph.depthFirstTraversal(node, function (s) {\n                        s.childrenLayout = layout;\n                    });\n                    if (!includeStart) {\n                        node.childrenLayout = rootLayout;\n                    }\n                }\n            },\n            measure: function (node, givenSize) {\n                var w = 0, h = 0, s;\n                var result = new Size(0, 0);\n                if (!node) {\n                    throw '';\n                }\n                var b = node.associatedShape.bounds();\n                var shapeWidth = b.width;\n                var shapeHeight = b.height;\n                if (node.parents.length !== 1) {\n                    throw 'Node not in a spanning tree.';\n                }\n                var parent = node.parents[0];\n                if (node.treeDirection === 'Undefined') {\n                    node.treeDirection = parent.treeDirection;\n                }\n                if (Utils.isEmpty(node.children)) {\n                    result = new Size(Math.abs(shapeWidth) < EPSILON ? 50 : shapeWidth, Math.abs(shapeHeight) < EPSILON ? 25 : shapeHeight);\n                } else if (node.children.length === 1) {\n                    switch (node.treeDirection) {\n                    case 'Radial':\n                        s = this.measure(node.children[0], givenSize);\n                        w = shapeWidth + this.options.radialSeparation * Math.cos(node.AngleToParent) + s.width;\n                        h = shapeHeight + Math.abs(this.options.radialSeparation * Math.sin(node.AngleToParent)) + s.height;\n                        break;\n                    case 'Left':\n                    case 'Right':\n                        switch (node.childrenLayout) {\n                        case 'TopAlignedWithParent':\n                            break;\n                        case 'BottomAlignedWithParent':\n                            break;\n                        case 'Underneath':\n                            s = this.measure(node.children[0], givenSize);\n                            w = shapeWidth + s.width + this.options.underneathHorizontalOffset;\n                            h = shapeHeight + this.options.underneathVerticalTopOffset + s.height;\n                            break;\n                        case 'Default':\n                            s = this.measure(node.children[0], givenSize);\n                            w = shapeWidth + this.options.horizontalSeparation + s.width;\n                            h = Math.max(shapeHeight, s.height);\n                            break;\n                        default:\n                            throw 'Unhandled TreeDirection in the Radial layout measuring.';\n                        }\n                        break;\n                    case 'Up':\n                    case 'Down':\n                        switch (node.childrenLayout) {\n                        case 'TopAlignedWithParent':\n                        case 'BottomAlignedWithParent':\n                            break;\n                        case 'Underneath':\n                            s = this.measure(node.children[0], givenSize);\n                            w = Math.max(shapeWidth, s.width + this.options.underneathHorizontalOffset);\n                            h = shapeHeight + this.options.underneathVerticalTopOffset + s.height;\n                            break;\n                        case 'Default':\n                            s = this.measure(node.children[0], givenSize);\n                            h = shapeHeight + this.options.verticalSeparation + s.height;\n                            w = Math.max(shapeWidth, s.width);\n                            break;\n                        default:\n                            throw 'Unhandled TreeDirection in the Down layout measuring.';\n                        }\n                        break;\n                    default:\n                        throw 'Unhandled TreeDirection in the layout measuring.';\n                    }\n                    result = new Size(w, h);\n                } else {\n                    var i, childNode;\n                    switch (node.treeDirection) {\n                    case 'Left':\n                    case 'Right':\n                        switch (node.childrenLayout) {\n                        case 'TopAlignedWithParent':\n                        case 'BottomAlignedWithParent':\n                            break;\n                        case 'Underneath':\n                            w = shapeWidth;\n                            h = shapeHeight + this.options.underneathVerticalTopOffset;\n                            for (i = 0; i < node.children.length; i++) {\n                                childNode = node.children[i];\n                                s = this.measure(childNode, givenSize);\n                                w = Math.max(w, s.width + this.options.underneathHorizontalOffset);\n                                h += s.height + this.options.underneathVerticalSeparation;\n                            }\n                            h -= this.options.underneathVerticalSeparation;\n                            break;\n                        case 'Default':\n                            w = shapeWidth;\n                            h = 0;\n                            for (i = 0; i < node.children.length; i++) {\n                                childNode = node.children[i];\n                                s = this.measure(childNode, givenSize);\n                                w = Math.max(w, shapeWidth + this.options.horizontalSeparation + s.width);\n                                h += s.height + this.options.verticalSeparation;\n                            }\n                            h -= this.options.verticalSeparation;\n                            break;\n                        default:\n                            throw 'Unhandled TreeDirection in the Right layout measuring.';\n                        }\n                        break;\n                    case 'Up':\n                    case 'Down':\n                        switch (node.childrenLayout) {\n                        case 'TopAlignedWithParent':\n                        case 'BottomAlignedWithParent':\n                            break;\n                        case 'Underneath':\n                            w = shapeWidth;\n                            h = shapeHeight + this.options.underneathVerticalTopOffset;\n                            for (i = 0; i < node.children.length; i++) {\n                                childNode = node.children[i];\n                                s = this.measure(childNode, givenSize);\n                                w = Math.max(w, s.width + this.options.underneathHorizontalOffset);\n                                h += s.height + this.options.underneathVerticalSeparation;\n                            }\n                            h -= this.options.underneathVerticalSeparation;\n                            break;\n                        case 'Default':\n                            w = 0;\n                            h = 0;\n                            for (i = 0; i < node.children.length; i++) {\n                                childNode = node.children[i];\n                                s = this.measure(childNode, givenSize);\n                                w += s.width + this.options.horizontalSeparation;\n                                h = Math.max(h, s.height + this.options.verticalSeparation + shapeHeight);\n                            }\n                            w -= this.options.horizontalSeparation;\n                            break;\n                        default:\n                            throw 'Unhandled TreeDirection in the Down layout measuring.';\n                        }\n                        break;\n                    default:\n                        throw 'Unhandled TreeDirection in the layout measuring.';\n                    }\n                    result = new Size(w, h);\n                }\n                node.SectorAngle = Math.sqrt(w * w / 4 + h * h / 4);\n                node.Size = result;\n                return result;\n            },\n            arrange: function (n, p) {\n                var i, pp, child, node, childrenwidth, b = n.associatedShape.bounds();\n                var shapeWidth = b.width;\n                var shapeHeight = b.height;\n                if (Utils.isEmpty(n.children)) {\n                    n.x = p.x;\n                    n.y = p.y;\n                    n.BoundingRectangle = new Rect(p.x, p.y, shapeWidth, shapeHeight);\n                } else {\n                    var x, y;\n                    var selfLocation;\n                    switch (n.treeDirection) {\n                    case 'Left':\n                        switch (n.childrenLayout) {\n                        case 'TopAlignedWithParent':\n                        case 'BottomAlignedWithParent':\n                            break;\n                        case 'Underneath':\n                            selfLocation = p;\n                            n.x = selfLocation.x;\n                            n.y = selfLocation.y;\n                            n.BoundingRectangle = new Rect(n.x, n.y, n.width, n.height);\n                            y = p.y + shapeHeight + this.options.underneathVerticalTopOffset;\n                            for (i = 0; i < node.children.length; i++) {\n                                node = node.children[i];\n                                x = selfLocation.x - node.associatedShape.width - this.options.underneathHorizontalOffset;\n                                pp = new Point(x, y);\n                                this.arrange(node, pp);\n                                y += node.Size.height + this.options.underneathVerticalSeparation;\n                            }\n                            break;\n                        case 'Default':\n                            selfLocation = new Point(p.x + n.Size.width - shapeWidth, p.y + (n.Size.height - shapeHeight) / 2);\n                            n.x = selfLocation.x;\n                            n.y = selfLocation.y;\n                            n.BoundingRectangle = new Rect(n.x, n.y, n.width, n.height);\n                            x = selfLocation.x - this.options.horizontalSeparation;\n                            y = p.y;\n                            for (i = 0; i < n.children.length; i++) {\n                                node = n.children[i];\n                                pp = new Point(x - node.Size.width, y);\n                                this.arrange(node, pp);\n                                y += node.Size.height + this.options.verticalSeparation;\n                            }\n                            break;\n                        default:\n                            throw 'Unsupported TreeDirection';\n                        }\n                        break;\n                    case 'Right':\n                        switch (n.childrenLayout) {\n                        case 'TopAlignedWithParent':\n                        case 'BottomAlignedWithParent':\n                            break;\n                        case 'Underneath':\n                            selfLocation = p;\n                            n.x = selfLocation.x;\n                            n.y = selfLocation.y;\n                            n.BoundingRectangle = new Rect(n.x, n.y, n.width, n.height);\n                            x = p.x + shapeWidth + this.options.underneathHorizontalOffset;\n                            y = p.y + shapeHeight + this.options.underneathVerticalTopOffset;\n                            for (i = 0; i < n.children.length; i++) {\n                                node = n.children[i];\n                                pp = new Point(x, y);\n                                this.arrange(node, pp);\n                                y += node.Size.height + this.options.underneathVerticalSeparation;\n                            }\n                            break;\n                        case 'Default':\n                            selfLocation = new Point(p.x, p.y + (n.Size.height - shapeHeight) / 2);\n                            n.x = selfLocation.x;\n                            n.y = selfLocation.y;\n                            n.BoundingRectangle = new Rect(n.x, n.y, n.width, n.height);\n                            x = p.x + shapeWidth + this.options.horizontalSeparation;\n                            y = p.y;\n                            for (i = 0; i < n.children.length; i++) {\n                                node = n.children[i];\n                                pp = new Point(x, y);\n                                this.arrange(node, pp);\n                                y += node.Size.height + this.options.verticalSeparation;\n                            }\n                            break;\n                        default:\n                            throw 'Unsupported TreeDirection';\n                        }\n                        break;\n                    case 'Up':\n                        selfLocation = new Point(p.x + (n.Size.width - shapeWidth) / 2, p.y + n.Size.height - shapeHeight);\n                        n.x = selfLocation.x;\n                        n.y = selfLocation.y;\n                        n.BoundingRectangle = new Rect(n.x, n.y, n.width, n.height);\n                        if (Math.abs(selfLocation.x - p.x) < EPSILON) {\n                            childrenwidth = 0;\n                            for (i = 0; i < n.children.length; i++) {\n                                child = n.children[i];\n                                childrenwidth += child.Size.width + this.options.horizontalSeparation;\n                            }\n                            childrenwidth -= this.options.horizontalSeparation;\n                            x = p.x + (shapeWidth - childrenwidth) / 2;\n                        } else {\n                            x = p.x;\n                        }\n                        for (i = 0; i < n.children.length; i++) {\n                            node = n.children[i];\n                            y = selfLocation.y - this.options.verticalSeparation - node.Size.height;\n                            pp = new Point(x, y);\n                            this.arrange(node, pp);\n                            x += node.Size.width + this.options.horizontalSeparation;\n                        }\n                        break;\n                    case 'Down':\n                        switch (n.childrenLayout) {\n                        case 'TopAlignedWithParent':\n                        case 'BottomAlignedWithParent':\n                            break;\n                        case 'Underneath':\n                            selfLocation = p;\n                            n.x = selfLocation.x;\n                            n.y = selfLocation.y;\n                            n.BoundingRectangle = new Rect(n.x, n.y, n.width, n.height);\n                            x = p.x + this.options.underneathHorizontalOffset;\n                            y = p.y + shapeHeight + this.options.underneathVerticalTopOffset;\n                            for (i = 0; i < n.children.length; i++) {\n                                node = n.children[i];\n                                pp = new Point(x, y);\n                                this.arrange(node, pp);\n                                y += node.Size.height + this.options.underneathVerticalSeparation;\n                            }\n                            break;\n                        case 'Default':\n                            selfLocation = new Point(p.x + (n.Size.width - shapeWidth) / 2, p.y);\n                            n.x = selfLocation.x;\n                            n.y = selfLocation.y;\n                            n.BoundingRectangle = new Rect(n.x, n.y, n.width, n.height);\n                            if (Math.abs(selfLocation.x - p.x) < EPSILON) {\n                                childrenwidth = 0;\n                                for (i = 0; i < n.children.length; i++) {\n                                    child = n.children[i];\n                                    childrenwidth += child.Size.width + this.options.horizontalSeparation;\n                                }\n                                childrenwidth -= this.options.horizontalSeparation;\n                                x = p.x + (shapeWidth - childrenwidth) / 2;\n                            } else {\n                                x = p.x;\n                            }\n                            for (i = 0; i < n.children.length; i++) {\n                                node = n.children[i];\n                                y = selfLocation.y + this.options.verticalSeparation + shapeHeight;\n                                pp = new Point(x, y);\n                                this.arrange(node, pp);\n                                x += node.Size.width + this.options.horizontalSeparation;\n                            }\n                            break;\n                        default:\n                            throw 'Unsupported TreeDirection';\n                        }\n                        break;\n                    case 'None':\n                        break;\n                    default:\n                        throw 'Unsupported TreeDirection';\n                    }\n                }\n            },\n            layoutSwitch: function () {\n                if (!this.center) {\n                    return;\n                }\n                if (Utils.isEmpty(this.center.children)) {\n                    return;\n                }\n                var type = this.options.subtype;\n                if (Utils.isUndefined(type)) {\n                    type = 'Down';\n                }\n                var single, male, female, leftcount;\n                var children = this.center.children;\n                switch (type.toLowerCase()) {\n                case 'radial':\n                case 'radialtree':\n                    this.layoutRadialTree();\n                    break;\n                case 'mindmaphorizontal':\n                case 'mindmap':\n                    single = this.center.children;\n                    if (this.center.children.length === 1) {\n                        this.layoutRight(single);\n                    } else {\n                        leftcount = children.length / 2;\n                        male = grep(this.center.children, function (n) {\n                            return Utils.indexOf(children, n) < leftcount;\n                        });\n                        female = grep(this.center.children, function (n) {\n                            return Utils.indexOf(children, n) >= leftcount;\n                        });\n                        this.layoutLeft(male);\n                        this.layoutRight(female);\n                    }\n                    break;\n                case 'mindmapvertical':\n                    single = this.center.children;\n                    if (this.center.children.length === 1) {\n                        this.layoutDown(single);\n                    } else {\n                        leftcount = children.length / 2;\n                        male = grep(this.center.children, function (n) {\n                            return Utils.indexOf(children, n) < leftcount;\n                        });\n                        female = grep(this.center.children, function (n) {\n                            return Utils.indexOf(children, n) >= leftcount;\n                        });\n                        this.layoutUp(male);\n                        this.layoutDown(female);\n                    }\n                    break;\n                case 'right':\n                    this.layoutRight(this.center.children);\n                    break;\n                case 'left':\n                    this.layoutLeft(this.center.children);\n                    break;\n                case 'up':\n                case 'bottom':\n                    this.layoutUp(this.center.children);\n                    break;\n                case 'down':\n                case 'top':\n                    this.layoutDown(this.center.children);\n                    break;\n                case 'tipover':\n                case 'tipovertree':\n                    if (this.options.tipOverTreeStartLevel < 0) {\n                        throw 'The tip-over level should be a positive integer.';\n                    }\n                    this.tipOverTree(this.center.children, this.options.tipOverTreeStartLevel);\n                    break;\n                case 'undefined':\n                case 'none':\n                    break;\n                }\n            }\n        });\n        var TreeLayout = LayoutBase.extend({\n            init: function (diagram) {\n                var that = this;\n                LayoutBase.fn.init.call(that);\n                if (Utils.isUndefined(diagram)) {\n                    throw 'No diagram specified.';\n                }\n                this.diagram = diagram;\n            },\n            layout: function (options) {\n                this.transferOptions(options);\n                var adapter = new DiagramToHyperTreeAdapter(this.diagram);\n                this.graph = adapter.convert();\n                var finalNodeSet = this.layoutComponents();\n                return new diagram.LayoutState(this.diagram, finalNodeSet);\n            },\n            layoutComponents: function () {\n                if (this.graph.isEmpty()) {\n                    return;\n                }\n                var components = this.graph.getConnectedComponents();\n                if (Utils.isEmpty(components)) {\n                    return;\n                }\n                var layout = new TreeLayoutProcessor(this.options);\n                var trees = [];\n                for (var i = 0; i < components.length; i++) {\n                    var component = components[i];\n                    var treeGraph = this.getTree(component);\n                    if (!treeGraph) {\n                        throw 'Failed to find a spanning tree for the component.';\n                    }\n                    var root = treeGraph.root;\n                    var tree = treeGraph.tree;\n                    layout.layout(tree, root);\n                    trees.push(tree);\n                }\n                return this.gridLayoutComponents(trees);\n            },\n            getTree: function (graph) {\n                var root = null;\n                if (this.options.roots && this.options.roots.length > 0) {\n                    for (var i = 0, len = graph.nodes.length; i < len; i++) {\n                        var node = graph.nodes[i];\n                        for (var j = 0; j < this.options.roots.length; j++) {\n                            var givenRootShape = this.options.roots[j];\n                            if (givenRootShape === node.associatedShape) {\n                                root = node;\n                                break;\n                            }\n                        }\n                    }\n                }\n                if (!root) {\n                    root = graph.root();\n                    if (!root) {\n                        throw 'Unable to find a root for the tree.';\n                    }\n                }\n                return this.getTreeForRoot(graph, root);\n            },\n            getTreeForRoot: function (graph, root) {\n                var tree = graph.getSpanningTree(root);\n                if (Utils.isUndefined(tree) || tree.isEmpty()) {\n                    return null;\n                }\n                return {\n                    tree: tree,\n                    root: tree.root\n                };\n            }\n        });\n        var LayeredLayout = LayoutBase.extend({\n            init: function (diagram) {\n                var that = this;\n                LayoutBase.fn.init.call(that);\n                if (Utils.isUndefined(diagram)) {\n                    throw 'Diagram is not specified.';\n                }\n                this.diagram = diagram;\n            },\n            layout: function (options) {\n                this.transferOptions(options);\n                var adapter = new DiagramToHyperTreeAdapter(this.diagram);\n                var graph = adapter.convert(options);\n                if (graph.isEmpty()) {\n                    return;\n                }\n                var components = graph.getConnectedComponents();\n                if (Utils.isEmpty(components)) {\n                    return;\n                }\n                for (var i = 0; i < components.length; i++) {\n                    var component = components[i];\n                    this.layoutGraph(component, options);\n                }\n                var finalNodeSet = this.gridLayoutComponents(components);\n                return new diagram.LayoutState(this.diagram, finalNodeSet);\n            },\n            _initRuntimeProperties: function () {\n                for (var k = 0; k < this.graph.nodes.length; k++) {\n                    var node = this.graph.nodes[k];\n                    node.layer = -1;\n                    node.downstreamLinkCount = 0;\n                    node.upstreamLinkCount = 0;\n                    node.isVirtual = false;\n                    node.uBaryCenter = 0;\n                    node.dBaryCenter = 0;\n                    node.upstreamPriority = 0;\n                    node.downstreamPriority = 0;\n                    node.gridPosition = 0;\n                }\n            },\n            _prepare: function (graph) {\n                var current = [], i, l, link;\n                var layerMap = new Dictionary();\n                var layerCount = 0;\n                var targetLayer, next, target;\n                Utils.forEach(graph.nodes, function (node) {\n                    if (node.incoming.length === 0) {\n                        layerMap.set(node, 0);\n                        current.push(node);\n                    }\n                });\n                while (current.length > 0) {\n                    next = current.shift();\n                    for (i = 0; i < next.outgoing.length; i++) {\n                        link = next.outgoing[i];\n                        target = link.target;\n                        if (layerMap.containsKey(target)) {\n                            targetLayer = Math.max(layerMap.get(next) + 1, layerMap.get(target));\n                        } else {\n                            targetLayer = layerMap.get(next) + 1;\n                        }\n                        layerMap.set(target, targetLayer);\n                        if (targetLayer > layerCount) {\n                            layerCount = targetLayer;\n                        }\n                        if (!contains(current, target)) {\n                            current.push(target);\n                        }\n                    }\n                }\n                var sortedNodes = layerMap.keys();\n                sortedNodes.sort(function (o1, o2) {\n                    var o1layer = layerMap.get(o1);\n                    var o2layer = layerMap.get(o2);\n                    return Utils.sign(o2layer - o1layer);\n                });\n                for (var n = 0; n < sortedNodes.length; ++n) {\n                    var node = sortedNodes[n];\n                    var minLayer = Number.MAX_VALUE;\n                    if (node.outgoing.length === 0) {\n                        continue;\n                    }\n                    for (l = 0; l < node.outgoing.length; ++l) {\n                        link = node.outgoing[l];\n                        minLayer = Math.min(minLayer, layerMap.get(link.target));\n                    }\n                    if (minLayer > 1) {\n                        layerMap.set(node, minLayer - 1);\n                    }\n                }\n                this.layers = [];\n                var layer;\n                for (i = 0; i < layerCount + 1; i++) {\n                    layer = [];\n                    layer.linksTo = {};\n                    this.layers.push(layer);\n                }\n                layerMap.forEach(function (node, layer) {\n                    node.layer = layer;\n                    this.layers[layer].push(node);\n                }, this);\n                for (l = 0; l < this.layers.length; l++) {\n                    layer = this.layers[l];\n                    for (i = 0; i < layer.length; i++) {\n                        layer[i].gridPosition = i;\n                    }\n                }\n            },\n            layoutGraph: function (graph, options) {\n                if (Utils.isUndefined(graph)) {\n                    throw 'No graph given or graph analysis of the diagram failed.';\n                }\n                if (Utils.isDefined(options)) {\n                    this.transferOptions(options);\n                }\n                this.graph = graph;\n                graph.setItemIndices();\n                var reversedEdges = graph.makeAcyclic();\n                this._initRuntimeProperties();\n                this._prepare(graph, options);\n                this._dummify();\n                this._optimizeCrossings();\n                this._swapPairs();\n                this.arrangeNodes();\n                this._moveThingsAround();\n                this._dedummify();\n                Utils.forEach(reversedEdges, function (e) {\n                    if (e.points) {\n                        e.points.reverse();\n                    }\n                });\n            },\n            setMinDist: function (m, n, minDist) {\n                var l = m.layer;\n                var i = m.layerIndex;\n                this.minDistances[l][i] = minDist;\n            },\n            getMinDist: function (m, n) {\n                var dist = 0, i1 = m.layerIndex, i2 = n.layerIndex, l = m.layer, min = Math.min(i1, i2), max = Math.max(i1, i2);\n                for (var k = min; k < max; ++k) {\n                    dist += this.minDistances[l][k];\n                }\n                return dist;\n            },\n            placeLeftToRight: function (leftClasses) {\n                var leftPos = new Dictionary(), n, node;\n                for (var c = 0; c < this.layers.length; ++c) {\n                    var classNodes = leftClasses[c];\n                    if (!classNodes) {\n                        continue;\n                    }\n                    for (n = 0; n < classNodes.length; n++) {\n                        node = classNodes[n];\n                        if (!leftPos.containsKey(node)) {\n                            this.placeLeft(node, leftPos, c);\n                        }\n                    }\n                    var d = Number.POSITIVE_INFINITY;\n                    for (n = 0; n < classNodes.length; n++) {\n                        node = classNodes[n];\n                        var rightSibling = this.rightSibling(node);\n                        if (rightSibling && this.nodeLeftClass.get(rightSibling) !== c) {\n                            d = Math.min(d, leftPos.get(rightSibling) - leftPos.get(node) - this.getMinDist(node, rightSibling));\n                        }\n                    }\n                    if (d === Number.POSITIVE_INFINITY) {\n                        var D = [];\n                        for (n = 0; n < classNodes.length; n++) {\n                            node = classNodes[n];\n                            var neighbors = [];\n                            Utils.addRange(neighbors, this.upNodes.get(node));\n                            Utils.addRange(neighbors, this.downNodes.get(node));\n                            for (var e = 0; e < neighbors.length; e++) {\n                                var neighbor = neighbors[e];\n                                if (this.nodeLeftClass.get(neighbor) < c) {\n                                    D.push(leftPos.get(neighbor) - leftPos.get(node));\n                                }\n                            }\n                        }\n                        D.sort();\n                        if (D.length === 0) {\n                            d = 0;\n                        } else if (D.length % 2 === 1) {\n                            d = D[this.intDiv(D.length, 2)];\n                        } else {\n                            d = (D[this.intDiv(D.length, 2) - 1] + D[this.intDiv(D.length, 2)]) / 2;\n                        }\n                    }\n                    for (n = 0; n < classNodes.length; n++) {\n                        node = classNodes[n];\n                        leftPos.set(node, leftPos.get(node) + d);\n                    }\n                }\n                return leftPos;\n            },\n            placeRightToLeft: function (rightClasses) {\n                var rightPos = new Dictionary(), n, node;\n                for (var c = 0; c < this.layers.length; ++c) {\n                    var classNodes = rightClasses[c];\n                    if (!classNodes) {\n                        continue;\n                    }\n                    for (n = 0; n < classNodes.length; n++) {\n                        node = classNodes[n];\n                        if (!rightPos.containsKey(node)) {\n                            this.placeRight(node, rightPos, c);\n                        }\n                    }\n                    var d = Number.NEGATIVE_INFINITY;\n                    for (n = 0; n < classNodes.length; n++) {\n                        node = classNodes[n];\n                        var leftSibling = this.leftSibling(node);\n                        if (leftSibling && this.nodeRightClass.get(leftSibling) !== c) {\n                            d = Math.max(d, rightPos.get(leftSibling) - rightPos.get(node) + this.getMinDist(leftSibling, node));\n                        }\n                    }\n                    if (d === Number.NEGATIVE_INFINITY) {\n                        var D = [];\n                        for (n = 0; n < classNodes.length; n++) {\n                            node = classNodes[n];\n                            var neighbors = [];\n                            Utils.addRange(neighbors, this.upNodes.get(node));\n                            Utils.addRange(neighbors, this.downNodes.get(node));\n                            for (var e = 0; e < neighbors.length; e++) {\n                                var neighbor = neighbors[e];\n                                if (this.nodeRightClass.get(neighbor) < c) {\n                                    D.push(rightPos.get(node) - rightPos.get(neighbor));\n                                }\n                            }\n                        }\n                        D.sort();\n                        if (D.length === 0) {\n                            d = 0;\n                        } else if (D.length % 2 === 1) {\n                            d = D[this.intDiv(D.length, 2)];\n                        } else {\n                            d = (D[this.intDiv(D.length, 2) - 1] + D[this.intDiv(D.length, 2)]) / 2;\n                        }\n                    }\n                    for (n = 0; n < classNodes.length; n++) {\n                        node = classNodes[n];\n                        rightPos.set(node, rightPos.get(node) + d);\n                    }\n                }\n                return rightPos;\n            },\n            _getLeftWing: function () {\n                var leftWing = { value: null };\n                var result = this.computeClasses(leftWing, 1);\n                this.nodeLeftClass = leftWing.value;\n                return result;\n            },\n            _getRightWing: function () {\n                var rightWing = { value: null };\n                var result = this.computeClasses(rightWing, -1);\n                this.nodeRightClass = rightWing.value;\n                return result;\n            },\n            computeClasses: function (wingPair, d) {\n                var currentWing = 0, wing = wingPair.value = new Dictionary();\n                for (var l = 0; l < this.layers.length; ++l) {\n                    currentWing = l;\n                    var layer = this.layers[l];\n                    for (var n = d === 1 ? 0 : layer.length - 1; 0 <= n && n < layer.length; n += d) {\n                        var node = layer[n];\n                        if (!wing.containsKey(node)) {\n                            wing.set(node, currentWing);\n                            if (node.isVirtual) {\n                                var ndsinl = this._nodesInLink(node);\n                                for (var kk = 0; kk < ndsinl.length; kk++) {\n                                    var vnode = ndsinl[kk];\n                                    wing.set(vnode, currentWing);\n                                }\n                            }\n                        } else {\n                            currentWing = wing.get(node);\n                        }\n                    }\n                }\n                var wings = [];\n                for (var i = 0; i < this.layers.length; i++) {\n                    wings.push(null);\n                }\n                wing.forEach(function (node, classIndex) {\n                    if (wings[classIndex] === null) {\n                        wings[classIndex] = [];\n                    }\n                    wings[classIndex].push(node);\n                });\n                return wings;\n            },\n            _isVerticalLayout: function () {\n                return this.options.subtype.toLowerCase() === 'up' || this.options.subtype.toLowerCase() === 'down' || this.options.subtype.toLowerCase() === 'vertical';\n            },\n            _isHorizontalLayout: function () {\n                return this.options.subtype.toLowerCase() === 'right' || this.options.subtype.toLowerCase() === 'left' || this.options.subtype.toLowerCase() === 'horizontal';\n            },\n            _isIncreasingLayout: function () {\n                return this.options.subtype.toLowerCase() === 'right' || this.options.subtype.toLowerCase() === 'down';\n            },\n            _moveThingsAround: function () {\n                var i, l, node, layer, n, w;\n                for (l = 0; l < this.layers.length; ++l) {\n                    layer = this.layers[l];\n                    layer.sort(this._gridPositionComparer);\n                }\n                this.minDistances = [];\n                for (l = 0; l < this.layers.length; ++l) {\n                    layer = this.layers[l];\n                    this.minDistances[l] = [];\n                    for (n = 0; n < layer.length; ++n) {\n                        node = layer[n];\n                        node.layerIndex = n;\n                        this.minDistances[l][n] = this.options.nodeDistance;\n                        if (n < layer.length - 1) {\n                            if (this._isVerticalLayout()) {\n                                this.minDistances[l][n] += (node.width + layer[n + 1].width) / 2;\n                            } else {\n                                this.minDistances[l][n] += (node.height + layer[n + 1].height) / 2;\n                            }\n                        }\n                    }\n                }\n                this.downNodes = new Dictionary();\n                this.upNodes = new Dictionary();\n                Utils.forEach(this.graph.nodes, function (node) {\n                    this.downNodes.set(node, []);\n                    this.upNodes.set(node, []);\n                }, this);\n                Utils.forEach(this.graph.links, function (link) {\n                    var origin = link.source;\n                    var dest = link.target;\n                    var down = null, up = null;\n                    if (origin.layer > dest.layer) {\n                        down = link.source;\n                        up = link.target;\n                    } else {\n                        up = link.source;\n                        down = link.target;\n                    }\n                    this.downNodes.get(up).push(down);\n                    this.upNodes.get(down).push(up);\n                }, this);\n                this.downNodes.forEachValue(function (list) {\n                    list.sort(this._gridPositionComparer);\n                }, this);\n                this.upNodes.forEachValue(function (list) {\n                    list.sort(this._gridPositionComparer);\n                }, this);\n                for (l = 0; l < this.layers.length - 1; ++l) {\n                    layer = this.layers[l];\n                    for (w = 0; w < layer.length - 1; w++) {\n                        var currentNode = layer[w];\n                        if (!currentNode.isVirtual) {\n                            continue;\n                        }\n                        var currDown = this.downNodes.get(currentNode)[0];\n                        if (!currDown.isVirtual) {\n                            continue;\n                        }\n                        for (n = w + 1; n < layer.length; ++n) {\n                            node = layer[n];\n                            if (!node.isVirtual) {\n                                continue;\n                            }\n                            var downNode = this.downNodes.get(node)[0];\n                            if (!downNode.isVirtual) {\n                                continue;\n                            }\n                            if (currDown.gridPosition > downNode.gridPosition) {\n                                var pos = currDown.gridPosition;\n                                currDown.gridPosition = downNode.gridPosition;\n                                downNode.gridPosition = pos;\n                                var i1 = currDown.layerIndex;\n                                var i2 = downNode.layerIndex;\n                                this.layers[l + 1][i1] = downNode;\n                                this.layers[l + 1][i2] = currDown;\n                                currDown.layerIndex = i2;\n                                downNode.layerIndex = i1;\n                            }\n                        }\n                    }\n                }\n                var leftClasses = this._getLeftWing();\n                var rightClasses = this._getRightWing();\n                var leftPos = this.placeLeftToRight(leftClasses);\n                var rightPos = this.placeRightToLeft(rightClasses);\n                var x = new Dictionary();\n                Utils.forEach(this.graph.nodes, function (node) {\n                    x.set(node, (leftPos.get(node) + rightPos.get(node)) / 2);\n                });\n                var order = new Dictionary();\n                var placed = new Dictionary();\n                for (l = 0; l < this.layers.length; ++l) {\n                    layer = this.layers[l];\n                    var sequenceStart = -1, sequenceEnd = -1;\n                    for (n = 0; n < layer.length; ++n) {\n                        node = layer[n];\n                        order.set(node, 0);\n                        placed.set(node, false);\n                        if (node.isVirtual) {\n                            if (sequenceStart === -1) {\n                                sequenceStart = n;\n                            } else if (sequenceStart === n - 1) {\n                                sequenceStart = n;\n                            } else {\n                                sequenceEnd = n;\n                                order.set(layer[sequenceStart], 0);\n                                if (x.get(node) - x.get(layer[sequenceStart]) === this.getMinDist(layer[sequenceStart], node)) {\n                                    placed.set(layer[sequenceStart], true);\n                                } else {\n                                    placed.set(layer[sequenceStart], false);\n                                }\n                                sequenceStart = n;\n                            }\n                        }\n                    }\n                }\n                var directions = [\n                    1,\n                    -1\n                ];\n                Utils.forEach(directions, function (d) {\n                    var start = d === 1 ? 0 : this.layers.length - 1;\n                    for (var l = start; 0 <= l && l < this.layers.length; l += d) {\n                        var layer = this.layers[l];\n                        var virtualStartIndex = this._firstVirtualNode(layer);\n                        var virtualStart = null;\n                        var sequence = null;\n                        if (virtualStartIndex !== -1) {\n                            virtualStart = layer[virtualStartIndex];\n                            sequence = [];\n                            for (i = 0; i < virtualStartIndex; i++) {\n                                sequence.push(layer[i]);\n                            }\n                        } else {\n                            virtualStart = null;\n                            sequence = layer;\n                        }\n                        if (sequence.length > 0) {\n                            this._sequencer(x, null, virtualStart, d, sequence);\n                            for (i = 0; i < sequence.length - 1; ++i) {\n                                this.setMinDist(sequence[i], sequence[i + 1], x.get(sequence[i + 1]) - x.get(sequence[i]));\n                            }\n                            if (virtualStart) {\n                                this.setMinDist(sequence[sequence.length - 1], virtualStart, x.get(virtualStart) - x.get(sequence[sequence.length - 1]));\n                            }\n                        }\n                        while (virtualStart) {\n                            var virtualEnd = this.nextVirtualNode(layer, virtualStart);\n                            if (!virtualEnd) {\n                                virtualStartIndex = virtualStart.layerIndex;\n                                sequence = [];\n                                for (i = virtualStartIndex + 1; i < layer.length; i++) {\n                                    sequence.push(layer[i]);\n                                }\n                                if (sequence.length > 0) {\n                                    this._sequencer(x, virtualStart, null, d, sequence);\n                                    for (i = 0; i < sequence.length - 1; ++i) {\n                                        this.setMinDist(sequence[i], sequence[i + 1], x.get(sequence[i + 1]) - x.get(sequence[i]));\n                                    }\n                                    this.setMinDist(virtualStart, sequence[0], x.get(sequence[0]) - x.get(virtualStart));\n                                }\n                            } else if (order.get(virtualStart) === d) {\n                                virtualStartIndex = virtualStart.layerIndex;\n                                var virtualEndIndex = virtualEnd.layerIndex;\n                                sequence = [];\n                                for (i = virtualStartIndex + 1; i < virtualEndIndex; i++) {\n                                    sequence.push(layer[i]);\n                                }\n                                if (sequence.length > 0) {\n                                    this._sequencer(x, virtualStart, virtualEnd, d, sequence);\n                                }\n                                placed.set(virtualStart, true);\n                            }\n                            virtualStart = virtualEnd;\n                        }\n                        this.adjustDirections(l, d, order, placed);\n                    }\n                }, this);\n                var fromLayerIndex = this._isIncreasingLayout() ? 0 : this.layers.length - 1;\n                var reachedFinalLayerIndex = function (k, ctx) {\n                    if (ctx._isIncreasingLayout()) {\n                        return k < ctx.layers.length;\n                    } else {\n                        return k >= 0;\n                    }\n                };\n                var layerIncrement = this._isIncreasingLayout() ? +1 : -1, offset = 0;\n                function maximumHeight(layer, ctx) {\n                    var height = Number.MIN_VALUE;\n                    for (var n = 0; n < layer.length; ++n) {\n                        var node = layer[n];\n                        if (ctx._isVerticalLayout()) {\n                            height = Math.max(height, node.height);\n                        } else {\n                            height = Math.max(height, node.width);\n                        }\n                    }\n                    return height;\n                }\n                for (i = fromLayerIndex; reachedFinalLayerIndex(i, this); i += layerIncrement) {\n                    layer = this.layers[i];\n                    var height = maximumHeight(layer, this);\n                    for (n = 0; n < layer.length; ++n) {\n                        node = layer[n];\n                        if (this._isVerticalLayout()) {\n                            node.x = x.get(node);\n                            node.y = offset + height / 2;\n                        } else {\n                            node.x = offset + height / 2;\n                            node.y = x.get(node);\n                        }\n                    }\n                    offset += this.options.layerSeparation + height;\n                }\n            },\n            adjustDirections: function (l, d, order, placed) {\n                if (l + d < 0 || l + d >= this.layers.length) {\n                    return;\n                }\n                var prevBridge = null, prevBridgeTarget = null;\n                var layer = this.layers[l + d];\n                for (var n = 0; n < layer.length; ++n) {\n                    var nextBridge = layer[n];\n                    if (nextBridge.isVirtual) {\n                        var nextBridgeTarget = this.getNeighborOnLayer(nextBridge, l);\n                        if (nextBridgeTarget.isVirtual) {\n                            if (prevBridge) {\n                                var p = placed.get(prevBridgeTarget);\n                                var clayer = this.layers[l];\n                                var i1 = prevBridgeTarget.layerIndex;\n                                var i2 = nextBridgeTarget.layerIndex;\n                                for (var i = i1 + 1; i < i2; ++i) {\n                                    if (clayer[i].isVirtual) {\n                                        p = p && placed.get(clayer[i]);\n                                    }\n                                }\n                                if (p) {\n                                    order.set(prevBridge, d);\n                                    var j1 = prevBridge.layerIndex;\n                                    var j2 = nextBridge.layerIndex;\n                                    for (var j = j1 + 1; j < j2; ++j) {\n                                        if (layer[j].isVirtual) {\n                                            order.set(layer[j], d);\n                                        }\n                                    }\n                                }\n                            }\n                            prevBridge = nextBridge;\n                            prevBridgeTarget = nextBridgeTarget;\n                        }\n                    }\n                }\n            },\n            getNeighborOnLayer: function (node, l) {\n                var neighbor = this.upNodes.get(node)[0];\n                if (neighbor.layer === l) {\n                    return neighbor;\n                }\n                neighbor = this.downNodes.get(node)[0];\n                if (neighbor.layer === l) {\n                    return neighbor;\n                }\n                return null;\n            },\n            _sequencer: function (x, virtualStart, virtualEnd, dir, sequence) {\n                if (sequence.length === 1) {\n                    this._sequenceSingle(x, virtualStart, virtualEnd, dir, sequence[0]);\n                }\n                if (sequence.length > 1) {\n                    var r = sequence.length, t = this.intDiv(r, 2);\n                    this._sequencer(x, virtualStart, virtualEnd, dir, sequence.slice(0, t));\n                    this._sequencer(x, virtualStart, virtualEnd, dir, sequence.slice(t));\n                    this.combineSequences(x, virtualStart, virtualEnd, dir, sequence);\n                }\n            },\n            _sequenceSingle: function (x, virtualStart, virtualEnd, dir, node) {\n                var neighbors = dir === -1 ? this.downNodes.get(node) : this.upNodes.get(node);\n                var n = neighbors.length;\n                if (n !== 0) {\n                    if (n % 2 === 1) {\n                        x.set(node, x.get(neighbors[this.intDiv(n, 2)]));\n                    } else {\n                        x.set(node, (x.get(neighbors[this.intDiv(n, 2) - 1]) + x.get(neighbors[this.intDiv(n, 2)])) / 2);\n                    }\n                    if (virtualStart) {\n                        x.set(node, Math.max(x.get(node), x.get(virtualStart) + this.getMinDist(virtualStart, node)));\n                    }\n                    if (virtualEnd) {\n                        x.set(node, Math.min(x.get(node), x.get(virtualEnd) - this.getMinDist(node, virtualEnd)));\n                    }\n                }\n            },\n            combineSequences: function (x, virtualStart, virtualEnd, dir, sequence) {\n                var r = sequence.length, t = this.intDiv(r, 2);\n                var leftHeap = [], i, c, n, neighbors, neighbor, pair;\n                for (i = 0; i < t; ++i) {\n                    c = 0;\n                    neighbors = dir === -1 ? this.downNodes.get(sequence[i]) : this.upNodes.get(sequence[i]);\n                    for (n = 0; n < neighbors.length; ++n) {\n                        neighbor = neighbors[n];\n                        if (x.get(neighbor) >= x.get(sequence[i])) {\n                            c++;\n                        } else {\n                            c--;\n                            leftHeap.push({\n                                k: x.get(neighbor) + this.getMinDist(sequence[i], sequence[t - 1]),\n                                v: 2\n                            });\n                        }\n                    }\n                    leftHeap.push({\n                        k: x.get(sequence[i]) + this.getMinDist(sequence[i], sequence[t - 1]),\n                        v: c\n                    });\n                }\n                if (virtualStart) {\n                    leftHeap.push({\n                        k: x.get(virtualStart) + this.getMinDist(virtualStart, sequence[t - 1]),\n                        v: Number.MAX_VALUE\n                    });\n                }\n                leftHeap.sort(this._positionDescendingComparer);\n                var rightHeap = [];\n                for (i = t; i < r; ++i) {\n                    c = 0;\n                    neighbors = dir === -1 ? this.downNodes.get(sequence[i]) : this.upNodes.get(sequence[i]);\n                    for (n = 0; n < neighbors.length; ++n) {\n                        neighbor = neighbors[n];\n                        if (x.get(neighbor) <= x.get(sequence[i])) {\n                            c++;\n                        } else {\n                            c--;\n                            rightHeap.push({\n                                k: x.get(neighbor) - this.getMinDist(sequence[i], sequence[t]),\n                                v: 2\n                            });\n                        }\n                    }\n                    rightHeap.push({\n                        k: x.get(sequence[i]) - this.getMinDist(sequence[i], sequence[t]),\n                        v: c\n                    });\n                }\n                if (virtualEnd) {\n                    rightHeap.push({\n                        k: x.get(virtualEnd) - this.getMinDist(virtualEnd, sequence[t]),\n                        v: Number.MAX_VALUE\n                    });\n                }\n                rightHeap.sort(this._positionAscendingComparer);\n                var leftRes = 0, rightRes = 0;\n                var m = this.getMinDist(sequence[t - 1], sequence[t]);\n                while (x.get(sequence[t]) - x.get(sequence[t - 1]) < m) {\n                    if (leftRes < rightRes) {\n                        if (leftHeap.length === 0) {\n                            x.set(sequence[t - 1], x.get(sequence[t]) - m);\n                            break;\n                        } else {\n                            pair = leftHeap.shift();\n                            leftRes = leftRes + pair.v;\n                            x.set(sequence[t - 1], pair.k);\n                            x.set(sequence[t - 1], Math.max(x.get(sequence[t - 1]), x.get(sequence[t]) - m));\n                        }\n                    } else {\n                        if (rightHeap.length === 0) {\n                            x.set(sequence[t], x.get(sequence[t - 1]) + m);\n                            break;\n                        } else {\n                            pair = rightHeap.shift();\n                            rightRes = rightRes + pair.v;\n                            x.set(sequence[t], pair.k);\n                            x.set(sequence[t], Math.min(x.get(sequence[t]), x.get(sequence[t - 1]) + m));\n                        }\n                    }\n                }\n                for (i = t - 2; i >= 0; i--) {\n                    x.set(sequence[i], Math.min(x.get(sequence[i]), x.get(sequence[t - 1]) - this.getMinDist(sequence[i], sequence[t - 1])));\n                }\n                for (i = t + 1; i < r; i++) {\n                    x.set(sequence[i], Math.max(x.get(sequence[i]), x.get(sequence[t]) + this.getMinDist(sequence[i], sequence[t])));\n                }\n            },\n            placeLeft: function (node, leftPos, leftClass) {\n                var pos = Number.NEGATIVE_INFINITY;\n                Utils.forEach(this._getComposite(node), function (v) {\n                    var leftSibling = this.leftSibling(v);\n                    if (leftSibling && this.nodeLeftClass.get(leftSibling) === this.nodeLeftClass.get(v)) {\n                        if (!leftPos.containsKey(leftSibling)) {\n                            this.placeLeft(leftSibling, leftPos, leftClass);\n                        }\n                        pos = Math.max(pos, leftPos.get(leftSibling) + this.getMinDist(leftSibling, v));\n                    }\n                }, this);\n                if (pos === Number.NEGATIVE_INFINITY) {\n                    pos = 0;\n                }\n                Utils.forEach(this._getComposite(node), function (v) {\n                    leftPos.set(v, pos);\n                });\n            },\n            placeRight: function (node, rightPos, rightClass) {\n                var pos = Number.POSITIVE_INFINITY;\n                Utils.forEach(this._getComposite(node), function (v) {\n                    var rightSibling = this.rightSibling(v);\n                    if (rightSibling && this.nodeRightClass.get(rightSibling) === this.nodeRightClass.get(v)) {\n                        if (!rightPos.containsKey(rightSibling)) {\n                            this.placeRight(rightSibling, rightPos, rightClass);\n                        }\n                        pos = Math.min(pos, rightPos.get(rightSibling) - this.getMinDist(v, rightSibling));\n                    }\n                }, this);\n                if (pos === Number.POSITIVE_INFINITY) {\n                    pos = 0;\n                }\n                Utils.forEach(this._getComposite(node), function (v) {\n                    rightPos.set(v, pos);\n                });\n            },\n            leftSibling: function (node) {\n                var layer = this.layers[node.layer], layerIndex = node.layerIndex;\n                return layerIndex === 0 ? null : layer[layerIndex - 1];\n            },\n            rightSibling: function (node) {\n                var layer = this.layers[node.layer];\n                var layerIndex = node.layerIndex;\n                return layerIndex === layer.length - 1 ? null : layer[layerIndex + 1];\n            },\n            _getComposite: function (node) {\n                return node.isVirtual ? this._nodesInLink(node) : [node];\n            },\n            arrangeNodes: function () {\n                var i, l, ni, layer, node;\n                for (l = 0; l < this.layers.length; l++) {\n                    layer = this.layers[l];\n                    for (ni = 0; ni < layer.length; ni++) {\n                        node = layer[ni];\n                        node.upstreamPriority = node.upstreamLinkCount;\n                        node.downstreamPriority = node.downstreamLinkCount;\n                    }\n                }\n                var maxLayoutIterations = 2;\n                for (var it = 0; it < maxLayoutIterations; it++) {\n                    for (i = this.layers.length - 1; i >= 1; i--) {\n                        this.layoutLayer(false, i);\n                    }\n                    for (i = 0; i < this.layers.length - 1; i++) {\n                        this.layoutLayer(true, i);\n                    }\n                }\n                var gridPos = Number.MAX_VALUE;\n                for (l = 0; l < this.layers.length; l++) {\n                    layer = this.layers[l];\n                    for (ni = 0; ni < layer.length; ni++) {\n                        node = layer[ni];\n                        gridPos = Math.min(gridPos, node.gridPosition);\n                    }\n                }\n                if (gridPos < 0) {\n                    for (l = 0; l < this.layers.length; l++) {\n                        layer = this.layers[l];\n                        for (ni = 0; ni < layer.length; ni++) {\n                            node = layer[ni];\n                            node.gridPosition = node.gridPosition - gridPos;\n                        }\n                    }\n                }\n            },\n            layoutLayer: function (down, layer) {\n                var iconsidered;\n                var considered;\n                if (down) {\n                    considered = this.layers[iconsidered = layer + 1];\n                } else {\n                    considered = this.layers[iconsidered = layer - 1];\n                }\n                var sorted = [];\n                for (var n = 0; n < considered.length; n++) {\n                    sorted.push(considered[n]);\n                }\n                sorted.sort(function (n1, n2) {\n                    var n1Priority = (n1.upstreamPriority + n1.downstreamPriority) / 2;\n                    var n2Priority = (n2.upstreamPriority + n2.downstreamPriority) / 2;\n                    if (Math.abs(n1Priority - n2Priority) < 0.0001) {\n                        return 0;\n                    }\n                    if (n1Priority < n2Priority) {\n                        return 1;\n                    }\n                    return -1;\n                });\n                Utils.forEach(sorted, function (node) {\n                    var nodeGridPos = node.gridPosition;\n                    var nodeBaryCenter = this.calcBaryCenter(node);\n                    var nodePriority = (node.upstreamPriority + node.downstreamPriority) / 2;\n                    if (Math.abs(nodeGridPos - nodeBaryCenter) < 0.0001) {\n                        return;\n                    }\n                    if (Math.abs(nodeGridPos - nodeBaryCenter) < 0.25 + 0.0001) {\n                        return;\n                    }\n                    if (nodeGridPos < nodeBaryCenter) {\n                        while (nodeGridPos < nodeBaryCenter) {\n                            if (!this.moveRight(node, considered, nodePriority)) {\n                                break;\n                            }\n                            nodeGridPos = node.gridPosition;\n                        }\n                    } else {\n                        while (nodeGridPos > nodeBaryCenter) {\n                            if (!this.moveLeft(node, considered, nodePriority)) {\n                                break;\n                            }\n                            nodeGridPos = node.gridPosition;\n                        }\n                    }\n                }, this);\n                if (iconsidered > 0) {\n                    this.calcDownData(iconsidered - 1);\n                }\n                if (iconsidered < this.layers.length - 1) {\n                    this.calcUpData(iconsidered + 1);\n                }\n            },\n            moveRight: function (node, layer, priority) {\n                var index = Utils.indexOf(layer, node);\n                if (index === layer.length - 1) {\n                    node.gridPosition = node.gridPosition + 0.5;\n                    return true;\n                }\n                var rightNode = layer[index + 1];\n                var rightNodePriority = (rightNode.upstreamPriority + rightNode.downstreamPriority) / 2;\n                if (rightNode.gridPosition > node.gridPosition + 1) {\n                    node.gridPosition = node.gridPosition + 0.5;\n                    return true;\n                }\n                if (rightNodePriority > priority || Math.abs(rightNodePriority - priority) < 0.0001) {\n                    return false;\n                }\n                if (this.moveRight(rightNode, layer, priority)) {\n                    node.gridPosition = node.gridPosition + 0.5;\n                    return true;\n                }\n                return false;\n            },\n            moveLeft: function (node, layer, priority) {\n                var index = Utils.indexOf(layer, node);\n                if (index === 0) {\n                    node.gridPosition = node.gridPosition - 0.5;\n                    return true;\n                }\n                var leftNode = layer[index - 1];\n                var leftNodePriority = (leftNode.upstreamPriority + leftNode.downstreamPriority) / 2;\n                if (leftNode.gridPosition < node.gridPosition - 1) {\n                    node.gridPosition = node.gridPosition - 0.5;\n                    return true;\n                }\n                if (leftNodePriority > priority || Math.abs(leftNodePriority - priority) < 0.0001) {\n                    return false;\n                }\n                if (this.moveLeft(leftNode, layer, priority)) {\n                    node.gridPosition = node.gridPosition - 0.5;\n                    return true;\n                }\n                return false;\n            },\n            mapVirtualNode: function (node, link) {\n                this.nodeToLinkMap.set(node, link);\n                if (!this.linkToNodeMap.containsKey(link)) {\n                    this.linkToNodeMap.set(link, []);\n                }\n                this.linkToNodeMap.get(link).push(node);\n            },\n            _nodesInLink: function (node) {\n                return this.linkToNodeMap.get(this.nodeToLinkMap.get(node));\n            },\n            _dummify: function () {\n                this.linkToNodeMap = new Dictionary();\n                this.nodeToLinkMap = new Dictionary();\n                var layer, pos, newNode, node, r, newLink, i, l, links = this.graph.links.slice(0);\n                var layers = this.layers;\n                var addLinkBetweenLayers = function (upLayer, downLayer, link) {\n                    layers[upLayer].linksTo[downLayer] = layers[upLayer].linksTo[downLayer] || [];\n                    layers[upLayer].linksTo[downLayer].push(link);\n                };\n                for (l = 0; l < links.length; l++) {\n                    var link = links[l];\n                    var o = link.source;\n                    var d = link.target;\n                    var oLayer = o.layer;\n                    var dLayer = d.layer;\n                    var oPos = o.gridPosition;\n                    var dPos = d.gridPosition;\n                    var step = (dPos - oPos) / Math.abs(dLayer - oLayer);\n                    var p = o;\n                    if (oLayer - dLayer > 1) {\n                        for (i = oLayer - 1; i > dLayer; i--) {\n                            newNode = new Node();\n                            newNode.x = o.x;\n                            newNode.y = o.y;\n                            newNode.width = o.width / 100;\n                            newNode.height = o.height / 100;\n                            layer = layers[i];\n                            pos = (i - dLayer) * step + oPos;\n                            if (pos > layer.length) {\n                                pos = layer.length;\n                            }\n                            if (oPos >= layers[oLayer].length - 1 && dPos >= layers[dLayer].length - 1) {\n                                pos = layer.length;\n                            } else if (oPos === 0 && dPos === 0) {\n                                pos = 0;\n                            }\n                            newNode.layer = i;\n                            newNode.uBaryCenter = 0;\n                            newNode.dBaryCenter = 0;\n                            newNode.upstreamLinkCount = 0;\n                            newNode.downstreamLinkCount = 0;\n                            newNode.gridPosition = pos;\n                            newNode.isVirtual = true;\n                            Utils.insert(layer, newNode, pos);\n                            for (r = pos + 1; r < layer.length; r++) {\n                                node = layer[r];\n                                node.gridPosition = node.gridPosition + 1;\n                            }\n                            newLink = new Link(p, newNode);\n                            newLink.depthOfDumminess = 0;\n                            addLinkBetweenLayers(i - 1, i, newLink);\n                            p = newNode;\n                            this.graph._addNode(newNode);\n                            this.graph.addLink(newLink);\n                            newNode.index = this.graph.nodes.length - 1;\n                            this.mapVirtualNode(newNode, link);\n                        }\n                        addLinkBetweenLayers(dLayer - 1, dLayer, newLink);\n                        link.changeSource(p);\n                        link.depthOfDumminess = oLayer - dLayer - 1;\n                    } else if (oLayer - dLayer < -1) {\n                        for (i = oLayer + 1; i < dLayer; i++) {\n                            newNode = new Node();\n                            newNode.x = o.x;\n                            newNode.y = o.y;\n                            newNode.width = o.width / 100;\n                            newNode.height = o.height / 100;\n                            layer = layers[i];\n                            pos = (i - oLayer) * step + oPos;\n                            if (pos > layer.length) {\n                                pos = layer.length;\n                            }\n                            if (oPos >= layers[oLayer].length - 1 && dPos >= layers[dLayer].length - 1) {\n                                pos = layer.length;\n                            } else if (oPos === 0 && dPos === 0) {\n                                pos = 0;\n                            }\n                            newNode.layer = i;\n                            newNode.uBaryCenter = 0;\n                            newNode.dBaryCenter = 0;\n                            newNode.upstreamLinkCount = 0;\n                            newNode.downstreamLinkCount = 0;\n                            newNode.gridPosition = pos;\n                            newNode.isVirtual = true;\n                            pos &= pos;\n                            Utils.insert(layer, newNode, pos);\n                            for (r = pos + 1; r < layer.length; r++) {\n                                node = layer[r];\n                                node.gridPosition = node.gridPosition + 1;\n                            }\n                            newLink = new Link(p, newNode);\n                            newLink.depthOfDumminess = 0;\n                            addLinkBetweenLayers(i - 1, i, newLink);\n                            p = newNode;\n                            this.graph._addNode(newNode);\n                            this.graph.addLink(newLink);\n                            newNode.index = this.graph.nodes.length - 1;\n                            this.mapVirtualNode(newNode, link);\n                        }\n                        addLinkBetweenLayers(dLayer - 1, dLayer, link);\n                        link.changeSource(p);\n                        link.depthOfDumminess = dLayer - oLayer - 1;\n                    } else {\n                        addLinkBetweenLayers(oLayer, dLayer, link);\n                    }\n                }\n            },\n            _dedummify: function () {\n                var dedum = true;\n                while (dedum) {\n                    dedum = false;\n                    for (var l = 0; l < this.graph.links.length; l++) {\n                        var link = this.graph.links[l];\n                        if (!link.depthOfDumminess) {\n                            continue;\n                        }\n                        var points = [];\n                        points.unshift({\n                            x: link.target.x,\n                            y: link.target.y\n                        });\n                        points.unshift({\n                            x: link.source.x,\n                            y: link.source.y\n                        });\n                        var temp = link;\n                        var depthOfDumminess = link.depthOfDumminess;\n                        for (var d = 0; d < depthOfDumminess; d++) {\n                            var node = temp.source;\n                            var prevLink = node.incoming[0];\n                            points.unshift({\n                                x: prevLink.source.x,\n                                y: prevLink.source.y\n                            });\n                            temp = prevLink;\n                        }\n                        link.changeSource(temp.source);\n                        link.depthOfDumminess = 0;\n                        if (points.length > 2) {\n                            points.splice(0, 1);\n                            points.splice(points.length - 1);\n                            link.points = points;\n                        } else {\n                            link.points = [];\n                        }\n                        dedum = true;\n                        break;\n                    }\n                }\n            },\n            _optimizeCrossings: function () {\n                var moves = -1, i;\n                var maxIterations = 3;\n                var iter = 0;\n                while (moves !== 0) {\n                    if (iter++ > maxIterations) {\n                        break;\n                    }\n                    moves = 0;\n                    for (i = this.layers.length - 1; i >= 1; i--) {\n                        moves += this.optimizeLayerCrossings(false, i);\n                    }\n                    for (i = 0; i < this.layers.length - 1; i++) {\n                        moves += this.optimizeLayerCrossings(true, i);\n                    }\n                }\n            },\n            calcUpData: function (layer) {\n                if (layer === 0) {\n                    return;\n                }\n                var considered = this.layers[layer], i, l, link;\n                var upLayer = new Set();\n                var temp = this.layers[layer - 1];\n                for (i = 0; i < temp.length; i++) {\n                    upLayer.add(temp[i]);\n                }\n                for (i = 0; i < considered.length; i++) {\n                    var node = considered[i];\n                    var sum = 0;\n                    var total = 0;\n                    for (l = 0; l < node.incoming.length; l++) {\n                        link = node.incoming[l];\n                        if (upLayer.contains(link.source)) {\n                            total++;\n                            sum += link.source.gridPosition;\n                        }\n                    }\n                    for (l = 0; l < node.outgoing.length; l++) {\n                        link = node.outgoing[l];\n                        if (upLayer.contains(link.target)) {\n                            total++;\n                            sum += link.target.gridPosition;\n                        }\n                    }\n                    if (total > 0) {\n                        node.uBaryCenter = sum / total;\n                        node.upstreamLinkCount = total;\n                    } else {\n                        node.uBaryCenter = i;\n                        node.upstreamLinkCount = 0;\n                    }\n                }\n            },\n            calcDownData: function (layer) {\n                if (layer === this.layers.length - 1) {\n                    return;\n                }\n                var considered = this.layers[layer], i, l, link;\n                var downLayer = new Set();\n                var temp = this.layers[layer + 1];\n                for (i = 0; i < temp.length; i++) {\n                    downLayer.add(temp[i]);\n                }\n                for (i = 0; i < considered.length; i++) {\n                    var node = considered[i];\n                    var sum = 0;\n                    var total = 0;\n                    for (l = 0; l < node.incoming.length; l++) {\n                        link = node.incoming[l];\n                        if (downLayer.contains(link.source)) {\n                            total++;\n                            sum += link.source.gridPosition;\n                        }\n                    }\n                    for (l = 0; l < node.outgoing.length; l++) {\n                        link = node.outgoing[l];\n                        if (downLayer.contains(link.target)) {\n                            total++;\n                            sum += link.target.gridPosition;\n                        }\n                    }\n                    if (total > 0) {\n                        node.dBaryCenter = sum / total;\n                        node.downstreamLinkCount = total;\n                    } else {\n                        node.dBaryCenter = i;\n                        node.downstreamLinkCount = 0;\n                    }\n                }\n            },\n            optimizeLayerCrossings: function (down, layer) {\n                var iconsidered;\n                var considered;\n                if (down) {\n                    considered = this.layers[iconsidered = layer + 1];\n                } else {\n                    considered = this.layers[iconsidered = layer - 1];\n                }\n                var presorted = considered.slice(0);\n                if (down) {\n                    this.calcUpData(iconsidered);\n                } else {\n                    this.calcDownData(iconsidered);\n                }\n                var that = this;\n                considered.sort(function (n1, n2) {\n                    var n1BaryCenter = that.calcBaryCenter(n1), n2BaryCenter = that.calcBaryCenter(n2);\n                    if (Math.abs(n1BaryCenter - n2BaryCenter) < 0.0001) {\n                        if (n1.degree() === n2.degree()) {\n                            return that.compareByIndex(n1, n2);\n                        } else if (n1.degree() < n2.degree()) {\n                            return 1;\n                        }\n                        return -1;\n                    }\n                    var compareValue = (n2BaryCenter - n1BaryCenter) * 1000;\n                    if (compareValue > 0) {\n                        return -1;\n                    } else if (compareValue < 0) {\n                        return 1;\n                    }\n                    return that.compareByIndex(n1, n2);\n                });\n                var i, moves = 0;\n                for (i = 0; i < considered.length; i++) {\n                    if (considered[i] !== presorted[i]) {\n                        moves++;\n                    }\n                }\n                if (moves > 0) {\n                    var inode = 0;\n                    for (i = 0; i < considered.length; i++) {\n                        var node = considered[i];\n                        node.gridPosition = inode++;\n                    }\n                }\n                return moves;\n            },\n            _swapPairs: function () {\n                var maxIterations = this.options.layeredIterations;\n                var iter = 0;\n                while (true) {\n                    if (iter++ > maxIterations) {\n                        break;\n                    }\n                    var downwards = iter % 4 <= 1;\n                    var secondPass = iter % 4 === 1;\n                    for (var l = downwards ? 0 : this.layers.length - 1; downwards ? l <= this.layers.length - 1 : l >= 0; l += downwards ? 1 : -1) {\n                        var layer = this.layers[l];\n                        var hasSwapped = false;\n                        var calcCrossings = true;\n                        var memCrossings = 0;\n                        for (var n = 0; n < layer.length - 1; n++) {\n                            var up = 0;\n                            var down = 0;\n                            var crossBefore = 0;\n                            if (calcCrossings) {\n                                if (l !== 0) {\n                                    up = this.countLinksCrossingBetweenTwoLayers(l - 1, l);\n                                }\n                                if (l !== this.layers.length - 1) {\n                                    down = this.countLinksCrossingBetweenTwoLayers(l, l + 1);\n                                }\n                                if (downwards) {\n                                    up *= 2;\n                                } else {\n                                    down *= 2;\n                                }\n                                crossBefore = up + down;\n                            } else {\n                                crossBefore = memCrossings;\n                            }\n                            if (crossBefore === 0) {\n                                continue;\n                            }\n                            var node1 = layer[n];\n                            var node2 = layer[n + 1];\n                            var node1GridPos = node1.gridPosition;\n                            var node2GridPos = node2.gridPosition;\n                            layer[n] = node2;\n                            layer[n + 1] = node1;\n                            node1.gridPosition = node2GridPos;\n                            node2.gridPosition = node1GridPos;\n                            up = 0;\n                            if (l !== 0) {\n                                up = this.countLinksCrossingBetweenTwoLayers(l - 1, l);\n                            }\n                            down = 0;\n                            if (l !== this.layers.length - 1) {\n                                down = this.countLinksCrossingBetweenTwoLayers(l, l + 1);\n                            }\n                            if (downwards) {\n                                up *= 2;\n                            } else {\n                                down *= 2;\n                            }\n                            var crossAfter = up + down;\n                            var revert = false;\n                            if (secondPass) {\n                                revert = crossAfter >= crossBefore;\n                            } else {\n                                revert = crossAfter > crossBefore;\n                            }\n                            if (revert) {\n                                node1 = layer[n];\n                                node2 = layer[n + 1];\n                                node1GridPos = node1.gridPosition;\n                                node2GridPos = node2.gridPosition;\n                                layer[n] = node2;\n                                layer[n + 1] = node1;\n                                node1.gridPosition = node2GridPos;\n                                node2.gridPosition = node1GridPos;\n                                memCrossings = crossBefore;\n                                calcCrossings = false;\n                            } else {\n                                hasSwapped = true;\n                                calcCrossings = true;\n                            }\n                        }\n                        if (hasSwapped) {\n                            if (l !== this.layers.length - 1) {\n                                this.calcUpData(l + 1);\n                            }\n                            if (l !== 0) {\n                                this.calcDownData(l - 1);\n                            }\n                        }\n                    }\n                }\n            },\n            countLinksCrossingBetweenTwoLayers: function (ulayer, dlayer) {\n                var links = this.layers[ulayer].linksTo[dlayer];\n                var link1, link2, n11, n12, n21, n22, l1, l2;\n                var crossings = 0;\n                var length = links.length;\n                for (l1 = 0; l1 < length; l1++) {\n                    link1 = links[l1];\n                    for (l2 = l1 + 1; l2 < length; l2++) {\n                        link2 = links[l2];\n                        if (link1.target.layer === dlayer) {\n                            n11 = link1.source;\n                            n12 = link1.target;\n                        } else {\n                            n11 = link1.target;\n                            n12 = link1.source;\n                        }\n                        if (link2.target.layer === dlayer) {\n                            n21 = link2.source;\n                            n22 = link2.target;\n                        } else {\n                            n21 = link2.target;\n                            n22 = link2.source;\n                        }\n                        var n11gp = n11.gridPosition;\n                        var n12gp = n12.gridPosition;\n                        var n21gp = n21.gridPosition;\n                        var n22gp = n22.gridPosition;\n                        if ((n11gp - n21gp) * (n12gp - n22gp) < 0) {\n                            crossings++;\n                        }\n                    }\n                }\n                return crossings;\n            },\n            calcBaryCenter: function (node) {\n                var upstreamLinkCount = node.upstreamLinkCount;\n                var downstreamLinkCount = node.downstreamLinkCount;\n                var uBaryCenter = node.uBaryCenter;\n                var dBaryCenter = node.dBaryCenter;\n                if (upstreamLinkCount > 0 && downstreamLinkCount > 0) {\n                    return (uBaryCenter + dBaryCenter) / 2;\n                }\n                if (upstreamLinkCount > 0) {\n                    return uBaryCenter;\n                }\n                if (downstreamLinkCount > 0) {\n                    return dBaryCenter;\n                }\n                return 0;\n            },\n            _gridPositionComparer: function (x, y) {\n                if (x.gridPosition < y.gridPosition) {\n                    return -1;\n                }\n                if (x.gridPosition > y.gridPosition) {\n                    return 1;\n                }\n                return 0;\n            },\n            _positionAscendingComparer: function (x, y) {\n                return x.k < y.k ? -1 : x.k > y.k ? 1 : 0;\n            },\n            _positionDescendingComparer: function (x, y) {\n                return x.k < y.k ? 1 : x.k > y.k ? -1 : 0;\n            },\n            _firstVirtualNode: function (layer) {\n                for (var c = 0; c < layer.length; c++) {\n                    if (layer[c].isVirtual) {\n                        return c;\n                    }\n                }\n                return -1;\n            },\n            compareByIndex: function (o1, o2) {\n                var i1 = o1.index;\n                var i2 = o2.index;\n                if (i1 < i2) {\n                    return 1;\n                }\n                if (i1 > i2) {\n                    return -1;\n                }\n                return 0;\n            },\n            intDiv: function (numerator, denominator) {\n                return (numerator - numerator % denominator) / denominator;\n            },\n            nextVirtualNode: function (layer, node) {\n                var nodeIndex = node.layerIndex;\n                for (var i = nodeIndex + 1; i < layer.length; ++i) {\n                    if (layer[i].isVirtual) {\n                        return layer[i];\n                    }\n                }\n                return null;\n            }\n        });\n        var LayoutState = kendo.Class.extend({\n            init: function (diagram, graphOrNodes) {\n                if (Utils.isUndefined(diagram)) {\n                    throw 'No diagram given';\n                }\n                this.diagram = diagram;\n                this.nodeMap = new Dictionary();\n                this.linkMap = new Dictionary();\n                this.capture(graphOrNodes ? graphOrNodes : diagram);\n            },\n            capture: function (diagramOrGraphOrNodes) {\n                var node, nodes, shape, i, conn, link, links;\n                if (diagramOrGraphOrNodes instanceof diagram.Graph) {\n                    for (i = 0; i < diagramOrGraphOrNodes.nodes.length; i++) {\n                        node = diagramOrGraphOrNodes.nodes[i];\n                        shape = node.associatedShape;\n                        this.nodeMap.set(shape.visual.id, new Rect(node.x, node.y, node.width, node.height));\n                    }\n                    for (i = 0; i < diagramOrGraphOrNodes.links.length; i++) {\n                        link = diagramOrGraphOrNodes.links[i];\n                        conn = link.associatedConnection;\n                        this.linkMap.set(conn.visual.id, link.points());\n                    }\n                } else if (diagramOrGraphOrNodes instanceof Array) {\n                    nodes = diagramOrGraphOrNodes;\n                    for (i = 0; i < nodes.length; i++) {\n                        node = nodes[i];\n                        shape = node.associatedShape;\n                        if (shape) {\n                            this.nodeMap.set(shape.visual.id, new Rect(node.x, node.y, node.width, node.height));\n                        }\n                    }\n                } else if (diagramOrGraphOrNodes.hasOwnProperty('links') && diagramOrGraphOrNodes.hasOwnProperty('nodes')) {\n                    nodes = diagramOrGraphOrNodes.nodes;\n                    links = diagramOrGraphOrNodes.links;\n                    for (i = 0; i < nodes.length; i++) {\n                        node = nodes[i];\n                        shape = node.associatedShape;\n                        if (shape) {\n                            this.nodeMap.set(shape.visual.id, new Rect(node.x, node.y, node.width, node.height));\n                        }\n                    }\n                    for (i = 0; i < links.length; i++) {\n                        link = links[i];\n                        conn = link.associatedConnection;\n                        if (conn) {\n                            this.linkMap.set(conn.visual.id, link.points);\n                        }\n                    }\n                } else {\n                    var shapes = this.diagram.shapes;\n                    var connections = this.diagram.connections;\n                    for (i = 0; i < shapes.length; i++) {\n                        shape = shapes[i];\n                        this.nodeMap.set(shape.visual.id, shape.bounds());\n                    }\n                    for (i = 0; i < connections.length; i++) {\n                        conn = connections[i];\n                        this.linkMap.set(conn.visual.id, conn.points());\n                    }\n                }\n            }\n        });\n        deepExtend(diagram, {\n            init: function (element) {\n                kendo.init(element, diagram.ui);\n            },\n            SpringLayout: SpringLayout,\n            TreeLayout: TreeLayout,\n            GraphAdapter: DiagramToHyperTreeAdapter,\n            LayeredLayout: LayeredLayout,\n            LayoutBase: LayoutBase,\n            LayoutState: LayoutState\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('dataviz/diagram/dom', [\n        'kendo.data',\n        'kendo.draganddrop',\n        'kendo.toolbar',\n        'kendo.editable',\n        'kendo.window',\n        'kendo.dropdownlist',\n        'kendo.dataviz.core',\n        'kendo.dataviz.themes',\n        'dataviz/diagram/svg',\n        'dataviz/diagram/services',\n        'dataviz/diagram/layout'\n    ], f);\n}(function () {\n    (function ($, undefined) {\n        var dataviz = kendo.dataviz, draw = kendo.drawing, geom = kendo.geometry, diagram = dataviz.diagram, Widget = kendo.ui.Widget, Class = kendo.Class, proxy = $.proxy, deepExtend = kendo.deepExtend, extend = $.extend, HierarchicalDataSource = kendo.data.HierarchicalDataSource, Canvas = diagram.Canvas, Group = diagram.Group, Rectangle = diagram.Rectangle, Circle = diagram.Circle, CompositeTransform = diagram.CompositeTransform, Rect = diagram.Rect, Path = diagram.Path, DeleteShapeUnit = diagram.DeleteShapeUnit, DeleteConnectionUnit = diagram.DeleteConnectionUnit, TextBlock = diagram.TextBlock, Image = diagram.Image, Point = diagram.Point, Intersect = diagram.Intersect, ConnectionEditAdorner = diagram.ConnectionEditAdorner, UndoRedoService = diagram.UndoRedoService, ToolService = diagram.ToolService, Selector = diagram.Selector, ResizingAdorner = diagram.ResizingAdorner, ConnectorsAdorner = diagram.ConnectorsAdorner, Cursors = diagram.Cursors, Utils = diagram.Utils, Observable = kendo.Observable, ToBackUnit = diagram.ToBackUnit, ToFrontUnit = diagram.ToFrontUnit, PolylineRouter = diagram.PolylineRouter, CascadingRouter = diagram.CascadingRouter, isUndefined = Utils.isUndefined, isDefined = Utils.isDefined, defined = kendo.util.defined, isArray = $.isArray, isFunction = kendo.isFunction, isString = Utils.isString, isPlainObject = $.isPlainObject, math = Math;\n        var NS = '.kendoDiagram', CASCADING = 'cascading', ITEMBOUNDSCHANGE = 'itemBoundsChange', CHANGE = 'change', CLICK = 'click', DRAG = 'drag', DRAG_END = 'dragEnd', DRAG_START = 'dragStart', MOUSE_ENTER = 'mouseEnter', MOUSE_LEAVE = 'mouseLeave', ERROR = 'error', AUTO = 'Auto', TOP = 'Top', RIGHT = 'Right', LEFT = 'Left', BOTTOM = 'Bottom', MAXINT = 9007199254740992, SELECT = 'select', ITEMROTATE = 'itemRotate', PAN = 'pan', ZOOM_START = 'zoomStart', ZOOM_END = 'zoomEnd', NONE = 'none', DEFAULT_CANVAS_WIDTH = 600, DEFAULT_CANVAS_HEIGHT = 600, DEFAULT_SHAPE_TYPE = 'rectangle', DEFAULT_SHAPE_WIDTH = 100, DEFAULT_SHAPE_HEIGHT = 100, DEFAULT_SHAPE_MINWIDTH = 20, DEFAULT_SHAPE_MINHEIGHT = 20, DEFAULT_SHAPE_POSITION = 0, DEFAULT_CONNECTION_BACKGROUND = 'Yellow', MAX_VALUE = Number.MAX_VALUE, MIN_VALUE = -Number.MAX_VALUE, ABSOLUTE = 'absolute', TRANSFORMED = 'transformed', ROTATED = 'rotated', TRANSPARENT = 'transparent', WIDTH = 'width', HEIGHT = 'height', X = 'x', Y = 'y', MOUSEWHEEL_NS = 'DOMMouseScroll' + NS + ' mousewheel' + NS, MOBILE_ZOOM_RATE = 0.05, MOBILE_PAN_DISTANCE = 5, BUTTON_TEMPLATE = '<a class=\"k-button k-button-icontext #=className#\" href=\"\\\\#\"><span class=\"#=iconClass# #=imageClass#\"></span>#=text#</a>', CONNECTION_CONTENT_OFFSET = 5;\n        diagram.DefaultConnectors = [\n            { name: TOP },\n            { name: BOTTOM },\n            { name: LEFT },\n            { name: RIGHT },\n            {\n                name: AUTO,\n                position: function (shape) {\n                    return shape.getPosition('center');\n                }\n            }\n        ];\n        var defaultButtons = {\n            cancel: {\n                text: 'Cancel',\n                imageClass: 'k-i-cancel',\n                className: 'k-diagram-cancel',\n                iconClass: 'k-icon'\n            },\n            update: {\n                text: 'Update',\n                imageClass: 'k-i-update',\n                className: 'k-diagram-update',\n                iconClass: 'k-icon'\n            }\n        };\n        diagram.shapeDefaults = function (extra) {\n            var defaults = {\n                type: DEFAULT_SHAPE_TYPE,\n                path: '',\n                autoSize: true,\n                visual: null,\n                x: DEFAULT_SHAPE_POSITION,\n                y: DEFAULT_SHAPE_POSITION,\n                minWidth: DEFAULT_SHAPE_MINWIDTH,\n                minHeight: DEFAULT_SHAPE_MINHEIGHT,\n                width: DEFAULT_SHAPE_WIDTH,\n                height: DEFAULT_SHAPE_HEIGHT,\n                hover: {},\n                editable: {\n                    connect: true,\n                    tools: []\n                },\n                connectors: diagram.DefaultConnectors,\n                rotation: { angle: 0 }\n            };\n            Utils.simpleExtend(defaults, extra);\n            return defaults;\n        };\n        function mwDelta(e) {\n            var origEvent = e.originalEvent, delta = 0;\n            if (origEvent.wheelDelta) {\n                delta = -origEvent.wheelDelta / 40;\n                delta = delta > 0 ? math.ceil(delta) : math.floor(delta);\n            } else if (origEvent.detail) {\n                delta = origEvent.detail;\n            }\n            return delta;\n        }\n        function isAutoConnector(connector) {\n            return connector.options.name.toLowerCase() === AUTO.toLowerCase();\n        }\n        function closestConnector(point, connectors) {\n            var minimumDistance = MAXINT, resCtr, connector;\n            for (var i = 0; i < connectors.length; i++) {\n                connector = connectors[i];\n                if (!isAutoConnector(connector)) {\n                    var dist = point.distanceTo(connector.position());\n                    if (dist < minimumDistance) {\n                        minimumDistance = dist;\n                        resCtr = connector;\n                    }\n                }\n            }\n            return resCtr;\n        }\n        function indicesOfItems(group, visuals) {\n            var i, indices = [], visual;\n            var children = group.drawingContainer().children;\n            var length = children.length;\n            for (i = 0; i < visuals.length; i++) {\n                visual = visuals[i];\n                for (var j = 0; j < length; j++) {\n                    if (children[j] == visual.drawingContainer()) {\n                        indices.push(j);\n                        break;\n                    }\n                }\n            }\n            return indices;\n        }\n        var DiagramElement = Observable.extend({\n            init: function (options) {\n                var that = this;\n                that.dataItem = (options || {}).dataItem;\n                Observable.fn.init.call(that);\n                that.options = deepExtend({ id: diagram.randomId() }, that.options, options);\n                that.isSelected = false;\n                that.visual = new Group({\n                    id: that.options.id,\n                    autoSize: that.options.autoSize\n                });\n                that.id = that.options.id;\n                that._template();\n            },\n            options: {\n                hover: {},\n                cursor: Cursors.grip,\n                content: { align: 'center middle' },\n                selectable: true,\n                serializable: true,\n                enable: true\n            },\n            _getCursor: function (point) {\n                if (this.adorner) {\n                    return this.adorner._getCursor(point);\n                }\n                return this.options.cursor;\n            },\n            visible: function (value) {\n                if (isUndefined(value)) {\n                    return this.visual.visible();\n                } else {\n                    this.visual.visible(value);\n                }\n            },\n            bounds: function () {\n            },\n            refresh: function () {\n                this.visual.redraw();\n            },\n            position: function (point) {\n                this.options.x = point.x;\n                this.options.y = point.y;\n                this.visual.position(point);\n            },\n            toString: function () {\n                return this.options.id;\n            },\n            serialize: function () {\n                var json = deepExtend({}, { options: this.options });\n                if (this.dataItem) {\n                    json.dataItem = this.dataItem.toString();\n                }\n                return json;\n            },\n            _content: function (content) {\n                if (content !== undefined) {\n                    var options = this.options;\n                    if (diagram.Utils.isString(content)) {\n                        options.content.text = content;\n                    } else {\n                        deepExtend(options.content, content);\n                    }\n                    var contentOptions = options.content;\n                    var contentVisual = this._contentVisual;\n                    if (!contentVisual) {\n                        this._createContentVisual(contentOptions);\n                    } else {\n                        this._updateContentVisual(contentOptions);\n                    }\n                }\n                return this.options.content.text;\n            },\n            _createContentVisual: function (options) {\n                if (options.text) {\n                    this._contentVisual = new TextBlock(options);\n                    this._contentVisual._includeInBBox = false;\n                    this.visual.append(this._contentVisual);\n                }\n            },\n            _updateContentVisual: function (options) {\n                this._contentVisual.redraw(options);\n            },\n            _hitTest: function (point) {\n                var bounds = this.bounds();\n                return this.visible() && bounds.contains(point) && this.options.enable;\n            },\n            _template: function () {\n                var that = this;\n                if (that.options.content.template) {\n                    var data = that.dataItem || {}, elementTemplate = kendo.template(that.options.content.template, { paramName: 'dataItem' });\n                    that.options.content.text = elementTemplate(data);\n                }\n            },\n            _canSelect: function () {\n                return this.options.selectable !== false;\n            },\n            toJSON: function () {\n                return { id: this.options.id };\n            }\n        });\n        var Connector = Class.extend({\n            init: function (shape, options) {\n                this.options = deepExtend({}, this.options, options);\n                this.connections = [];\n                this.shape = shape;\n            },\n            options: {\n                width: 7,\n                height: 7,\n                fill: { color: DEFAULT_CONNECTION_BACKGROUND },\n                hover: {}\n            },\n            position: function () {\n                if (this.options.position) {\n                    return this.options.position(this.shape);\n                } else {\n                    return this.shape.getPosition(this.options.name);\n                }\n            },\n            toJSON: function () {\n                return {\n                    shapeId: this.shape.toString(),\n                    connector: this.options.name\n                };\n            }\n        });\n        Connector.parse = function (diagram, str) {\n            var tempStr = str.split(':'), id = tempStr[0], name = tempStr[1] || AUTO;\n            for (var i = 0; i < diagram.shapes.length; i++) {\n                var shape = diagram.shapes[i];\n                if (shape.options.id == id) {\n                    return shape.getConnector(name.trim());\n                }\n            }\n        };\n        var Shape = DiagramElement.extend({\n            init: function (options, diagram) {\n                var that = this;\n                DiagramElement.fn.init.call(that, options);\n                this.diagram = diagram;\n                this.updateOptionsFromModel();\n                options = that.options;\n                that.connectors = [];\n                that.type = options.type;\n                that.createShapeVisual();\n                that.updateBounds();\n                that.content(that.content());\n                that._createConnectors();\n            },\n            options: diagram.shapeDefaults(),\n            _setOptionsFromModel: function (model) {\n                var modelOptions = filterShapeDataItem(model || this.dataItem);\n                this.options = deepExtend({}, this.options, modelOptions);\n                this.redrawVisual();\n            },\n            updateOptionsFromModel: function (model, field) {\n                if (this.diagram && this.diagram._isEditable) {\n                    var modelOptions = filterShapeDataItem(model || this.dataItem);\n                    if (model && field) {\n                        if (!dataviz.inArray(field, [\n                                'x',\n                                'y',\n                                'width',\n                                'height'\n                            ])) {\n                            if (this.options.visual) {\n                                this._redrawVisual();\n                            } else if (modelOptions.type) {\n                                this.options = deepExtend({}, this.options, modelOptions);\n                                this._redrawVisual();\n                            }\n                            if (this.options.content) {\n                                this._template();\n                                this.content(this.options.content);\n                            }\n                        } else {\n                            var bounds = this.bounds();\n                            bounds[field] = model[field];\n                            this.bounds(bounds);\n                        }\n                    } else {\n                        this.options = deepExtend({}, this.options, modelOptions);\n                    }\n                }\n            },\n            _redrawVisual: function () {\n                this.visual.clear();\n                this._contentVisual = null;\n                this.options.dataItem = this.dataItem;\n                this.createShapeVisual();\n                this.updateBounds();\n            },\n            redrawVisual: function () {\n                this._redrawVisual();\n                if (this.options.content) {\n                    this._template();\n                    this.content(this.options.content);\n                }\n            },\n            updateModel: function (syncChanges) {\n                var diagram = this.diagram;\n                if (diagram && diagram._isEditable) {\n                    var bounds = this._bounds;\n                    var model = this.dataItem;\n                    if (model) {\n                        diagram._suspendModelRefresh();\n                        if (defined(model.x) && bounds.x !== model.x) {\n                            model.set('x', bounds.x);\n                        }\n                        if (defined(model.y) && bounds.y !== model.y) {\n                            model.set('y', bounds.y);\n                        }\n                        if (defined(model.width) && bounds.width !== model.width) {\n                            model.set('width', bounds.width);\n                        }\n                        if (defined(model.height) && bounds.height !== model.height) {\n                            model.set('height', bounds.height);\n                        }\n                        this.dataItem = model;\n                        diagram._resumeModelRefresh();\n                        if (syncChanges) {\n                            diagram._syncShapeChanges();\n                        }\n                    }\n                }\n            },\n            updateBounds: function () {\n                var bounds = this.visual._measure(true);\n                var options = this.options;\n                this.bounds(new Rect(options.x, options.y, bounds.width, bounds.height));\n                this._rotate();\n                this._alignContent();\n            },\n            content: function (content) {\n                var result = this._content(content);\n                this._alignContent();\n                return result;\n            },\n            _alignContent: function () {\n                var contentOptions = this.options.content || {};\n                var contentVisual = this._contentVisual;\n                if (contentVisual && contentOptions.align) {\n                    var containerRect = this.visual._measure();\n                    var aligner = new diagram.RectAlign(containerRect);\n                    var contentBounds = contentVisual.drawingElement.bbox(null);\n                    var contentRect = new Rect(0, 0, contentBounds.width(), contentBounds.height());\n                    var alignedBounds = aligner.align(contentRect, contentOptions.align);\n                    contentVisual.position(alignedBounds.topLeft());\n                }\n            },\n            _createConnectors: function () {\n                var options = this.options, length = options.connectors.length, connectorDefaults = options.connectorDefaults, connector, i;\n                for (i = 0; i < length; i++) {\n                    connector = new Connector(this, deepExtend({}, connectorDefaults, options.connectors[i]));\n                    this.connectors.push(connector);\n                }\n            },\n            bounds: function (value) {\n                var bounds;\n                if (value) {\n                    if (isString(value)) {\n                        switch (value) {\n                        case TRANSFORMED:\n                            bounds = this._transformedBounds();\n                            break;\n                        case ABSOLUTE:\n                            bounds = this._transformedBounds();\n                            var pan = this.diagram._pan;\n                            bounds.x += pan.x;\n                            bounds.y += pan.y;\n                            break;\n                        case ROTATED:\n                            bounds = this._rotatedBounds();\n                            break;\n                        default:\n                            bounds = this._bounds;\n                        }\n                    } else {\n                        this._setBounds(value);\n                        this._triggerBoundsChange();\n                        if (!(this.diagram && this.diagram._layouting)) {\n                            this.refreshConnections();\n                        }\n                    }\n                } else {\n                    bounds = this._bounds;\n                }\n                return bounds;\n            },\n            _setBounds: function (rect) {\n                var options = this.options;\n                var topLeft = rect.topLeft();\n                var x = options.x = topLeft.x;\n                var y = options.y = topLeft.y;\n                var width = options.width = math.max(rect.width, options.minWidth);\n                var height = options.height = math.max(rect.height, options.minHeight);\n                this._bounds = new Rect(x, y, width, height);\n                this.visual.redraw({\n                    x: x,\n                    y: y,\n                    width: width,\n                    height: height\n                });\n            },\n            position: function (point) {\n                if (point) {\n                    this.bounds(new Rect(point.x, point.y, this._bounds.width, this._bounds.height));\n                } else {\n                    return this._bounds.topLeft();\n                }\n            },\n            clone: function () {\n                var json = this.serialize();\n                json.options.id = diagram.randomId();\n                if (this.diagram && this.diagram._isEditable && defined(this.dataItem)) {\n                    json.options.dataItem = cloneDataItem(this.dataItem);\n                }\n                return new Shape(json.options);\n            },\n            select: function (value) {\n                var diagram = this.diagram, selected, deselected;\n                if (isUndefined(value)) {\n                    value = true;\n                }\n                if (this._canSelect()) {\n                    if (this.isSelected != value) {\n                        selected = [];\n                        deselected = [];\n                        this.isSelected = value;\n                        if (this.isSelected) {\n                            diagram._selectedItems.push(this);\n                            selected.push(this);\n                        } else {\n                            Utils.remove(diagram._selectedItems, this);\n                            deselected.push(this);\n                        }\n                        if (!diagram._internalSelection) {\n                            diagram._selectionChanged(selected, deselected);\n                        }\n                        return true;\n                    }\n                }\n            },\n            rotate: function (angle, center, undoable) {\n                var rotate = this.visual.rotate();\n                if (angle !== undefined) {\n                    if (undoable !== false && this.diagram && this.diagram.undoRedoService && angle !== rotate.angle) {\n                        this.diagram.undoRedoService.add(new diagram.RotateUnit(this.diagram._resizingAdorner, [this], [rotate.angle]), false);\n                    }\n                    var b = this.bounds(), sc = new Point(b.width / 2, b.height / 2), deltaAngle, newPosition;\n                    if (center) {\n                        deltaAngle = angle - rotate.angle;\n                        newPosition = b.center().rotate(center, 360 - deltaAngle).minus(sc);\n                        this._rotationOffset = this._rotationOffset.plus(newPosition.minus(b.topLeft()));\n                        this.position(newPosition);\n                    }\n                    this.visual.rotate(angle, sc);\n                    this.options.rotation.angle = angle;\n                    if (this.diagram && this.diagram._connectorsAdorner) {\n                        this.diagram._connectorsAdorner.refresh();\n                    }\n                    this.refreshConnections();\n                    if (this.diagram) {\n                        this.diagram.trigger(ITEMROTATE, { item: this });\n                    }\n                }\n                return rotate;\n            },\n            connections: function (type) {\n                var result = [], i, j, con, cons, ctr;\n                for (i = 0; i < this.connectors.length; i++) {\n                    ctr = this.connectors[i];\n                    cons = ctr.connections;\n                    for (j = 0, cons; j < cons.length; j++) {\n                        con = cons[j];\n                        if (type == 'out') {\n                            var source = con.source();\n                            if (source.shape && source.shape == this) {\n                                result.push(con);\n                            }\n                        } else if (type == 'in') {\n                            var target = con.target();\n                            if (target.shape && target.shape == this) {\n                                result.push(con);\n                            }\n                        } else {\n                            result.push(con);\n                        }\n                    }\n                }\n                return result;\n            },\n            refreshConnections: function () {\n                $.each(this.connections(), function () {\n                    this.refresh();\n                });\n            },\n            getConnector: function (nameOrPoint) {\n                var i, ctr;\n                if (isString(nameOrPoint)) {\n                    nameOrPoint = nameOrPoint.toLocaleLowerCase();\n                    for (i = 0; i < this.connectors.length; i++) {\n                        ctr = this.connectors[i];\n                        if (ctr.options.name.toLocaleLowerCase() == nameOrPoint) {\n                            return ctr;\n                        }\n                    }\n                } else if (nameOrPoint instanceof Point) {\n                    return closestConnector(nameOrPoint, this.connectors);\n                } else {\n                    return this.connectors.length ? this.connectors[0] : null;\n                }\n            },\n            getPosition: function (side) {\n                var b = this.bounds(), fnName = side.charAt(0).toLowerCase() + side.slice(1);\n                if (isFunction(b[fnName])) {\n                    return this._transformPoint(b[fnName]());\n                }\n                return b.center();\n            },\n            redraw: function (options) {\n                if (options) {\n                    var shapeOptions = this.options;\n                    var boundsChange;\n                    this.shapeVisual.redraw(this._visualOptions(options));\n                    if (this._diffNumericOptions(options, [\n                            WIDTH,\n                            HEIGHT,\n                            X,\n                            Y\n                        ])) {\n                        this.bounds(new Rect(shapeOptions.x, shapeOptions.y, shapeOptions.width, shapeOptions.height));\n                        boundsChange = true;\n                    }\n                    if (options.connectors) {\n                        shapeOptions.connectors = options.connectors;\n                        this._updateConnectors();\n                    }\n                    shapeOptions = deepExtend(shapeOptions, options);\n                    if (options.rotation || boundsChange) {\n                        this._rotate();\n                    }\n                    if (shapeOptions.content) {\n                        this.content(shapeOptions.content);\n                    }\n                }\n            },\n            _updateConnectors: function () {\n                var connections = this.connections();\n                this.connectors = [];\n                this._createConnectors();\n                var connection;\n                var source;\n                var target;\n                for (var idx = 0; idx < connections.length; idx++) {\n                    connection = connections[idx];\n                    source = connection.source();\n                    target = connection.target();\n                    if (source.shape && source.shape === this) {\n                        connection.source(this.getConnector(source.options.name) || null);\n                    } else if (target.shape && target.shape === this) {\n                        connection.target(this.getConnector(target.options.name) || null);\n                    }\n                    connection.updateModel();\n                }\n            },\n            _diffNumericOptions: diagram.diffNumericOptions,\n            _visualOptions: function (options) {\n                return {\n                    data: options.path,\n                    source: options.source,\n                    hover: options.hover,\n                    fill: options.fill,\n                    stroke: options.stroke\n                };\n            },\n            _triggerBoundsChange: function () {\n                if (this.diagram) {\n                    this.diagram.trigger(ITEMBOUNDSCHANGE, {\n                        item: this,\n                        bounds: this._bounds.clone()\n                    });\n                }\n            },\n            _transformPoint: function (point) {\n                var rotate = this.rotate(), bounds = this.bounds(), tl = bounds.topLeft();\n                if (rotate.angle) {\n                    point.rotate(rotate.center().plus(tl), 360 - rotate.angle);\n                }\n                return point;\n            },\n            _transformedBounds: function () {\n                var bounds = this.bounds(), tl = bounds.topLeft(), br = bounds.bottomRight();\n                return Rect.fromPoints(this.diagram.modelToView(tl), this.diagram.modelToView(br));\n            },\n            _rotatedBounds: function () {\n                var bounds = this.bounds().rotatedBounds(this.rotate().angle), tl = bounds.topLeft(), br = bounds.bottomRight();\n                return Rect.fromPoints(tl, br);\n            },\n            _rotate: function () {\n                var rotation = this.options.rotation;\n                if (rotation && rotation.angle) {\n                    this.rotate(rotation.angle);\n                }\n                this._rotationOffset = new Point();\n            },\n            _hover: function (value) {\n                var options = this.options, hover = options.hover, stroke = options.stroke, fill = options.fill;\n                if (value && isDefined(hover.stroke)) {\n                    stroke = deepExtend({}, stroke, hover.stroke);\n                }\n                if (value && isDefined(hover.fill)) {\n                    fill = hover.fill;\n                }\n                this.shapeVisual.redraw({\n                    stroke: stroke,\n                    fill: fill\n                });\n                if (options.editable && options.editable.connect) {\n                    this.diagram._showConnectors(this, value);\n                }\n            },\n            _hitTest: function (value) {\n                if (this.visible()) {\n                    var bounds = this.bounds(), rotatedPoint, angle = this.rotate().angle;\n                    if (value.isEmpty && !value.isEmpty()) {\n                        return Intersect.rects(value, bounds, angle ? angle : 0);\n                    } else {\n                        rotatedPoint = value.clone().rotate(bounds.center(), angle);\n                        if (bounds.contains(rotatedPoint)) {\n                            return this;\n                        }\n                    }\n                }\n            },\n            toJSON: function () {\n                return { shapeId: this.options.id };\n            },\n            createShapeVisual: function () {\n                var options = this.options;\n                var visualOptions = this._visualOptions(options);\n                var visualTemplate = options.visual;\n                var type = (options.type + '').toLocaleLowerCase();\n                var shapeVisual;\n                visualOptions.width = options.width;\n                visualOptions.height = options.height;\n                if (isFunction(visualTemplate)) {\n                    shapeVisual = visualTemplate.call(this, options);\n                } else if (visualOptions.data) {\n                    shapeVisual = new Path(visualOptions);\n                    translateToOrigin(shapeVisual);\n                } else if (type == 'rectangle') {\n                    shapeVisual = new Rectangle(visualOptions);\n                } else if (type == 'circle') {\n                    shapeVisual = new Circle(visualOptions);\n                } else if (type == 'text') {\n                    shapeVisual = new TextBlock(visualOptions);\n                } else if (type == 'image') {\n                    shapeVisual = new Image(visualOptions);\n                } else {\n                    shapeVisual = new Path(visualOptions);\n                }\n                this.shapeVisual = shapeVisual;\n                this.visual.append(this.shapeVisual);\n            }\n        });\n        var Connection = DiagramElement.extend({\n            init: function (from, to, options) {\n                var that = this;\n                DiagramElement.fn.init.call(that, options);\n                this.updateOptionsFromModel();\n                this._initRouter();\n                that.path = new diagram.Polyline(that.options);\n                that.path.fill(TRANSPARENT);\n                that.visual.append(that.path);\n                that._sourcePoint = that._targetPoint = new Point();\n                that._setSource(from);\n                that._setTarget(to);\n                that.content(that.options.content);\n                that.definers = [];\n                if (defined(options) && options.points) {\n                    that.points(options.points);\n                }\n            },\n            options: {\n                hover: { stroke: {} },\n                startCap: NONE,\n                endCap: NONE,\n                points: [],\n                selectable: true,\n                fromConnector: AUTO,\n                toConenctor: AUTO\n            },\n            _setOptionsFromModel: function (model) {\n                this.updateOptionsFromModel(model || this.dataItem);\n            },\n            updateOptionsFromModel: function (model) {\n                if (this.diagram && this.diagram._isEditable) {\n                    var dataMap = this.diagram._dataMap;\n                    var options = filterConnectionDataItem(model || this.dataItem);\n                    if (model) {\n                        if (defined(options.from)) {\n                            var from = dataMap[options.from];\n                            if (from && defined(options.fromConnector)) {\n                                from = from.getConnector(options.fromConnector);\n                            }\n                            this.source(from);\n                        } else if (defined(options.fromX) && defined(options.fromY)) {\n                            this.source(new Point(options.fromX, options.fromY));\n                        }\n                        if (defined(options.to)) {\n                            var to = dataMap[options.to];\n                            if (to && defined(options.toConnector)) {\n                                to = to.getConnector(options.toConnector);\n                            }\n                            this.target(to);\n                        } else if (defined(options.toX) && defined(options.toY)) {\n                            this.target(new Point(options.toX, options.toY));\n                        }\n                        if (defined(options.type) && this.type() !== options.type) {\n                            this.points([]);\n                            this.type(options.type);\n                        }\n                        this.dataItem = model;\n                        this._template();\n                        this.redraw(this.options);\n                    } else {\n                        this.options = deepExtend({}, options, this.options);\n                    }\n                }\n            },\n            updateModel: function (syncChanges) {\n                if (this.diagram && this.diagram._isEditable) {\n                    if (this.diagram.connectionsDataSource) {\n                        var model = this.diagram.connectionsDataSource.getByUid(this.dataItem.uid);\n                        if (model) {\n                            this.diagram._suspendModelRefresh();\n                            if (defined(this.options.fromX) && this.options.fromX !== null) {\n                                clearField('from', model);\n                                clearField('fromConnector', model);\n                                model.set('fromX', this.options.fromX);\n                                model.set('fromY', this.options.fromY);\n                            } else {\n                                model.set('from', this.options.from);\n                                if (defined(model.fromConnector)) {\n                                    model.set('fromConnector', this.sourceConnector ? this.sourceConnector.options.name : null);\n                                }\n                                clearField('fromX', model);\n                                clearField('fromY', model);\n                            }\n                            if (defined(this.options.toX) && this.options.toX !== null) {\n                                clearField('to', model);\n                                clearField('toConnector', model);\n                                model.set('toX', this.options.toX);\n                                model.set('toY', this.options.toY);\n                            } else {\n                                model.set('to', this.options.to);\n                                if (defined(model.toConnector)) {\n                                    model.set('toConnector', this.targetConnector ? this.targetConnector.options.name : null);\n                                }\n                                clearField('toX', model);\n                                clearField('toY', model);\n                            }\n                            if (defined(this.options.type) && defined(model.type)) {\n                                model.set('type', this.options.type);\n                            }\n                            this.dataItem = model;\n                            this.diagram._resumeModelRefresh();\n                            if (syncChanges) {\n                                this.diagram._syncConnectionChanges();\n                            }\n                        }\n                    }\n                }\n            },\n            sourcePoint: function () {\n                return this._resolvedSourceConnector ? this._resolvedSourceConnector.position() : this._sourcePoint;\n            },\n            _setSource: function (source) {\n                var shapeSource = source instanceof Shape;\n                var defaultConnector = this.options.fromConnector || AUTO;\n                var dataItem;\n                if (shapeSource && !source.getConnector(defaultConnector)) {\n                    return;\n                }\n                if (source !== undefined) {\n                    this.from = source;\n                }\n                this._removeFromSourceConnector();\n                if (source === null) {\n                    if (this.sourceConnector) {\n                        this._sourcePoint = (this._resolvedSourceConnector || this.sourceConnector).position();\n                        this._clearSourceConnector();\n                        this._setFromOptions(null, this._sourcePoint);\n                    }\n                } else if (source instanceof Connector) {\n                    dataItem = source.shape.dataItem;\n                    if (dataItem) {\n                        this._setFromOptions(dataItem.id);\n                    }\n                    this.sourceConnector = source;\n                    this.sourceConnector.connections.push(this);\n                } else if (source instanceof Point) {\n                    this._setFromOptions(null, source);\n                    this._sourcePoint = source;\n                    if (this.sourceConnector) {\n                        this._clearSourceConnector();\n                    }\n                } else if (shapeSource) {\n                    dataItem = source.dataItem;\n                    if (dataItem) {\n                        this._setFromOptions(dataItem.id);\n                    }\n                    this.sourceConnector = source.getConnector(defaultConnector);\n                    this.sourceConnector.connections.push(this);\n                }\n            },\n            source: function (source, undoable) {\n                if (isDefined(source)) {\n                    if (undoable && this.diagram) {\n                        this.diagram.undoRedoService.addCompositeItem(new diagram.ConnectionEditUnit(this, source));\n                    }\n                    this._setSource(source);\n                    this.refresh();\n                }\n                return this.sourceConnector ? this.sourceConnector : this._sourcePoint;\n            },\n            _setFromOptions: function (from, fromPoint) {\n                this.options.from = from;\n                if (fromPoint) {\n                    this.options.fromX = fromPoint.x;\n                    this.options.fromY = fromPoint.y;\n                } else {\n                    this.options.fromX = null;\n                    this.options.fromY = null;\n                }\n            },\n            sourceDefiner: function (value) {\n                if (value) {\n                    if (value instanceof diagram.PathDefiner) {\n                        value.left = null;\n                        this._sourceDefiner = value;\n                        this.source(value.point);\n                    } else {\n                        throw 'The sourceDefiner needs to be a PathDefiner.';\n                    }\n                } else {\n                    if (!this._sourceDefiner) {\n                        this._sourceDefiner = new diagram.PathDefiner(this.sourcePoint(), null, null);\n                    }\n                    return this._sourceDefiner;\n                }\n            },\n            targetPoint: function () {\n                return this._resolvedTargetConnector ? this._resolvedTargetConnector.position() : this._targetPoint;\n            },\n            _setTarget: function (target) {\n                var shapeTarget = target instanceof Shape;\n                var defaultConnector = this.options.toConnector || AUTO;\n                var dataItem;\n                if (shapeTarget && !target.getConnector(defaultConnector)) {\n                    return;\n                }\n                if (target !== undefined) {\n                    this.to = target;\n                }\n                this._removeFromTargetConnector();\n                if (target === null) {\n                    if (this.targetConnector) {\n                        this._targetPoint = (this._resolvedTargetConnector || this.targetConnector).position();\n                        this._clearTargetConnector();\n                        this._setToOptions(null, this._targetPoint);\n                    }\n                } else if (target instanceof Connector) {\n                    dataItem = target.shape.dataItem;\n                    if (dataItem) {\n                        this._setToOptions(dataItem.id);\n                    }\n                    this.targetConnector = target;\n                    this.targetConnector.connections.push(this);\n                } else if (target instanceof Point) {\n                    this._setToOptions(null, target);\n                    this._targetPoint = target;\n                    if (this.targetConnector) {\n                        this._clearTargetConnector();\n                    }\n                } else if (shapeTarget) {\n                    dataItem = target.dataItem;\n                    if (dataItem) {\n                        this._setToOptions(dataItem.id);\n                    }\n                    this.targetConnector = target.getConnector(defaultConnector);\n                    this.targetConnector.connections.push(this);\n                }\n            },\n            target: function (target, undoable) {\n                if (isDefined(target)) {\n                    if (undoable && this.diagram) {\n                        this.diagram.undoRedoService.addCompositeItem(new diagram.ConnectionEditUnit(this, undefined, target));\n                    }\n                    this._setTarget(target);\n                    this.refresh();\n                }\n                return this.targetConnector ? this.targetConnector : this._targetPoint;\n            },\n            _setToOptions: function (to, toPoint) {\n                this.options.to = to;\n                if (toPoint) {\n                    this.options.toX = toPoint.x;\n                    this.options.toY = toPoint.y;\n                } else {\n                    this.options.toX = null;\n                    this.options.toY = null;\n                }\n            },\n            targetDefiner: function (value) {\n                if (value) {\n                    if (value instanceof diagram.PathDefiner) {\n                        value.right = null;\n                        this._targetDefiner = value;\n                        this.target(value.point);\n                    } else {\n                        throw 'The sourceDefiner needs to be a PathDefiner.';\n                    }\n                } else {\n                    if (!this._targetDefiner) {\n                        this._targetDefiner = new diagram.PathDefiner(this.targetPoint(), null, null);\n                    }\n                    return this._targetDefiner;\n                }\n            },\n            _updateConnectors: function () {\n                this._updateConnector(this.source(), 'source');\n                this._updateConnector(this.target(), 'target');\n            },\n            _updateConnector: function (instance, name) {\n                var that = this;\n                var diagram = that.diagram;\n                if (instance instanceof Connector && !diagram.getShapeById(instance.shape.id)) {\n                    var dataItem = instance.shape.dataItem;\n                    var connectorName = instance.options.name;\n                    var setNewTarget = function () {\n                        var shape = diagram._dataMap[dataItem.id];\n                        instance = shape.getConnector(connectorName);\n                        that[name](instance, false);\n                        that.updateModel();\n                    };\n                    if (diagram._dataMap[dataItem.id]) {\n                        setNewTarget();\n                    } else {\n                        var inactiveItem = diagram._inactiveShapeItems.getByUid(dataItem.uid);\n                        if (inactiveItem) {\n                            diagram._deferredConnectionUpdates.push(inactiveItem.onActivate(setNewTarget));\n                        }\n                    }\n                } else {\n                    that[name](instance, false);\n                }\n            },\n            content: function (content) {\n                var result = this._content(content);\n                if (defined(content)) {\n                    this._alignContent();\n                }\n                return result;\n            },\n            _createContentVisual: function (options) {\n                var visual;\n                if (isFunction(options.visual)) {\n                    visual = options.visual.call(this, options);\n                } else if (options.text) {\n                    visual = new TextBlock(options);\n                }\n                if (visual) {\n                    this._contentVisual = visual;\n                    visual._includeInBBox = false;\n                    this.visual.append(visual);\n                }\n                return visual;\n            },\n            _updateContentVisual: function (options) {\n                if (isFunction(options.visual)) {\n                    this.visual.remove(this._contentVisual);\n                    this._createContentVisual(options);\n                } else {\n                    this._contentVisual.redraw(options);\n                }\n            },\n            _alignContent: function () {\n                if (this._contentVisual) {\n                    var offset = CONNECTION_CONTENT_OFFSET;\n                    var points = this.allPoints();\n                    var endIdx = math.floor(points.length / 2);\n                    var startIdx = endIdx - 1;\n                    while (startIdx > 0 && points[startIdx].equals(points[endIdx])) {\n                        startIdx--;\n                        endIdx++;\n                    }\n                    var endPoint = points[endIdx];\n                    var startPoint = points[startIdx];\n                    var boundingBox = this._contentVisual._measure();\n                    var width = boundingBox.width;\n                    var height = boundingBox.height;\n                    var alignToPath = points.length % 2 === 0;\n                    var distance = startPoint.distanceTo(endPoint);\n                    if (alignToPath && points.length > 2 && distance > 0 && (startPoint.y === endPoint.y && distance < width || startPoint.x === endPoint.x && distance < height)) {\n                        alignToPath = false;\n                        offset = 0;\n                    }\n                    var point;\n                    if (alignToPath) {\n                        var angle = kendo.util.deg(math.atan2(endPoint.y - startPoint.y, endPoint.x - startPoint.x));\n                        point = new Point((endPoint.x - startPoint.x) / 2 + startPoint.x, (endPoint.y - startPoint.y) / 2 + startPoint.y);\n                        if (math.abs(angle) === 90) {\n                            point.x += offset;\n                            point.y -= height / 2;\n                        } else if (angle % 180 === 0) {\n                            point.x -= width / 2;\n                            point.y -= height + offset;\n                        } else if (angle < -90 || 0 < angle && angle < 90) {\n                            point.y -= height;\n                        } else if (angle < 0 || angle > 90) {\n                            point.x -= width;\n                            point.y -= height;\n                        }\n                    } else {\n                        var midIdx = math.floor(points.length / 2);\n                        point = points[midIdx].clone();\n                        startPoint = points[midIdx - 1];\n                        endPoint = points[midIdx + 1];\n                        var offsetX = startPoint.x <= point.x && endPoint.x <= point.x ? offset : -boundingBox.width - offset;\n                        var offsetY = startPoint.y <= point.y && endPoint.y <= point.y ? offset : -boundingBox.height - offset;\n                        point.x += offsetX;\n                        point.y += offsetY;\n                    }\n                    this._contentVisual.position(point);\n                }\n            },\n            select: function (value) {\n                var diagram = this.diagram, selected, deselected;\n                if (this._canSelect()) {\n                    if (this.isSelected !== value) {\n                        this.isSelected = value;\n                        selected = [];\n                        deselected = [];\n                        if (this.isSelected) {\n                            this.adorner = new ConnectionEditAdorner(this, this.options.selection);\n                            diagram._adorn(this.adorner, true);\n                            diagram._selectedItems.push(this);\n                            selected.push(this);\n                        } else {\n                            if (this.adorner) {\n                                diagram._adorn(this.adorner, false);\n                                Utils.remove(diagram._selectedItems, this);\n                                this.adorner = undefined;\n                                deselected.push(this);\n                            }\n                        }\n                        if (this.adorner) {\n                            this.adorner.refresh();\n                        }\n                        if (!diagram._internalSelection) {\n                            diagram._selectionChanged(selected, deselected);\n                        }\n                        return true;\n                    }\n                }\n            },\n            bounds: function (value) {\n                if (value && !isString(value)) {\n                    this._bounds = value;\n                } else {\n                    return this._bounds;\n                }\n            },\n            type: function (value) {\n                var options = this.options;\n                if (value) {\n                    if (value !== options.type) {\n                        options.type = value;\n                        this._initRouter();\n                        this.refresh();\n                    }\n                } else {\n                    return options.type;\n                }\n            },\n            _initRouter: function () {\n                var type = (this.options.type || '').toLowerCase();\n                if (type == CASCADING) {\n                    this._router = new CascadingRouter(this);\n                } else {\n                    this._router = new PolylineRouter(this);\n                }\n            },\n            points: function (value) {\n                if (value) {\n                    this.definers = [];\n                    for (var i = 0; i < value.length; i++) {\n                        var definition = value[i];\n                        if (definition instanceof diagram.Point) {\n                            this.definers.push(new diagram.PathDefiner(definition));\n                        } else if (definition.hasOwnProperty('x') && definition.hasOwnProperty('y')) {\n                            this.definers.push(new diagram.PathDefiner(new Point(definition.x, definition.y)));\n                        } else {\n                            throw 'A Connection point needs to be a Point or an object with x and y properties.';\n                        }\n                    }\n                } else {\n                    var pts = [];\n                    if (isDefined(this.definers)) {\n                        for (var k = 0; k < this.definers.length; k++) {\n                            pts.push(this.definers[k].point);\n                        }\n                    }\n                    return pts;\n                }\n            },\n            allPoints: function () {\n                var pts = [this.sourcePoint()];\n                if (this.definers) {\n                    for (var k = 0; k < this.definers.length; k++) {\n                        pts.push(this.definers[k].point);\n                    }\n                }\n                pts.push(this.targetPoint());\n                return pts;\n            },\n            refresh: function () {\n                this._resolveConnectors();\n                this._refreshPath();\n                this._alignContent();\n                if (this.adorner) {\n                    this.adorner.refresh();\n                }\n            },\n            _resolveConnectors: function () {\n                var connection = this, sourcePoint, targetPoint, sourceConnectors, targetConnectors, source = connection.source(), target = connection.target();\n                if (source instanceof Point) {\n                    sourcePoint = source;\n                } else if (source instanceof Connector) {\n                    if (isAutoConnector(source)) {\n                        sourceConnectors = source.shape.connectors;\n                    } else {\n                        sourceConnectors = [source];\n                    }\n                }\n                if (target instanceof Point) {\n                    targetPoint = target;\n                } else if (target instanceof Connector) {\n                    if (isAutoConnector(target)) {\n                        targetConnectors = target.shape.connectors;\n                    } else {\n                        targetConnectors = [target];\n                    }\n                }\n                if (sourcePoint) {\n                    if (targetConnectors) {\n                        connection._resolvedTargetConnector = closestConnector(sourcePoint, targetConnectors);\n                    }\n                } else if (sourceConnectors) {\n                    if (targetPoint) {\n                        connection._resolvedSourceConnector = closestConnector(targetPoint, sourceConnectors);\n                    } else if (targetConnectors) {\n                        this._resolveAutoConnectors(sourceConnectors, targetConnectors);\n                    }\n                }\n            },\n            _resolveAutoConnectors: function (sourceConnectors, targetConnectors) {\n                var minNonConflict = MAXINT;\n                var minDist = MAXINT;\n                var minNonConflictSource, minNonConflictTarget;\n                var sourcePoint, targetPoint;\n                var minSource, minTarget;\n                var sourceConnector, targetConnector;\n                var sourceIdx, targetIdx;\n                var dist;\n                for (sourceIdx = 0; sourceIdx < sourceConnectors.length; sourceIdx++) {\n                    sourceConnector = sourceConnectors[sourceIdx];\n                    if (!isAutoConnector(sourceConnector)) {\n                        sourcePoint = sourceConnector.position();\n                        for (targetIdx = 0; targetIdx < targetConnectors.length; targetIdx++) {\n                            targetConnector = targetConnectors[targetIdx];\n                            if (!isAutoConnector(targetConnector)) {\n                                targetPoint = targetConnector.position();\n                                dist = math.round(sourcePoint.distanceTo(targetPoint));\n                                if (dist < minNonConflict && this.diagram && this._testRoutePoints(sourcePoint, targetPoint, sourceConnector, targetConnector)) {\n                                    minNonConflict = dist;\n                                    minNonConflictSource = sourceConnector;\n                                    minNonConflictTarget = targetConnector;\n                                }\n                                if (dist < minDist) {\n                                    minSource = sourceConnector;\n                                    minTarget = targetConnector;\n                                    minDist = dist;\n                                }\n                            }\n                        }\n                    }\n                }\n                if (minNonConflictSource) {\n                    minSource = minNonConflictSource;\n                    minTarget = minNonConflictTarget;\n                }\n                this._resolvedSourceConnector = minSource;\n                this._resolvedTargetConnector = minTarget;\n            },\n            _testRoutePoints: function (sourcePoint, targetPoint, sourceConnector, targetConnector) {\n                var router = this._router;\n                var passRoute = true;\n                if (router instanceof CascadingRouter) {\n                    var points = router.routePoints(sourcePoint, targetPoint, sourceConnector, targetConnector), start, end, rect;\n                    points.unshift(sourcePoint);\n                    points.push(targetPoint);\n                    for (var idx = 1; idx < points.length; idx++) {\n                        start = points[idx - 1];\n                        end = points[idx];\n                        rect = new Rect(math.min(start.x, end.x), math.min(start.y, end.y), math.abs(start.x - end.x), math.abs(start.y - end.y));\n                        if (rect.width > 0) {\n                            rect.x++;\n                            rect.width -= 2;\n                        }\n                        if (rect.height > 0) {\n                            rect.y++;\n                            rect.height -= 2;\n                        }\n                        if (!rect.isEmpty() && this.diagram._shapesQuadTree.hitTestRect(rect)) {\n                            passRoute = false;\n                            break;\n                        }\n                    }\n                }\n                return passRoute;\n            },\n            redraw: function (options) {\n                if (options) {\n                    this.options = deepExtend({}, this.options, options);\n                    var points = this.options.points;\n                    if (defined(points) && points.length > 0) {\n                        this.points(points);\n                        this._refreshPath();\n                    }\n                    if (options && options.content || options.text) {\n                        this.content(options.content);\n                    }\n                    this.path.redraw({\n                        fill: options.fill,\n                        stroke: options.stroke,\n                        startCap: options.startCap,\n                        endCap: options.endCap\n                    });\n                }\n            },\n            clone: function () {\n                var json = this.serialize();\n                if (this.diagram && this.diagram._isEditable && defined(this.dataItem)) {\n                    json.options.dataItem = cloneDataItem(this.dataItem);\n                }\n                return new Connection(this.from, this.to, json.options);\n            },\n            serialize: function () {\n                var from = this.from.toJSON ? this.from.toJSON : this.from.toString(), to = this.to.toJSON ? this.to.toJSON : this.to.toString();\n                var json = deepExtend({}, {\n                    options: this.options,\n                    from: from,\n                    to: to\n                });\n                if (defined(this.dataItem)) {\n                    json.dataItem = this.dataItem.toString();\n                }\n                json.options.points = this.points();\n                return json;\n            },\n            _hitTest: function (value) {\n                if (this.visible()) {\n                    var p = new Point(value.x, value.y), from = this.sourcePoint(), to = this.targetPoint();\n                    if (value.isEmpty && !value.isEmpty() && value.contains(from) && value.contains(to)) {\n                        return this;\n                    }\n                    if (this._router.hitTest(p)) {\n                        return this;\n                    }\n                }\n            },\n            _hover: function (value) {\n                var color = (this.options.stroke || {}).color;\n                if (value && isDefined(this.options.hover.stroke.color)) {\n                    color = this.options.hover.stroke.color;\n                }\n                this.path.redraw({ stroke: { color: color } });\n            },\n            _refreshPath: function () {\n                if (!defined(this.path)) {\n                    return;\n                }\n                this._drawPath();\n                this.bounds(this._router.getBounds());\n            },\n            _drawPath: function () {\n                if (this._router) {\n                    this._router.route();\n                }\n                var source = this.sourcePoint();\n                var target = this.targetPoint();\n                var points = this.points();\n                this.path.redraw({ points: [source].concat(points, [target]) });\n            },\n            _clearSourceConnector: function () {\n                this.sourceConnector = undefined;\n                this._resolvedSourceConnector = undefined;\n            },\n            _clearTargetConnector: function () {\n                this.targetConnector = undefined;\n                this._resolvedTargetConnector = undefined;\n            },\n            _removeFromSourceConnector: function () {\n                if (this.sourceConnector) {\n                    Utils.remove(this.sourceConnector.connections, this);\n                }\n            },\n            _removeFromTargetConnector: function () {\n                if (this.targetConnector) {\n                    Utils.remove(this.targetConnector.connections, this);\n                }\n            },\n            toJSON: function () {\n                var connection = this;\n                var from, to, point;\n                if (connection.from && connection.from.toJSON) {\n                    from = connection.from.toJSON();\n                } else {\n                    point = connection._sourcePoint;\n                    from = {\n                        x: point.x,\n                        y: point.y\n                    };\n                }\n                if (connection.to && connection.to.toJSON) {\n                    to = connection.to.toJSON();\n                } else {\n                    point = connection._targetPoint;\n                    to = {\n                        x: point.x,\n                        y: point.y\n                    };\n                }\n                return {\n                    from: from,\n                    to: to\n                };\n            }\n        });\n        var Diagram = Widget.extend({\n            init: function (element, userOptions) {\n                var that = this;\n                kendo.destroy(element);\n                Widget.fn.init.call(that, element, userOptions);\n                that._initTheme();\n                that._initElements();\n                that._extendLayoutOptions(that.options);\n                that._initDefaults(userOptions);\n                that._interactionDefaults();\n                that._initCanvas();\n                that.mainLayer = new Group({ id: 'main-layer' });\n                that.canvas.append(that.mainLayer);\n                that._shapesQuadTree = new ShapesQuadTree(that);\n                that._pan = new Point();\n                that._adorners = [];\n                that.adornerLayer = new Group({ id: 'adorner-layer' });\n                that.canvas.append(that.adornerLayer);\n                that._createHandlers();\n                that._initialize();\n                that._resizingAdorner = new ResizingAdorner(that, { editable: that.options.editable });\n                that._connectorsAdorner = new ConnectorsAdorner(that);\n                that._adorn(that._resizingAdorner, true);\n                that._adorn(that._connectorsAdorner, true);\n                that.selector = new Selector(that);\n                that._clipboard = [];\n                that.pauseMouseHandlers = false;\n                that._fetchFreshData();\n                that._createGlobalToolBar();\n                that._createOptionElements();\n                that.zoom(that.options.zoom);\n                that.canvas.draw();\n            },\n            options: {\n                name: 'Diagram',\n                theme: 'default',\n                layout: '',\n                zoomRate: 0.1,\n                zoom: 1,\n                zoomMin: 0,\n                zoomMax: 2,\n                dataSource: {},\n                draggable: true,\n                template: '',\n                autoBind: true,\n                editable: {\n                    rotate: {},\n                    resize: {},\n                    text: true,\n                    tools: [],\n                    drag: {\n                        snap: {\n                            size: 10,\n                            angle: 10\n                        }\n                    },\n                    remove: true\n                },\n                pannable: {},\n                selectable: { key: 'none' },\n                tooltip: {\n                    enabled: true,\n                    format: '{0}'\n                },\n                copy: {\n                    enabled: true,\n                    offsetX: 20,\n                    offsetY: 20\n                },\n                shapeDefaults: diagram.shapeDefaults({ undoable: true }),\n                connectionDefaults: {\n                    editable: { tools: [] },\n                    type: CASCADING\n                },\n                shapes: [],\n                connections: []\n            },\n            events: [\n                ZOOM_END,\n                ZOOM_START,\n                PAN,\n                SELECT,\n                ITEMROTATE,\n                ITEMBOUNDSCHANGE,\n                CHANGE,\n                CLICK,\n                MOUSE_ENTER,\n                MOUSE_LEAVE,\n                'toolBarClick',\n                'save',\n                'cancel',\n                'edit',\n                'remove',\n                'add',\n                'dataBound',\n                DRAG_START,\n                DRAG,\n                DRAG_END\n            ],\n            items: function () {\n                return $();\n            },\n            _createGlobalToolBar: function () {\n                var editable = this.options.editable;\n                if (editable) {\n                    var tools = editable.tools;\n                    if (this._isEditable && tools !== false && (!tools || tools.length === 0)) {\n                        tools = [\n                            'createShape',\n                            'undo',\n                            'redo',\n                            'rotateClockwise',\n                            'rotateAnticlockwise'\n                        ];\n                    }\n                    if (tools && tools.length) {\n                        this.toolBar = new DiagramToolBar(this, {\n                            tools: tools || {},\n                            click: proxy(this._toolBarClick, this),\n                            modal: false\n                        });\n                        this.toolBar.element.css({ textAlign: 'left' });\n                        this.element.prepend(this.toolBar.element);\n                        this._resize();\n                    }\n                }\n            },\n            createShape: function () {\n                if (this.editor && this.editor.end() || !this.editor) {\n                    var dataSource = this.dataSource;\n                    var view = dataSource.view() || [];\n                    var index = view.length;\n                    var model = createModel(dataSource, {});\n                    var shape = this._createShape(model, {});\n                    if (!this.trigger('add', { shape: shape })) {\n                        dataSource.insert(index, model);\n                        var inactiveItem = this._inactiveShapeItems.getByUid(model.uid);\n                        inactiveItem.element = shape;\n                        this.edit(shape);\n                    }\n                }\n            },\n            _createShape: function (dataItem, options) {\n                options = deepExtend({}, this.options.shapeDefaults, options);\n                options.dataItem = dataItem;\n                var shape = new Shape(options, this);\n                return shape;\n            },\n            createConnection: function () {\n                if (this.editor && this.editor.end() || !this.editor) {\n                    var connectionsDataSource = this.connectionsDataSource;\n                    var view = connectionsDataSource.view() || [];\n                    var index = view.length;\n                    var model = createModel(connectionsDataSource, {});\n                    var connection = this._createConnection(model);\n                    if (!this.trigger('add', { connection: connection })) {\n                        this._connectionsDataMap[model.uid] = connection;\n                        connectionsDataSource.insert(index, model);\n                        this.addConnection(connection, false);\n                        this.edit(connection);\n                    }\n                }\n            },\n            _createConnection: function (dataItem, source, target) {\n                var options = deepExtend({}, this.options.connectionDefaults);\n                options.dataItem = dataItem;\n                var connection = new Connection(source || new Point(), target || new Point(), options);\n                return connection;\n            },\n            editModel: function (dataItem, editorType) {\n                this.cancelEdit();\n                var editors, template;\n                var editable = this.options.editable;\n                if (editorType == 'shape') {\n                    editors = editable.shapeEditors;\n                    template = editable.shapeTemplate;\n                } else if (editorType == 'connection') {\n                    var connectionSelectorHandler = proxy(connectionSelector, this);\n                    editors = deepExtend({}, {\n                        from: connectionSelectorHandler,\n                        to: connectionSelectorHandler\n                    }, editable.connectionEditors);\n                    template = editable.connectionTemplate;\n                } else {\n                    return;\n                }\n                this.editor = new PopupEditor(this.element, {\n                    update: proxy(this._update, this),\n                    cancel: proxy(this._cancel, this),\n                    model: dataItem,\n                    type: editorType,\n                    target: this,\n                    editors: editors,\n                    template: template\n                });\n                this.trigger('edit', this._editArgs());\n            },\n            edit: function (item) {\n                if (item.dataItem) {\n                    var editorType = item instanceof Shape ? 'shape' : 'connection';\n                    this.editModel(item.dataItem, editorType);\n                }\n            },\n            cancelEdit: function () {\n                if (this.editor) {\n                    this._getEditDataSource().cancelChanges(this.editor.model);\n                    this._destroyEditor();\n                }\n            },\n            saveEdit: function () {\n                if (this.editor && this.editor.end() && !this.trigger('save', this._editArgs())) {\n                    this._getEditDataSource().sync();\n                }\n            },\n            _update: function () {\n                if (this.editor && this.editor.end() && !this.trigger('save', this._editArgs())) {\n                    this._getEditDataSource().sync();\n                    this._destroyEditor();\n                }\n            },\n            _cancel: function () {\n                if (this.editor && !this.trigger('cancel', this._editArgs())) {\n                    var model = this.editor.model;\n                    this._getEditDataSource().cancelChanges(model);\n                    var element = this._connectionsDataMap[model.uid] || this._dataMap[model.id];\n                    if (element) {\n                        element._setOptionsFromModel(model);\n                    }\n                    this._destroyEditor();\n                }\n            },\n            _getEditDataSource: function () {\n                return this.editor.options.type === 'shape' ? this.dataSource : this.connectionsDataSource;\n            },\n            _editArgs: function () {\n                var result = { container: this.editor.wrapper };\n                result[this.editor.options.type] = this.editor.model;\n                return result;\n            },\n            _destroyEditor: function () {\n                if (this.editor) {\n                    this.editor.close();\n                    this.editor = null;\n                }\n            },\n            _initElements: function () {\n                this.wrapper = this.element.empty().css('position', 'relative').attr('tabindex', 0).addClass('k-widget k-diagram');\n                this.scrollable = $('<div />').appendTo(this.element);\n            },\n            _initDefaults: function (userOptions) {\n                var options = this.options;\n                var editable = options.editable;\n                var shapeDefaults = options.shapeDefaults;\n                var connectionDefaults = options.connectionDefaults;\n                var userShapeDefaults = (userOptions || {}).shapeDefaults;\n                if (editable === false) {\n                    shapeDefaults.editable = false;\n                    connectionDefaults.editable = false;\n                } else {\n                    copyDefaultOptions(editable, shapeDefaults.editable, [\n                        'drag',\n                        'remove',\n                        'connect'\n                    ]);\n                    copyDefaultOptions(editable, connectionDefaults.editable, [\n                        'drag',\n                        'remove'\n                    ]);\n                }\n                if (userShapeDefaults && userShapeDefaults.connectors) {\n                    options.shapeDefaults.connectors = userShapeDefaults.connectors;\n                }\n            },\n            _interactionDefaults: function () {\n                var options = this.options;\n                var selectable = options.selectable;\n                var pannable = options.pannable;\n                var mobile = kendo.support.mobileOS;\n                if (selectable && !defined(selectable.multiple)) {\n                    options.selectable = deepExtend({ multiple: mobile ? false : true }, options.selectable);\n                }\n                if (pannable && !defined(pannable.key)) {\n                    options.pannable = deepExtend({ key: mobile ? 'none' : 'ctrl' }, options.pannable);\n                }\n            },\n            _initCanvas: function () {\n                var canvasContainer = $('<div class=\\'k-layer\\'></div>').appendTo(this.scrollable)[0];\n                var viewPort = this.viewport();\n                this.canvas = new Canvas(canvasContainer, {\n                    width: viewPort.width || DEFAULT_CANVAS_WIDTH,\n                    height: viewPort.height || DEFAULT_CANVAS_HEIGHT\n                });\n            },\n            _createHandlers: function () {\n                var that = this;\n                var element = that.element;\n                element.on(MOUSEWHEEL_NS, proxy(that._wheel, that)).on('keydown' + NS, proxy(that._keydown, that));\n                that._userEvents = new kendo.UserEvents(this.scrollable, {\n                    multiTouch: true,\n                    fastTap: true,\n                    tap: proxy(that._tap, that),\n                    start: proxy(that._dragStart, that),\n                    move: proxy(that._drag, that),\n                    end: proxy(that._dragEnd, that),\n                    gesturestart: proxy(that._gestureStart, that),\n                    gesturechange: proxy(that._gestureChange, that),\n                    gestureend: proxy(that._gestureEnd, that)\n                });\n                that.toolService = new ToolService(that);\n                this.scrollable.on('mouseover' + NS, proxy(that._mouseover, that)).on('mouseout' + NS, proxy(that._mouseout, that)).on('mousemove' + NS, proxy(that._mouseMove, that));\n                this._syncHandler = proxy(that._syncChanges, that);\n                that._resizeHandler = proxy(that.resize, that, false);\n                kendo.onResize(that._resizeHandler);\n                this.bind(ZOOM_START, proxy(that._destroyToolBar, that));\n                this.bind(PAN, proxy(that._destroyToolBar, that));\n            },\n            _dragStart: function (e) {\n                this._pauseMouseHandlers = true;\n                var point = this._eventPositions(e, true);\n                var event = e.event;\n                if (this.toolService.start(point, this._meta(event))) {\n                    this._destroyToolBar();\n                    event.preventDefault();\n                }\n            },\n            _drag: function (e) {\n                var p = this._eventPositions(e);\n                var event = e.event;\n                if (this.toolService.move(p, this._meta(event))) {\n                    event.preventDefault();\n                }\n            },\n            _dragEnd: function (e) {\n                this._pauseMouseHandlers = false;\n                var p = this._eventPositions(e);\n                var event = e.event;\n                if (this.toolService.end(p, this._meta(event))) {\n                    this._createToolBar();\n                    event.preventDefault();\n                }\n            },\n            _mouseMove: function (e) {\n                if (!this._pauseMouseHandlers && (e.which === 0 || e.which === 1)) {\n                    var p = this._eventPositions(e);\n                    this.toolService._updateHoveredItem(p);\n                    this.toolService._updateCursor(p);\n                }\n            },\n            _tap: function (e) {\n                var toolService = this.toolService;\n                var selectable = this.options.selectable;\n                var point = this._eventPositions(e);\n                var focused = this.focus();\n                toolService._updateHoveredItem(point);\n                if (toolService.hoveredItem) {\n                    var item = toolService.hoveredItem;\n                    this.trigger('click', {\n                        item: item,\n                        point: point\n                    });\n                    if (selectable && item.options.selectable !== false) {\n                        var multiple = selectable.multiple !== false;\n                        var ctrlPressed = kendo.support.mobileOS || this._meta(e.event).ctrlKey;\n                        if (item.isSelected) {\n                            if (ctrlPressed) {\n                                this._destroyToolBar();\n                                item.select(false);\n                            } else {\n                                this._createToolBar(focused);\n                            }\n                        } else {\n                            this._destroyToolBar();\n                            this.select(item, { addToSelection: multiple && ctrlPressed });\n                            this._createToolBar(focused);\n                        }\n                    }\n                } else if (selectable) {\n                    this._destroyToolBar();\n                    this.deselect();\n                }\n            },\n            _keydown: function (e) {\n                if (this.toolService.keyDown(e.keyCode, this._meta(e))) {\n                    e.preventDefault();\n                }\n            },\n            _wheel: function (e) {\n                var delta = mwDelta(e), p = this._eventPositions(e), meta = deepExtend(this._meta(e), { delta: delta });\n                if (this.toolService.wheel(p, meta)) {\n                    e.preventDefault();\n                }\n            },\n            _meta: function (e) {\n                return {\n                    ctrlKey: e.ctrlKey,\n                    metaKey: e.metaKey,\n                    altKey: e.altKey,\n                    shiftKey: e.shiftKey\n                };\n            },\n            _eventPositions: function (e, start) {\n                var point;\n                if (e.touch) {\n                    var field = start ? 'startLocation' : 'location';\n                    point = new Point(e.x[field], e.y[field]);\n                } else {\n                    point = new Point(e.pageX, e.pageY);\n                }\n                return this.documentToModel(point);\n            },\n            _gestureStart: function (e) {\n                this._destroyToolBar();\n                this.scroller.disable();\n                var initialCenter = this.documentToModel(new Point(e.center.x, e.center.y));\n                var eventArgs = {\n                    point: initialCenter,\n                    zoom: this.zoom()\n                };\n                if (this.trigger(ZOOM_START, eventArgs)) {\n                    return;\n                }\n                this._gesture = e;\n                this._initialCenter = initialCenter;\n            },\n            _gestureChange: function (e) {\n                var previousGesture = this._gesture;\n                var initialCenter = this._initialCenter;\n                var center = this.documentToView(new Point(e.center.x, e.center.y));\n                var scaleDelta = e.distance / previousGesture.distance;\n                var zoom = this._zoom;\n                var updateZoom = false;\n                if (math.abs(scaleDelta - 1) >= MOBILE_ZOOM_RATE) {\n                    this._zoom = zoom = this._getValidZoom(zoom * scaleDelta);\n                    this.options.zoom = zoom;\n                    this._gesture = e;\n                    updateZoom = true;\n                }\n                var zoomedPoint = initialCenter.times(zoom);\n                var pan = center.minus(zoomedPoint);\n                if (updateZoom || this._pan.distanceTo(pan) >= MOBILE_PAN_DISTANCE) {\n                    this._panTransform(pan);\n                    this._updateAdorners();\n                }\n                e.preventDefault();\n            },\n            _gestureEnd: function () {\n                if (this.options.pannable !== false) {\n                    this.scroller.enable();\n                }\n                this.trigger(ZOOM_END, {\n                    point: this._initialCenter,\n                    zoom: this.zoom()\n                });\n            },\n            _resize: function () {\n                var viewport = this.viewport();\n                if (this.canvas) {\n                    this.canvas.size(viewport);\n                }\n                if (this.scrollable && this.toolBar) {\n                    this.scrollable.height(viewport.height);\n                }\n            },\n            _mouseover: function (e) {\n                var node = e.target._kendoNode;\n                if (node && node.srcElement._hover) {\n                    node.srcElement._hover(true, node.srcElement);\n                }\n            },\n            _mouseout: function (e) {\n                var node = e.target._kendoNode;\n                if (node && node.srcElement._hover) {\n                    node.srcElement._hover(false, node.srcElement);\n                }\n            },\n            _initTheme: function () {\n                var that = this, themes = dataviz.ui.themes || {}, themeName = ((that.options || {}).theme || '').toLowerCase(), themeOptions = (themes[themeName] || {}).diagram;\n                that.options = deepExtend({}, themeOptions, that.options);\n                if (that.options.editable === true) {\n                    deepExtend(that.options, { editable: (themeOptions || {}).editable });\n                }\n            },\n            _createOptionElements: function () {\n                var options = this.options;\n                var shapesLength = options.shapes.length;\n                if (shapesLength) {\n                    this._createShapes();\n                }\n                if (options.connections.length) {\n                    this._createConnections();\n                }\n                if (shapesLength && options.layout) {\n                    this.layout(options.layout);\n                }\n            },\n            _createShapes: function () {\n                var that = this, options = that.options, shapes = options.shapes, shape, i;\n                for (i = 0; i < shapes.length; i++) {\n                    shape = shapes[i];\n                    that.addShape(shape);\n                }\n            },\n            _createConnections: function () {\n                var diagram = this, options = diagram.options, defaults = options.connectionDefaults, connections = options.connections, conn, source, target, i;\n                for (i = 0; i < connections.length; i++) {\n                    conn = connections[i];\n                    source = diagram._findConnectionTarget(conn.from);\n                    target = diagram._findConnectionTarget(conn.to);\n                    diagram.connect(source, target, deepExtend({}, defaults, conn));\n                }\n            },\n            _findConnectionTarget: function (options) {\n                options = options || {};\n                var diagram = this;\n                var shapeId = isString(options) ? options : options.shapeId || options.id;\n                var target;\n                if (shapeId) {\n                    target = diagram.getShapeById(shapeId);\n                    if (options.connector) {\n                        target = target.getConnector(options.connector);\n                    }\n                } else {\n                    target = new Point(options.x || 0, options.y || 0);\n                }\n                return target;\n            },\n            destroy: function () {\n                var that = this;\n                Widget.fn.destroy.call(that);\n                if (this._userEvents) {\n                    this._userEvents.destroy();\n                }\n                kendo.unbindResize(that._resizeHandler);\n                that.clear();\n                that.element.off(NS);\n                that.scroller.wrapper.off(NS);\n                that.canvas.destroy(true);\n                that.canvas = undefined;\n                that._destroyEditor();\n                that.destroyScroller();\n                that._destroyGlobalToolBar();\n                that._destroyToolBar();\n            },\n            destroyScroller: function () {\n                var scroller = this.scroller;\n                if (!scroller) {\n                    return;\n                }\n                scroller.destroy();\n                scroller.element.remove();\n                this.scroller = null;\n            },\n            save: function () {\n                var json = {\n                    shapes: [],\n                    connections: []\n                };\n                var i, connection, shape;\n                for (i = 0; i < this.shapes.length; i++) {\n                    shape = this.shapes[i];\n                    if (shape.options.serializable) {\n                        json.shapes.push(shape.options);\n                    }\n                }\n                for (i = 0; i < this.connections.length; i++) {\n                    connection = this.connections[i];\n                    json.connections.push(deepExtend({}, connection.options, connection.toJSON()));\n                }\n                return json;\n            },\n            focus: function () {\n                if (!this.element.is(kendo._activeElement())) {\n                    var element = this.element, scrollContainer = element[0], containers = [], offsets = [], documentElement = document.documentElement, i;\n                    do {\n                        scrollContainer = scrollContainer.parentNode;\n                        if (scrollContainer.scrollHeight > scrollContainer.clientHeight) {\n                            containers.push(scrollContainer);\n                            offsets.push(scrollContainer.scrollTop);\n                        }\n                    } while (scrollContainer != documentElement);\n                    element.focus();\n                    for (i = 0; i < containers.length; i++) {\n                        containers[i].scrollTop = offsets[i];\n                    }\n                    return true;\n                }\n            },\n            load: function (options) {\n                this.clear();\n                this.setOptions(options);\n                this._createShapes();\n                this._createConnections();\n            },\n            setOptions: function (options) {\n                deepExtend(this.options, options);\n            },\n            clear: function () {\n                var that = this;\n                that.select(false);\n                that.mainLayer.clear();\n                that._shapesQuadTree.clear();\n                that._initialize();\n            },\n            connect: function (source, target, options) {\n                var connection;\n                if (this.connectionsDataSource && this._isEditable) {\n                    var dataItem = this.connectionsDataSource.add({});\n                    connection = this._connectionsDataMap[dataItem.uid];\n                    connection.source(source);\n                    connection.target(target);\n                    connection.redraw(options);\n                    connection.updateModel();\n                } else {\n                    connection = new Connection(source, target, deepExtend({}, this.options.connectionDefaults, options));\n                    this.addConnection(connection);\n                }\n                return connection;\n            },\n            connected: function (source, target) {\n                for (var i = 0; i < this.connections.length; i++) {\n                    var c = this.connections[i];\n                    if (c.from == source && c.to == target) {\n                        return true;\n                    }\n                }\n                return false;\n            },\n            addConnection: function (connection, undoable) {\n                if (undoable !== false) {\n                    this.undoRedoService.add(new diagram.AddConnectionUnit(connection, this), false);\n                }\n                connection.diagram = this;\n                connection._setOptionsFromModel();\n                connection.refresh();\n                this.mainLayer.append(connection.visual);\n                this.connections.push(connection);\n                this.trigger(CHANGE, {\n                    added: [connection],\n                    removed: []\n                });\n                return connection;\n            },\n            _addConnection: function (connection, undoable) {\n                var connectionsDataSource = this.connectionsDataSource;\n                var dataItem;\n                if (connectionsDataSource && this._isEditable) {\n                    dataItem = createModel(connectionsDataSource, cloneDataItem(connection.dataItem));\n                    connection.dataItem = dataItem;\n                    connection.updateModel();\n                    if (!this.trigger('add', { connection: connection })) {\n                        this._connectionsDataMap[dataItem.uid] = connection;\n                        connectionsDataSource.add(dataItem);\n                        this.addConnection(connection, undoable);\n                        connection._updateConnectors();\n                        return connection;\n                    }\n                } else if (!this.trigger('add', { connection: connection })) {\n                    this.addConnection(connection, undoable);\n                    connection._updateConnectors();\n                    return connection;\n                }\n            },\n            addShape: function (item, undoable) {\n                var shape, shapeDefaults = this.options.shapeDefaults;\n                if (item instanceof Shape) {\n                    shape = item;\n                } else if (!(item instanceof kendo.Class)) {\n                    shapeDefaults = deepExtend({}, shapeDefaults, item || {});\n                    shape = new Shape(shapeDefaults, this);\n                } else {\n                    return;\n                }\n                if (undoable !== false) {\n                    this.undoRedoService.add(new diagram.AddShapeUnit(shape, this), false);\n                }\n                this.shapes.push(shape);\n                if (shape.diagram !== this) {\n                    this._shapesQuadTree.insert(shape);\n                    shape.diagram = this;\n                }\n                this.mainLayer.append(shape.visual);\n                this.trigger(CHANGE, {\n                    added: [shape],\n                    removed: []\n                });\n                return shape;\n            },\n            _addShape: function (shape, undoable) {\n                var that = this;\n                var dataSource = that.dataSource;\n                var dataItem;\n                if (dataSource && this._isEditable) {\n                    dataItem = createModel(dataSource, cloneDataItem(shape.dataItem));\n                    shape.dataItem = dataItem;\n                    shape.updateModel();\n                    if (!this.trigger('add', { shape: shape })) {\n                        this.dataSource.add(dataItem);\n                        var inactiveItem = this._inactiveShapeItems.getByUid(dataItem.uid);\n                        inactiveItem.element = shape;\n                        inactiveItem.undoable = undoable;\n                        return shape;\n                    }\n                } else if (!this.trigger('add', { shape: shape })) {\n                    return this.addShape(shape, undoable);\n                }\n            },\n            remove: function (items, undoable) {\n                items = isArray(items) ? items.slice(0) : [items];\n                var elements = splitDiagramElements(items);\n                var shapes = elements.shapes;\n                var connections = elements.connections;\n                var i;\n                if (!defined(undoable)) {\n                    undoable = true;\n                }\n                if (undoable) {\n                    this.undoRedoService.begin();\n                }\n                this._suspendModelRefresh();\n                for (i = shapes.length - 1; i >= 0; i--) {\n                    this._removeItem(shapes[i], undoable, connections);\n                }\n                for (i = connections.length - 1; i >= 0; i--) {\n                    this._removeItem(connections[i], undoable);\n                }\n                this._resumeModelRefresh();\n                if (undoable) {\n                    this.undoRedoService.commit(false);\n                }\n                this.trigger(CHANGE, {\n                    added: [],\n                    removed: items\n                });\n            },\n            _removeShapeDataItem: function (item) {\n                if (this._isEditable) {\n                    this.dataSource.remove(item.dataItem);\n                    delete this._dataMap[item.dataItem.id];\n                }\n            },\n            _removeConnectionDataItem: function (item) {\n                if (this._isEditable) {\n                    this.connectionsDataSource.remove(item.dataItem);\n                    delete this._connectionsDataMap[item.dataItem.uid];\n                }\n            },\n            _triggerRemove: function (items) {\n                var toRemove = [];\n                var item, args, editable;\n                for (var idx = 0; idx < items.length; idx++) {\n                    item = items[idx];\n                    editable = item.options.editable;\n                    if (item instanceof Shape) {\n                        args = { shape: item };\n                    } else {\n                        args = { connection: item };\n                    }\n                    if (editable && editable.remove !== false && !this.trigger('remove', args)) {\n                        toRemove.push(item);\n                    }\n                }\n                return toRemove;\n            },\n            undo: function () {\n                this.undoRedoService.undo();\n            },\n            redo: function () {\n                this.undoRedoService.redo();\n            },\n            select: function (item, options) {\n                if (isDefined(item)) {\n                    options = deepExtend({ addToSelection: false }, options);\n                    var addToSelection = options.addToSelection, items = [], selected = [], i, element;\n                    if (!addToSelection) {\n                        this.deselect();\n                    }\n                    this._internalSelection = true;\n                    if (item instanceof Array) {\n                        items = item;\n                    } else if (item instanceof DiagramElement) {\n                        items = [item];\n                    }\n                    for (i = 0; i < items.length; i++) {\n                        element = items[i];\n                        if (element.select(true)) {\n                            selected.push(element);\n                        }\n                    }\n                    this._selectionChanged(selected, []);\n                    this._internalSelection = false;\n                } else {\n                    return this._selectedItems;\n                }\n            },\n            selectAll: function () {\n                this.select(this.shapes.concat(this.connections));\n            },\n            selectArea: function (rect) {\n                var i, items, item;\n                this._internalSelection = true;\n                var selected = [];\n                if (rect instanceof Rect) {\n                    items = this.shapes.concat(this.connections);\n                    for (i = 0; i < items.length; i++) {\n                        item = items[i];\n                        if ((!rect || item._hitTest(rect)) && item.options.enable) {\n                            if (item.select(true)) {\n                                selected.push(item);\n                            }\n                        }\n                    }\n                }\n                this._selectionChanged(selected, []);\n                this._internalSelection = false;\n            },\n            deselect: function (item) {\n                this._internalSelection = true;\n                var deselected = [], items = [], element, i;\n                if (item instanceof Array) {\n                    items = item;\n                } else if (item instanceof DiagramElement) {\n                    items.push(item);\n                } else if (!isDefined(item)) {\n                    items = this._selectedItems.slice(0);\n                }\n                for (i = 0; i < items.length; i++) {\n                    element = items[i];\n                    if (element.select(false)) {\n                        deselected.push(element);\n                    }\n                }\n                this._selectionChanged([], deselected);\n                this._internalSelection = false;\n            },\n            toFront: function (items, undoable) {\n                if (!items) {\n                    items = this._selectedItems.slice();\n                }\n                var result = this._getDiagramItems(items), indices;\n                if (!defined(undoable) || undoable) {\n                    indices = indicesOfItems(this.mainLayer, result.visuals);\n                    var unit = new ToFrontUnit(this, items, indices);\n                    this.undoRedoService.add(unit);\n                } else {\n                    this.mainLayer.toFront(result.visuals);\n                    this._fixOrdering(result, true);\n                }\n            },\n            toBack: function (items, undoable) {\n                if (!items) {\n                    items = this._selectedItems.slice();\n                }\n                var result = this._getDiagramItems(items), indices;\n                if (!defined(undoable) || undoable) {\n                    indices = indicesOfItems(this.mainLayer, result.visuals);\n                    var unit = new ToBackUnit(this, items, indices);\n                    this.undoRedoService.add(unit);\n                } else {\n                    this.mainLayer.toBack(result.visuals);\n                    this._fixOrdering(result, false);\n                }\n            },\n            bringIntoView: function (item, options) {\n                var viewport = this.viewport();\n                var aligner = new diagram.RectAlign(viewport);\n                var current, rect, original, newPan;\n                if (viewport.width === 0 || viewport.height === 0) {\n                    return;\n                }\n                options = deepExtend({\n                    animate: false,\n                    align: 'center middle'\n                }, options);\n                if (options.align == 'none') {\n                    options.align = 'center middle';\n                }\n                if (item instanceof DiagramElement) {\n                    rect = item.bounds(TRANSFORMED);\n                } else if (isArray(item)) {\n                    rect = this.boundingBox(item);\n                } else if (item instanceof Rect) {\n                    rect = item.clone();\n                }\n                original = rect.clone();\n                rect.zoom(this._zoom);\n                if (rect.width > viewport.width || rect.height > viewport.height) {\n                    this._zoom = this._getValidZoom(math.min(viewport.width / original.width, viewport.height / original.height));\n                    rect = original.clone().zoom(this._zoom);\n                }\n                this._zoomMainLayer();\n                current = rect.clone();\n                aligner.align(rect, options.align);\n                newPan = rect.topLeft().minus(current.topLeft());\n                this.pan(newPan.times(-1), options.animate);\n            },\n            alignShapes: function (direction) {\n                if (isUndefined(direction)) {\n                    direction = 'Left';\n                }\n                var items = this.select(), val, item, i;\n                if (items.length === 0) {\n                    return;\n                }\n                switch (direction.toLowerCase()) {\n                case 'left':\n                case 'top':\n                    val = MAX_VALUE;\n                    break;\n                case 'right':\n                case 'bottom':\n                    val = MIN_VALUE;\n                    break;\n                }\n                for (i = 0; i < items.length; i++) {\n                    item = items[i];\n                    if (item instanceof Shape) {\n                        switch (direction.toLowerCase()) {\n                        case 'left':\n                            val = math.min(val, item.options.x);\n                            break;\n                        case 'top':\n                            val = math.min(val, item.options.y);\n                            break;\n                        case 'right':\n                            val = math.max(val, item.options.x);\n                            break;\n                        case 'bottom':\n                            val = math.max(val, item.options.y);\n                            break;\n                        }\n                    }\n                }\n                var undoStates = [];\n                var shapes = [];\n                for (i = 0; i < items.length; i++) {\n                    item = items[i];\n                    if (item instanceof Shape) {\n                        shapes.push(item);\n                        undoStates.push(item.bounds());\n                        switch (direction.toLowerCase()) {\n                        case 'left':\n                        case 'right':\n                            item.position(new Point(val, item.options.y));\n                            break;\n                        case 'top':\n                        case 'bottom':\n                            item.position(new Point(item.options.x, val));\n                            break;\n                        }\n                    }\n                }\n                var unit = new diagram.TransformUnit(shapes, undoStates);\n                this.undoRedoService.add(unit, false);\n            },\n            zoom: function (zoom, options) {\n                if (zoom) {\n                    var staticPoint = options ? options.point : new diagram.Point(0, 0);\n                    zoom = this._zoom = this._getValidZoom(zoom);\n                    if (!isUndefined(staticPoint)) {\n                        staticPoint = new diagram.Point(math.round(staticPoint.x), math.round(staticPoint.y));\n                        var zoomedPoint = staticPoint.times(zoom);\n                        var viewportVector = this.modelToView(staticPoint);\n                        var raw = viewportVector.minus(zoomedPoint);\n                        this._storePan(new diagram.Point(math.round(raw.x), math.round(raw.y)));\n                    }\n                    if (options) {\n                        options.zoom = zoom;\n                    }\n                    this._panTransform();\n                    this.canvas.surface.hideTooltip();\n                    this._updateAdorners();\n                }\n                return this._zoom;\n            },\n            _getPan: function (pan) {\n                var canvas = this.canvas;\n                if (!canvas.translate) {\n                    pan = pan.plus(this._pan);\n                }\n                return pan;\n            },\n            pan: function (pan, animate) {\n                if (pan instanceof Point) {\n                    var that = this;\n                    var scroller = that.scroller;\n                    pan = that._getPan(pan);\n                    pan = pan.times(-1);\n                    if (animate) {\n                        scroller.animatedScrollTo(pan.x, pan.y, function () {\n                            that._updateAdorners();\n                        });\n                    } else {\n                        scroller.scrollTo(pan.x, pan.y);\n                        that._updateAdorners();\n                    }\n                } else {\n                    return this._pan.times(-1);\n                }\n            },\n            viewport: function () {\n                var element = this.element;\n                var width = element.width();\n                var height = element.height();\n                if (this.toolBar) {\n                    height -= this.toolBar.element.outerHeight();\n                }\n                return new Rect(0, 0, width, height);\n            },\n            copy: function () {\n                if (this.options.copy.enabled) {\n                    this._clipboard = [];\n                    this._copyOffset = 1;\n                    for (var i = 0; i < this._selectedItems.length; i++) {\n                        var item = this._selectedItems[i];\n                        this._clipboard.push(item);\n                    }\n                }\n            },\n            cut: function () {\n                if (this.options.copy.enabled) {\n                    this._clipboard = [];\n                    this._copyOffset = 0;\n                    for (var i = 0; i < this._selectedItems.length; i++) {\n                        var item = this._selectedItems[i];\n                        this._clipboard.push(item);\n                    }\n                    this.remove(this._clipboard, true);\n                }\n            },\n            paste: function () {\n                if (this._clipboard.length > 0) {\n                    var item, copied, i;\n                    var mapping = {};\n                    var elements = splitDiagramElements(this._clipboard);\n                    var connections = elements.connections;\n                    var shapes = elements.shapes;\n                    var offset = {\n                        x: this._copyOffset * this.options.copy.offsetX,\n                        y: this._copyOffset * this.options.copy.offsetY\n                    };\n                    this.deselect();\n                    for (i = 0; i < shapes.length; i++) {\n                        item = shapes[i];\n                        copied = item.clone();\n                        mapping[item.id] = copied;\n                        copied.position(new Point(item.options.x + offset.x, item.options.y + offset.y));\n                        copied.diagram = this;\n                        copied = this._addShape(copied);\n                        if (copied) {\n                            copied.select();\n                        }\n                    }\n                    for (i = 0; i < connections.length; i++) {\n                        item = connections[i];\n                        copied = this._addConnection(item.clone());\n                        if (copied) {\n                            this._updateCopiedConnection(copied, item, 'source', mapping, offset);\n                            this._updateCopiedConnection(copied, item, 'target', mapping, offset);\n                            copied.select(true);\n                            copied.updateModel();\n                        }\n                    }\n                    this._syncChanges();\n                    this._copyOffset += 1;\n                }\n            },\n            _updateCopiedConnection: function (connection, sourceConnection, connectorName, mapping, offset) {\n                var onActivate, inactiveItem, targetShape;\n                var target = sourceConnection[connectorName]();\n                var diagram = this;\n                if (target instanceof Connector && mapping[target.shape.id]) {\n                    targetShape = mapping[target.shape.id];\n                    if (diagram.getShapeById(targetShape.id)) {\n                        connection[connectorName](targetShape.getConnector(target.options.name));\n                    } else {\n                        inactiveItem = diagram._inactiveShapeItems.getByUid(targetShape.dataItem.uid);\n                        if (inactiveItem) {\n                            onActivate = function (item) {\n                                targetShape = diagram._dataMap[item.id];\n                                connection[connectorName](targetShape.getConnector(target.options.name));\n                                connection.updateModel();\n                            };\n                            diagram._deferredConnectionUpdates.push(inactiveItem.onActivate(onActivate));\n                        }\n                    }\n                } else {\n                    connection[connectorName](new Point(sourceConnection[connectorName + 'Point']().x + offset.x, sourceConnection[connectorName + 'Point']().y + offset.y));\n                }\n            },\n            boundingBox: function (items, origin) {\n                var rect = Rect.empty(), temp, di = isDefined(items) ? this._getDiagramItems(items) : { shapes: this.shapes };\n                if (di.shapes.length > 0) {\n                    var item = di.shapes[0];\n                    rect = item.bounds(ROTATED);\n                    for (var i = 1; i < di.shapes.length; i++) {\n                        item = di.shapes[i];\n                        temp = item.bounds(ROTATED);\n                        if (origin === true) {\n                            temp.x -= item._rotationOffset.x;\n                            temp.y -= item._rotationOffset.y;\n                        }\n                        rect = rect.union(temp);\n                    }\n                }\n                return rect;\n            },\n            _containerOffset: function () {\n                var containerOffset = this.element.offset();\n                if (this.toolBar) {\n                    containerOffset.top += this.toolBar.element.outerHeight();\n                }\n                return containerOffset;\n            },\n            documentToView: function (point) {\n                var containerOffset = this._containerOffset();\n                return new Point(point.x - containerOffset.left, point.y - containerOffset.top);\n            },\n            viewToDocument: function (point) {\n                var containerOffset = this._containerOffset();\n                return new Point(point.x + containerOffset.left, point.y + containerOffset.top);\n            },\n            viewToModel: function (point) {\n                return this._transformWithMatrix(point, this._matrixInvert);\n            },\n            modelToView: function (point) {\n                return this._transformWithMatrix(point, this._matrix);\n            },\n            modelToLayer: function (point) {\n                return this._transformWithMatrix(point, this._layerMatrix);\n            },\n            layerToModel: function (point) {\n                return this._transformWithMatrix(point, this._layerMatrixInvert);\n            },\n            documentToModel: function (point) {\n                var viewPoint = this.documentToView(point);\n                if (!this.canvas.translate) {\n                    viewPoint.x = viewPoint.x + this.scroller.scrollLeft;\n                    viewPoint.y = viewPoint.y + this.scroller.scrollTop;\n                }\n                return this.viewToModel(viewPoint);\n            },\n            modelToDocument: function (point) {\n                return this.viewToDocument(this.modelToView(point));\n            },\n            _transformWithMatrix: function (point, matrix) {\n                var result = point;\n                if (point instanceof Point) {\n                    if (matrix) {\n                        result = matrix.apply(point);\n                    }\n                } else {\n                    var tl = this._transformWithMatrix(point.topLeft(), matrix), br = this._transformWithMatrix(point.bottomRight(), matrix);\n                    result = Rect.fromPoints(tl, br);\n                }\n                return result;\n            },\n            setDataSource: function (dataSource) {\n                this.options.dataSource = dataSource;\n                this._dataSource();\n                if (this.options.autoBind) {\n                    this.dataSource.fetch();\n                }\n            },\n            setConnectionsDataSource: function (dataSource) {\n                this.options.connectionsDataSource = dataSource;\n                this._connectionDataSource();\n                if (this.options.autoBind) {\n                    this.connectionsDataSource.fetch();\n                }\n            },\n            layout: function (options) {\n                this._layouting = true;\n                var type;\n                if (isUndefined(options)) {\n                    options = this.options.layout;\n                }\n                if (isUndefined(options) || isUndefined(options.type)) {\n                    type = 'Tree';\n                } else {\n                    type = options.type;\n                }\n                var l;\n                switch (type.toLowerCase()) {\n                case 'tree':\n                    l = new diagram.TreeLayout(this);\n                    break;\n                case 'layered':\n                    l = new diagram.LayeredLayout(this);\n                    break;\n                case 'forcedirected':\n                case 'force':\n                case 'spring':\n                case 'springembedder':\n                    l = new diagram.SpringLayout(this);\n                    break;\n                default:\n                    throw 'Layout algorithm \\'' + type + '\\' is not supported.';\n                }\n                var initialState = new diagram.LayoutState(this);\n                var finalState = l.layout(options);\n                if (finalState) {\n                    var unit = new diagram.LayoutUndoUnit(initialState, finalState, options ? options.animate : null);\n                    this.undoRedoService.add(unit);\n                }\n                this._layouting = false;\n                this._redrawConnections();\n            },\n            getShapeById: function (id) {\n                var found;\n                found = Utils.first(this.shapes, function (s) {\n                    return s.visual.id === id;\n                });\n                if (found) {\n                    return found;\n                }\n                found = Utils.first(this.connections, function (c) {\n                    return c.visual.id === id;\n                });\n                return found;\n            },\n            getShapeByModelId: function (id) {\n                var shape;\n                if (this._isEditable) {\n                    shape = this._dataMap[id];\n                } else {\n                    shape = Utils.first(this.shapes, function (shape) {\n                        return (shape.dataItem || {}).id === id;\n                    });\n                }\n                return shape;\n            },\n            getShapeByModelUid: function (uid) {\n                var shape;\n                if (this._isEditable) {\n                    shape = Utils.first(this.shapes, function (shape) {\n                        return (shape.dataItem || {}).uid === uid;\n                    });\n                } else {\n                    shape = this._dataMap[uid];\n                }\n                return shape;\n            },\n            getConnectionByModelId: function (id) {\n                var connection;\n                if (this.connectionsDataSource) {\n                    connection = Utils.first(this.connections, function (connection) {\n                        return (connection.dataItem || {}).id === id;\n                    });\n                }\n                return connection;\n            },\n            getConnectionByModelUid: function (uid) {\n                var connection;\n                if (this.connectionsDataSource) {\n                    connection = this._connectionsDataMap[uid];\n                }\n                return connection;\n            },\n            _extendLayoutOptions: function (options) {\n                if (options.layout) {\n                    options.layout = deepExtend(diagram.LayoutBase.fn.defaultOptions || {}, options.layout);\n                }\n            },\n            _selectionChanged: function (selected, deselected) {\n                if (selected.length || deselected.length) {\n                    this.trigger(SELECT, {\n                        selected: selected,\n                        deselected: deselected\n                    });\n                }\n            },\n            _getValidZoom: function (zoom) {\n                return math.min(math.max(zoom, this.options.zoomMin), this.options.zoomMax);\n            },\n            _panTransform: function (pos) {\n                var diagram = this, pan = pos || diagram._pan;\n                if (diagram.canvas.translate) {\n                    diagram.scroller.scrollTo(pan.x, pan.y);\n                    diagram._zoomMainLayer();\n                } else {\n                    diagram._storePan(pan);\n                    diagram._transformMainLayer();\n                }\n            },\n            _finishPan: function () {\n                this.trigger(PAN, {\n                    total: this._pan,\n                    delta: Number.NaN\n                });\n            },\n            _storePan: function (pan) {\n                this._pan = pan;\n                this._storeViewMatrix();\n            },\n            _zoomMainLayer: function () {\n                var zoom = this._zoom;\n                var transform = new CompositeTransform(0, 0, zoom, zoom);\n                transform.render(this.mainLayer);\n                this._storeLayerMatrix(transform);\n                this._storeViewMatrix();\n            },\n            _transformMainLayer: function () {\n                var pan = this._pan, zoom = this._zoom;\n                var transform = new CompositeTransform(pan.x, pan.y, zoom, zoom);\n                transform.render(this.mainLayer);\n                this._storeLayerMatrix(transform);\n                this._storeViewMatrix();\n            },\n            _storeLayerMatrix: function (canvasTransform) {\n                this._layerMatrix = canvasTransform.toMatrix();\n                this._layerMatrixInvert = canvasTransform.invert().toMatrix();\n            },\n            _storeViewMatrix: function () {\n                var pan = this._pan, zoom = this._zoom;\n                var transform = new CompositeTransform(pan.x, pan.y, zoom, zoom);\n                this._matrix = transform.toMatrix();\n                this._matrixInvert = transform.invert().toMatrix();\n            },\n            _toIndex: function (items, indices) {\n                var result = this._getDiagramItems(items);\n                this.mainLayer.toIndex(result.visuals, indices);\n                this._fixOrdering(result, false);\n            },\n            _fixOrdering: function (result, toFront) {\n                var shapePos = toFront ? this.shapes.length - 1 : 0, conPos = toFront ? this.connections.length - 1 : 0, i, item;\n                for (i = 0; i < result.shapes.length; i++) {\n                    item = result.shapes[i];\n                    Utils.remove(this.shapes, item);\n                    Utils.insert(this.shapes, item, shapePos);\n                }\n                for (i = 0; i < result.cons.length; i++) {\n                    item = result.cons[i];\n                    Utils.remove(this.connections, item);\n                    Utils.insert(this.connections, item, conPos);\n                }\n            },\n            _getDiagramItems: function (items) {\n                var i, result = {}, args = items;\n                result.visuals = [];\n                result.shapes = [];\n                result.cons = [];\n                if (!items) {\n                    args = this._selectedItems.slice();\n                } else if (!isArray(items)) {\n                    args = [items];\n                }\n                for (i = 0; i < args.length; i++) {\n                    var item = args[i];\n                    if (item instanceof Shape) {\n                        result.shapes.push(item);\n                        result.visuals.push(item.visual);\n                    } else if (item instanceof Connection) {\n                        result.cons.push(item);\n                        result.visuals.push(item.visual);\n                    }\n                }\n                return result;\n            },\n            _removeItem: function (item, undoable, removedConnections) {\n                item.select(false);\n                if (item instanceof Shape) {\n                    this._removeShapeDataItem(item);\n                    this._removeShape(item, undoable, removedConnections);\n                } else if (item instanceof Connection) {\n                    this._removeConnectionDataItem(item);\n                    this._removeConnection(item, undoable);\n                }\n                this.mainLayer.remove(item.visual);\n            },\n            _removeShape: function (shape, undoable, removedConnections) {\n                var i, connection, connector, sources = [], targets = [];\n                this.toolService._removeHover();\n                if (undoable) {\n                    this.undoRedoService.addCompositeItem(new DeleteShapeUnit(shape));\n                }\n                Utils.remove(this.shapes, shape);\n                this._shapesQuadTree.remove(shape);\n                for (i = 0; i < shape.connectors.length; i++) {\n                    connector = shape.connectors[i];\n                    for (var j = 0; j < connector.connections.length; j++) {\n                        connection = connector.connections[j];\n                        if (!removedConnections || !dataviz.inArray(connection, removedConnections)) {\n                            if (connection.sourceConnector == connector) {\n                                sources.push(connection);\n                            } else if (connection.targetConnector == connector) {\n                                targets.push(connection);\n                            }\n                        }\n                    }\n                }\n                for (i = 0; i < sources.length; i++) {\n                    sources[i].source(null, undoable);\n                    sources[i].updateModel();\n                }\n                for (i = 0; i < targets.length; i++) {\n                    targets[i].target(null, undoable);\n                    targets[i].updateModel();\n                }\n            },\n            _removeConnection: function (connection, undoable) {\n                if (connection.sourceConnector) {\n                    Utils.remove(connection.sourceConnector.connections, connection);\n                }\n                if (connection.targetConnector) {\n                    Utils.remove(connection.targetConnector.connections, connection);\n                }\n                if (undoable) {\n                    this.undoRedoService.addCompositeItem(new DeleteConnectionUnit(connection));\n                }\n                Utils.remove(this.connections, connection);\n            },\n            _removeDataItems: function (items, recursive) {\n                var item, children, shape, idx;\n                items = isArray(items) ? items : [items];\n                while (items.length) {\n                    item = items.shift();\n                    shape = this._dataMap[item.uid];\n                    if (shape) {\n                        this._removeShapeConnections(shape);\n                        this._removeItem(shape, false);\n                        delete this._dataMap[item.uid];\n                        if (recursive && item.hasChildren && item.loaded()) {\n                            children = item.children.data();\n                            for (idx = 0; idx < children.length; idx++) {\n                                items.push(children[idx]);\n                            }\n                        }\n                    }\n                }\n            },\n            _removeShapeConnections: function (shape) {\n                var connections = shape.connections();\n                var idx;\n                if (connections) {\n                    for (idx = 0; idx < connections.length; idx++) {\n                        this._removeItem(connections[idx], false);\n                    }\n                }\n            },\n            _addDataItem: function (dataItem, undoable) {\n                if (!defined(dataItem)) {\n                    return;\n                }\n                var shape = this._dataMap[dataItem.id];\n                if (shape) {\n                    return shape;\n                }\n                var options = deepExtend({}, this.options.shapeDefaults);\n                options.dataItem = dataItem;\n                shape = new Shape(options, this);\n                this.addShape(shape, undoable !== false);\n                this._dataMap[dataItem.id] = shape;\n                return shape;\n            },\n            _addDataItemByUid: function (dataItem) {\n                if (!defined(dataItem)) {\n                    return;\n                }\n                var shape = this._dataMap[dataItem.uid];\n                if (shape) {\n                    return shape;\n                }\n                var options = deepExtend({}, this.options.shapeDefaults);\n                options.dataItem = dataItem;\n                shape = new Shape(options, this);\n                this.addShape(shape);\n                this._dataMap[dataItem.uid] = shape;\n                return shape;\n            },\n            _addDataItems: function (items, parent) {\n                var item, idx, shape, parentShape, connection;\n                for (idx = 0; idx < items.length; idx++) {\n                    item = items[idx];\n                    shape = this._addDataItemByUid(item);\n                    parentShape = this._addDataItemByUid(parent);\n                    if (parentShape && !this.connected(parentShape, shape)) {\n                        connection = this.connect(parentShape, shape);\n                    }\n                }\n            },\n            _refreshSource: function (e) {\n                var that = this, node = e.node, action = e.action, items = e.items, options = that.options, idx, dataBound;\n                if (e.field) {\n                    for (idx = 0; idx < items.length; idx++) {\n                        if (this._dataMap[items[idx].uid]) {\n                            this._dataMap[items[idx].uid].redrawVisual();\n                        }\n                    }\n                    return;\n                }\n                if (action == 'remove') {\n                    this._removeDataItems(e.items, true);\n                } else {\n                    if ((!action || action === 'itemloaded') && !this._bindingRoots) {\n                        this._bindingRoots = true;\n                        dataBound = true;\n                    }\n                    if (!action && !node) {\n                        that.clear();\n                    }\n                    this._addDataItems(items, node);\n                    for (idx = 0; idx < items.length; idx++) {\n                        items[idx].load();\n                    }\n                }\n                if (options.layout && (dataBound || action == 'remove' || action == 'add')) {\n                    that.layout(options.layout);\n                }\n                if (dataBound) {\n                    this.trigger('dataBound');\n                    this._bindingRoots = false;\n                }\n            },\n            _addItem: function (item) {\n                if (item instanceof Shape) {\n                    this.addShape(item);\n                } else if (item instanceof Connection) {\n                    this.addConnection(item);\n                }\n            },\n            _createToolBar: function (preventClosing) {\n                var diagram = this.toolService.diagram;\n                if (!this.singleToolBar && diagram.select().length === 1) {\n                    var element = diagram.select()[0];\n                    if (element && element.options.editable !== false) {\n                        var editable = element.options.editable;\n                        var tools = editable.tools;\n                        if (this._isEditable && tools.length === 0) {\n                            if (element instanceof Shape) {\n                                tools = [\n                                    'edit',\n                                    'rotateClockwise',\n                                    'rotateAnticlockwise'\n                                ];\n                            } else if (element instanceof Connection) {\n                                tools = ['edit'];\n                            }\n                            if (editable && editable.remove !== false) {\n                                tools.push('delete');\n                            }\n                        }\n                        if (tools && tools.length) {\n                            var padding = 20;\n                            var point;\n                            this.singleToolBar = new DiagramToolBar(diagram, {\n                                tools: tools,\n                                click: proxy(this._toolBarClick, this),\n                                modal: true\n                            });\n                            var popupWidth = this.singleToolBar._popup.element.outerWidth();\n                            var popupHeight = this.singleToolBar._popup.element.outerHeight();\n                            if (element instanceof Shape) {\n                                var shapeBounds = this.modelToView(element.bounds(ROTATED));\n                                point = Point(shapeBounds.x, shapeBounds.y).minus(Point((popupWidth - shapeBounds.width) / 2, popupHeight + padding));\n                            } else if (element instanceof Connection) {\n                                var connectionBounds = this.modelToView(element.bounds());\n                                point = Point(connectionBounds.x, connectionBounds.y).minus(Point((popupWidth - connectionBounds.width - 20) / 2, popupHeight + padding));\n                            }\n                            if (point) {\n                                if (!this.canvas.translate) {\n                                    point = point.minus(Point(this.scroller.scrollLeft, this.scroller.scrollTop));\n                                }\n                                point = this.viewToDocument(point);\n                                point = Point(math.max(point.x, 0), math.max(point.y, 0));\n                                this.singleToolBar.showAt(point);\n                                if (preventClosing) {\n                                    this.singleToolBar._popup.one('close', preventDefault);\n                                }\n                            } else {\n                                this._destroyToolBar();\n                            }\n                        }\n                    }\n                }\n            },\n            _toolBarClick: function (e) {\n                this.trigger('toolBarClick', e);\n                this._destroyToolBar();\n            },\n            _normalizePointZoom: function (point) {\n                return point.times(1 / this.zoom());\n            },\n            _initialize: function () {\n                this.shapes = [];\n                this._selectedItems = [];\n                this.connections = [];\n                this._dataMap = {};\n                this._connectionsDataMap = {};\n                this._inactiveShapeItems = new InactiveItemsCollection();\n                this._deferredConnectionUpdates = [];\n                this.undoRedoService = new UndoRedoService({\n                    undone: this._syncHandler,\n                    redone: this._syncHandler\n                });\n                this.id = diagram.randomId();\n            },\n            _fetchFreshData: function () {\n                var that = this;\n                that._dataSource();\n                if (that._isEditable) {\n                    that._connectionDataSource();\n                }\n                if (that.options.autoBind) {\n                    if (that._isEditable) {\n                        this._loadingShapes = true;\n                        this._loadingConnections = true;\n                        that.dataSource.fetch();\n                        that.connectionsDataSource.fetch();\n                    } else {\n                        that.dataSource.fetch();\n                    }\n                }\n            },\n            _dataSource: function () {\n                if (defined(this.options.connectionsDataSource)) {\n                    this._isEditable = true;\n                    var dsOptions = this.options.dataSource || {};\n                    var ds = isArray(dsOptions) ? { data: dsOptions } : dsOptions;\n                    if (this.dataSource && this._shapesRefreshHandler) {\n                        this.dataSource.unbind('change', this._shapesRefreshHandler).unbind('requestStart', this._shapesRequestStartHandler).unbind('error', this._shapesErrorHandler);\n                    } else {\n                        this._shapesRefreshHandler = proxy(this._refreshShapes, this);\n                        this._shapesRequestStartHandler = proxy(this._shapesRequestStart, this);\n                        this._shapesErrorHandler = proxy(this._error, this);\n                    }\n                    this.dataSource = kendo.data.DataSource.create(ds).bind('change', this._shapesRefreshHandler).bind('requestStart', this._shapesRequestStartHandler).bind('error', this._shapesErrorHandler);\n                } else {\n                    this._treeDataSource();\n                    this._isEditable = false;\n                }\n            },\n            _connectionDataSource: function () {\n                var dsOptions = this.options.connectionsDataSource;\n                if (dsOptions) {\n                    var ds = isArray(dsOptions) ? { data: dsOptions } : dsOptions;\n                    if (this.connectionsDataSource && this._connectionsRefreshHandler) {\n                        this.connectionsDataSource.unbind('change', this._connectionsRefreshHandler).unbind('requestStart', this._connectionsRequestStartHandler).unbind('error', this._connectionsErrorHandler);\n                    } else {\n                        this._connectionsRefreshHandler = proxy(this._refreshConnections, this);\n                        this._connectionsRequestStartHandler = proxy(this._connectionsRequestStart, this);\n                        this._connectionsErrorHandler = proxy(this._connectionsError, this);\n                    }\n                    this.connectionsDataSource = kendo.data.DataSource.create(ds).bind('change', this._connectionsRefreshHandler).bind('requestStart', this._connectionsRequestStartHandler).bind('error', this._connectionsErrorHandler);\n                }\n            },\n            _shapesRequestStart: function (e) {\n                if (e.type == 'read') {\n                    this._loadingShapes = true;\n                }\n            },\n            _connectionsRequestStart: function (e) {\n                if (e.type == 'read') {\n                    this._loadingConnections = true;\n                }\n            },\n            _error: function () {\n                this._loadingShapes = false;\n            },\n            _connectionsError: function () {\n                this._loadingConnections = false;\n            },\n            _refreshShapes: function (e) {\n                if (e.action === 'remove') {\n                    if (this._shouldRefresh()) {\n                        this._removeShapes(e.items);\n                    }\n                } else if (e.action === 'itemchange') {\n                    if (this._shouldRefresh()) {\n                        this._updateShapes(e.items, e.field);\n                    }\n                } else if (e.action === 'add') {\n                    this._inactiveShapeItems.add(e.items);\n                } else if (e.action === 'sync') {\n                    this._syncShapes(e.items);\n                } else {\n                    this.refresh();\n                }\n            },\n            _shouldRefresh: function () {\n                return !this._suspended;\n            },\n            _suspendModelRefresh: function () {\n                this._suspended = (this._suspended || 0) + 1;\n            },\n            _resumeModelRefresh: function () {\n                this._suspended = math.max((this._suspended || 0) - 1, 0);\n            },\n            refresh: function () {\n                this._loadingShapes = false;\n                if (!this._loadingConnections) {\n                    this._rebindShapesAndConnections();\n                }\n            },\n            _rebindShapesAndConnections: function () {\n                this.clear();\n                this._addShapes(this.dataSource.view());\n                if (this.connectionsDataSource) {\n                    this._addConnections(this.connectionsDataSource.view(), false);\n                }\n                if (this.options.layout) {\n                    this.layout(this.options.layout);\n                } else {\n                    this._redrawConnections();\n                }\n                this.trigger('dataBound');\n            },\n            refreshConnections: function () {\n                this._loadingConnections = false;\n                if (!this._loadingShapes) {\n                    this._rebindShapesAndConnections();\n                }\n            },\n            _redrawConnections: function () {\n                var connections = this.connections;\n                for (var idx = 0; idx < connections.length; idx++) {\n                    connections[idx].refresh();\n                }\n            },\n            _removeShapes: function (items) {\n                var dataMap = this._dataMap;\n                var item, i;\n                for (i = 0; i < items.length; i++) {\n                    item = items[i];\n                    if (dataMap[item.id]) {\n                        this.remove(dataMap[item.id], false);\n                        dataMap[item.id] = null;\n                    }\n                }\n            },\n            _syncShapes: function () {\n                var diagram = this;\n                var inactiveItems = diagram._inactiveShapeItems;\n                inactiveItems.forEach(function (inactiveItem) {\n                    var dataItem = inactiveItem.dataItem;\n                    var shape = inactiveItem.element;\n                    if (!dataItem.isNew()) {\n                        if (shape) {\n                            shape._setOptionsFromModel();\n                            diagram.addShape(shape, inactiveItem.undoable);\n                            diagram._dataMap[dataItem.id] = shape;\n                        } else {\n                            diagram._addDataItem(dataItem);\n                        }\n                        inactiveItem.activate();\n                        inactiveItems.remove(dataItem);\n                    }\n                });\n            },\n            _updateShapes: function (items, field) {\n                for (var i = 0; i < items.length; i++) {\n                    var dataItem = items[i];\n                    var shape = this._dataMap[dataItem.id];\n                    if (shape) {\n                        shape.updateOptionsFromModel(dataItem, field);\n                    }\n                }\n            },\n            _addShapes: function (dataItems) {\n                for (var i = 0; i < dataItems.length; i++) {\n                    this._addDataItem(dataItems[i], false);\n                }\n            },\n            _refreshConnections: function (e) {\n                if (e.action === 'remove') {\n                    if (this._shouldRefresh()) {\n                        this._removeConnections(e.items);\n                    }\n                } else if (e.action === 'add') {\n                    this._addConnections(e.items);\n                } else if (e.action === 'sync') {\n                } else if (e.action === 'itemchange') {\n                    if (this._shouldRefresh()) {\n                        this._updateConnections(e.items);\n                    }\n                } else {\n                    this.refreshConnections();\n                }\n            },\n            _removeConnections: function (items) {\n                for (var i = 0; i < items.length; i++) {\n                    this.remove(this._connectionsDataMap[items[i].uid], false);\n                    this._connectionsDataMap[items[i].uid] = null;\n                }\n            },\n            _updateConnections: function (items) {\n                for (var i = 0; i < items.length; i++) {\n                    var dataItem = items[i];\n                    var connection = this._connectionsDataMap[dataItem.uid];\n                    connection.updateOptionsFromModel(dataItem);\n                }\n            },\n            _addConnections: function (connections, undoable) {\n                var length = connections.length;\n                for (var i = 0; i < length; i++) {\n                    var dataItem = connections[i];\n                    this._addConnectionDataItem(dataItem, undoable);\n                }\n            },\n            _addConnectionDataItem: function (dataItem, undoable) {\n                if (!this._connectionsDataMap[dataItem.uid]) {\n                    var from = this._validateConnector(dataItem.from);\n                    if (!defined(from) || from === null) {\n                        from = new Point(dataItem.fromX, dataItem.fromY);\n                    }\n                    var to = this._validateConnector(dataItem.to);\n                    if (!defined(to) || to === null) {\n                        to = new Point(dataItem.toX, dataItem.toY);\n                    }\n                    if (defined(from) && defined(to)) {\n                        var options = deepExtend({}, this.options.connectionDefaults);\n                        options.dataItem = dataItem;\n                        var connection = new Connection(from, to, options);\n                        this._connectionsDataMap[dataItem.uid] = connection;\n                        this.addConnection(connection, undoable);\n                    }\n                }\n            },\n            _validateConnector: function (value) {\n                var connector;\n                if (defined(value) && value !== null) {\n                    connector = this._dataMap[value];\n                }\n                return connector;\n            },\n            _treeDataSource: function () {\n                var that = this, options = that.options, dataSource = options.dataSource;\n                dataSource = isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (dataSource instanceof kendo.data.DataSource && !(dataSource instanceof kendo.data.HierarchicalDataSource)) {\n                    throw new Error('Incorrect DataSource type. If a single dataSource instance is set to the diagram then it should be a HierarchicalDataSource. You should set only the options instead of an instance or a HierarchicalDataSource instance or supply connectionsDataSource as well.');\n                }\n                if (!dataSource.fields) {\n                    dataSource.fields = [\n                        { field: 'text' },\n                        { field: 'url' },\n                        { field: 'spriteCssClass' },\n                        { field: 'imageUrl' }\n                    ];\n                }\n                if (that.dataSource && that._refreshHandler) {\n                    that._unbindDataSource();\n                }\n                that._refreshHandler = proxy(that._refreshSource, that);\n                that._errorHandler = proxy(that._error, that);\n                that.dataSource = HierarchicalDataSource.create(dataSource).bind(CHANGE, that._refreshHandler).bind(ERROR, that._errorHandler);\n            },\n            _unbindDataSource: function () {\n                var that = this;\n                that.dataSource.unbind(CHANGE, that._refreshHandler).unbind(ERROR, that._errorHandler);\n            },\n            _adorn: function (adorner, isActive) {\n                if (isActive !== undefined && adorner) {\n                    if (isActive) {\n                        this._adorners.push(adorner);\n                        this.adornerLayer.append(adorner.visual);\n                    } else {\n                        Utils.remove(this._adorners, adorner);\n                        this.adornerLayer.remove(adorner.visual);\n                    }\n                }\n            },\n            _showConnectors: function (shape, value) {\n                if (value) {\n                    this._connectorsAdorner.show(shape);\n                } else {\n                    this._connectorsAdorner.destroy();\n                }\n            },\n            _updateAdorners: function () {\n                var adorners = this._adorners;\n                for (var i = 0; i < adorners.length; i++) {\n                    var adorner = adorners[i];\n                    if (adorner.refreshBounds) {\n                        adorner.refreshBounds();\n                    }\n                    adorner.refresh();\n                }\n            },\n            _refresh: function () {\n                for (var i = 0; i < this.connections.length; i++) {\n                    this.connections[i].refresh();\n                }\n            },\n            _destroyToolBar: function () {\n                if (this.singleToolBar) {\n                    this.singleToolBar.hide();\n                    this.singleToolBar.destroy();\n                    this.singleToolBar = null;\n                }\n            },\n            _destroyGlobalToolBar: function () {\n                if (this.toolBar) {\n                    this.toolBar.hide();\n                    this.toolBar.destroy();\n                    this.toolBar = null;\n                }\n            },\n            exportDOMVisual: function () {\n                var viewBox = this.canvas._viewBox;\n                var scrollOffset = geom.transform().translate(-viewBox.x, -viewBox.y);\n                var viewRect = new geom.Rect([\n                    0,\n                    0\n                ], [\n                    viewBox.width,\n                    viewBox.height\n                ]);\n                var clipPath = draw.Path.fromRect(viewRect);\n                var wrap = new draw.Group({ transform: scrollOffset });\n                var clipWrap = new draw.Group({ clip: clipPath });\n                var root = this.canvas.drawingElement.children[0];\n                clipWrap.append(wrap);\n                wrap.children.push(root);\n                return clipWrap;\n            },\n            exportVisual: function () {\n                var scale = geom.transform().scale(1 / this._zoom);\n                var wrap = new draw.Group({ transform: scale });\n                var root = this.mainLayer.drawingElement;\n                wrap.children.push(root);\n                return wrap;\n            },\n            _syncChanges: function () {\n                this._syncShapeChanges();\n                this._syncConnectionChanges();\n            },\n            _syncShapeChanges: function () {\n                if (this.dataSource && this._isEditable) {\n                    this.dataSource.sync();\n                }\n            },\n            _syncConnectionChanges: function () {\n                var that = this;\n                if (that.connectionsDataSource && that._isEditable) {\n                    $.when.apply($, that._deferredConnectionUpdates).then(function () {\n                        that.connectionsDataSource.sync();\n                    });\n                    that.deferredConnectionUpdates = [];\n                }\n            }\n        });\n        dataviz.ExportMixin.extend(Diagram.fn, true);\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Diagram.fn);\n        }\n        function filterShapeDataItem(dataItem) {\n            var result = {};\n            dataItem = dataItem || {};\n            if (defined(dataItem.text) && dataItem.text !== null) {\n                result.text = dataItem.text;\n            }\n            if (defined(dataItem.x) && dataItem.x !== null) {\n                result.x = dataItem.x;\n            }\n            if (defined(dataItem.y) && dataItem.y !== null) {\n                result.y = dataItem.y;\n            }\n            if (defined(dataItem.width) && dataItem.width !== null) {\n                result.width = dataItem.width;\n            }\n            if (defined(dataItem.height) && dataItem.height !== null) {\n                result.height = dataItem.height;\n            }\n            if (defined(dataItem.type) && dataItem.type !== null) {\n                result.type = dataItem.type;\n            }\n            return result;\n        }\n        function filterConnectionDataItem(dataItem) {\n            var result = {};\n            dataItem = dataItem || {};\n            if (defined(dataItem.text) && dataItem.text !== null) {\n                result.content = dataItem.text;\n            }\n            if (defined(dataItem.type) && dataItem.type !== null) {\n                result.type = dataItem.type;\n            }\n            if (defined(dataItem.from) && dataItem.from !== null) {\n                result.from = dataItem.from;\n            }\n            if (defined(dataItem.fromConnector) && dataItem.fromConnector !== null) {\n                result.fromConnector = dataItem.fromConnector;\n            }\n            if (defined(dataItem.fromX) && dataItem.fromX !== null) {\n                result.fromX = dataItem.fromX;\n            }\n            if (defined(dataItem.fromY) && dataItem.fromY !== null) {\n                result.fromY = dataItem.fromY;\n            }\n            if (defined(dataItem.to) && dataItem.to !== null) {\n                result.to = dataItem.to;\n            }\n            if (defined(dataItem.toConnector) && dataItem.toConnector !== null) {\n                result.toConnector = dataItem.toConnector;\n            }\n            if (defined(dataItem.toX) && dataItem.toX !== null) {\n                result.toX = dataItem.toX;\n            }\n            if (defined(dataItem.toY) && dataItem.toY !== null) {\n                result.toY = dataItem.toY;\n            }\n            return result;\n        }\n        var DiagramToolBar = kendo.Observable.extend({\n            init: function (diagram, options) {\n                kendo.Observable.fn.init.call(this);\n                this.diagram = diagram;\n                this.options = deepExtend({}, this.options, options);\n                this._tools = [];\n                this.createToolBar();\n                this.createTools();\n                this.appendTools();\n                if (this.options.modal) {\n                    this.createPopup();\n                }\n                this.bind(this.events, options);\n            },\n            events: ['click'],\n            createPopup: function () {\n                this.container = $('<div/>').append(this.element);\n                this._popup = this.container.kendoPopup({}).getKendoPopup();\n            },\n            appendTools: function () {\n                for (var i = 0; i < this._tools.length; i++) {\n                    var tool = this._tools[i];\n                    if (tool.buttons && tool.buttons.length || !defined(tool.buttons)) {\n                        this._toolBar.add(tool);\n                    }\n                }\n            },\n            createToolBar: function () {\n                this.element = $('<div/>');\n                this._toolBar = this.element.kendoToolBar({\n                    click: proxy(this.click, this),\n                    resizable: false\n                }).getKendoToolBar();\n                this.element.css('border', 'none');\n            },\n            createTools: function () {\n                for (var i = 0; i < this.options.tools.length; i++) {\n                    this.createTool(this.options.tools[i]);\n                }\n            },\n            createTool: function (tool) {\n                if (!isPlainObject(tool)) {\n                    tool = { name: tool };\n                }\n                var toolName = tool.name + 'Tool';\n                if (this[toolName]) {\n                    this[toolName](tool);\n                } else {\n                    this._tools.push(deepExtend({}, tool, { attributes: this._setAttributes({ action: tool.name }) }));\n                }\n            },\n            showAt: function (point) {\n                if (this._popup) {\n                    this._popup.open(point.x, point.y);\n                }\n            },\n            hide: function () {\n                if (this._popup) {\n                    this._popup.close();\n                }\n            },\n            newGroup: function () {\n                return {\n                    type: 'buttonGroup',\n                    buttons: []\n                };\n            },\n            editTool: function () {\n                this._tools.push({\n                    spriteCssClass: 'k-icon k-i-pencil',\n                    showText: 'overflow',\n                    type: 'button',\n                    text: 'Edit',\n                    attributes: this._setAttributes({ action: 'edit' })\n                });\n            },\n            deleteTool: function () {\n                this._tools.push({\n                    spriteCssClass: 'k-icon k-i-close',\n                    showText: 'overflow',\n                    type: 'button',\n                    text: 'Delete',\n                    attributes: this._setAttributes({ action: 'delete' })\n                });\n            },\n            rotateAnticlockwiseTool: function (options) {\n                this._appendGroup('rotate');\n                this._rotateGroup.buttons.push({\n                    spriteCssClass: 'k-icon k-i-rotateccw',\n                    showText: 'overflow',\n                    text: 'RotateAnticlockwise',\n                    group: 'rotate',\n                    attributes: this._setAttributes({\n                        action: 'rotateAnticlockwise',\n                        step: options.step\n                    })\n                });\n            },\n            rotateClockwiseTool: function (options) {\n                this._appendGroup('rotate');\n                this._rotateGroup.buttons.push({\n                    spriteCssClass: 'k-icon k-i-rotatecw',\n                    attributes: this._setAttributes({\n                        action: 'rotateClockwise',\n                        step: options.step\n                    }),\n                    showText: 'overflow',\n                    text: 'RotateClockwise',\n                    group: 'rotate'\n                });\n            },\n            createShapeTool: function () {\n                this._appendGroup('create');\n                this._createGroup.buttons.push({\n                    spriteCssClass: 'k-icon k-i-shape',\n                    showText: 'overflow',\n                    text: 'CreateShape',\n                    group: 'create',\n                    attributes: this._setAttributes({ action: 'createShape' })\n                });\n            },\n            createConnectionTool: function () {\n                this._appendGroup('create');\n                this._createGroup.buttons.push({\n                    spriteCssClass: 'k-icon k-i-connector',\n                    showText: 'overflow',\n                    text: 'CreateConnection',\n                    group: 'create',\n                    attributes: this._setAttributes({ action: 'createConnection' })\n                });\n            },\n            undoTool: function () {\n                this._appendGroup('history');\n                this._historyGroup.buttons.push({\n                    spriteCssClass: 'k-icon k-i-undo',\n                    showText: 'overflow',\n                    text: 'Undo',\n                    group: 'history',\n                    attributes: this._setAttributes({ action: 'undo' })\n                });\n            },\n            redoTool: function () {\n                this._appendGroup('history');\n                this._historyGroup.buttons.push({\n                    spriteCssClass: 'k-icon k-i-redo',\n                    showText: 'overflow',\n                    text: 'Redo',\n                    group: 'history',\n                    attributes: this._setAttributes({ action: 'redo' })\n                });\n            },\n            _appendGroup: function (name) {\n                var prop = '_' + name + 'Group';\n                if (!this[prop]) {\n                    this[prop] = this.newGroup();\n                    this._tools.push(this[prop]);\n                }\n            },\n            _setAttributes: function (attributes) {\n                var attr = {};\n                if (attributes.action) {\n                    attr[kendo.attr('action')] = attributes.action;\n                }\n                if (attributes.step) {\n                    attr[kendo.attr('step')] = attributes.step;\n                }\n                return attr;\n            },\n            _getAttributes: function (element) {\n                var attr = {};\n                var action = element.attr(kendo.attr('action'));\n                if (action) {\n                    attr.action = action;\n                }\n                var step = element.attr(kendo.attr('step'));\n                if (step) {\n                    attr.step = step;\n                }\n                return attr;\n            },\n            click: function (e) {\n                var attributes = this._getAttributes($(e.target));\n                var action = attributes.action;\n                if (action && this[action]) {\n                    this[action](attributes);\n                }\n                this.trigger('click', this.eventData(action, e.target));\n            },\n            eventData: function (action, target) {\n                var elements = this.selectedElements(), length = elements.length, shapes = [], connections = [], element;\n                for (var idx = 0; idx < length; idx++) {\n                    element = elements[idx];\n                    if (element instanceof Shape) {\n                        shapes.push(element);\n                    } else {\n                        connections.push(element);\n                    }\n                }\n                return {\n                    shapes: shapes,\n                    connections: connections,\n                    action: action,\n                    target: target\n                };\n            },\n            'delete': function () {\n                var diagram = this.diagram;\n                var toRemove = diagram._triggerRemove(this.selectedElements());\n                if (toRemove.length) {\n                    this.diagram.remove(toRemove, true);\n                    this.diagram._syncChanges();\n                }\n            },\n            edit: function () {\n                var selectedElemens = this.selectedElements();\n                if (selectedElemens.length === 1) {\n                    this.diagram.edit(selectedElemens[0]);\n                }\n            },\n            rotateClockwise: function (options) {\n                var angle = parseFloat(options.step || 90);\n                this._rotate(angle);\n            },\n            rotateAnticlockwise: function (options) {\n                var angle = parseFloat(options.step || 90);\n                this._rotate(-angle);\n            },\n            _rotate: function (angle) {\n                var adorner = this.diagram._resizingAdorner;\n                adorner.angle(adorner.angle() + angle);\n                adorner.rotate();\n            },\n            selectedElements: function () {\n                return this.diagram.select();\n            },\n            createShape: function () {\n                this.diagram.createShape();\n            },\n            createConnection: function () {\n                this.diagram.createConnection();\n            },\n            undo: function () {\n                this.diagram.undo();\n            },\n            redo: function () {\n                this.diagram.redo();\n            },\n            destroy: function () {\n                this.diagram = null;\n                this.element = null;\n                this.options = null;\n                if (this._toolBar) {\n                    this._toolBar.destroy();\n                }\n                if (this._popup) {\n                    this._popup.destroy();\n                }\n            }\n        });\n        var Editor = kendo.Observable.extend({\n            init: function (element, options) {\n                kendo.Observable.fn.init.call(this);\n                this.options = extend(true, {}, this.options, options);\n                this.element = element;\n                this.model = this.options.model;\n                this.fields = this._getFields();\n                this._initContainer();\n                this.createEditable();\n            },\n            options: { editors: {} },\n            _initContainer: function () {\n                this.wrapper = this.element;\n            },\n            createEditable: function () {\n                var options = this.options;\n                this.editable = new kendo.ui.Editable(this.wrapper, {\n                    fields: this.fields,\n                    target: options.target,\n                    clearContainer: false,\n                    model: this.model\n                });\n            },\n            _isEditable: function (field) {\n                return this.model.editable && this.model.editable(field);\n            },\n            _getFields: function () {\n                var fields = [];\n                var modelFields = this.model.fields;\n                for (var field in modelFields) {\n                    var result = {};\n                    if (this._isEditable(field)) {\n                        var editor = this.options.editors[field];\n                        if (editor) {\n                            result.editor = editor;\n                        }\n                        result.field = field;\n                        fields.push(result);\n                    }\n                }\n                return fields;\n            },\n            end: function () {\n                return this.editable.end();\n            },\n            destroy: function () {\n                this.editable.destroy();\n                this.editable.element.find('[' + kendo.attr('container-for') + ']').empty();\n                this.model = this.wrapper = this.element = this.columns = this.editable = null;\n            }\n        });\n        var PopupEditor = Editor.extend({\n            init: function (element, options) {\n                Editor.fn.init.call(this, element, options);\n                this.bind(this.events, this.options);\n                this.open();\n            },\n            events: [\n                'update',\n                'cancel'\n            ],\n            options: {\n                window: {\n                    modal: true,\n                    resizable: false,\n                    draggable: true,\n                    title: 'Edit',\n                    visible: false\n                }\n            },\n            _initContainer: function () {\n                var that = this;\n                this.wrapper = $('<div class=\"k-popup-edit-form\"/>').attr(kendo.attr('uid'), this.model.uid);\n                var formContent = '';\n                if (this.options.template) {\n                    formContent += this._renderTemplate();\n                    this.fields = [];\n                } else {\n                    formContent += this._renderFields();\n                }\n                formContent += this._renderButtons();\n                this.wrapper.append($('<div class=\"k-edit-form-container\"/>').append(formContent));\n                this.window = new kendo.ui.Window(this.wrapper.appendTo(this.element), this.options.window);\n                this.window.bind('close', function (e) {\n                    if (e.userTriggered) {\n                        e.sender.element.focus();\n                        that._cancelClick(e);\n                    }\n                });\n                this._attachButtonEvents();\n            },\n            _renderTemplate: function () {\n                var template = this.options.template;\n                if (typeof template === 'string') {\n                    template = window.unescape(template);\n                }\n                template = kendo.template(template)(this.model);\n                return template;\n            },\n            _renderFields: function () {\n                var form = '';\n                for (var i = 0; i < this.fields.length; i++) {\n                    var field = this.fields[i];\n                    form += '<div class=\"k-edit-label\"><label for=\"' + field.field + '\">' + (field.field || '') + '</label></div>';\n                    if (this._isEditable(field.field)) {\n                        form += '<div ' + kendo.attr('container-for') + '=\"' + field.field + '\" class=\"k-edit-field\"></div>';\n                    }\n                }\n                return form;\n            },\n            _renderButtons: function () {\n                var form = '<div class=\"k-edit-buttons k-state-default\">';\n                form += this._createButton('update');\n                form += this._createButton('cancel');\n                form += '</div>';\n                return form;\n            },\n            _createButton: function (name) {\n                return kendo.template(BUTTON_TEMPLATE)(defaultButtons[name]);\n            },\n            _attachButtonEvents: function () {\n                this._cancelClickHandler = proxy(this._cancelClick, this);\n                this.window.element.on(CLICK + NS, 'a.k-diagram-cancel', this._cancelClickHandler);\n                this._updateClickHandler = proxy(this._updateClick, this);\n                this.window.element.on(CLICK + NS, 'a.k-diagram-update', this._updateClickHandler);\n            },\n            _updateClick: function (e) {\n                e.preventDefault();\n                this.trigger('update');\n            },\n            _cancelClick: function (e) {\n                e.preventDefault();\n                this.trigger('cancel');\n            },\n            open: function () {\n                this.window.center().open();\n            },\n            close: function () {\n                this.window.bind('deactivate', proxy(this.destroy, this)).close();\n            },\n            destroy: function () {\n                this.window.close().destroy();\n                this.window.element.off(CLICK + NS, 'a.k-diagram-cancel', this._cancelClickHandler);\n                this.window.element.off(CLICK + NS, 'a.k-diagram-update', this._updateClickHandler);\n                this._cancelClickHandler = null;\n                this._editUpdateClickHandler = null;\n                this.window = null;\n                Editor.fn.destroy.call(this);\n            }\n        });\n        function connectionSelector(container, options) {\n            var model = this.dataSource.reader.model;\n            if (model) {\n                var textField = model.fn.fields.text ? 'text' : model.idField;\n                $('<input name=\\'' + options.field + '\\' />').appendTo(container).kendoDropDownList({\n                    dataValueField: model.idField,\n                    dataTextField: textField,\n                    dataSource: this.dataSource.data().toJSON(),\n                    optionLabel: ' ',\n                    valuePrimitive: true\n                });\n            }\n        }\n        function InactiveItem(dataItem) {\n            this.dataItem = dataItem;\n            this.callbacks = [];\n        }\n        InactiveItem.fn = InactiveItem.prototype = {\n            onActivate: function (callback) {\n                var deffered = $.Deferred();\n                this.callbacks.push({\n                    callback: callback,\n                    deferred: deffered\n                });\n                return deffered;\n            },\n            activate: function () {\n                var callbacks = this.callbacks;\n                var item;\n                for (var idx = 0; idx < callbacks.length; idx++) {\n                    item = this.callbacks[idx];\n                    item.callback(this.dataItem);\n                    item.deferred.resolve();\n                }\n                this.callbacks = [];\n            }\n        };\n        function InactiveItemsCollection() {\n            this.items = {};\n        }\n        InactiveItemsCollection.fn = InactiveItemsCollection.prototype = {\n            add: function (items) {\n                for (var idx = 0; idx < items.length; idx++) {\n                    this.items[items[idx].uid] = new InactiveItem(items[idx]);\n                }\n            },\n            forEach: function (callback) {\n                for (var uid in this.items) {\n                    callback(this.items[uid]);\n                }\n            },\n            getByUid: function (uid) {\n                return this.items[uid];\n            },\n            remove: function (item) {\n                delete this.items[item.uid];\n            }\n        };\n        var QuadRoot = Class.extend({\n            init: function () {\n                this.shapes = [];\n            },\n            _add: function (shape, bounds) {\n                this.shapes.push({\n                    bounds: bounds,\n                    shape: shape\n                });\n                shape._quadNode = this;\n            },\n            insert: function (shape, bounds) {\n                this._add(shape, bounds);\n            },\n            remove: function (shape) {\n                var shapes = this.shapes;\n                var length = shapes.length;\n                for (var idx = 0; idx < length; idx++) {\n                    if (shapes[idx].shape === shape) {\n                        shapes.splice(idx, 1);\n                        break;\n                    }\n                }\n            },\n            hitTestRect: function (rect) {\n                var shapes = this.shapes;\n                var length = shapes.length;\n                for (var i = 0; i < length; i++) {\n                    if (this._testRect(shapes[i].shape, rect)) {\n                        return true;\n                    }\n                }\n            },\n            _testRect: function (shape, rect) {\n                var angle = shape.rotate().angle;\n                var bounds = shape.bounds();\n                var hit;\n                if (!angle) {\n                    hit = bounds.overlaps(rect);\n                } else {\n                    hit = Intersect.rects(rect, bounds, -angle);\n                }\n                return hit;\n            }\n        });\n        var QuadNode = QuadRoot.extend({\n            init: function (rect) {\n                QuadRoot.fn.init.call(this);\n                this.children = [];\n                this.rect = rect;\n            },\n            inBounds: function (rect) {\n                var nodeRect = this.rect;\n                var nodeBottomRight = nodeRect.bottomRight();\n                var bottomRight = rect.bottomRight();\n                var inBounds = nodeRect.x <= rect.x && nodeRect.y <= rect.y && bottomRight.x <= nodeBottomRight.x && bottomRight.y <= nodeBottomRight.y;\n                return inBounds;\n            },\n            overlapsBounds: function (rect) {\n                return this.rect.overlaps(rect);\n            },\n            insert: function (shape, bounds) {\n                var inserted = false;\n                var children = this.children;\n                var length = children.length;\n                if (this.inBounds(bounds)) {\n                    if (!length && this.shapes.length < 4) {\n                        this._add(shape, bounds);\n                    } else {\n                        if (!length) {\n                            this._initChildren();\n                        }\n                        for (var idx = 0; idx < children.length; idx++) {\n                            if (children[idx].insert(shape, bounds)) {\n                                inserted = true;\n                                break;\n                            }\n                        }\n                        if (!inserted) {\n                            this._add(shape, bounds);\n                        }\n                    }\n                    inserted = true;\n                }\n                return inserted;\n            },\n            _initChildren: function () {\n                var rect = this.rect, children = this.children, shapes = this.shapes, center = rect.center(), halfWidth = rect.width / 2, halfHeight = rect.height / 2, childIdx, shapeIdx;\n                children.push(new QuadNode(new Rect(rect.x, rect.y, halfWidth, halfHeight)), new QuadNode(new Rect(center.x, rect.y, halfWidth, halfHeight)), new QuadNode(new Rect(rect.x, center.y, halfWidth, halfHeight)), new QuadNode(new Rect(center.x, center.y, halfWidth, halfHeight)));\n                for (shapeIdx = shapes.length - 1; shapeIdx >= 0; shapeIdx--) {\n                    for (childIdx = 0; childIdx < children.length; childIdx++) {\n                        if (children[childIdx].insert(shapes[shapeIdx].shape, shapes[shapeIdx].bounds)) {\n                            shapes.splice(shapeIdx, 1);\n                            break;\n                        }\n                    }\n                }\n            },\n            hitTestRect: function (rect) {\n                var idx;\n                var children = this.children;\n                var length = children.length;\n                var hit = false;\n                if (this.overlapsBounds(rect)) {\n                    if (QuadRoot.fn.hitTestRect.call(this, rect)) {\n                        hit = true;\n                    } else {\n                        for (idx = 0; idx < length; idx++) {\n                            if (children[idx].hitTestRect(rect)) {\n                                hit = true;\n                                break;\n                            }\n                        }\n                    }\n                }\n                return hit;\n            }\n        });\n        var ShapesQuadTree = Class.extend({\n            ROOT_SIZE: 1000,\n            init: function (diagram) {\n                var boundsChangeHandler = proxy(this._boundsChange, this);\n                diagram.bind(ITEMBOUNDSCHANGE, boundsChangeHandler);\n                diagram.bind(ITEMROTATE, boundsChangeHandler);\n                this.initRoots();\n            },\n            initRoots: function () {\n                this.rootMap = {};\n                this.root = new QuadRoot();\n            },\n            clear: function () {\n                this.initRoots();\n            },\n            _boundsChange: function (e) {\n                if (e.item._quadNode) {\n                    e.item._quadNode.remove(e.item);\n                }\n                this.insert(e.item);\n            },\n            insert: function (shape) {\n                var bounds = shape.bounds(ROTATED);\n                var rootSize = this.ROOT_SIZE;\n                var sectors = this.getSectors(bounds);\n                var x = sectors[0][0];\n                var y = sectors[1][0];\n                if (this.inRoot(sectors)) {\n                    this.root.insert(shape, bounds);\n                } else {\n                    if (!this.rootMap[x]) {\n                        this.rootMap[x] = {};\n                    }\n                    if (!this.rootMap[x][y]) {\n                        this.rootMap[x][y] = new QuadNode(new Rect(x * rootSize, y * rootSize, rootSize, rootSize));\n                    }\n                    this.rootMap[x][y].insert(shape, bounds);\n                }\n            },\n            remove: function (shape) {\n                if (shape._quadNode) {\n                    shape._quadNode.remove(shape);\n                }\n            },\n            inRoot: function (sectors) {\n                return sectors[0].length > 1 || sectors[1].length > 1;\n            },\n            getSectors: function (rect) {\n                var rootSize = this.ROOT_SIZE;\n                var bottomRight = rect.bottomRight();\n                var bottomX = math.floor(bottomRight.x / rootSize);\n                var bottomY = math.floor(bottomRight.y / rootSize);\n                var sectors = [\n                    [],\n                    []\n                ];\n                for (var x = math.floor(rect.x / rootSize); x <= bottomX; x++) {\n                    sectors[0].push(x);\n                }\n                for (var y = math.floor(rect.y / rootSize); y <= bottomY; y++) {\n                    sectors[1].push(y);\n                }\n                return sectors;\n            },\n            hitTestRect: function (rect) {\n                var sectors = this.getSectors(rect);\n                var xIdx, yIdx, x, y;\n                var root;\n                if (this.root.hitTestRect(rect)) {\n                    return true;\n                }\n                for (xIdx = 0; xIdx < sectors[0].length; xIdx++) {\n                    x = sectors[0][xIdx];\n                    for (yIdx = 0; yIdx < sectors[1].length; yIdx++) {\n                        y = sectors[1][yIdx];\n                        root = (this.rootMap[x] || {})[y];\n                        if (root && root.hitTestRect(rect)) {\n                            return true;\n                        }\n                    }\n                }\n                return false;\n            }\n        });\n        function cloneDataItem(dataItem) {\n            var result = dataItem;\n            if (dataItem instanceof kendo.data.Model) {\n                result = dataItem.toJSON();\n                result[dataItem.idField] = dataItem._defaultId;\n            }\n            return result;\n        }\n        function splitDiagramElements(elements) {\n            var connections = [];\n            var shapes = [];\n            var element, idx;\n            for (idx = 0; idx < elements.length; idx++) {\n                element = elements[idx];\n                if (element instanceof Shape) {\n                    shapes.push(element);\n                } else {\n                    connections.push(element);\n                }\n            }\n            return {\n                shapes: shapes,\n                connections: connections\n            };\n        }\n        function createModel(dataSource, model) {\n            if (dataSource.reader.model) {\n                return new dataSource.reader.model(model);\n            }\n            return new kendo.data.ObservableObject(model);\n        }\n        function clearField(field, model) {\n            if (defined(model[field])) {\n                model.set(field, null);\n            }\n        }\n        function copyDefaultOptions(mainOptions, elementOptions, fields) {\n            var field;\n            for (var idx = 0; idx < fields.length; idx++) {\n                field = fields[idx];\n                if (elementOptions && !defined(elementOptions[field])) {\n                    elementOptions[field] = mainOptions[field];\n                }\n            }\n        }\n        function translateToOrigin(visual) {\n            var bbox = visual.drawingContainer().clippedBBox(null);\n            if (bbox.origin.x !== 0 || bbox.origin.y !== 0) {\n                visual.position(-bbox.origin.x, -bbox.origin.y);\n            }\n        }\n        function preventDefault(e) {\n            e.preventDefault();\n        }\n        dataviz.ui.plugin(Diagram);\n        deepExtend(diagram, {\n            Shape: Shape,\n            Connection: Connection,\n            Connector: Connector,\n            DiagramToolBar: DiagramToolBar,\n            QuadNode: QuadNode,\n            QuadRoot: QuadRoot,\n            ShapesQuadTree: ShapesQuadTree,\n            PopupEditor: PopupEditor\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.dataviz.diagram', [\n        'kendo.data',\n        'kendo.draganddrop',\n        'kendo.userevents',\n        'kendo.mobile.scroller',\n        'kendo.drawing',\n        'dataviz/diagram/utils',\n        'dataviz/diagram/math',\n        'dataviz/diagram/svg',\n        'dataviz/diagram/services',\n        'dataviz/diagram/layout',\n        'dataviz/diagram/dom'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'dataviz.diagram',\n        name: 'Diagram',\n        category: 'dataviz',\n        description: 'The Kendo DataViz Diagram ',\n        depends: [\n            'data',\n            'userevents',\n            'mobile.scroller',\n            'draganddrop',\n            'drawing',\n            'dataviz.core',\n            'dataviz.themes',\n            'toolbar'\n        ],\n        features: [\n            {\n                id: 'dataviz.diagram-pdf-export',\n                name: 'PDF export',\n                description: 'Export Diagram as PDF',\n                depends: ['pdf']\n            },\n            {\n                id: 'dataviz.diagram-editing',\n                name: 'Editing',\n                description: 'Support for model editing',\n                depends: [\n                    'editable',\n                    'window',\n                    'dropdownlist'\n                ]\n            }\n        ]\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"],"sourceRoot":"/source/"}