/*
* Kendo UI v2014.2.716 (http://www.telerik.com/kendo-ui)
* Copyright 2014 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at
* http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
!function(e,define){define(["./kendo.autocomplete.min","./kendo.datepicker.min","./kendo.numerictextbox.min","./kendo.combobox.min","./kendo.dropdownlist.min"],e)}(function(){return function(e,t){function n(t,i){var r,o,a=[];if(e.isPlainObject(t))if(t.hasOwnProperty("filters"))a=t.filters;else if(t.field==i)return t;for(e.isArray(t)&&(a=t),r=0;a.length>r;r++)if(o=n(a[r],i))return o}function i(t,n){t.filters&&(t.filters=e.grep(t.filters,function(e){return i(e,n),e.filters?e.filters.length:e.field!=n}))}function r(e,t){return function(n){for(var i,r,o=e(n),a=[],s=0,l={};o.length>s;)i=o[s++],r=i[t],l.hasOwnProperty(r)||(a.push(i),l[r]=!0);return a}}var o=window.kendo,a=o.ui,s=o.data.DataSource,l=a.Widget,d="change",c="boolean",u="enums",p="string",f="Is equal to",h="Is not equal to",m=e.proxy,g=l.extend({init:function(n,i){var r,a,f,h,g,v,_,k,b;n=e(n).addClass("grid-filter-header"),r=this.wrapper=e("<span/>").appendTo(n),a=this,_=a.operators=i.operators||{},k=a.input=e("<input/>").attr(o.attr("bind"),"value: value").appendTo(r),l.fn.init.call(a,n[0],i),i=a.options,f=a.dataSource=i.dataSource,a.model=f.reader.model,v=i.type=o.getter("reader.model.fields['"+i.field+"'].type",!0)(f)||p,i.values&&(i.type=v=u),_=_[v]||i.operators[v],a._parse=function(e){return e+""},a.model&&a.model.fields&&(b=a.model.fields[i.field],b&&b.parse&&(a._parse=m(b.parse,b))),a.viewModel=g=o.observable({operator:i.operator,value:null,operatorVisible:function(){var e=this.get("value");return null!==e&&e!==t&&"undefined"!=e}}),g.bind(d,m(a.updateDsFilter,a)),a._setInputType(i,v),v!=c&&i.showOperators!==!1&&a._createOperatorDropDown(_),a._createClearIcon(),o.bind(this.wrapper,g),v==p&&(h=a.suggestDataSource=i.suggestDataSource,h instanceof s||(!i.customDataSource&&h&&(h.data=t,h.group=t),h=a.suggestDataSource=s.create(h)),a.setSuggestDataSource(h)),v==u&&a.setComboBoxSource(a.options.values),a._refreshUI(),a._refreshHandler=m(a._refreshUI,a),a.dataSource.bind(d,a._refreshHandler)},_setInputType:function(t,n){var i,r,a,s,l=this,d=l.input;"function"==typeof t.template?t.template.call(l.viewModel,l.input):n==p?d.attr(o.attr("role"),"autocomplete").attr(o.attr("text-field"),l.options.dataTextField||l.options.field).attr(o.attr("delay"),this.options.delay).attr(o.attr("value-primitive"),!0):"date"==n?d.attr(o.attr("role"),"datepicker"):n==c?(i=this.wrapper,r=o.guid(),a=e("<label/>").text(this.options.messages.isTrue).append(d),d.attr(o.attr("bind"),"checked:value").attr("name",r).val("true").attr("type","radio"),s=a.clone().text(this.options.messages.isFalse),d.clone().val("false").appendTo(s),i.append([a,s])):"number"==n?d.attr(o.attr("role"),"numerictextbox"):n==u&&d.attr(o.attr("role"),"combobox").attr(o.attr("text-field"),"text").attr(o.attr("suggest"),!0).attr(o.attr("filter"),"contains").attr(o.attr("value-field"),"value").attr(o.attr("value-primitive"),!0)},_createOperatorDropDown:function(t){var n,i,r=[];for(n in t)r.push({text:t[n],value:n});i=e('<input class="k-dropdown-operator" '+o.attr("bind")+'="value: operator"/>').appendTo(this.wrapper),this.operatorDropDown=i.kendoDropDownList({dataSource:r,dataTextField:"text",dataValueField:"value",open:function(){this.popup.element.width(150)},valuePrimitive:!0}).data("kendoDropDownList"),this.operatorDropDown.wrapper.find(".k-i-arrow-s").removeClass("k-i-arrow-s").addClass("k-filter")},setSuggestDataSource:function(e){this.options.customDataSource||(e._pageSize=t,e.reader.data=r(e.reader.data,this.options.field)),this.suggestDataSource=e;var n=this.input.data("kendoAutoComplete");n&&n.setDataSource(e)},setComboBoxSource:function(e){var t=s.create({data:e}),n=this.input.data("kendoComboBox");n&&n.setDataSource(t)},_refreshUI:function(){var t=this,i=n(t.dataSource.filter(),this.options.field)||{},r=t.viewModel;t.manuallyUpdatingVM=!0,i=e.extend(!0,{},i),t.options.type==c&&r.value!==i.value&&t.wrapper.find(":radio").prop("checked",!1),i.operator&&r.set("operator",i.operator),r.set("value",i.value),t.manuallyUpdatingVM=!1},updateDsFilter:function(){var n,i,r,o=this;o.manuallyUpdatingVM||(n=e.extend({},o.viewModel.toJSON(),{field:o.options.field}),i={logic:"and",filters:[]},n.value!==t&&null!==n.value&&i.filters.push(n),r=o._merge(i),o.dataSource.filter(r.filters.length?r:{}))},_merge:function(t){var n,r,o,a=this,s=t.logic||"and",l=t.filters,d=a.dataSource.filter()||{filters:[],logic:"and"};for(i(d,a.options.field),r=0,o=l.length;o>r;r++)n=l[r],n.value=a._parse(n.value);return l=e.grep(l,function(e){return""!==e.value&&null!==e.value}),l.length&&(d.filters.length?(t.filters=l,"and"!==d.logic&&(d.filters=[{logic:d.logic,filters:d.filters}],d.logic="and"),d.filters.push(l.length>1?t:l[0])):(d.filters=l,d.logic=s)),d},_createClearIcon:function(){var t=this;e("<button type='button' class='k-button k-button-icon'/>").attr(o.attr("bind"),"visible:operatorVisible").html("<span class='k-icon k-i-close'/>").click(m(t.clearFilter,t)).appendTo(t.wrapper)},clearFilter:function(){this.viewModel.set("value",null)},destroy:function(){var e=this;e.filterModel=null,l.fn.destroy.call(e),o.destroy(e.element)},events:[d],options:{name:"FilterCell",delay:200,values:t,customDataSource:!1,field:"",dataTextField:"",type:"string",suggestDataSource:null,operator:"eq",showOperators:!0,template:null,messages:{isTrue:"is true",isFalse:"is false",filter:"Filter",clear:"Clear",operator:"Operator"},operators:{string:{eq:f,neq:h,startswith:"Starts with",contains:"Contains",doesnotcontain:"Does not contain",endswith:"Ends with"},number:{eq:f,neq:h,gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"},date:{eq:f,neq:h,gte:"Is after or equal to",gt:"Is after",lte:"Is before or equal to",lt:"Is before"},enums:{eq:f,neq:h}}}});a.plugin(g)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});