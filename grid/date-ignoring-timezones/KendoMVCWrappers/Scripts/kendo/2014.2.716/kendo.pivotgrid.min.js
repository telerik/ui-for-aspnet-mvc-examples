/*
* Kendo UI v2014.2.716 (http://www.telerik.com/kendo-ui)
* Copyright 2014 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at
* http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
!function(e,define){define(["./kendo.dom.min","./kendo.data.min"],e)}(function(){return function(e,t){function n(e){var n="string"==typeof e?{name:e,expand:!1}:e,i="[object Array]"===st.call(n)?n:n!==t?[n]:[];return dt(i,function(e){return"string"==typeof e?{name:e,expand:!1}:{name:e.name,expand:e.expand}})}function i(e,t,n){var r,o,a,s;for(s=0;t.length>s;s++)r=t[s].members[n],o=r.name,a=r.parentName||"",r.children.length>0?(e[o]=!0,i(e,r.children,n)):a in e||(e[o]=!1)}function r(e){var t,n,r,o,a={};if(e.length)for(t=e[0].members||[],n=0;t.length>n;n++)t[n].measure||i(a,e,n);r=[];for(o in a)r.push({name:o,expand:a[o]});return r}function o(e,t){var n,i,r,o,a=t.tuples||[],s=a[0];if(s&&s.members.length>e.length)for(n=s.members,i=0;n.length>i;i++)if(!n[i].measure){for(r=!1,o=0;e.length>o;o++)if(0===e[o].name.indexOf(n[i].hierarchy)){r=!0;break}r||e.push(n[i])}}function a(e){var t,n=[],i=e.members;for(t=0;i.length>t;t++)i[t].measure||n.push({name:i[t].name,expand:i[t].children.length>0});return n}function s(e,t,i){var r,s;return e=e||{},o(t,e),i.length>1&&t.push({name:"Measures",measure:!0,children:n(i)}),r={members:t},e.tuples&&(s=_(e.tuples,r),s.tuple&&(t=a(s.tuple))),t}function l(e,t,n,i,r){var o,a;e[e.length]={ordinal:t,value:n[i].aggregates,fmtValue:r?nt.format(r,n[i].aggregates):n[i].aggregates},o=n[i].items;for(a in o)e[e.length]={ordinal:t+o[a].index+1,value:o[a].aggregate,fmtValue:r?nt.format(r,o[a].aggregate):o[a].aggregate}}function d(e,n,i){return e.tuples.length<f(n.tuples,i)?n:t}function c(e,t,n,i,r){var o,a,s,l=e.length,d=f(t,i),c=i.length||1;for(a=0;n>a;a++)for(o=0;l>o;o++)s=p(e[o],t)*c,s+=o%c,r[a*l+o].ordinal=a*d+s}function u(e,t,n,i,r){var o,a,s,l=e.length,d=(f(t,i),i.length||1);for(a=0;l>a;a++)for(s=p(e[a],t),s*=d,s+=a%d,o=0;n>o;o++)r[a*n+o].ordinal=s*n+o}function p(e,t){return _(t,e).index}function f(e,t){var n,i,r;if(!e.length)return 0;for(n=e.slice(),i=n.shift(),r=1;i;)i.members?[].push.apply(n,i.members):i.children&&(i.measure||(r+=i.children.length),[].push.apply(n,i.children)),i=n.shift();return t.length&&(r*=t.length),r}function h(e){return e||(e={tuples:[]}),e.tuples||(e.tuples=[]),e}function m(e,t,n){var i,r,o;if(!e)return 0;for(i=Math.max(n.length,1),r=e.members.slice(0,t),o=r.shift();o;)o.children?[].push.apply(r,o.children):(i++,[].push.apply(r,o.members)),o=r.shift();return i}function g(e,t,n){var i,r,o,a,s,l;if(!t[0])return{parsedRoot:null,tuples:e,memberIndex:0,index:0};if(i=_(e,t[0]),!i.tuple)return{parsedRoot:null,tuples:t,memberIndex:0,index:0};if(r=i.tuple.members,o=t[0].members,a=-1,r.length!==o.length)return{parsedRoot:null,tuples:t,memberIndex:0,index:0};for(s=0,l=r.length;l>s;s++)!r[s].measure&&o[s].children[0]&&(-1==a&&o[s].children.length&&(a=s),r[s].children=o[s].children);return n=Math.max(n.length,1),{parsedRoot:i.tuple,index:i.index*n,memberIndex:a,tuples:e}}function v(e,t){var n,i,r=!0;for(e=e.members,t=t.members,n=0,i=e.length;i>n;n++)e[n].measure||t[n].measure||(r=r&&e[n].name===t[n].name);return r}function _(e,t){var n,i,r,o,a,s,l,d=0;for(n=0,i=e.length;i>n;n++){if(r=e[n],v(r,t))return{tuple:r,index:d};for(d++,a=0,s=r.members.length;s>a;a++)if(l=r.members[a],!l.measure&&(o=_(l.children,t),d+=o.index,o.tuple))return{tuple:o.tuple,index:d}}return{index:d}}function b(e,t){var n,i,r,o="";for(i=0,r=e.length;r>i;i++)n=e[i],o+=n.name,t[o]||(t[o]=n)}function k(e,t){var n,i,r,o,a=e.members,s="",l="";for(n=0,i=a.length;i>n;n++){if(r=a[n],o){if(t[s+r.name]){s+=r.name,o=t[s];continue}return t[s+r.parentName]?t[s+r.parentName]:(r.parentName&&(l+=r.parentName),t[l])}if(s+=r.name,o=t[r.parentName],!o&&(o=t[s],!o))return null;o&&(l+=o.name)}return o}function w(e,t){var n,i,r,o;if(0===t.length)return-1;for(n=t[0],i=e.members,r=0,o=i.length;o>r;r++)if(i[r].name==n)return r}function y(n,i){if(!(0>i)){var r={name:"Measures",measure:!0,children:[e.extend({members:[],dataIndex:n.dataIndex},n.members[i])]};n.members.splice(i,1,r),n.dataIndex=t}}function x(e,t){var n,i,r,o,a,s;if(1>e.length)return[];for(n=[],i={},r=w(e[0],t),o=0;e.length>o;o++)a=e[o],a.dataIndex=o,y(a,r),s=k(a,i),s?s.children.push(0>r||!s.measure?a:a.members[r].children[0]):n.push(a),b(a.members,i);return n}function C(e,t){var n,i,r,o,a,s,l,d;if(!e||!e.length)return t;for(n=[],i=S(e),r=i.length,o=Math.max(t.length/r,1),a=0;r>a;a++)for(l=o*a,d=o*i[a],s=0;o>s;s++)n[l+s]=t[d+s];return n}function T(e,t){var n,i,r,o,a,s,l;if(!e||!e.length)return t;for(n=[],i=S(e),r=i.length,o=Math.max(t.length/r,1),s=0;o>s;s++)for(l=r*s,a=0;r>a;a++)n[l+a]=t[i[a]+l];return n}function S(e){var n,i,r,o,a,s,l;for(e=e.slice(),n=[],i=e.shift();i;){for(i.dataIndex!==t&&n.push(i.dataIndex),a=0,r=0,o=i.members.length;o>r;r++)l=i.members[r],s=l.children,l.measure?[].splice.apply(e,[0,0].concat(s)):[].splice.apply(e,[a,0].concat(s)),a+=s.length;i=e.shift()}return n}function F(e,t){var n,i=[];for(n=0;e.length>n;n++)i.push(t(e[n]));return i}function D(e){var t=e.split(".");return t.length>2?t[0]+"."+t[1]:e}function E(e){var t,n,i,r=e.slice(0);for(t=0;e.length>t;t++)for(n=D(e[t].name),i=t+1;r.length>i;)0===r[i].name.indexOf(n)?r.splice(i,1):i++;return r}function A(e,t){var n,i,r,o=[];for(n=0;e.length>n;n++)i=e[n].name,r=D(t),(t==i||0!==i.indexOf(r))&&o.push(e[n]);return o}function H(e){var t,n,i,r,o,a,s,l={};for(t=0;e.length>t;t++)for(n=e[t].name,i=D(n),r=0;e.length>r;r++)o=e[r].name,0===o.indexOf(i)&&o!==n&&(l[n]=e[t]);a=[];for(s in l)a.push(l[s]);return a}function I(e,t){return F(e,function(e){var n,i=e.name,r=!1;for(n=0;t.length>n;n++)if(i===t[n]){r=!0;break}return e.expand&&r&&(i+=".Children"),i})}function N(e){return F(e,function(e){var t=e.name;return e.expand&&(t+=".Children"),t})}function M(e){return F(e,function(e){return e.name})}function R(e){var t,n="CROSSJOIN({";return e.length>2?(t=e.pop(),n+=R(e)):(n+=e.shift(),t=e.pop()),n+="},{",n+=t,n+="})"}function O(e,t){var n=e;return t.length>1&&n.push("{"+t.join(",")+"}"),R(n)}function z(e){var t,n=[];for(t=0;e.length>t;t++)e[t].expand&&n.push(e[t]);return n}function P(t,n){var i,r,o,a,s,l,d,c,u,p,f,h="";if(t=t||[],i=M(E(t)),r=z(t),i.length>1||n.length>1){if(h+=O(i,n),r.length)for(o=0,d=[],c=H(t),u=[],a=0;r.length>a;a++){for(s=o;r.length>s;s++)l=r[s].name,p=E(t),e.inArray(r[s],c)>-1&&(p=A(t,l)),f=O(I(p,d.concat(l)),n),-1==e.inArray(f,u)&&(h+=",",h+=f,u.push(f));o++,d.push(r[a].name),d.shift()}}else r.length&&(i=i.concat(N(t))),h+=i.join(",");return h}function L(e){var t="",n=e.value,i=e.field,r=e.operator;return"in"==r?(t+="{",t+=n,t+="}"):(t+="Filter(",t+=i+".Children",t+=nt.format(V[r],i,n),t+=")"),t}function B(e,t){var n,i,r="",o=e.filters,a=o.length;for(i=a-1;i>=0;i--)n="SELECT (",n+=L(o[i]),n+=") ON 0",i==a-1?(n+=" FROM ["+t+"]",r=n):r=n+" FROM ( "+r+" )";return r}function W(e,t,n){var i,r,o="";if(t){o+="<"+e+">";for(r in t)i=t[r],n&&(r=r.replace(/([A-Z]+(?=$|[A-Z][a-z])|[A-Z]?[a-z]+)/g,"$1_").toUpperCase().replace(/_$/,"")),o+="<"+r+">"+i+"</"+r+">";o+="</"+e+">"}else o+="<"+e+"/>";return o}function U(e){if(null==e)return[];var t=st.call(e);return"[object Array]"!==t?[e]:e}function q(e){var t,n,i,r,o={tuples:[]},a=U(nt.getter("Tuples.Tuple",!0)(e)),s=nt.getter("Caption['#text']"),l=nt.getter("UName['#text']"),d=nt.getter("LName['#text']"),c=nt.getter("LNum['#text']"),u=nt.getter("CHILDREN_CARDINALITY['#text']",!0),p=nt.getter("['@Hierarchy']"),f=nt.getter("PARENT_UNIQUE_NAME['#text']",!0);for(t=0;a.length>t;t++){for(n=[],i=U(a[t].Member),r=0;i.length>r;r++)n.push({children:[],caption:s(i[r]),name:l(i[r]),levelName:d(i[r]),levelNum:c(i[r]),hasChildren:parseInt(u(i[r]),10)>0,parentName:f(i[r]),hierarchy:p(i[r])});o.tuples.push({members:n})}return o}var V,j,$,G,Y,Q,K,J,X,Z,et,tt,nt=window.kendo,it=nt.ui,rt=nt.Class,ot=it.Widget,at=nt.data.DataSource,st={}.toString,lt=function(e){return e},dt=e.map,ct=e.extend,ut=nt.isFunction,pt="change",ft="error",ht="progress",mt="stateReset",gt="<div/>",vt=".kendoPivotGrid",_t="__row_total__",bt="dataBinding",kt="dataBound",wt="expandMember",yt="collapseMember",xt="k-i-arrow-s",Ct="k-i-arrow-e",Tt='<table class="k-pivot-layout"><tr><td><div class="k-pivot-rowheaders"></div></td><td><div class="k-pivot-table k-state-default"></div></td></tr></table>',St=rt.extend({init:function(e){this.options=ct({},this.options,e),this.dimensions=this._normalizeDescriptors("field",this.options.dimensions),this.measures=this._normalizeDescriptors("name",this.options.measures)},_normalizeDescriptors:function(e,t){var n,i,r,o;if(t=t||{},n={},"[object Array]"===st.call(t)){for(r=0,o=t.length;o>r;r++)i=t[r],"string"==typeof i?n[i]={}:i[e]&&(n[i[e]]=i);t=n}return t},_asTuples:function(e,n){var i,r,o,a,s,l=this.dimensions||[],d=[];if(n.length){for(i={members:[]},r=0,o=n.length;o>r;r++)i.members[i.members.length]={children:[],caption:(l[n[r].name]||{}).caption||"All",name:n[r].name,levelName:n[r].name,levelNum:"0",hasChildren:!0,parentName:t,hierarchy:n[r].name};d[d.length]=i}for(a in e){for(s={members:[]},r=0,o=n.length;o>r;r++)s.members[s.members.length]=0===e[a].parentName.indexOf(n[r].name)?{children:[],caption:e[a].value,name:e[a].name,levelName:e[a].name,levelNum:1,hasChildren:!1,parentName:n[r].name,hierarchy:n[r].name}:{children:[],caption:(l[n[r].name]||{}).caption||"All",name:n[r].name,levelName:n[r].name,levelNum:"0",hasChildren:!0,parentName:t,hierarchy:n[r].name};d[d.length]=s}return d},_toDataArray:function(e,t,n){var i,r,o,a,s;n&&n.length&&(r=(this.measures||{})[n[0]],r.format&&(i=r.format)),o=[],a=0,l(o,a,e,_t,i),a+=t.length;for(s in e)s!==_t&&(l(o,a,e,s,i),a+=t.length);return o},_matchDescriptors:function(e,t,n,i){for(var r,o,a,s,l;i>0;)if(r=t[--i],o=r.name.split("&"),o.length>1&&(a=o[0],s=o[1],l=n[a],l(e)!=s))return!1;return!0},_isExpanded:function(e){for(var t=0,n=e.length;n>t;t++)if(e[t].expand)return!0;return!1},_processColumns:function(e,n,i,r,o,a,s,l){var d,c,u,p,f,h;for(h=0;n.length>h;h++)if(c=n[h],c.expand){if(!this._matchDescriptors(o,n,i,h))continue;d=i[c.name](o),d=d!==t?""+d:d,u=c.name+"&"+d,p=r[u]||{index:s.columnIndex,name:u,parentName:c.name,value:d},f=a.items[u]||{aggregate:0},a.items[u]={index:p.index,aggregate:e(o,f.aggregate)},l&&(r[u]||s.columnIndex++,r[u]=p)}},_measureAggregator:function(e){var t,n,i=e.measures||[],r=(this.measures||{})[i[0]];return r?(n=nt.getter(r.field,!0),t=function(e,t){return r.aggregate(n(e),t)}):t=function(){return 1},t},_buildGetters:function(e){var t,n,i,r,o={};for(i=0,r=e.length;r>i;i++)t=e[i],n=t.name.split("&"),n.length>1?o[n[0]]=nt.getter(n[0],!0):o[t.name]=nt.getter(t.name,!0);return o},process:function(e,n){var i,r,o,a,s,l,d,c,u,p,f,h,m,g,v,_,b,k,w;if(e=e||[],n=n||{},i=n.columns||[],r=n.rows||[],o={},a={},s={},d={columnIndex:0},c=this._measureAggregator(n),u=this._buildGetters(i),p=this._buildGetters(r),f=!1,i.length||r.length)for(h=this._isExpanded(r),f=!0,m=0,g=e.length;g>m;m++)for(v=o[_t]||{items:{},aggregates:0},this._processColumns(c,i,u,a,e[m],v,d,!h),v.aggregates=c(e[m],v.aggregates),o[_t]=v,_=0,b=r.length;b>_;_++)if(k=r[_],k.expand){if(!this._matchDescriptors(e[m],r,p,_))continue;l=p[k.name](e[m]),l=l!==t?""+l:l,s[l]={name:k.name+"&"+l,parentName:k.name,value:l},w=o[l]||{items:{},aggregates:0},this._processColumns(c,i,u,a,e[m],w,d,!0),w.aggregates=c(e[m],w.aggregates),o[l]=w}return f&&e.length?(a=this._asTuples(a,i),s=this._asTuples(s,r),o=this._toDataArray(o,a,n.measures)):o=a=s=[],{axes:{columns:{tuples:a},rows:{tuples:s}},data:o}}}),Ft=rt.extend({init:function(e,t){this.transport=t,this.options=t.options||{},this.transport.discover||ut(e.discover)&&(this.discover=e.discover)},read:function(e){return this.transport.read(e)},update:function(e){return this.transport.update(e)},create:function(e){return this.transport.create(e)},destroy:function(e){return this.transport.destroy(e)},discover:function(e){return this.transport.discover?this.transport.discover(e):(e.success({}),t)},catalog:function(n){var i,r=this.options||{};return n===t?(r.connection||{}).catalog:(i=r.connection||{},i.catalog=n,this.options.connection=i,e.extend(this.transport.options,{connection:i}),t)},cube:function(e){var n,i=this.options||{};return e===t?(i.connection||{}).cube:(n=i.connection||{},n.cube=e,this.options.connection=n,ct(!0,this.transport.options,{connection:n}),t)}}),Dt=at.extend({init:function(e){var t,i;at.fn.init.call(this,ct(!0,{},{schema:{axes:lt,cubes:lt,catalogs:lt,measures:lt,dimensions:lt,hierarchies:lt,levels:lt,members:lt}},e)),this.options.schema&&this.options.schema.cube&&(this.cubeBuilder=new St(this.options.schema.cube)),this.transport=new Ft(this.options.transport||{},this.transport),this._columns=n(this.options.columns),this._rows=n(this.options.rows),t=this.options.measures||[],i="columns",null!==this.options.measures&&"[object Object]"===st.call(this.options.measures)&&(t=this.options.measures.values||[],i=this.options.measures.axis||"columns"),this._measures=t||[],this._measuresAxis=i,this._axes={}},options:{serverSorting:!0,serverPaging:!0,serverFiltering:!0,serverGrouping:!0,serverAggregates:!0},catalog:function(e){return e===t?this.transport.catalog():(this.transport.catalog(e),this._mergeState({}),this._axes={},this.data([]),t)},cube:function(e){return e===t?this.transport.cube():(this.transport.cube(e),this._axes={},this._mergeState({}),this.data([]),t)},axes:function(){return this._axes},columns:function(e){return e===t?this._columns:(this._clearAxesData=!0,this._columns=n(e),this.query({columns:e,rows:this.rowsAxisDescriptors(),measures:this.measures()}),t)},rows:function(e){return e===t?this._rows:(this._clearAxesData=!0,this._rows=n(e),this.query({columns:this.columnsAxisDescriptors(),rows:e,measures:this.measures()}),t)},measures:function(e){return e===t?this._measures:(this._clearAxesData=!0,this.query({columns:this.columnsAxisDescriptors(),rows:this.rowsAxisDescriptors(),measures:e}),t)},measuresAxis:function(){return this._measuresAxis||"columns"},_expandPath:function(e,t){var i,r,o="columns"===t?"columns":"rows",a="columns"===t?"rows":"columns",l=n(e),d=l[l.length-1].name;for(this._lastExpanded=o,l=s(this.axes()[o],l,this.measures()),i=0;l.length>i;i++)if(l[i].name===d){if(l[i].expand)return;l[i].expand=!0}else l[i].expand=!1;r={},r[o]=l,r[a]=this._descriptorsForAxis(a),this._query(r)},_descriptorsForAxis:function(e){var t=this.axes(),n=this[e]()||[];return t&&t[e]&&t[e].tuples&&t[e].tuples[0]&&(n=r(t[e].tuples||[])),n},columnsAxisDescriptors:function(){return this._descriptorsForAxis("columns")},rowsAxisDescriptors:function(){return this._descriptorsForAxis("rows")},_process:function(e,t){this._view=e,t=t||{},t.items=t.items||this._view,this.trigger(pt,t)},_query:function(e){var t=this;e||(this._clearAxesData=!0),t.query(ct({},{page:t.page(),pageSize:t.pageSize(),sort:t.sort(),filter:t.filter(),group:t.group(),aggregate:t.aggregate(),columns:this.columnsAxisDescriptors(),rows:this.rowsAxisDescriptors(),measures:this.measures()},e))},query:function(e){var t=this._mergeState(e);this._data.length&&this.cubeBuilder?(this._params(t),this._updateLocalData(this._pristineData)):this.read(t)},_mergeState:function(e){return e=at.fn._mergeState.call(this,e),e!==t&&(this._measures=U(e.measures),e.columns?e.columns=n(e.columns):e.columns||(this._columns=[]),e.rows?e.rows=n(e.rows):e.rows||(this._rows=[])),e},filter:function(e){return e===t?this._filter:(this._clearAxesData=!0,this._query({filter:e,page:1}),t)},expandColumn:function(e){this._expandPath(e,"columns")},expandRow:function(e){this._expandPath(e,"rows")},success:function(e){var t;this.cubeBuilder&&(t=(this.reader.data(e)||[]).slice(0)),at.fn.success.call(this,e),t&&(this._pristineData=t)},_processResult:function(e,t){var n,i,r,o,a,s,l,p,m;return this.cubeBuilder&&(n=this.cubeBuilder.process(e,this._requestData),e=n.data,t=n.axes),s=this.columns().length,l=this.rows().length,p=t.columns&&t.columns.tuples,s||!l||!p||!this._rowMeasures().length&&this.measures().length||(t={columns:{},rows:t.columns}),s||l||"rows"!==this.measuresAxis()||!p||(t={columns:{},rows:t.columns}),this._axes={columns:h(this._axes.columns),rows:h(this._axes.rows)},t={columns:h(t.columns),rows:h(t.rows)},e=this._normalizeData(e,t.columns.tuples.length,t.rows.tuples.length),"rows"==this._lastExpanded?(i=t.columns.tuples,o=this._columnMeasures(),r=d(t.columns,this._axes.columns,o),r&&(a="columns",t.columns=r,c(i,r.tuples,t.rows.tuples.length,o,e),e=this._normalizeData(e,f(t.columns.tuples,o),t.rows.tuples.length))):"columns"==this._lastExpanded&&(i=t.rows.tuples,o=this._rowMeasures(),r=d(t.rows,this._axes.rows,o),r&&(a="rows",t.rows=r,u(i,r.tuples,t.columns.tuples.length,o,e),e=this._normalizeData(e,f(t.rows.tuples,o),t.columns.tuples.length))),this._lastExpanded=null,m=this._mergeAxes(t,e,a),this._axes=m.axes,m.data},_readData:function(e){var t=this.reader.axes(e),n=this.reader.data(e);return this._processResult(n,t)},_mergeAxes:function(e,t,n){var i,r,o,a,s,l=this._columnMeasures(),d=this._rowMeasures(),c=this.axes(),u=e.rows.tuples.length,p=f(c.columns.tuples,l),h=e.columns.tuples.length;return"columns"==n?(h=p,r=e.columns.tuples):(r=x(e.columns.tuples,l),t=T(r,t)),o=g(c.columns.tuples,r,l),"rows"==n?(u=f(e.rows.tuples,d),r=e.rows.tuples):(r=x(e.rows.tuples,d),t=C(r,t)),a=g(c.rows.tuples,r,d),c.columns.tuples=o.tuples,c.rows.tuples=a.tuples,p!==f(c.columns.tuples,l)?(i=o.index+m(o.parsedRoot,o.memberIndex,l),s=p+h,t=this._mergeColumnData(t,i,u,h,s)):(i=a.index+m(a.parsedRoot,a.memberIndex,d),t=this._mergeRowData(t,i,u,h)),{axes:c,data:t}},_mergeColumnData:function(e,t,n,i,r){var o,a,s,l=this.data().toJSON(),d=0,c=Math.max(this._columnMeasures().length,1);for(n=Math.max(n,1),l.length>0&&(d=c,r-=c),o=0;n>o;o++)a=t+o*r,s=e.splice(0,i),s.splice(0,d),[].splice.apply(l,[a,0].concat(s));return l},_mergeRowData:function(e,t,n,i){var r,o,a,s=this.data().toJSON(),l=Math.max(this._rowMeasures().length,1);for(i=Math.max(i,1),s.length>0&&(n-=l,e.splice(0,i*l)),r=0;n>r;r++)a=e.splice(0,i),o=t*i+r*i,[].splice.apply(s,[o,0].concat(a));return s},_columnMeasures:function(){var e=this.measures(),t=[];return"columns"===this.measuresAxis()&&(0===this.columns().length?t=e:e.length>1&&(t=e)),t},_rowMeasures:function(){var e=this.measures(),t=[];return"rows"===this.measuresAxis()&&(0===this.rows().length?t=e:e.length>1&&(t=e)),t},_updateLocalData:function(e,t){this.cubeBuilder&&(t&&(this._requestData=t),e=this._processResult(e)),this._data=this._observe(e),this._ranges=[],this._addRange(this._data),this._total=this._data.length,this._pristineTotal=this._total,this._process(this._data)},data:function(e){var n=this;return e===t?n._data:(this._pristineData=e.slice(0),this._updateLocalData(e,{columns:this.columns(),rows:this.rows(),measures:this.measures()}),t)},_normalizeData:function(e,t,n){var i,r,o,a=(t||1)*(n||1),s=Array(a);if(e.length===a)return e;for(r=0,o=s.length;o>r;r++)s[r]={value:"",fmtValue:"",ordinal:r};for(r=0,o=e.length;o>r;r++)i=e[r],s[i.ordinal]=i;return s},discover:function(t,n){var i=this,r=i.transport;return e.Deferred(function(e){r.discover(ct({success:function(t){t=i.reader.parse(t),i._handleCustomErrors(t)||(n&&(t=n(t)),e.resolve(t))},error:function(t,n,r){e.reject(t),i.error(t,n,r)}},t))}).promise().done(function(){i.trigger("schemaChange")})},schemaMeasures:function(){var e=this;return e.discover({data:{command:"schemaMeasures",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}}},function(t){return e.reader.measures(t)})},schemaDimensions:function(){var e=this;return e.discover({data:{command:"schemaDimensions",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}}},function(t){return e.reader.dimensions(t)})},schemaHierarchies:function(e){var t=this;return t.discover({data:{command:"schemaHierarchies",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),dimensionUniqueName:e}}},function(e){return t.reader.hierarchies(e)})},schemaLevels:function(e){var t=this;return t.discover({data:{command:"schemaLevels",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),hierarchyUniqueName:e}}},function(e){return t.reader.levels(e)})},schemaCubes:function(){var e=this;return e.discover({data:{command:"schemaCubes",restrictions:{catalogName:e.transport.catalog()}}},function(t){return e.reader.cubes(t)})},schemaCatalogs:function(){var e=this;return e.discover({data:{command:"schemaCatalogs"}},function(t){return e.reader.catalogs(t)})},schemaMembers:function(e){var t=this;return t.discover({data:{command:"schemaMembers",restrictions:ct({catalogName:t.transport.catalog(),cubeName:t.transport.cube()},e)}},function(e){return t.reader.members(e)})},_params:function(e){this._clearAxesData&&(this._axes={},this._data=this._observe([]),this._clearAxesData=!1,this.trigger(mt));var t=at.fn._params.call(this,e);return t=ct({measures:this.measures(),measuresAxis:this.measuresAxis(),columns:this.columns(),rows:this.rows()},t),this.cubeBuilder&&(this._requestData=t),t}});Dt.create=function(e){e=e&&e.push?{data:e}:e;var t=e||{},n=t.data;if(t.data=n,!(t instanceof Dt)&&t instanceof nt.data.DataSource)throw Error("Incorrect DataSource type. Only PivotDataSource instances are supported");return t instanceof Dt?t:new Dt(t)},V={contains:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") > 0',doesnotcontain:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") = 0',startswith:', Left({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',endswith:', Right({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',eq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"',neq:', NOT {0}.CurrentMember.MEMBER_CAPTION = "{1}"'},j={schemaCubes:"MDSCHEMA_CUBES",schemaCatalogs:"DBSCHEMA_CATALOGS",schemaMeasures:"MDSCHEMA_MEASURES",schemaDimensions:"MDSCHEMA_DIMENSIONS",schemaHierarchies:"MDSCHEMA_HIERARCHIES",schemaLevels:"MDSCHEMA_LEVELS",schemaMembers:"MDSCHEMA_MEMBERS"},$={read:function(e){var t,n,i,r,o='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement>';return o+="SELECT NON EMPTY {",t=e.columns||[],n=e.rows||[],i=e.measures||[],r="rows"===e.measuresAxis,!t.length&&n.length&&(!i.length||i.length&&r)&&(t=n,n=[],r=!1),t.length||n.length||(r=!1),t.length?o+=P(t,r?[]:i):i.length&&!r&&(o+=i.join(",")),o+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON COLUMNS",(n.length||r&&i.length>1)&&(o+=", NON EMPTY {",o+=n.length?P(n,r?i:[]):i.join(","),o+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON ROWS"),e.filter?(o+=" FROM ",o+="(",o+=B(e.filter,e.connection.cube),o+=")"):o+=" FROM ["+e.connection.cube+"]",1==i.length&&t.length&&(o+=" WHERE ("+i.join(",")+")"),o+="</Statement></Command><Properties><PropertyList><Catalog>"+e.connection.catalog+"</Catalog><Format>Multidimensional</Format></PropertyList></Properties></Execute></Body></Envelope>",o.replace(/\&/g,"&amp;")},discover:function(t){t=t||{};var n='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis">';return n+="<RequestType>"+(j[t.command]||t.command)+"</RequestType>",n+="<Restrictions>"+W("RestrictionList",t.restrictions,!0)+"</Restrictions>",t.connection&&t.connection.catalog&&(t.properties=e.extend({},{Catalog:t.connection.catalog},t.properties)),n+="<Properties>"+W("PropertyList",t.properties)+"</Properties>",n+="</Discover></Body></Envelope>"}},G=nt.data.RemoteTransport.extend({init:function(e){var t=e;e=this.options=ct(!0,{},this.options,e),nt.data.RemoteTransport.call(this,e),ut(t.discover)?this.discover=t.discover:"string"==typeof t.discover?this.options.discover={url:t.discover}:t.discover||(this.options.discover=this.options.read)},setup:function(t,n){return t.data=t.data||{},e.extend(!0,t.data,{connection:this.options.connection}),nt.data.RemoteTransport.fn.setup.call(this,t,n)},options:{read:{dataType:"text",contentType:"text/xml",type:"POST"},discover:{dataType:"text",contentType:"text/xml",type:"POST"},parameterMap:function(e,t){return $[t](e,t)}},discover:function(t){return e.ajax(this.setup(t,"discover"))}}),Y={cubes:{name:nt.getter("CUBE_NAME['#text']",!0),caption:nt.getter("CUBE_CAPTION['#text']",!0),description:nt.getter("DESCRIPTION['#text']",!0),type:nt.getter("CUBE_TYPE['#text']",!0)},catalogs:{name:nt.getter("CATALOG_NAME['#text']",!0),description:nt.getter("DESCRIPTION['#text']",!0)},measures:{name:nt.getter("MEASURE_NAME['#text']",!0),caption:nt.getter("MEASURE_CAPTION['#text']",!0),uniqueName:nt.getter("MEASURE_UNIQUE_NAME['#text']",!0),description:nt.getter("DESCRIPTION['#text']",!0),aggregator:nt.getter("MEASURE_AGGREGATOR['#text']",!0),groupName:nt.getter("MEASUREGROUP_NAME['#text']",!0),displayFolder:nt.getter("MEASURE_DISPLAY_FOLDER['#text']",!0),defaultFormat:nt.getter("DEFAULT_FORMAT_STRING['#text']",!0)},dimensions:{name:nt.getter("DIMENSION_NAME['#text']",!0),caption:nt.getter("DIMENSION_CAPTION['#text']",!0),description:nt.getter("DESCRIPTION['#text']",!0),uniqueName:nt.getter("DIMENSION_UNIQUE_NAME['#text']",!0),defaultHierarchy:nt.getter("DEFAULT_HIERARCHY['#text']",!0),type:nt.getter("DIMENSION_TYPE['#text']",!0)},hierarchies:{name:nt.getter("HIERARCHY_NAME['#text']",!0),caption:nt.getter("HIERARCHY_CAPTION['#text']",!0),description:nt.getter("DESCRIPTION['#text']",!0),uniqueName:nt.getter("HIERARCHY_UNIQUE_NAME['#text']",!0),dimensionUniqueName:nt.getter("DIMENSION_UNIQUE_NAME['#text']",!0),displayFolder:nt.getter("HIERARCHY_DISPLAY_FOLDER['#text']",!0),origin:nt.getter("HIERARCHY_ORIGIN['#text']",!0),defaultMember:nt.getter("DEFAULT_MEMBER['#text']",!0)},levels:{name:nt.getter("LEVEL_NAME['#text']",!0),caption:nt.getter("LEVEL_CAPTION['#text']",!0),description:nt.getter("DESCRIPTION['#text']",!0),uniqueName:nt.getter("LEVEL_UNIQUE_NAME['#text']",!0),dimensionUniqueName:nt.getter("DIMENSION_UNIQUE_NAME['#text']",!0),displayFolder:nt.getter("LEVEL_DISPLAY_FOLDER['#text']",!0),orderingProperty:nt.getter("LEVEL_ORDERING_PROPERTY['#text']",!0),origin:nt.getter("LEVEL_ORIGIN['#text']",!0),hierarchyUniqueName:nt.getter("HIERARCHY_UNIQUE_NAME['#text']",!0)},members:{name:nt.getter("MEMBER_NAME['#text']",!0),caption:nt.getter("MEMBER_CAPTION['#text']",!0),uniqueName:nt.getter("MEMBER_UNIQUE_NAME['#text']",!0),dimensionUniqueName:nt.getter("DIMENSION_UNIQUE_NAME['#text']",!0),hierarchyUniqueName:nt.getter("HIERARCHY_UNIQUE_NAME['#text']",!0),levelUniqueName:nt.getter("LEVEL_UNIQUE_NAME['#text']",!0),childrenCardinality:nt.getter("CHILDREN_CARDINALITY['#text']",!0)}},Q=nt.data.XmlDataReader.extend({parse:function(e){var t=nt.data.XmlDataReader.fn.parse(e.replace(/<(\/?)(\w|-)+:/g,"<$1"));return nt.getter("['Envelope']['Body']",!0)(t)},errors:function(e){var t=nt.getter("['Fault']",!0)(e);return t?[{faultstring:nt.getter("faultstring['#text']",!0)(t),faultcode:nt.getter("faultcode['#text']",!0)(t)}]:null},axes:function(e){var t,n,i;return e=nt.getter("ExecuteResponse.return.root",!0)(e),t=U(nt.getter("Axes.Axis",!0)(e)),n=q(t[0]),i={},t.length>2&&(i=q(t[1])),{columns:n,rows:i}},data:function(e){var t,n,i,r,o,a;for(e=nt.getter("ExecuteResponse.return.root",!0)(e),t=U(nt.getter("CellData.Cell",!0)(e)),n=[],i=nt.getter("['@CellOrdinal']"),r=nt.getter("Value['#text']"),o=nt.getter("FmtValue['#text']"),a=0;t.length>a;a++)n.push({value:r(t[a]),fmtValue:o(t[a]),ordinal:parseInt(i(t[a]),10)});return n},_mapSchema:function(e,t){var n,i,r,o,a;for(e=nt.getter("DiscoverResponse.return.root",!0)(e),n=U(nt.getter("row",!0)(e)),i=[],r=0;n.length>r;r++){o={};for(a in t)o[a]=t[a](n[r]);i.push(o)}return i},measures:function(e){return this._mapSchema(e,Y.measures)},hierarchies:function(e){return this._mapSchema(e,Y.hierarchies)},levels:function(e){return this._mapSchema(e,Y.levels)},dimensions:function(e){return this._mapSchema(e,Y.dimensions)},cubes:function(e){return this._mapSchema(e,Y.cubes)},catalogs:function(e){return this._mapSchema(e,Y.catalogs)},members:function(e){return this._mapSchema(e,Y.members)}}),ct(!0,nt.data,{PivotDataSource:Dt,XmlaTransport:G,XmlaDataReader:Q,PivotCubeBuilder:St,transports:{xmla:G},readers:{xmla:Q}}),nt.ui.PivotSettingTarget=ot.extend({init:function(t,n){ot.fn.init.call(this,t,n),this.element.addClass("k-pivot-setting"),this.dataSource=nt.data.PivotDataSource.create(n.dataSource),this._refreshHandler=e.proxy(this.refresh,this),this.dataSource.first(pt,this._refreshHandler),n.template||(this.options.template="<div data-"+nt.ns+'name="${data.name || data}">${data.name || data}'+(this.options.enabled?'<a class="k-button k-button-icon k-button-bare"><span class="k-icon k-setting-delete"></span></a>':"")+"</div>"),this.template=nt.template(this.options.template),this.emptyTemplate=nt.template(this.options.emptyTemplate),this._sortable();var i=this;this.element.on("click"+vt,".k-setting-delete",function(){var t=e(this).closest("["+nt.attr("name")+"]").attr(nt.attr("name"));t&&i.remove(t)}),n.filterable&&(this.fieldMenu=new it.PivotFieldMenu(this.element,{messages:this.options.messages.fieldMenu,filter:".k-setting-filter",dataSource:this.dataSource})),this.refresh()},options:{name:"PivotSettingTarget",template:null,filterable:!1,emptyTemplate:"<div class='k-empty'>${data}</div>",setting:"columns",enabled:!0,messages:{empty:"Drop Fields Here"}},setDataSource:function(e){this.dataSource.unbind(pt,this._refreshHandler),this.dataSource=this.options.dataSource=e,this.fieldMenu&&this.fieldMenu.setDataSource(e),e.first(pt,this._refreshHandler),this.refresh()},_sortable:function(){var e=this;e.options.enabled&&(this.sortable=this.element.kendoSortable({connectWith:this.options.connectWith,filter:">:not(.k-empty)",placeholder:function(e){return e.clone().hide()},cursor:"move",change:function(t){var n=t.item.attr(nt.attr("name"));"receive"==t.action?e.add(n):"remove"==t.action?e.remove(n):"sort"==t.action&&e.move(n,t.newIndex)}}).data("kendoSortable"))},_indexOf:function(e,t){var n,i,r=-1;for(n=0,i=t.length;i>n;n++)if(t[n].name===e||t[n]===e){r=n;break}return r},validate:function(e){var t,n,i=2==e.type||"aggregator"in e;return i?"measures"===this.options.setting:"measures"===this.options.setting?i:(t=this.dataSource[this.options.setting](),n=e.defaultHierarchy||e.uniqueName,this._indexOf(n,t)>-1?!1:(t=this.dataSource["columns"===this.options.setting?"rows":"columns"](),this._indexOf(n,t)>-1?!1:!0))},add:function(e){var t=this.dataSource[this.options.setting](),n=this._indexOf(e,t);-1==n&&(t.push(e),this.dataSource[this.options.setting](t))},move:function(e,t){var n=this.dataSource[this.options.setting](),i=this._indexOf(e,n);i>-1&&(n.splice(i,1),n.splice(t,0,e),this.dataSource[this.options.setting](n))},remove:function(e){var t=this.dataSource[this.options.setting](),n=this._indexOf(e,t);n>-1&&(t.splice(n,1),this.dataSource[this.options.setting](t))},refresh:function(){var e=this.dataSource[this.options.setting](),t=this.emptyTemplate(this.options.messages.empty);e.length&&(t=nt.render(this.template,e)),this.element.html(t)},destroy:function(){ot.fn.destroy.call(this),this.dataSource.unbind(pt,this._refreshHandler),this.element.off(vt),this.sortable&&this.sortable.destroy(),this.fieldMenu&&this.fieldMenu.destroy(),this.element=null,this._refreshHandler=null}}),K=ot.extend({init:function(n,i){var r,o,a=this;ot.fn.init.call(a,n,i),a._dataSource(),a._bindConfigurator(),a._wrapper(),a._createLayout(),a._columnBuilder=r=new Z,a._rowBuilder=o=new et,a._contentBuilder=new tt,a.columnsHeader.add(a.rowsHeader).on("click","span.k-icon",function(){var n,i,s,l,d=e(this),c=r,u="expandColumn",p=d.attr(nt.attr("path")),f={axis:"columns",path:e.parseJSON(p)};d.parent().is("td")&&(c=o,u="expandRow",f.axis="rows"),i=d.hasClass(xt),s=c.metadata[p],l=s.expanded===t,n=i?yt:wt,a.trigger(n,f)||(c.metadata[p].expanded=!i,d.toggleClass(xt,!i).toggleClass(Ct,i),!i&&l?a.dataSource[u](f.path):a.refresh())}),a._scrollable(),a.options.autoBind&&a.dataSource.fetch(),nt.notify(a)},events:[bt,kt,wt,yt],options:{name:"PivotGrid",autoBind:!0,reorderable:!0,filterable:!1,height:null,columnWidth:100,configurator:"",messages:{measureFields:"Drop Data Fields Here",columnFields:"Drop Column Fields Here",rowFields:"Drop Rows Fields Here"}},_bindConfigurator:function(){var t=this.options.configurator;
t&&e(t).kendoPivotConfigurator("setDataSource",this.dataSource)},setDataSource:function(e){this.options.dataSource=e,this._dataSource(),this.measuresTarget&&this.measuresTarget.setDataSource(e),this.rowsTarget&&this.rowsTarget.setDataSource(e),this.columnsTarget&&this.columnsTarget.setDataSource(e),this._bindConfigurator(),this.options.autoBind&&e.fetch()},_dataSource:function(){var t=this,n=t.options.dataSource;n=e.isArray(n)?{data:n}:n,t.dataSource&&this._refreshHandler?t.dataSource.unbind(pt,t._refreshHandler).unbind(mt,t._stateResetHandler).unbind(ht,t._progressHandler).unbind(ft,t._errorHandler):(t._refreshHandler=e.proxy(t.refresh,t),t._progressHandler=e.proxy(t._requestStart,t),t._stateResetHandler=e.proxy(t._stateReset,t),t._errorHandler=e.proxy(t._error,t)),t.dataSource=nt.data.PivotDataSource.create(n).bind(pt,t._refreshHandler).bind(ht,t._progressHandler).bind(mt,t._stateResetHandler).bind(ft,t._errorHandler)},_error:function(){this._progress(!1)},_requestStart:function(){this._progress(!0)},_stateReset:function(){this._columnBuilder.reset(),this._rowBuilder.reset()},_wrapper:function(){this.wrapper=this.element.addClass("k-widget k-pivot")},_measureFields:function(){this.measureFields=e(gt).addClass("k-pivot-toolbar k-header k-settings-measures"),this.measuresTarget=this._createSettingTarget(this.measureFields,{setting:"measures",messages:{empty:this.options.messages.measureFields}})},_createSettingTarget:function(t,n){var i='<span class="k-button" data-'+nt.ns+'name="${data.name || data}">${data.name || data}',r="";return n.filterable&&(r+='<span class="k-icon k-filter k-setting-filter"></span>'),this.options.reorderable&&(r+='<span class="k-icon k-si-close k-setting-delete"></span>'),r&&(i+='<span class="k-field-actions">'+r+"</span>"),i+="</span>",new nt.ui.PivotSettingTarget(t,e.extend({template:i,emptyTemplate:'<span class="k-empty">${data}</span>',enabled:this.options.reorderable,dataSource:this.dataSource},n))},_initSettingTargets:function(){this.columnsTarget=this._createSettingTarget(this.columnFields,{connectWith:this.rowFields,setting:"columns",filterable:this.options.filterable,messages:{empty:this.options.messages.columnFields,fieldMenu:this.options.messages.fieldMenu}}),this.rowsTarget=this._createSettingTarget(this.rowFields,{connectWith:this.columnFields,setting:"rows",filterable:this.options.filterable,messages:{empty:this.options.messages.rowFields,fieldMenu:this.options.messages.fieldMenu}})},_createLayout:function(){var t=this,n=e(Tt),i=n.find(".k-pivot-rowheaders"),r=n.find(".k-pivot-table"),o=e(gt).addClass("k-grid k-widget");t._measureFields(),t.columnFields=e(gt).addClass("k-pivot-toolbar k-header k-settings-columns"),t.rowFields=e(gt).addClass("k-pivot-toolbar k-header k-settings-rows"),t.columnsHeader=e('<div class="k-grid-header-wrap" />').wrap('<div class="k-grid-header" />'),t.columnsHeader.parent().css("padding-right",nt.support.scrollbar()),t.rowsHeader=e('<div class="k-grid k-widget k-alt"/>'),t.content=e('<div class="k-grid-content" />'),i.append(t.measureFields),i.append(t.rowFields),i.append(t.rowsHeader),o.append(t.columnsHeader.parent()),o.append(t.content),r.append(t.columnFields),r.append(o),t.wrapper.append(n),t.columnsHeaderTree=new nt.dom.Tree(t.columnsHeader[0]),t.rowsHeaderTree=new nt.dom.Tree(t.rowsHeader[0]),t.contentTree=new nt.dom.Tree(t.content[0]),t._initSettingTargets()},_progress:function(e){nt.ui.progress(this.wrapper,e)},_resize:function(){this.content[0].firstChild&&(this._setSectionsWidth(),this._setSectionsHeight(),this._setContentWidth(),this._setContentHeight())},_setSectionsWidth:function(){var e=this.rowsHeader,t=e.parent(".k-pivot-rowheaders").width("auto"),n=Math.max(this.measureFields.outerWidth(),this.rowFields.outerWidth());n=Math.max(e.children("table").width(),n),t.width(n)},_setSectionsHeight:function(){var e=this.measureFields.height("auto").height(),t=this.columnFields.height("auto").height(),n=this.rowFields.height("auto").innerHeight(),i=this.columnsHeader.height("auto").innerHeight(),r=n-this.rowFields.height(),o=t>e?t:e,a=i>n?i:n;this.measureFields.height(o),this.columnFields.height(o),this.rowFields.height(a-r),this.columnsHeader.height(a)},_setContentWidth:function(){var e=this.content.children("table"),t=this.content.width(),n=e.children("colgroup").children().length,i=100,r=n*this.options.columnWidth;r>t&&(i=Math.ceil(r/t*100)),e.add(this.columnsHeader.children("table")).css("min-width",i+"%")},_setContentHeight:function(){var e=this,n=e.content,i=e.rowsHeader,r=e.options.height,o=nt.support.scrollbar(),a=n[0].offsetHeight===n[0].clientHeight;if(e.wrapper.is(":visible")){if(!r)return a&&(o=0),i.height(n.height()-o),t;r-=e.columnFields.outerHeight(),r-=e.columnsHeader.outerHeight(),2*o>=r&&(r=2*o+1),n.height(r),a&&(o=0),i.height(r-o)}},refresh:function(){var e,t=this,n=t.dataSource,i=n.axes(),r=(i.columns||{}).tuples||[],o=(i.rows||{}).tuples||[],a=t._columnBuilder,s=t._rowBuilder,l={},d={};t.trigger(bt,{action:"rebind"})||(a.measures=n._columnMeasures().length||1,t.columnsHeaderTree.render(a.build(r)),t.rowsHeaderTree.render(s.build(o)),l={indexes:a._indexes,measures:a.measures,metadata:a.metadata},d={indexes:s._indexes,measures:n._rowMeasures().length||1,metadata:s.metadata},t.contentTree.render(t._contentBuilder.build(n.view(),l,d)),t._resize(),t.touchScroller?t.touchScroller.contentResized():(e=nt.touchScroller(t.content),e&&e.movable&&(t.touchScroller=e,e.movable.bind("change",function(e){t.columnsHeader.scrollLeft(-e.sender.x),t.rowsHeader.scrollTop(-e.sender.y)}))),t._progress(!1),t.trigger(kt))},_scrollable:function(){var t=this,n=t.columnsHeader,i=t.rowsHeader;t.content.scroll(function(){n.scrollLeft(this.scrollLeft),i.scrollTop(this.scrollTop)}),i.bind("DOMMouseScroll"+vt+" mousewheel"+vt,e.proxy(t._wheelScroll,t))},_wheelScroll:function(t){var n,i;t.ctrlKey||(n=nt.wheelDeltaY(t),i=this.content.scrollTop(),n&&(t.preventDefault(),e(t.currentTarget).one("wheel"+vt,!1),this.rowsHeader.scrollTop(i+-n),this.content.scrollTop(i+-n)))}}),J=nt.dom.element,X=nt.dom.text,Z=rt.extend({init:function(){this.measures=1,this.metadata={}},build:function(e){var t=this._tbody(e),n=this._colGroup();return[J("table",null,[n,t])]},reset:function(){this.metadata={}},rowLength:function(){var e=this.rows[0]?this.rows[0].children:[],t=e.length,n=0,i=0;if(t)for(;t>i;i++)n+=e[i].attr.colspan||1;return n||(n=this.measures),n},_colGroup:function(){for(var e=this.rowLength(),t=[],n=0;e>n;n++)t.push(J("col",null));return J("colgroup",null,t)},_tbody:function(e){var t=e[0];return this.map={},this.rows=[],this.rootTuple=t,this._indexes=[],t?(this._buildRows(t,0),this._normalizeRows()):this.rows.push(J("tr",null,[J("th",null)])),J("tbody",null,this.rows)},_memberIdx:function(e,t){for(var n=0,i=e[n];i&&i.parentName!==t.name;)n+=1,i=e[n];return i?n:n-1},_normalizeRows:function(){this._normalizeRowSpan(),this._normalizeColSpan()},_normalizeRowSpan:function(){for(var e,t,n,i,r,o=this.rows,a=o.length,s=0,l=nt.attr("tuple-all");a>s;s++)if(e=o[s],1!==e.rowspan)for(i=e.children,n=0,t=i.length;t>n;n++)r=i[n],r.attr[l]&&(r.attr.rowspan=e.rowspan)},_normalizeColSpan:function(){var e,t,n,i=this.rootTuple.members,r=i.length-1,o=i[r];if(!o.measure||(o=i[--r]))for(e=this.map,t=e[o.name+o.levelNum],n=this._rootRowColSpan(t);r;)r-=1,o=i[r],t=e[o.name+o.levelNum],n>1&&(t.children[t.children.length-1].attr.colspan=n),n=this._rootRowColSpan(t)},_rootRowColSpan:function(e){var t=e.children,n=t.length-1,i=t[n],r=i.attr.colspan||1;return i.attr.rowspan>1&&(r+=t[n-1].attr.colspan),r},_rowIndex:function(e){for(var t=this.rows,n=t.length,i=0;n>i&&t[i]!==e;i++);return i},_row:function(e,t,n){var i,r,o=this.rootTuple.members[t].name,a=e.members[t].levelNum,s=o+a,l=this.map,d=l[s];return d?d.notFirst=!1:(d=J("tr",null,[]),d.parentMember=n,d.colspan=0,d.rowspan=1,l[s]=d,i=l[o+(+a-1)],i&&(r=i.children,d.notFirst=r[1]&&-1===r[1].attr.className.indexOf("k-alt")?!0:i.notFirst),this.rows.splice(this._rowIndex(i)+1,0,d)),d.parentMember&&d.parentMember===n||(d.parentMember=n,d.colspan=0),d},_tuplePath:function(e,t){for(var n=[],i=0;t>=i;i++)n.push(e.members[i].name);return n},_measures:function(e){var t,n,i,r=this.map,o=r.measureRow;for(o||(o=J("tr",null,[]),r.measureRow=o,this.rows.push(o)),n=0,i=e.length;i>n;n++)t=e[n],o.children.push(J("th",{className:"k-header"},[X(t.caption||t.name)]));return i},_buildRows:function(e,n,i){var r,o,a,s,l,d,c,u,p,f,h,m,g=e.members,v=[],_=0;if(i&&(n=this._memberIdx(g,i)),a=g[n],a.measure)return this._measures(a.children),t;if(s=this._row(e,n,i),r=a.children,f=r.length,p=nt.stringify(this._tuplePath(e,n)),m=this.metadata[p],this._indexes.push(p),m||(m={maxChildren:0,children:0,maxMembers:0,members:0,measures:1,levelNum:+a.levelNum,parentMember:0!==n},this.metadata[p]=m),a.hasChildren&&(m.expanded===!1&&(f=0,m.children=0),u={className:"k-icon "+(f?xt:Ct)},u[nt.attr("path")]=p,v.push(J("span",u))),v.push(X(a.caption||a.name)),c=J("th",{className:"k-header"+(s.notFirst?" k-first":"")},v),s.children.push(c),s.colspan+=1,l=g[n+1],f){for(d=J("th",{className:"k-header k-alt"},[X(a.caption||a.name)]),s.children.push(d);f>_;_++)o=this._buildRows(r[_],0,a);h=o.colspan,c.attr.colspan=h,m.children=h,m.members=1,s.colspan+=h,s.rowspan=o.rowspan+1,l&&(h=l.measure?this._measures(l.children):this._buildRows(e,n+1).colspan,d.attr.colspan=h,h-=1,m.members+=h,s.colspan+=h)}else l&&(h=l.measure?this._measures(l.children):this._buildRows(e,n+1).colspan,m.members=h,h>1&&(c.attr.colspan=h,s.colspan+=h-1));return m.children>m.maxChildren&&(m.maxChildren=m.children),m.members>m.maxMembers&&(m.maxMembers=m.members),(d||c).attr[nt.attr("tuple-all")]=!0,s}}),et=rt.extend({init:function(){this.metadata={}},build:function(e){var t=this._tbody(e),n=this._colGroup();return[J("table",null,[n,t])]},reset:function(){this.metadata={}},_colGroup:function(){for(var e=this.rows[0].children.length,t=[],n=0;e>n;n++)t.push(J("col",null));return J("colgroup",null,t)},_tbody:function(e){var t=e[0];return this.rootTuple=t,this.rows=[],this.map={},this._indexes=[],t?(this._buildRows(t,0),this._normalize()):this.rows.push(J("tr",null,[J("td",null)])),J("tbody",null,this.rows)},_normalize:function(){for(var e,t,n,i,r=this.rows,o=r.length,a=0,s=this.rootTuple.members,l=s[0].name,d=s.length,c=0,u=this.map;o>a;a++)for(e=r[a],c=0;d>c;c++)n=this[s[c].name],t=e.colspan["dim"+c],t&&n>t.levelNum&&(t.attr.colspan=n-t.levelNum+1);e=u[l],i=u[l+"all"],e&&(e.children[0].attr.className="k-first"),i&&(i.children[0].attr.className="k-first")},_tuplePath:function(e,t){for(var n=[],i=0;t>=i;i++)n.push(e.members[i].name);return n},_row:function(e,t){var n=J("tr",e,t);return n.rowspan=1,n.colspan={},this.rows.push(n),n},_text:function(e){return X(e.caption||e.name)},_buildRows:function(e,t){var n,i,r,o,a,s,l,d,c=this.map,u=e.members,p=u[t],f=u[t+1],h=p.children,m=h.length,g=+p.levelNum+1,v=this.rootTuple.members[t].name,_=this._tuplePath(e,t-1).join(""),b=_+(p.parentName||""),k=c[b+"all"]||c[b],w=[];if(!k||k.hasChild?k=this._row():k.hasChild=!0,p.measure){for(k.children.push(J("td",null,[this._text(h[0])])),k.rowspan=m,d=1;m>d;d++)this._row(k.attr,[J("td",null,[this._text(h[d])])]);return k}if(c[_+p.name]=k,n=nt.stringify(this._tuplePath(e,t)),o=this.metadata[n],this._indexes.push(n),o||(o={maxChildren:0,children:0,maxMembers:0,members:0,measures:1,levelNum:g-1,parentMember:0!==t},this.metadata[n]=o),p.hasChildren&&(o.expanded===!1&&(m=0,o.children=0),a={className:"k-icon "+(m?xt:Ct)},a[nt.attr("path")]=n,w.push(J("span",a))),w.push(this._text(p)),l=J("td",null,w),l.levelNum=g,k.children.push(l),k.colspan["dim"+t]=l,(!this[v]||g>this[v])&&(this[v]=g),m){for(k.hasChild=!1,d=0;m>d;d++)i=this._buildRows(h[d],t),k!==i&&(k.rowspan+=i.rowspan);k.rowspan>1&&(l.attr.rowspan=k.rowspan),o.children=k.rowspan,s=J("td",null,[this._text(p)]),s.levelNum=g,r=this._row({className:"k-grid-footer"},[s]),r.colspan["dim"+t]=s,c[_+p.name+"all"]=r,f&&(i=this._buildRows(e,t+1),s.attr.rowspan=i.rowspan),k.rowspan+=r.rowspan,o.members=r.rowspan}else f&&(k.hasChild=!1,this._buildRows(e,t+1),(s||l).attr.rowspan=k.rowspan,o.members=k.rowspan);return o.children>o.maxChildren&&(o.maxChildren=o.children),o.members>o.maxMembers&&(o.maxMembers=o.members),k}}),tt=rt.extend({init:function(){this.columnAxis={},this.rowAxis={}},build:function(e,t,n){var i,r,o=t.metadata[t.indexes[0]];return this.columnAxis=t,this.rowAxis=n,this.rowLength=o?o.maxChildren+o.maxMembers:t.measures,this.rowLength||(this.rowLength=1),i=this._tbody(e),r=this._colGroup(),[J("table",null,[r,i])]},_colGroup:function(){var e=this.columnAxis.measures,t=[],n=0;for(this.rows[0]&&(e=this.rows[0].children.length);e>n;n++)t.push(J("col",null));return J("colgroup",null,t)},_tbody:function(e){var t=e[0];return this.rows=[],t?(this.columnIndexes=this._indexes(this.columnAxis),this.rowIndexes=this._indexes(this.rowAxis),this._buildRows(e)):this.rows.push(J("tr",null,[J("td",null,[X("")])])),J("tbody",null,this.rows)},_indexes:function(e){var n,i,r,o,a=[],s=e.indexes,l=e.measures,d=e.metadata,c=0,u=0,p=0,f=s.length;if(!f){for(i=0;l>i;i++)a[i]=i;return a}for(;f>p;p++){if(n=d[s[p]],r=n.children+n.members,o=0,r&&(r-=l),n.expanded===!1&&n.children!==n.maxChildren&&(o=n.maxChildren),n.parentMember&&0===n.levelNum&&(r=-1),r>-1){for(i=0;l>i;i++)a[r+u+i]=c,c+=1;for(;a[u]!==t;)u+=1}c+=o}return a},_buildRows:function(e){for(var t,n=this.rowIndexes,i=this.rowLength,r=n.length,o=0;r>o;o++)t=n[o],this.rows.push(this._buildRow(e,t*i))},_buildRow:function(e,t){for(var n,i,r=[],o=this.columnIndexes,a=o.length,s=0;a>s;s++)n=e[t+o[s]],i=n?n.fmtValue||n.value:"",r.push(J("td",null,[X(i)]));return J("tr",null,r)}}),it.plugin(K)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});