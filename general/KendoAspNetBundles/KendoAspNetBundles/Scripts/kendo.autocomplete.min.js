/*
* Kendo UI Complete v2012.2.710 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at http://kendoui.com/complete-license
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
;(function(a,b){function x(a){var b=a.value.length;s(a,b,b)}function w(a,b,c,d){var e=b.split(d);e.splice(u(a,b,d),1,c),d&&e[e.length-1]!==""&&e.push("");return e.join(d)}function v(a,b,c){return b.split(c)[u(a,b,c)]}function u(a,b,c){return c?b.substring(0,a).split(c).length-1:0}var c=window.kendo,d=c.support,e=d.placeholder,f=c.ui,g=c.keys,h=c.data.DataSource,i=f.List,j="change",k="k-state-default",l="disabled",m="k-state-focused",n="k-state-selected",o="k-state-disabled",p="k-state-hover",q="mouseenter mouseleave",r=i.caret,s=i.selectText,t=a.proxy,y=i.extend({init:function(b,d){var f=this,g;d=a.isArray(d)?{dataSource:d}:d,i.fn.init.call(f,b,d),b=f.element,d=f.options,d.placeholder=d.placeholder||b.attr("placeholder"),e&&b.attr("placeholder",d.placeholder),f._wrapper(),f._accessors(),f._dataSource(),b[0].type="text",g=f.wrapper,b.attr("autocomplete","off").addClass("k-input").bind({keydown:t(f._keydown,f),paste:t(f._search,f),focus:function(){f._prev=f.value(),f._placeholder(!1),g.addClass(m),clearTimeout(f._bluring)},blur:function(){f._change(),f._placeholder(),g.removeClass(m)}}),f._enable(),f._popup(),f._old=f.value(),f._placeholder(),c.notify(f)},options:{name:"AutoComplete",suggest:!1,template:"",dataTextField:"",minLength:1,delay:200,height:200,filter:"startswith",ignoreCase:!0,highlightFirst:!1,separator:null,placeholder:"",animation:{}},_dataSource:function(){var a=this;a.dataSource&&a._refreshHandler?a.dataSource.unbind(j,a._refreshHandler):a._refreshHandler=t(a.refresh,a),a.dataSource=h.create(a.options.dataSource).bind(j,a._refreshHandler)},setDataSource:function(a){this.options.dataSource=a,this._dataSource()},events:["open","close",j,"select","dataBinding","dataBound"],setOptions:function(a){i.fn.setOptions.call(this,a),this._template(),this._accessors()},enable:function(a){var b=this,c=b.element,d=b.wrapper;a===!1?(d.removeClass(k).addClass(o).unbind(q),c.attr(l,l)):(d.removeClass(o).addClass(k).bind(q,b._toggleHover),c.removeAttr(l))},close:function(){var a=this;a._current=null,a.popup.close()},refresh:function(){var b=this,d=b.ul[0],e=b.popup,f=b.options,g=b._data(),h=g.length;b.trigger("dataBinding"),d.innerHTML=c.render(b.template,g),b._height(h),h&&(f.highlightFirst&&b.current(a(d.firstChild)),f.suggest&&b.suggest(a(d.firstChild))),b._open&&(b._open=!1,e[h?"open":"close"]()),b._touchScroller&&b._touchScroller.reset(),b._makeUnselectable(),b.trigger("dataBound")},select:function(a){this._select(a)},search:function(a){var b=this,c=b.options,d=c.ignoreCase,e=c.separator,f;a=a||b.value(),b._current=null,clearTimeout(b._typing),e&&(a=v(r(b.element[0]),a,e)),f=a.length,f?f>=b.options.minLength&&(b._open=!0,b.dataSource.filter({value:d?a.toLowerCase():a,operator:c.filter,field:c.dataTextField,ignoreCase:d})):b.popup.close()},suggest:function(a){var c=this,d=c._last,e=c.value(),f=c.element[0],h=r(f),j=c.options.separator,k=e.split(j),l=u(h,e,j),m=h,n;d==g.BACKSPACE||d==g.DELETE?c._last=b:(a=a||"",typeof a!="string"&&(n=i.inArray(a[0],c.ul[0]),n>-1?a=c._text(c._data()[n]):a=""),h<=0&&(h=e.toLowerCase().indexOf(a.toLowerCase())+1),n=e.substring(0,h).lastIndexOf(j),n=n>-1?h-(n+j.length):h,e=k[l].substring(0,n),a&&(n=a.toLowerCase().indexOf(e.toLowerCase()),n>-1&&(a=a.substring(n+e.length),m=h+a.length,e+=a),j&&k[k.length-1]!==""&&k.push("")),k[l]=e,c.value(k.join(j||"")),s(f,h,m))},value:function(a){var c=this,d=c.element[0];if(a!==b)d.value=a,c._placeholder();else{a=d.value;if(d.className.indexOf("k-readonly")>-1)return a===c.options.placeholder?"":a;return a}},_accept:function(a){var b=this;b._focus(a),x(b.element[0])},_keydown:function(b){var c=this,d=c.ul[0],e=b.keyCode,f=c._current,h=c.popup.visible();c._last=e,e===g.DOWN?(h&&c._move(f?f.next():a(d.firstChild)),b.preventDefault()):e===g.UP?(h&&c._move(f?f.prev():a(d.lastChild)),b.preventDefault()):e===g.ENTER||e===g.TAB?(c.popup.visible()&&b.preventDefault(),c._accept(f)):e===g.ESC?c.close():c._search()},_move:function(a){var b=this;a=a[0]?a:null,b.current(a),b.options.suggest&&b.suggest(a)},_placeholder:function(a){if(!e){var c=this,d=c.element,f=c.options.placeholder,g;if(f){g=d.val(),a===b&&(a=!g),a||(g!==f?f=g:f="");if(g===c._old&&!a)return;d.toggleClass("k-readonly",a).val(f)}}},_search:function(){var a=this;clearTimeout(a._typing),a._typing=setTimeout(function(){a._prev!==a.value()&&(a._prev=a.value(),a.search())},a.options.delay)},_select:function(b){var c=this,d=c.options.separator,e=c._data(),f,g;b=a(b),b[0]&&!b.hasClass(n)&&(g=i.inArray(b[0],c.ul[0]),g>-1&&(e=e[g],f=c._text(e),d&&(f=w(r(c.element[0]),c.value(),f,d)),c.value(f),c.current(b.addClass(n))))},_toggleHover:function(b){d.touch||a(b.currentTarget).toggleClass(p,b.type==="mouseenter")},_wrapper:function(){var a=this,b=a.element,c=b[0],d;d=b.parent(),d.is("span.k-widget")||(d=b.wrap("<span />").parent()),d[0].style.cssText=c.style.cssText,b.css({width:"100%",height:c.style.height}),a._focused=a.element,a.wrapper=d.addClass("k-widget k-autocomplete k-header").addClass(c.className)}});f.plugin(y)})(jQuery);