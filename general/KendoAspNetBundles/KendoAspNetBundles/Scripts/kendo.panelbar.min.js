/*
* Kendo UI Complete v2012.2.710 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at http://kendoui.com/complete-license
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
;(function(a,b){function U(a,b){a.find(J).removeClass(E.substr(1)),a.find(K).removeClass(G.substr(1)),b.addClass(E.substr(1)),b.parentsUntil(a,p).filter(":has(.k-header)").addClass(G.substr(1))}function T(b){b=a(b),b.filter(".k-first:not(:first-child)").removeClass(r),b.filter(".k-last:not(:last-child)").removeClass(l),b.filter(":first-child").addClass(r),b.filter(":last-child").addClass(l)}function S(b){b=a(b),b.children(".k-link").children(".k-icon").remove(),b.filter(":has(.k-panel),:has(.k-content)").children(".k-link:not(:has([class*=k-i-arrow]))").each(function(){var b=a(this),c=b.parent();b.append("<span class='k-icon "+(c.hasClass(B.substr(1))?"k-i-arrow-n k-panelbar-collapse":"k-i-arrow-s k-panelbar-expand")+"'/>")})}function R(b,c){b=a(b).addClass("k-item"),b.children(j).addClass(q),b.children("a").addClass(m).children(j).addClass(q),b.filter(":not([disabled]):not([class*=k-state])").addClass("k-state-default"),b.filter("li[disabled]").addClass("k-state-disabled").removeAttr("disabled"),b.filter(":not([class*=k-state])").children("a").filter(":focus").parent().addClass(B.substr(1)),b.find(">div").addClass(u).css({display:"none"}),b.each(function(){var b=a(this);b.children("."+m).length||b.contents().filter(function(){return!this.nodeName.match(i)&&(this.nodeType!=3||!!a.trim(this.nodeValue))}).wrapAll("<span class='"+m+"'/>")}),c.find(" > li > ."+m).addClass("k-header")}var c=window.kendo,d=c.ui,e=a.extend,f=a.each,g=c.template,h=d.Widget,i=/^(ul|a|div)$/i,j="img",k="href",l="k-last",m="k-link",n="error",o="click",p=".k-item",q="k-image",r="k-first",s="expand",t="select",u="k-content",v="activate",w="collapse",x="contentUrl",y="mouseenter",z="mouseleave",A="contentLoad",B=".k-state-active",C="> .k-panel",D="> .k-content",E=".k-state-selected",F=".k-state-disabled",G=".k-state-highlighted",H=p+":not(.k-state-disabled) .k-link",I=p+".k-state-disabled .k-link",J="> li > .k-state-selected, .k-panel > li > .k-state-selected",K="> .k-state-highlighted, .k-panel > .k-state-highlighted",L="k-state-default",M=":visible",N=":empty",O="single",P={content:g("<div class='k-content'#= contentAttributes(data) #>#= content(item) #</div>"),group:g("<ul class='#= groupCssClass(group) #'#= groupAttributes(group) #>#= renderItems(data) #</ul>"),itemWrapper:g("<#= tag(item) # class='#= textClass(item, group) #'#= contentUrl(item) ##= textAttributes(item) #>#= image(item) ##= sprite(item) ##= text(item) ##= arrow(data) #</#= tag(item) #>"),item:g("<li class='#= wrapperCssClass(group, item) #'>#= itemWrapper(data) ## if (item.items) { ##= subGroup({ items: item.items, panelBar: panelBar, group: { expanded: item.expanded } }) ## } #</li>"),image:g("<img class='k-image' alt='' src='#= imageUrl #' />"),arrow:g("<span class='#= arrowClass(item) #'></span>"),sprite:g("<span class='k-sprite #= spriteCssClass #'></span>"),empty:g("")},Q={wrapperCssClass:function(a,b){var c="k-item",d=b.index;b.enabled===!1?c+=" k-state-disabled":b.expanded===!0?c+=" k-state-active":c+=" k-state-default",d===0&&(c+=" k-first"),d==a.length-1&&(c+=" k-last");return c},textClass:function(a,b){var c=m;b.firstLevel&&(c+=" k-header");return c},textAttributes:function(a){return a.url?" href='"+a.url+"'":""},arrowClass:function(a){var b="k-icon";b+=a.expanded?" k-i-arrow-n k-panelbar-collapse":" k-i-arrow-s k-panelbar-expand";return b},text:function(a){return a.encoded===!1?a.text:c.htmlEncode(a.text)},tag:function(a){return a.url?"a":"span"},groupAttributes:function(a){return a.expanded!==!0?" style='display:none'":""},groupCssClass:function(a){return"k-group k-panel"},contentAttributes:function(a){return a.item.expanded!==!0?" style='display:none'":""},content:function(a){return a.content?a.content:a.contentUrl?"":"&nbsp;"},contentUrl:function(a){return a.contentUrl?c.attr("content-url")+'="'+a.contentUrl+'"':""}},V=h.extend({init:function(b,d){var e=this,f;h.fn.init.call(e,b,d),b=e.wrapper=e.element,d=e.options,d.dataSource&&(e.element.empty(),e.append(d.dataSource,b)),e._updateClasses(),d.animation===!1&&(d.animation={expand:{show:!0,effects:{}},collapse:{hide:!0,effects:{}}}),b.delegate(H,o,a.proxy(e._click,e)).delegate(H,y+" "+z,e._toggleHover).delegate(I,o,!1),d.contentUrls&&b.find("> .k-item").each(function(b,c){a(c).find("."+m).data(x,d.contentUrls[b])}),f=b.find("li"+B+" > ."+u),f.length>0&&e.expand(f.parent(),!1),c.notify(e)},events:[s,w,t,v,n,A],options:{name:"PanelBar",animation:{expand:{effects:"expand:vertical",duration:200,show:!0},collapse:{duration:200}},expandMode:"multiple"},expand:function(b,c){var d=this,e={};c=c!==!1,b=this.element.find(b),b.each(function(f,g){g=a(g);var h=g.find(C).add(g.find(D));if(!g.hasClass(F)&&h.length>0){if(d.options.expandMode==O&&d._collapseAllExpanded(g))return d;b.find(G).removeClass(G.substr(1)),g.addClass(G.substr(1)),c||(e=d.options.animation,d.options.animation={expand:{show:!0,effects:{}},collapse:{hide:!0,effects:{}}}),d._triggerEvent(s,g)||d._toggleItem(g,!1,null),c||(d.options.animation=e)}});return d},collapse:function(b,c){var d=this,e={};c=c!==!1,b=d.element.find(b),b.each(function(b,f){f=a(f);var g=f.find(C).add(f.find(D));!f.hasClass(F)&&g.is(M)&&(f.removeClass(G.substr(1)),c||(e=d.options.animation,d.options.animation={expand:{show:!0,effects:{}},collapse:{hide:!0,effects:{}}}),d._triggerEvent(w,f)||d._toggleItem(f,!0,null),c||(d.options.animation=e))});return d},_toggleDisabled:function(a,b){a=this.element.find(a),a.toggleClass(L,b).toggleClass(F.substr(1),!b)},select:function(b){var c=this;b=c.element.find(b);if(arguments.length===0)return c.element.find(J).parent();b.each(function(b,d){d=a(d);var e=d.children("."+m);if(d.is(F))return c;U(c.element,e)});return c},enable:function(a,b){this._toggleDisabled(a,b!==!1);return this},disable:function(a){this._toggleDisabled(a,!1);return this},append:function(b,c){c=this.element.find(c);var d=this._insert(b,c,c.length?c.find(C):null);f(d.items,function(b){d.group.append(this);var c=d.contents[b];c&&a(this).append(c),T(this)}),S(c),T(d.group.find(".k-first, .k-last")),d.group.height("auto");return this},insertBefore:function(b,c){c=this.element.find(c);var d=this._insert(b,c,c.parent());f(d.items,function(b){c.before(this);var e=d.contents[b];e&&a(this).append(e),T(this)}),T(c),d.group.height("auto");return this},insertAfter:function(b,c){c=this.element.find(c);var d=this._insert(b,c,c.parent());f(d.items,function(b){c.after(this);var e=d.contents[b];e&&a(this).append(e),T(this)}),T(c),d.group.height("auto");return this},remove:function(a){a=this.element.find(a);var b=this,c=a.parentsUntil(b.element,p),d=a.parent("ul");a.remove(),d&&!d.hasClass("k-panelbar")&&!d.children(p).length&&d.remove(),c.length&&(c=c.eq(0),S(c),T(c));return b},reload:function(b){var c=this;b=c.element.find(b),b.each(function(){var b=a(this);c._ajaxRequest(b,b.children("."+u),!b.is(M))})},_insert:function(b,c,d){var f=this,g,h=[];if(!c||!c.length)d=f.element;var i=a.isPlainObject(b),j={firstLevel:d.hasClass("k-panelbar"),expanded:d.parent().hasClass("k-state-active"),length:d.children().length};c&&!d.length&&(d=a(V.renderGroup({group:j})).appendTo(c)),i||a.isArray(b)?(g=a.map(i?[b]:b,function(b,c){return typeof b=="string"?a(b):a(V.renderItem({group:j,item:e(b,{index:c})}))}),h=a.map(i?[b]:b,function(b,c){return b.content||b.contentUrl?a(V.renderContent({item:e(b,{index:c})})):!1})):(g=a(b),R(g,f.element));return{items:g,group:d,contents:h}},_toggleHover:function(b){var c=a(b.currentTarget);c.parents("li"+F).length||c.toggleClass("k-state-hover",b.type==y)},_updateClasses:function(){var b=this;b.element.addClass("k-widget k-reset k-header k-panelbar");var c=b.element.find("li > ul").not(function(){return a(this).parentsUntil(".k-panelbar","div").length}).addClass("k-group k-panel").add(b.element),d=c.find("> li:not("+B+") > ul").css({display:"none"}).end().find("> li");d.each(function(){R(this,b.element)}),S(d),T(d)},_click:function(b){var c=this,d=a(b.currentTarget),e=c.element;if(!d.parents("li"+F).length){if(d.closest(".k-widget")[0]!=e[0])return;var f=d.closest("."+m),g=f.closest(p);U(e,f);var h=g.find(C).add(g.find(D)),i=f.attr(k),j=f.data(x)||i&&(i.charAt(i.length-1)=="#"||i.indexOf("#"+c.element[0].id+"-")!=-1);if(h.data("animating"))return;c._triggerEvent(t,g)&&b.preventDefault();if(j||h.length)b.preventDefault();else return;if(c.options.expandMode==O&&c._collapseAllExpanded(g))return;if(h.length){var l=h.is(M);c._triggerEvent(l?w:s,g)||c._toggleItem(g,l,b)}}},_toggleItem:function(a,b,c){var d=this,e=a.find(C);if(e.length)this._toggleGroup(e,b),c&&c.preventDefault();else{var f=a.find("> ."+u);f.length&&(c&&c.preventDefault(),f.is(N)?d._ajaxRequest(a,f,b):d._toggleGroup(f,b))}},_toggleGroup:function(a,b){var c=this,d=c.options.animation,f=d.expand,g=e({},d.collapse),h=g&&"effects"in g;a.is(M)==b&&(a.parent().toggleClass(L,b).toggleClass(B.substr(1),!b).find("> .k-link > .k-icon").toggleClass("k-i-arrow-n",!b).toggleClass("k-panelbar-collapse",!b).toggleClass("k-i-arrow-s",b).toggleClass("k-panelbar-expand",b),b?f=e(h?g:e({reverse:!0},f),{show:!1,hide:!0}):f=e({complete:function(a){c._triggerEvent(v,a.closest(p))}},f),a.kendoStop(!0,!0).kendoAnimate(f))},_collapseAllExpanded:function(b){var c=this,d,e=!1;if(b.find("> ."+m).hasClass("k-header")){var f=b.find(C).add(b.find(D));f.is(M)&&(e=!0),!f.is(M)&&f.length!==0&&(d=a(c.element).children(),d.find(C).add(d.find(D)).filter(function(){return a(this).is(M)}).each(function(b,d){d=a(d),e=c._triggerEvent(w,d.closest(p)),e||c._toggleGroup(d,!0)}));return e}},_ajaxRequest:function(b,c,d){var e=this,f=b.find(".k-panelbar-collapse, .k-panelbar-expand"),g=b.find("."+m),h=setTimeout(function(){f.addClass("k-loading")},100),i={};a.ajax({type:"GET",cache:!1,url:g.data(x)||g.attr(k),dataType:"html",data:i,error:function(a,b){f.removeClass("k-loading"),e.trigger(n,{xhr:a,status:b})&&this.complete()},complete:function(){clearTimeout(h),f.removeClass("k-loading")},success:function(a,f){c.html(a),e._toggleGroup(c,d),e.trigger(A,{item:b[0],contentElement:c[0]})}})},_triggerEvent:function(a,b){var c=this;return c.trigger(a,{item:b[0]})}});e(V,{renderItem:function(a){a=e({panelBar:{},group:{}},a);var b=P.empty,c=a.item;return P.item(e(a,{image:c.imageUrl?P.image:b,sprite:c.spriteCssClass?P.sprite:b,itemWrapper:P.itemWrapper,arrow:c.items||c.content||c.contentUrl?P.arrow:b,subGroup:V.renderGroup},Q))},renderGroup:function(a){return P.group(e({renderItems:function(a){var b="",c=0,d=a.items,f=d?d.length:0,g=e({length:f},a.group);for(;c<f;c++)b+=V.renderItem(e(a,{group:g,item:e({index:c},d[c])}));return b}},a,Q))},renderContent:function(a){return P.content(e(a,Q))}}),c.ui.plugin(V)})(jQuery);