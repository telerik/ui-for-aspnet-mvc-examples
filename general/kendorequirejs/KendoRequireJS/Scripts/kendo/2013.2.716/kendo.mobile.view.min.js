/*
* Kendo UI Complete v2013.2.716 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/


("function"==typeof define&&define.amd?define:function(e,t){return t()})(["./kendo.core.min","./kendo.fx.min","./kendo.mobile.scroller.min"],function(){!function(e,t){function n(e){var t,n,i=e.find(x("popover")),r=d.roles;for(t=0,n=i.length;n>t;t++)s.initWidget(i[t],{},r)}function i(e){s.triggeredByInput(e)||e.preventDefault()}function r(e,t){e[0]&&t[0]&&e[0]!=t[0]&&e.kendoAnimateTo(t,{effects:"fade",duration:p})}function o(t){t.each(function(){s.initWidget(e(this),{},d.roles)})}function a(e){for(var t=e.split("?")[1]||"",n={},i=t.split(/&|=/),r=i.length,o=0;r>o;o+=2)n[i[o]]=i[o+1];return n}var s=window.kendo,l=s.mobile,d=l.ui,c=s.attr,h=s.Class,u=d.Widget,f="init",m="show",p=320,w="beforeShow",v="afterShow",g="hide",y="z-index",_=s.attrValue,x=s.roleSelector,b=u.extend({init:function(t,n){var i=this;u.fn.init.call(i,t,n),t=i.element,i.params={},i._paramsHistory=[],e.extend(i,n),i._layout(),i._scroller(),i._model()},events:[f,w,m,v,g],options:{name:"View",title:"",reload:!1,defaultTransition:"",useNativeScrolling:!1,stretch:!1,zoom:!1,model:null},destroy:function(){this.layout&&this.layout.detach(this),u.fn.destroy.call(this),this.scroller&&this.scroller.destroy(),s.destroy(this.element)},purge:function(){this.destroy(),this.element.remove()},showStart:function(){var e=this;e.element.css("display",""),e.inited||(e.inited=!0,e.trigger(f,{view:e})),e.layout&&e.layout.attach(e),e.trigger(m,{view:e})},hideStart:function(){},hideComplete:function(){var e=this;e.element.hide(),e.trigger(g,{view:e})},updateParams:function(e,t,n){this._paramsHistory[this._paramsHistory.length-2]===JSON.stringify(t)&&(this._paramsHistory.pop(),this.nextViewID=this.id,this.backTransition=this.transition),this.switchWith(new k(this),e,t,n)},switchWith:function(e,t,n,i){var r=this,o=this._paramsHistory,a=function(){r.trigger(v,{view:r}),i()};r.trigger(w,{view:r})||(r._back=o[o.length-1]===JSON.stringify(n),r._back||o.push(JSON.stringify(n)),r.params=n,e?(e.hideStart(),r.showStart(),new V({current:e,next:r,transition:t,defaultTransition:e.options.defaultTransition,complete:a})):(r.showStart(),a()))},parallaxContents:function(e){var t=this,n=t.content;return e.header[0]||(n=n.add(t.header)),e.footer[0]||(n=n.add(t.footer)),n},contentElement:function(){var e=this;return e.options.stretch?e.content:e.scrollerContent},_scroller:function(){var t=this;t.options.stretch?t.content.addClass("km-stretched-view"):(t.content.kendoMobileScroller({zoom:t.options.zoom,useNative:t.options.useNativeScrolling}),t.scroller=t.content.data("kendoMobileScroller"),t.scrollerContent=t.scroller.scrollElement),s.support.kineticScrollNeeded&&(e(t.element).on("touchmove",".km-header",i),t.options.useNativeScrolling||e(t.element).on("touchmove",".km-content",i))},_model:function(){var e=this,t=e.element,i=e.options.model;"string"==typeof i&&(i=s.getter(i)(window)),e.model=i,n(t),e.element.css("display",""),i?s.bind(t.children(),i,d,s.ui,s.dataviz.ui):l.init(t.children()),e.element.css("display","none")},_layout:function(){var e=this,t=x("content"),n=e.element;n.data("kendoView",e).addClass("km-view"),e.transition=_(n,"transition"),e.header=n.children(x("header")).addClass("km-header"),e.footer=n.children(x("footer")).addClass("km-footer"),n.children(t)[0]||n.wrapInner("<div "+c("role")+'="content"></div>'),e.content=n.children(x("content")).addClass("km-content"),e.element.prepend(e.header).append(e.footer),e.id=_(n,"url")||"#"+n.attr("id"),e.layout&&e.layout.setup(e)}}),k=s.mobile.ui.Widget.extend({init:function(t){var n=t.element.clone(!0);e.extend(this,{element:n,header:n.children(x("header")),content:n.children(x("content")),footer:n.children(x("footer")),transition:t.transition,options:{defaultTransition:t.options.defaultTransition},params:JSON.stringify(t.params),id:t.id}),t.element.parent().append(this.element)},parallaxContents:b.prototype.parallaxContents,hideStart:e.noop,hideComplete:function(){this.element.remove()}}),V=h.extend({init:function(t){e.extend(this,t);var n=this,i=n.current,o=n.next,a=i.element,s=o.element,l=o,d=i,c=n._transition();c.reverse&&!c.parallax&&(l=i,d=o),l.element.css(y,1),d.element.css(y,0),c.parallax&&(r(i.footer,o.footer),r(i.header,o.header),a=i.parallaxContents(o),s=o.parallaxContents(i)),a.kendoAnimateTo(s,c),n.back()||(i.nextViewID=o.id,i.backTransition=c.transition)},_transition:function(){var e=this,t=e.current,n=e.next,i=e.back(),r=function(){t.hideComplete(),e.complete()},o=i?n.backTransition:n.transition,a=e.transition||o||e.defaultTransition,s=a.split(" "),l=s[0],d=/^slide/.test(l),c="reverse"===s[1];return e.back()&&!e.transition&&(c=!c),{effects:l,reverse:c,parallax:d,complete:r,transition:a,duration:p}},back:function(){var e=this.next,t=this.current;return e.nextViewID&&e.nextViewID===t.id&&e._back}}),S=u.extend({init:function(e,t){var i=this;u.fn.init.call(i,e,t),e=i.element,i.element=e.detach(),i.header=e.children(x("header")).addClass("km-header"),i.footer=e.children(x("footer")).addClass("km-footer"),i.elements=i.header.add(i.footer),n(e),s.mobile.init(i.element.children()),i.trigger(f,{layout:i})},options:{name:"Layout"},events:[f,m,g],setup:function(e){e.header[0]||(e.header=this.header),e.footer[0]||(e.footer=this.footer)},detach:function(e){var t=this;e.header===t.header&&t.header[0]&&e.element.prepend(t.header.detach()[0].cloneNode(!0)),e.footer===t.footer&&t.footer.length&&e.element.append(t.footer.detach()[0].cloneNode(!0)),t.trigger(g,{layout:t,view:e})},attach:function(e){var t=this,n=t.currentView;n&&t.detach(n),e.header===t.header&&(t.header.detach(),e.element.children(x("header")).remove(),e.element.prepend(t.header)),e.footer===t.footer&&(t.footer.detach(),e.element.children(x("footer")).remove(),e.element.append(t.footer)),t.trigger(m,{layout:t,view:e}),t.currentView=e}}),C=s.Observable,T=/<body[^>]*>(([\u000a\u000d\u2028\u2029]|.)*)<\/body>/i,N="loadStart",W="loadComplete",D="showStart",E="sameViewRequested",I="viewShow",H=C.extend({init:function(t){var n,i,r=this;if(C.fn.init.call(r),e.extend(r,t),r.sandbox=e("<div />"),i=r.container,n=r._hideViews(i),r.rootView=n.first(),!r.rootView[0])throw Error('Your kendo mobile application element does not contain any direct child elements with data-role="view" attribute set. Make sure that you instantiate the mobile application using the correct container.');r._view=null,r.layouts={},r._setupLayouts(i),o(i.children(x("modalview drawer"))),r.loader&&(r.bind(D,function(){r.loader.transition()}),r.bind(N,function(){r.loader.show()}),r.bind(W,function(){r.loader.hide()}),r.bind(I,function(){r.loader.transitionDone()}))},view:function(){return this._view},showView:function(e,n){if(e===this.url)return this.trigger(E),t;this.trigger(D);var i=this,r=function(t){i._show(t,n,a(e))},o=i._findViewElement(e),s=o.data("kendoView");i.url=e,s&&s.reload&&(s.purge(),o=[]),this.trigger("viewTypeDetermined",{remote:0===o.length,url:e}),o[0]?(s||(s=i._createView(o)),r(s)):i._loadView(e,r)},_findViewElement:function(e){var t,n=e.split("?")[0];return e&&"/"!==e?(t=this.container.children("["+c("url")+"='"+n+"']"),t[0]||-1!==n.indexOf("/")||(t=this.container.children("#"===n.charAt(0)?n:"#"+n)),t):this.rootView},_createView:function(e){var n,i=this,r=_(e,"layout");return t===r&&(r=i.layout),r&&(r=i.layouts[r]),n={defaultTransition:i.transition,loader:i.loader,container:i.container,layout:r,reload:_(e,"reload")},s.initWidget(e,n,d.roles)},_loadView:function(n,i){var r=this;return this.serverNavigation?(location.href=n,t):(r._xhr&&r._xhr.abort(),r.trigger(N),r._xhr=e.get(n,function(e){r.trigger(W),i(r._createRemoteView(n,e))},"html").fail(function(e){r.trigger(W),0===e.status&&e.responseText&&i(r._createRemoteView(n,e.responseText))}),t)},_createRemoteView:function(e,t){var n,i,r,a=this,s=a.sandbox,l=e.split("?")[0],d=a.container;return T.test(t)&&(t=RegExp.$1),s[0].innerHTML=t,d.append(s.children("script, style")),n=a._hideViews(s),r=n.first(),r.length||(n=r=s.wrapInner("<div data-role=view />").children()),r.hide().attr(c("url"),l),a._setupLayouts(s),i=s.children(x("modalview drawer")),d.append(s.children(x("layout modalview drawer")).add(n)),o(i),a._createView(r)},_show:function(e,t,n){var i=this;i._view!==e?e.switchWith(i._view,t,n,function(){i._view=e,i.trigger(I,{view:e})}):i._view.updateParams(t,n,function(){i.trigger(I,{view:i._view})})},_hideViews:function(e){return e.children(x("view splitview")).hide()},_setupLayouts:function(n){var i=this;n.children(x("layout")).each(function(){var n=e(this),r=_(n,"platform");(r===t||r===l.application.os.name)&&(i.layouts[s.attrValue(n,"id")]=s.initWidget(n,{},d.roles))})}});s.mobile.ViewEngine=H,d.plugin(b),d.plugin(S)}(window.kendo.jQuery)});